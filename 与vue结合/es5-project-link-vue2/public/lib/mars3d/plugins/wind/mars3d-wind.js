/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.5.6
 * 编译日期：2023-05-07 18:41:04
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x220891=_0x59eb;(function(_0x32ccfa,_0x3b339f){var _0xc39277=_0x59eb,_0x4905d7=_0x32ccfa();while(!![]){try{var _0x1185c=-parseInt(_0xc39277(0xe1))/0x1*(parseInt(_0xc39277(0xff))/0x2)+-parseInt(_0xc39277(0x194))/0x3*(parseInt(_0xc39277(0x167))/0x4)+-parseInt(_0xc39277(0xfb))/0x5*(parseInt(_0xc39277(0x142))/0x6)+-parseInt(_0xc39277(0x1ce))/0x7+-parseInt(_0xc39277(0x1af))/0x8+parseInt(_0xc39277(0x1bb))/0x9*(parseInt(_0xc39277(0x123))/0xa)+parseInt(_0xc39277(0x13c))/0xb;if(_0x1185c===_0x3b339f)break;else _0x4905d7['push'](_0x4905d7['shift']());}catch(_0x369beb){_0x4905d7['push'](_0x4905d7['shift']());}}}(_0x101c,0x9e65a));function _interopNamespace(_0x1d07a2){if(_0x1d07a2&&_0x1d07a2['__esModule'])return _0x1d07a2;var _0x1336e1=Object['create'](null);return _0x1d07a2&&Object['keys'](_0x1d07a2)['forEach'](function(_0x16df6e){var _0x54f154=_0x59eb;if(_0x16df6e!=='default'){var _0x1a800b=Object['getOwnPropertyDescriptor'](_0x1d07a2,_0x16df6e);Object[_0x54f154(0x1b8)](_0x1336e1,_0x16df6e,_0x1a800b['get']?_0x1a800b:{'enumerable':!![],'get':function(){return _0x1d07a2[_0x16df6e];}});}}),_0x1336e1['default']=_0x1d07a2,_0x1336e1;}var mars3d__namespace=_interopNamespace(mars3d),Cesium$7=mars3d__namespace[_0x220891(0xef)];function getU(_0x5e1139,_0x36239e){var _0x180e9f=_0x220891,_0x5c21bd=_0x5e1139*Math['cos'](Cesium$7[_0x180e9f(0x1be)]['toRadians'](_0x36239e));return _0x5c21bd;}function getV(_0xf9e909,_0x1e50f4){var _0x58a703=_0xf9e909*Math['sin'](Cesium$7['Math']['toRadians'](_0x1e50f4));return _0x58a703;}function getSpeed(_0x13bf85,_0x22c218){var _0x3119ae=_0x220891,_0x160d5a=Math['sqrt'](Math['pow'](_0x13bf85,0x2)+Math[_0x3119ae(0x1c0)](_0x22c218,0x2));return _0x160d5a;}function getDirection(_0x4e9ad0,_0x1d862b){var _0x257656=_0x220891,_0x2f55e5=Cesium$7['Math']['toDegrees'](Math[_0x257656(0x161)](_0x1d862b,_0x4e9ad0));return _0x2f55e5+=_0x2f55e5<0x0?0x168:0x0,_0x2f55e5;}var WindUtil={'__proto__':null,'getU':getU,'getV':getV,'getSpeed':getSpeed,'getDirection':getDirection};function ownKeys(_0x3ab8cc,_0x2bb4bb){var _0x5cf1fb=_0x220891,_0x55990d=Object[_0x5cf1fb(0x165)](_0x3ab8cc);if(Object['getOwnPropertySymbols']){var _0x1d3fee=Object['getOwnPropertySymbols'](_0x3ab8cc);_0x2bb4bb&&(_0x1d3fee=_0x1d3fee['filter'](function(_0x353a1f){var _0x17bf9f=_0x5cf1fb;return Object[_0x17bf9f(0x10a)](_0x3ab8cc,_0x353a1f)['enumerable'];})),_0x55990d['push'][_0x5cf1fb(0x191)](_0x55990d,_0x1d3fee);}return _0x55990d;}function _objectSpread2(_0x3bfd8d){var _0x5f4347=_0x220891;for(var _0x13322b=0x1;_0x13322b<arguments['length'];_0x13322b++){var _0x38395c=null!=arguments[_0x13322b]?arguments[_0x13322b]:{};_0x13322b%0x2?ownKeys(Object(_0x38395c),!0x0)['forEach'](function(_0x5be715){_defineProperty(_0x3bfd8d,_0x5be715,_0x38395c[_0x5be715]);}):Object['getOwnPropertyDescriptors']?Object[_0x5f4347(0x18e)](_0x3bfd8d,Object['getOwnPropertyDescriptors'](_0x38395c)):ownKeys(Object(_0x38395c))[_0x5f4347(0x19b)](function(_0x4af6ff){Object['defineProperty'](_0x3bfd8d,_0x4af6ff,Object['getOwnPropertyDescriptor'](_0x38395c,_0x4af6ff));});}return _0x3bfd8d;}function _classCallCheck(_0x4c672c,_0x3b939b){if(!(_0x4c672c instanceof _0x3b939b))throw new TypeError('Cannot\x20call\x20a\x20class\x20as\x20a\x20function');}function _defineProperties(_0x25ade8,_0x45980f){for(var _0x186e22=0x0;_0x186e22<_0x45980f['length'];_0x186e22++){var _0x5421ee=_0x45980f[_0x186e22];_0x5421ee['enumerable']=_0x5421ee['enumerable']||![],_0x5421ee['configurable']=!![];if('value'in _0x5421ee)_0x5421ee['writable']=!![];Object['defineProperty'](_0x25ade8,_0x5421ee['key'],_0x5421ee);}}function _createClass(_0x516696,_0x1217f8,_0x1e1e45){var _0x2e33cb=_0x220891;if(_0x1217f8)_defineProperties(_0x516696['prototype'],_0x1217f8);if(_0x1e1e45)_defineProperties(_0x516696,_0x1e1e45);return Object[_0x2e33cb(0x1b8)](_0x516696,'prototype',{'writable':![]}),_0x516696;}function _defineProperty(_0x42ebb4,_0xd99d49,_0x3f38e5){return _0xd99d49 in _0x42ebb4?Object['defineProperty'](_0x42ebb4,_0xd99d49,{'value':_0x3f38e5,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x42ebb4[_0xd99d49]=_0x3f38e5,_0x42ebb4;}function _inherits(_0x1d6056,_0x27ae9c){var _0x23291d=_0x220891;if(typeof _0x27ae9c!=='function'&&_0x27ae9c!==null)throw new TypeError(_0x23291d(0x13f));_0x1d6056['prototype']=Object[_0x23291d(0x17a)](_0x27ae9c&&_0x27ae9c['prototype'],{'constructor':{'value':_0x1d6056,'writable':!![],'configurable':!![]}}),Object['defineProperty'](_0x1d6056,'prototype',{'writable':![]});if(_0x27ae9c)_setPrototypeOf(_0x1d6056,_0x27ae9c);}function _getPrototypeOf(_0x5c725c){return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf']:function _0x30378f(_0x30700d){var _0x4e8283=_0x59eb;return _0x30700d['__proto__']||Object[_0x4e8283(0x137)](_0x30700d);},_getPrototypeOf(_0x5c725c);}function _setPrototypeOf(_0x230a7d,_0x2e327b){return _setPrototypeOf=Object['setPrototypeOf']||function _0x2ba5af(_0x1c29a5,_0x1c9cb9){return _0x1c29a5['__proto__']=_0x1c9cb9,_0x1c29a5;},_setPrototypeOf(_0x230a7d,_0x2e327b);}function _isNativeReflectConstruct(){var _0x240715=_0x220891;if(typeof Reflect===_0x240715(0x10d)||!Reflect[_0x240715(0x121)])return![];if(Reflect['construct']['sham'])return![];if(typeof Proxy==='function')return!![];try{return Boolean['prototype'][_0x240715(0x16d)]['call'](Reflect['construct'](Boolean,[],function(){})),!![];}catch(_0x5e8301){return![];}}function _0x59eb(_0x22791a,_0xb7292b){var _0x101c14=_0x101c();return _0x59eb=function(_0x59ebcf,_0x31986c){_0x59ebcf=_0x59ebcf-0xda;var _0x1b3c49=_0x101c14[_0x59ebcf];return _0x1b3c49;},_0x59eb(_0x22791a,_0xb7292b);}function _assertThisInitialized(_0x34462c){if(_0x34462c===void 0x0)throw new ReferenceError('this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called');return _0x34462c;}function _possibleConstructorReturn(_0x50eea5,_0x3e9aee){if(_0x3e9aee&&(typeof _0x3e9aee==='object'||typeof _0x3e9aee==='function'))return _0x3e9aee;else{if(_0x3e9aee!==void 0x0)throw new TypeError('Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined');}return _assertThisInitialized(_0x50eea5);}function _createSuper(_0x916dfe){var _0x313292=_isNativeReflectConstruct();return function _0x1aeb14(){var _0x275799=_0x59eb,_0x8ce9ac=_getPrototypeOf(_0x916dfe),_0x5f273b;if(_0x313292){var _0x493700=_getPrototypeOf(this)['constructor'];_0x5f273b=Reflect[_0x275799(0x121)](_0x8ce9ac,arguments,_0x493700);}else _0x5f273b=_0x8ce9ac['apply'](this,arguments);return _possibleConstructorReturn(this,_0x5f273b);};}function _toConsumableArray(_0x3341f5){return _arrayWithoutHoles(_0x3341f5)||_iterableToArray(_0x3341f5)||_unsupportedIterableToArray(_0x3341f5)||_nonIterableSpread();}function _arrayWithoutHoles(_0x32a347){if(Array['isArray'](_0x32a347))return _arrayLikeToArray(_0x32a347);}function _iterableToArray(_0x26f2ed){var _0x698add=_0x220891;if(typeof Symbol!=='undefined'&&_0x26f2ed[Symbol['iterator']]!=null||_0x26f2ed[_0x698add(0x1a2)]!=null)return Array['from'](_0x26f2ed);}function _unsupportedIterableToArray(_0x5a183f,_0x5af62f){var _0x2782df=_0x220891;if(!_0x5a183f)return;if(typeof _0x5a183f==='string')return _arrayLikeToArray(_0x5a183f,_0x5af62f);var _0x4a90f9=Object['prototype']['toString'][_0x2782df(0x134)](_0x5a183f)[_0x2782df(0x1cd)](0x8,-0x1);if(_0x4a90f9==='Object'&&_0x5a183f['constructor'])_0x4a90f9=_0x5a183f['constructor']['name'];if(_0x4a90f9===_0x2782df(0x188)||_0x4a90f9==='Set')return Array['from'](_0x5a183f);if(_0x4a90f9===_0x2782df(0xe6)||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/['test'](_0x4a90f9))return _arrayLikeToArray(_0x5a183f,_0x5af62f);}function _0x101c(){var _0x1d13ad=['trails','RenderState','maxParticles','cancelAnimationFrame','nextTrails','attributeLocations','CanvasWindField','windTextures','dropRate','hidden','getUVByPoint','11365jmIZzf','setOptions','mode','0px','410HRdCSf','style','_setOptionsHook','colorTable','createComputingPrimitives','show','cols','ymin','stroke','mouseUp','east','getOwnPropertyDescriptor','position','depthTexture','undefined','particlesTextureSize','SCENE3D','_pointerEvents','levmin','geometry','depthMask','THREE_PI_OVER_TWO','data','frameTime','defined','_speedRate','particlesComputing','destroyParticlesTextures','#ffffff','PI_OVER_THREE','globe','_onMapWhellEvent','fromCache','wheel','construct','array','40IwQcLK','createTexture','lon','mouse_down','initWorker','vdata','init','pixelSize','globeBoundingSphere','windField','layer','push','addEventListener','ymax','currentParticlesPosition','nextParticlesPosition','UNSIGNED_INT','call','updatePosition','canvasWindy','getPrototypeOf','nextTrailsColor','currentTrails','LayerUtil','createFramebuffer','36294698KKuPoz','speedRate','mouseMove','Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function','_onMap_preRenderEvent','tlng','786tFdYmG','mod','TWO_PI','_onMouseDownEvent','red','Compute','Texture','removeEventListener','primitives','lonRange','createRawRenderState','animateFrame','latRange','shaderProgram','destroy','_removedHook','randomBetween','DISABLE_GL_POSITION_LOG_DEPTH','ShaderSource','preRender','canrefresh','PixelDatatype','add','lineWidth','WindUtil','_drawLines','Color','clearCommand','Cartesian2','_createCanvas','textures','atan2','createSegmentsGeometry','remove','refreshParticles','keys','nextTrailsDepth','24BOhfry','dimensions','postProcessingPosition','createRenderingFramebuffers','max','register','valueOf','_canrefresh','rows','getOptions','updateViewerParameters','resize','Cartesian3','canvasWidth','lev','outputTexture','reverseY','height','bind','create','OPAQUE','CanvasWindLayer','abs','clientHeight','auto','updateSpeed','fadeOpacity','commandToExecute','clampToLatitudeRange','dropRateBump','worker','maxAge','framebuffer','Map','_tomap','Framebuffer','redraw','getUVByXY','_data','defineProperties','drawingBufferWidth','nextParticlesSpeed','apply','_updateIng','EventType','487710jcGqOr','class','canvas','postMessage','Pass','min','particles','forEach','Geometry','length','LUMINANCE','none','colors','particlesTextures','@@iterator','viewRectangleToLonLatRange','_updateIng2','uniformMap','clearFramebuffers','xmin','age','off','PI_OVER_TWO','onmessage','removeAll','_mountedHook','getWind','5942568jTRLcp','isInExtent','viewerParameters','refreshTimer','lat','lighter','_bilinearInterpolation','Appearance','fromGeometry','defineProperty','windData','particlesRendering','2541510WwZmnU','camera','particlesNumber','Math','scene','pow','tlat','_map','pointer-events','vertexArray','TextureMinificationFilter','ComponentDatatype','DrawCommand','reverse','_calcUV','getPixelSize','_onMouseMoveEvent','visibility','slice','5463395WVNnJX','context','xmax','segments','random','_addedHook','segmentsDepth','canvasContext','STATIC_DRAW','postProcessingSpeed','DepthFunction','arrayBufferView','width','uniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x0a\x20\x20\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0\x20*\x20trailsColor)\x20/\x20255.0;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20pointsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20trailsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a','particleSystem','update','options','clear','setAttribute','mouse_move','BaseLayer','framebuffers','setDate','4799hxtgvZ','PixelFormat','_onMouseUpEvent','autoClear','NEAREST','Arguments','VertexArray','udata','preExecute','removeChild','toDegrees','TextureMagnificationFilter','grid','Rectangle','Cesium'];_0x101c=function(){return _0x1d13ad;};return _0x101c();}function _arrayLikeToArray(_0x10a391,_0xfd314e){var _0x58ed9d=_0x220891;if(_0xfd314e==null||_0xfd314e>_0x10a391[_0x58ed9d(0x19d)])_0xfd314e=_0x10a391[_0x58ed9d(0x19d)];for(var _0x3279ee=0x0,_0x2f06c2=new Array(_0xfd314e);_0x3279ee<_0xfd314e;_0x3279ee++)_0x2f06c2[_0x3279ee]=_0x10a391[_0x3279ee];return _0x2f06c2;}function _nonIterableSpread(){throw new TypeError('Invalid\x20attempt\x20to\x20spread\x20non-iterable\x20instance.\x0aIn\x20order\x20to\x20be\x20iterable,\x20non-array\x20objects\x20must\x20have\x20a\x20[Symbol.iterator]()\x20method.');}var Cesium$6=mars3d__namespace['Cesium'],CustomPrimitive=(function(){var _0x1b3b25=_0x220891;function _0x3c8e52(_0x35bf8f){var _0x29c6f8=_0x59eb,_0x2b6d85;_classCallCheck(this,_0x3c8e52),this['commandType']=_0x35bf8f['commandType'],this[_0x29c6f8(0x112)]=_0x35bf8f['geometry'],this['attributeLocations']=_0x35bf8f[_0x29c6f8(0xf5)],this['primitiveType']=_0x35bf8f['primitiveType'],this[_0x29c6f8(0x1a5)]=_0x35bf8f[_0x29c6f8(0x1a5)],this['vertexShaderSource']=_0x35bf8f['vertexShaderSource'],this['fragmentShaderSource']=_0x35bf8f['fragmentShaderSource'],this['rawRenderState']=_0x35bf8f['rawRenderState'],this[_0x29c6f8(0x187)]=_0x35bf8f['framebuffer'],this['outputTexture']=_0x35bf8f['outputTexture'],this['autoClear']=(_0x2b6d85=_0x35bf8f[_0x29c6f8(0xe4)])!==null&&_0x2b6d85!==void 0x0?_0x2b6d85:![],this['preExecute']=_0x35bf8f['preExecute'],this[_0x29c6f8(0x104)]=!![],this['commandToExecute']=undefined,this['clearCommand']=undefined,this['autoClear']&&(this['clearCommand']=new Cesium$6['ClearCommand']({'color':new Cesium$6[(_0x29c6f8(0x15c))](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this[_0x29c6f8(0x187)],'pass':Cesium$6['Pass'][_0x29c6f8(0x17b)]}));}return _createClass(_0x3c8e52,[{'key':'createCommand','value':function _0x5cb20e(_0x1ccf82){var _0x362ee3=_0x59eb;switch(this['commandType']){case'Draw':{var _0x4c90f9=Cesium$6[_0x362ee3(0xe7)]['fromGeometry']({'context':_0x1ccf82,'geometry':this['geometry'],'attributeLocations':this[_0x362ee3(0xf5)],'bufferUsage':Cesium$6['BufferUsage']['STATIC_DRAW']}),_0x3d4c50=Cesium$6['ShaderProgram'][_0x362ee3(0x11f)]({'context':_0x1ccf82,'attributeLocations':this['attributeLocations'],'vertexShaderSource':this['vertexShaderSource'],'fragmentShaderSource':this['fragmentShaderSource']}),_0x391f49=Cesium$6[_0x362ee3(0xf1)][_0x362ee3(0x11f)](this['rawRenderState']);return new Cesium$6[(_0x362ee3(0x1c7))]({'primitiveType':this['primitiveType'],'shaderProgram':_0x3d4c50,'vertexArray':_0x4c90f9,'modelMatrix':Cesium$6['Matrix4']['IDENTITY'],'renderState':_0x391f49,'uniformMap':this['uniformMap'],'castShadows':![],'receiveShadows':![],'framebuffer':this['framebuffer'],'pass':Cesium$6[_0x362ee3(0x198)]['OPAQUE'],'pickOnly':!![],'owner':this});}case'Compute':{return new Cesium$6['ComputeCommand']({'owner':this,'fragmentShaderSource':this['fragmentShaderSource'],'uniformMap':this['uniformMap'],'outputTexture':this['outputTexture'],'persists':!![]});}}}},{'key':'setGeometry','value':function _0x5321a2(_0x49d544,_0xc70e56){var _0x263e53=_0x59eb;this[_0x263e53(0x112)]=_0xc70e56;var _0x5a6287=Cesium$6[_0x263e53(0xe7)]['fromGeometry']({'context':_0x49d544,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6['BufferUsage']['STATIC_DRAW']});this['commandToExecute'][_0x263e53(0x1c4)]=_0x5a6287;}},{'key':_0x1b3b25(0x1dd),'value':function _0x130efc(_0x53f479){var _0x1eaeec=_0x1b3b25;if(!this['show'])return;if(_0x53f479['mode']!==Cesium$6['SceneMode']['SCENE3D'])return;!Cesium$6['defined'](this['commandToExecute'])&&(this['commandToExecute']=this['createCommand'](_0x53f479['context'])),Cesium$6[_0x1eaeec(0x117)](this[_0x1eaeec(0xe9)])&&this['preExecute'](),Cesium$6['defined'](this[_0x1eaeec(0x15d)])&&_0x53f479['commandList']['push'](this['clearCommand']),_0x53f479['commandList']['push'](this['commandToExecute']);}},{'key':'isDestroyed','value':function _0x361731(){return![];}},{'key':_0x1b3b25(0x150),'value':function _0x3ac052(){var _0x590991=_0x1b3b25;if(this['clearCommand']){var _0x16a7ac,_0x1490c2;(_0x16a7ac=this[_0x590991(0x15d)])!==null&&_0x16a7ac!==void 0x0&&_0x16a7ac[_0x590991(0x1c4)]&&this['clearCommand']['vertexArray']['destroy'](),(_0x1490c2=this[_0x590991(0x15d)])!==null&&_0x1490c2!==void 0x0&&_0x1490c2['shaderProgram']&&this['clearCommand']['shaderProgram'][_0x590991(0x150)](),delete this[_0x590991(0x15d)];}return this[_0x590991(0x182)]&&(this[_0x590991(0x182)][_0x590991(0x1c4)]&&this[_0x590991(0x182)][_0x590991(0x1c4)]['destroy'](),this['commandToExecute']['shaderProgram']&&this['commandToExecute'][_0x590991(0x14f)][_0x590991(0x150)](),delete this['commandToExecute']),Cesium$6['destroyObject'](this);}}]),_0x3c8e52;}()),Cesium$5=mars3d__namespace['Cesium'],Util=(function(){var _0x16e0d6=function _0x2a3a32(){var _0x7770c0=_0x59eb,_0x44aaa2=new Cesium$5['Geometry']({'attributes':new Cesium$5['GeometryAttributes']({'position':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5[_0x7770c0(0x1c6)]['FLOAT'],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});return _0x44aaa2;},_0x4ded8c=function _0x500e7e(_0x1acbcc,_0x4d8872){var _0x4b46bf=_0x59eb;if(Cesium$5['defined'](_0x4d8872)){var _0x8a6e70={};_0x8a6e70[_0x4b46bf(0x1d9)]=_0x4d8872,_0x1acbcc['source']=_0x8a6e70;}var _0x58050f=new Cesium$5[(_0x4b46bf(0x148))](_0x1acbcc);return _0x58050f;},_0x255a0a=function _0x3c9ba1(_0x2418dd,_0x3ff682,_0x57178f){var _0x1b8a80=_0x59eb,_0x4d0cd6=new Cesium$5[(_0x1b8a80(0x18a))]({'context':_0x2418dd,'colorTextures':[_0x3ff682],'depthTexture':_0x57178f});return _0x4d0cd6;},_0x26eba6=function _0x10f5f7(_0x5aceb4){var _0x53fcba=_0x59eb,_0x5515cf=!![],_0x42ab46=![],_0x4bf9ae={'viewport':_0x5aceb4['viewport'],'depthTest':_0x5aceb4['depthTest'],'depthMask':_0x5aceb4[_0x53fcba(0x113)],'blending':_0x5aceb4['blending']},_0x1d53ee=Cesium$5[_0x53fcba(0x1b6)]['getDefaultRenderState'](_0x5515cf,_0x42ab46,_0x4bf9ae);return _0x1d53ee;},_0x4f8b51=function _0x3448f2(_0xa96c10){var _0xd14dfe=_0x59eb,_0x127fa9={},_0x4d20da=Cesium$5['Math'][_0xd14dfe(0x143)](_0xa96c10['west'],Cesium$5['Math']['TWO_PI']),_0x3995ea=Cesium$5['Math']['mod'](_0xa96c10[_0xd14dfe(0x109)],Cesium$5['Math'][_0xd14dfe(0x144)]),_0x16a69f=_0xa96c10['width'],_0x272331,_0x586da3;_0x16a69f>Cesium$5[_0xd14dfe(0x1be)][_0xd14dfe(0x114)]?(_0x272331=0x0,_0x586da3=Cesium$5['Math'][_0xd14dfe(0x144)]):_0x3995ea-_0x4d20da<_0x16a69f?(_0x272331=_0x4d20da,_0x586da3=_0x4d20da+_0x16a69f):(_0x272331=_0x4d20da,_0x586da3=_0x3995ea);_0x127fa9[_0xd14dfe(0x125)]={'min':Cesium$5['Math']['toDegrees'](_0x272331),'max':Cesium$5['Math']['toDegrees'](_0x586da3)};var _0x205863=_0xa96c10['south'],_0x4bc60c=_0xa96c10['north'],_0x1b0e04=_0xa96c10['height'],_0x3dffba=_0x1b0e04>Cesium$5['Math']['PI']/0xc?_0x1b0e04/0x2:0x0,_0x3cb8fd=Cesium$5['Math'][_0xd14dfe(0x183)](_0x205863-_0x3dffba),_0x158984=Cesium$5[_0xd14dfe(0x1be)]['clampToLatitudeRange'](_0x4bc60c+_0x3dffba);return _0x3cb8fd<-Cesium$5[_0xd14dfe(0x1be)][_0xd14dfe(0x11c)]&&(_0x3cb8fd=-Cesium$5[_0xd14dfe(0x1be)][_0xd14dfe(0x1aa)]),_0x158984>Cesium$5[_0xd14dfe(0x1be)]['PI_OVER_THREE']&&(_0x158984=Cesium$5['Math']['PI_OVER_TWO']),_0x127fa9['lat']={'min':Cesium$5['Math'][_0xd14dfe(0xeb)](_0x3cb8fd),'max':Cesium$5[_0xd14dfe(0x1be)][_0xd14dfe(0xeb)](_0x158984)},_0x127fa9;};return{'getFullscreenQuad':_0x16e0d6,'createTexture':_0x4ded8c,'createFramebuffer':_0x255a0a,'createRawRenderState':_0x26eba6,'viewRectangleToLonLatRange':_0x4f8b51};}()),segmentDraw_vert='in\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20normal\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20postProcessingSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0aout\x20float\x20speedNormalization;\x0a\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20\x20\x20float\x20a\x20=\x206378137.0;\x20//\x20Semi-major\x20axis\x0a\x20\x20\x20\x20float\x20b\x20=\x206356752.3142;\x20//\x20Semi-minor\x20axis\x0a\x20\x20\x20\x20float\x20e2\x20=\x206.69437999014e-3;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x0a\x20\x20\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calcProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0,\x20360.0)\x20-\x20180.0;\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0);\x0a\x20\x20\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calcOffset(vec4\x20currentProjectedCoordinate,\x20vec4\x20nextProjectedCoordinate,\x20float\x20offsetSign)\x20{\x0a\x20\x20\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0);\x0a\x20\x20\x20\x20vec2\x20currentXY\x20=\x20(currentProjectedCoordinate.xy\x20/\x20currentProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x20\x20\x20\x20vec2\x20nextXY\x20=\x20(nextProjectedCoordinate.xy\x20/\x20nextProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0;\x0a\x20\x20\x20\x20vec2\x20direction\x20=\x20normalize(nextXY\x20-\x20currentXY);\x0a\x20\x20\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0,\x200.0);\x0a\x20\x20\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20\x20\x20vec4\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex);\x0a\x0a\x20\x20\x20\x20vec4\x20currentProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20vec4\x20nextProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(nextPosition.w\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(nextPosition.xyz);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20float\x20pointToUse\x20=\x20normal.x;\x20//\x20-1\x20is\x20currentProjectedCoordinate\x20and\x20+1\x20is\x20nextProjectedCoordinate\x0a\x20\x20\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20pixelSize\x20*\x20calcOffset(currentProjectedCoordinate,\x20nextProjectedCoordinate,\x20offsetSign);\x0a\x20\x20\x20\x20if\x20(pointToUse\x20<\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20currentProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20nextProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20speedNormalization\x20=\x20texture(postProcessingSpeed,\x20particleIndex).a;\x0a}\x0a',segmentDraw_frag='uniform\x20sampler2D\x20colorTable;\x0a\x0ain\x20float\x20speedNormalization;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x200.0));\x0a}\x0a',fullscreen_vert='in\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(position,\x201.0);\x0a}\x0a',trailDraw_frag=_0x220891(0x1db),screenDraw_frag='uniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20trailsColor;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x0a}\x0a',Cesium$4=mars3d__namespace[_0x220891(0xef)],ParticlesRendering=(function(){var _0x5466ae=_0x220891;function _0x214646(_0x34818e,_0x58f314,_0xcfe1e8,_0x4a8949,_0x44e81b){var _0x31baea=_0x59eb;_classCallCheck(this,_0x214646),this['createRenderingTextures'](_0x34818e,_0x58f314,_0xcfe1e8[_0x31baea(0x1a0)]),this[_0x31baea(0x16a)](_0x34818e),this['createRenderingPrimitives'](_0x34818e,_0xcfe1e8,_0x4a8949,_0x44e81b);}return _createClass(_0x214646,[{'key':'createRenderingTextures','value':function _0x26af40(_0x3467ab,_0x5aa73f,_0x314f7a){var _0x1e07af=_0x59eb,_0x13b5c6={'context':_0x3467ab,'width':_0x3467ab['drawingBufferWidth'],'height':_0x3467ab['drawingBufferHeight'],'pixelFormat':Cesium$4['PixelFormat']['RGBA'],'pixelDatatype':Cesium$4['PixelDatatype']['UNSIGNED_BYTE']},_0x10f597={'context':_0x3467ab,'width':_0x3467ab['drawingBufferWidth'],'height':_0x3467ab['drawingBufferHeight'],'pixelFormat':Cesium$4[_0x1e07af(0xe2)]['DEPTH_COMPONENT'],'pixelDatatype':Cesium$4['PixelDatatype'][_0x1e07af(0x133)]},_0x306b11=_0x314f7a['length'],_0x92f5f8=new Float32Array(_0x306b11*0x3);for(var _0x3e8da7=0x0;_0x3e8da7<_0x306b11;_0x3e8da7++){var _0x384273=Cesium$4[_0x1e07af(0x15c)]['fromCssColorString'](_0x314f7a[_0x3e8da7]);_0x92f5f8[0x3*_0x3e8da7]=_0x384273[_0x1e07af(0x146)],_0x92f5f8[0x3*_0x3e8da7+0x1]=_0x384273['green'],_0x92f5f8[0x3*_0x3e8da7+0x2]=_0x384273['blue'];}var _0x3c057e={'context':_0x3467ab,'width':_0x306b11,'height':0x1,'pixelFormat':Cesium$4['PixelFormat']['RGB'],'pixelDatatype':Cesium$4['PixelDatatype']['FLOAT'],'sampler':new Cesium$4['Sampler']({'minificationFilter':Cesium$4['TextureMinificationFilter']['LINEAR'],'magnificationFilter':Cesium$4['TextureMagnificationFilter']['LINEAR']})};this['textures']={'segmentsColor':Util['createTexture'](_0x13b5c6),'segmentsDepth':Util['createTexture'](_0x10f597),'currentTrailsColor':Util['createTexture'](_0x13b5c6),'currentTrailsDepth':Util[_0x1e07af(0x124)](_0x10f597),'nextTrailsColor':Util['createTexture'](_0x13b5c6),'nextTrailsDepth':Util['createTexture'](_0x10f597),'colorTable':Util['createTexture'](_0x3c057e,_0x92f5f8)};}},{'key':'createRenderingFramebuffers','value':function _0x21cd62(_0x12b84b){var _0x464e07=_0x59eb;this['framebuffers']={'segments':Util['createFramebuffer'](_0x12b84b,this[_0x464e07(0x160)]['segmentsColor'],this['textures']['segmentsDepth']),'currentTrails':Util[_0x464e07(0x13b)](_0x12b84b,this[_0x464e07(0x160)]['currentTrailsColor'],this[_0x464e07(0x160)]['currentTrailsDepth']),'nextTrails':Util[_0x464e07(0x13b)](_0x12b84b,this[_0x464e07(0x160)][_0x464e07(0x138)],this['textures'][_0x464e07(0x166)])};}},{'key':_0x5466ae(0x162),'value':function _0x4d4d20(_0x367dbc){var _0x502dd1=_0x5466ae,_0x3e00cc=0x4,_0x468c4d=[];for(var _0xef4e29=0x0;_0xef4e29<_0x367dbc[_0x502dd1(0x10e)];_0xef4e29++){for(var _0x4c61c4=0x0;_0x4c61c4<_0x367dbc['particlesTextureSize'];_0x4c61c4++){for(var _0xfb2c4=0x0;_0xfb2c4<_0x3e00cc;_0xfb2c4++){_0x468c4d[_0x502dd1(0x12e)](_0xef4e29/_0x367dbc['particlesTextureSize']),_0x468c4d['push'](_0x4c61c4/_0x367dbc[_0x502dd1(0x10e)]);}}}_0x468c4d=new Float32Array(_0x468c4d);var _0x5d3051=[],_0x44c4d0=[-0x1,0x1],_0x3b4e28=[-0x1,0x1];for(var _0x3efcb4=0x0;_0x3efcb4<_0x367dbc[_0x502dd1(0xf2)];_0x3efcb4++){for(var _0x57544f=0x0;_0x57544f<_0x3e00cc/0x2;_0x57544f++){for(var _0x3bb4bc=0x0;_0x3bb4bc<_0x3e00cc/0x2;_0x3bb4bc++){_0x5d3051['push'](_0x44c4d0[_0x57544f]),_0x5d3051['push'](_0x3b4e28[_0x3bb4bc]),_0x5d3051['push'](0x0);}}}_0x5d3051=new Float32Array(_0x5d3051);var _0x176772=0x6*_0x367dbc[_0x502dd1(0xf2)],_0x477459=new Uint32Array(_0x176772);for(var _0x23dc08=0x0,_0xd422c9=0x0,_0x207c1b=0x0;_0x23dc08<_0x367dbc['maxParticles'];_0x23dc08++){_0x477459[_0xd422c9++]=_0x207c1b+0x0,_0x477459[_0xd422c9++]=_0x207c1b+0x1,_0x477459[_0xd422c9++]=_0x207c1b+0x2,_0x477459[_0xd422c9++]=_0x207c1b+0x2,_0x477459[_0xd422c9++]=_0x207c1b+0x1,_0x477459[_0xd422c9++]=_0x207c1b+0x3,_0x207c1b+=0x4;}var _0x52b0a3=new Cesium$4[(_0x502dd1(0x19c))]({'attributes':new Cesium$4['GeometryAttributes']({'st':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':_0x468c4d}),'normal':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':_0x5d3051})}),'indices':_0x477459});return _0x52b0a3;}},{'key':'createRenderingPrimitives','value':function _0x5af9dc(_0x1d639d,_0x44608c,_0x34af2e,_0x5ee7d4){var _0x5675bc=_0x5466ae,_0x307565=this;this['primitives']={'segments':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'st':0x0,'normal':0x1},'geometry':this['createSegmentsGeometry'](_0x44608c),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'currentParticlesPosition':function _0x57eb26(){var _0x3ae888=_0x59eb;return _0x5ee7d4['particlesTextures'][_0x3ae888(0x131)];},'postProcessingPosition':function _0x415033(){var _0xe3243b=_0x59eb;return _0x5ee7d4[_0xe3243b(0x1a1)]['postProcessingPosition'];},'postProcessingSpeed':function _0x49ad84(){return _0x5ee7d4['particlesTextures']['postProcessingSpeed'];},'colorTable':function _0x5b9c53(){var _0x48ba3f=_0x59eb;return _0x307565[_0x48ba3f(0x160)][_0x48ba3f(0x102)];},'aspect':function _0x587706(){return _0x1d639d['drawingBufferWidth']/_0x1d639d['drawingBufferHeight'];},'pixelSize':function _0x3ae3de(){var _0x4668b6=_0x59eb;return _0x34af2e[_0x4668b6(0x12a)];},'lineWidth':function _0x131dca(){return _0x44608c['lineWidth'];},'particleHeight':function _0x47f257(){return _0x44608c['particleHeight'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_vert]}),'fragmentShaderSource':new Cesium$4[(_0x5675bc(0x154))]({'sources':[segmentDraw_frag]}),'rawRenderState':Util[_0x5675bc(0x14c)]({'viewport':undefined,'depthTest':{'enabled':!![]},'depthMask':!![]}),'framebuffer':this['framebuffers']['segments'],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'segmentsColorTexture':function _0x3a6a46(){var _0xb8eb40=_0x5675bc;return _0x307565[_0xb8eb40(0x160)]['segmentsColor'];},'segmentsDepthTexture':function _0x56b2e2(){var _0x27de4f=_0x5675bc;return _0x307565[_0x27de4f(0x160)][_0x27de4f(0x1d4)];},'currentTrailsColor':function _0x4a686f(){var _0x2894d4=_0x5675bc;return _0x307565[_0x2894d4(0xdf)][_0x2894d4(0x139)]['getColorTexture'](0x0);},'trailsDepthTexture':function _0x372dd4(){var _0x5d5625=_0x5675bc;return _0x307565['framebuffers']['currentTrails'][_0x5d5625(0x10c)];},'fadeOpacity':function _0x151f36(){var _0x56921d=_0x5675bc;return _0x44608c[_0x56921d(0x181)];}},'vertexShaderSource':new Cesium$4[(_0x5675bc(0x154))]({'defines':['DISABLE_GL_POSITION_LOG_DEPTH'],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],'sources':[trailDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4[_0x5675bc(0x1d8)]['ALWAYS']},'depthMask':!![]}),'framebuffer':this['framebuffers'][_0x5675bc(0xf4)],'autoClear':!![],'preExecute':function _0x385207(){var _0x84fe9c=_0x5675bc,_0x1609b6=_0x307565['framebuffers']['currentTrails'];_0x307565['framebuffers']['currentTrails']=_0x307565['framebuffers']['nextTrails'],_0x307565['framebuffers']['nextTrails']=_0x1609b6,_0x307565['primitives']['trails']['commandToExecute'][_0x84fe9c(0x187)]=_0x307565['framebuffers'][_0x84fe9c(0xf4)],_0x307565['primitives'][_0x84fe9c(0xf0)][_0x84fe9c(0x15d)][_0x84fe9c(0x187)]=_0x307565['framebuffers']['nextTrails'];}}),'screen':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'trailsColorTexture':function _0x2aa76b(){var _0x4fa190=_0x5675bc;return _0x307565[_0x4fa190(0xdf)][_0x4fa190(0xf4)]['getColorTexture'](0x0);},'trailsDepthTexture':function _0x5df46(){var _0x426034=_0x5675bc;return _0x307565[_0x426034(0xdf)]['nextTrails']['depthTexture'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'defines':[_0x5675bc(0x153)],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],'sources':[screenDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':![]},'depthMask':!![],'blending':{'enabled':!![]}}),'framebuffer':undefined})};}}]),_0x214646;}()),getWind_frag='//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x,\x20360.0);\x0a\x20\x20\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20-90.0,\x2090.0);\x0a\x0a\x20\x20\x20\x20vec3\x20index3D\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20index3D.z\x20=\x20(lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z;\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205],\x20width\x20=\x203,\x20height\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x203\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x202\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWind(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20\x20\x20float\x20result\x20=\x20texture(windTexture,\x20normalizedIndex2D).r;\x0a\x20\x20\x20\x20return\x20result;\x0a}\x0a\x0aconst\x20mat4\x20kernelMatrix\x20=\x20mat4(\x0a\x20\x20\x20\x200.0,\x20-1.0,\x202.0,\x20-1.0,\x20//\x20first\x20column\x0a\x20\x20\x20\x202.0,\x200.0,\x20-5.0,\x203.0,\x20//\x20second\x20column\x0a\x20\x20\x20\x200.0,\x201.0,\x204.0,\x20-3.0,\x20//\x20third\x20column\x0a\x20\x20\x20\x200.0,\x200.0,\x20-1.0,\x201.0\x20//\x20fourth\x20column\x0a);\x0afloat\x20oneDimensionInterpolation(float\x20t,\x20float\x20p0,\x20float\x20p1,\x20float\x20p2,\x20float\x20p3)\x20{\x0a\x20\x20\x20\x20vec4\x20tVec4\x20=\x20vec4(1.0,\x20t,\x20t\x20*\x20t,\x20t\x20*\x20t\x20*\x20t);\x0a\x20\x20\x20\x20tVec4\x20=\x20tVec4\x20/\x202.0;\x0a\x20\x20\x20\x20vec4\x20pVec4\x20=\x20vec4(p0,\x20p1,\x20p2,\x20p3);\x0a\x20\x20\x20\x20return\x20dot((tVec4\x20*\x20kernelMatrix),\x20pVec4);\x0a}\x0a\x0afloat\x20calculateB(sampler2D\x20windTexture,\x20float\x20t,\x20float\x20lon,\x20float\x20lat,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20float\x20lon0\x20=\x20floor(lon)\x20-\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon1\x20=\x20floor(lon);\x0a\x20\x20\x20\x20float\x20lon2\x20=\x20floor(lon)\x20+\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon3\x20=\x20floor(lon)\x20+\x202.0\x20*\x20interval.x;\x0a\x0a\x20\x20\x20\x20float\x20p0\x20=\x20getWind(windTexture,\x20vec3(lon0,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p1\x20=\x20getWind(windTexture,\x20vec3(lon1,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p2\x20=\x20getWind(windTexture,\x20vec3(lon2,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p3\x20=\x20getWind(windTexture,\x20vec3(lon3,\x20lat,\x20lev));\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(t,\x20p0,\x20p1,\x20p2,\x20p3);\x0a}\x0a\x0afloat\x20interpolateOneTexture(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20\x20\x20float\x20lat0\x20=\x20floor(lat)\x20-\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat1\x20=\x20floor(lat);\x0a\x20\x20\x20\x20float\x20lat2\x20=\x20floor(lat)\x20+\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat3\x20=\x20floor(lat)\x20+\x202.0\x20*\x20interval.y;\x0a\x0a\x20\x20\x20\x20vec2\x20coefficient\x20=\x20lonLatLev.xy\x20-\x20floor(lonLatLev.xy);\x0a\x20\x20\x20\x20float\x20b0\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat0,\x20lev);\x0a\x20\x20\x20\x20float\x20b1\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat1,\x20lev);\x0a\x20\x20\x20\x20float\x20b2\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat2,\x20lev);\x0a\x20\x20\x20\x20float\x20b3\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat3,\x20lev);\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(coefficient.y,\x20b0,\x20b1,\x20b2,\x20b3);\x0a}\x0a\x0avec3\x20bicubic(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bicubic_interpolation#Bicubic_convolution_algorithm\x0a\x20\x20\x20\x20float\x20u\x20=\x20interpolateOneTexture(U,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20v\x20=\x20interpolateOneTexture(V,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20bicubic(lonLatLev);\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(windVector,\x200.0);\x0a}\x0a',updateSpeed_frag='uniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0auniform\x20sampler2D\x20particlesWind;\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20speedFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec3\x20percent\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20\x20\x20float\x20normalization\x20=\x20length(percent);\x0a\x0a\x20\x20\x20\x20return\x20normalization;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20//\x20vec3\x20currentSpeed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20texture(particlesWind,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20vec4(speedFactor\x20*\x20pixelSize\x20*\x20windVector,\x20calculateWindNorm(windVector));\x0a\x20\x20\x20\x20out_FragColor\x20=\x20nextSpeed;\x0a}\x0a',updatePosition_frag='uniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20\x20\x20float\x20term1\x20=\x20111132.92;\x0a\x20\x20\x20\x20float\x20term2\x20=\x20559.82\x20*\x20cos(2.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term3\x20=\x201.175\x20*\x20cos(4.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term4\x20=\x200.0023\x20*\x20cos(6.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20\x20\x20float\x20term5\x20=\x20111412.84\x20*\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20term6\x20=\x2093.5\x20*\x20cos(3.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term7\x20=\x200.118\x20*\x20cos(5.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avoid\x20updatePosition(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20windVectorInLonLatLev;\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20speed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20updatePosition(lonLatLev,\x20speed);\x0a}\x0a',postProcessingPosition_frag='uniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0auniform\x20float\x20dropRate;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0auniform\x20float\x20dropRateBump;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0,\x201.0);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0);\x0a\x20\x20\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20lev);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20\x20\x20return\x20particle.y\x20<\x20-90.0\x20||\x20particle.y\x20>\x2090.0;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20nextSpeed.a;\x0a\x0a\x20\x20\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20\x20\x20if\x20(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(randomParticle,\x201.0);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a\x20\x20\x20\x20}\x0a}\x0a',postProcessingSpeed_frag='uniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20randomParticle\x20=\x20texture(postProcessingPosition,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20vec4\x20particleSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x0a\x20\x20\x20\x20if\x20(randomParticle.a\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20particleSpeed;\x0a\x20\x20\x20\x20}\x0a}\x0a',Cesium$3=mars3d__namespace['Cesium'],ParticlesComputing=(function(){var _0x10c530=_0x220891;function _0x45eb0c(_0x405e4f,_0x475bf0,_0x299e12,_0x1ec5d1){var _0x468b71=_0x59eb;_classCallCheck(this,_0x45eb0c),this[_0x468b71(0x115)]=_0x475bf0,this['createWindTextures'](_0x405e4f,_0x475bf0),this['createParticlesTextures'](_0x405e4f,_0x299e12,_0x1ec5d1),this['createComputingPrimitives'](_0x475bf0,_0x299e12,_0x1ec5d1);}return _createClass(_0x45eb0c,[{'key':'createWindTextures','value':function _0xbb16a7(_0x88230a,_0x4baeaf){var _0x4a3791=_0x59eb,_0x58fd0e={'context':_0x88230a,'width':_0x4baeaf['dimensions']['lon'],'height':_0x4baeaf['dimensions']['lat']*(_0x4baeaf['dimensions']['lev']||0x1),'pixelFormat':Cesium$3[_0x4a3791(0xe2)][_0x4a3791(0x19e)],'pixelDatatype':Cesium$3['PixelDatatype']['FLOAT'],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3[_0x4a3791(0xec)]['NEAREST']})};this['windTextures']={'U':Util[_0x4a3791(0x124)](_0x58fd0e,_0x4baeaf['U'][_0x4a3791(0x122)]),'V':Util['createTexture'](_0x58fd0e,_0x4baeaf['V']['array'])};}},{'key':'createParticlesTextures','value':function _0x543fab(_0x581e2e,_0x2d9a95,_0x2a5c8a){var _0x358185=_0x59eb,_0x20e06d={'context':_0x581e2e,'width':_0x2d9a95[_0x358185(0x10e)],'height':_0x2d9a95['particlesTextureSize'],'pixelFormat':Cesium$3['PixelFormat']['RGBA'],'pixelDatatype':Cesium$3[_0x358185(0x157)]['FLOAT'],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3[_0x358185(0x1c5)][_0x358185(0xe5)],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})},_0x7dcda8=this['randomizeParticles'](_0x2d9a95['maxParticles'],_0x2a5c8a),_0x350105=new Float32Array(0x4*_0x2d9a95['maxParticles'])['fill'](0x0);this[_0x358185(0x1a1)]={'particlesWind':Util[_0x358185(0x124)](_0x20e06d),'currentParticlesPosition':Util['createTexture'](_0x20e06d,_0x7dcda8),'nextParticlesPosition':Util['createTexture'](_0x20e06d,_0x7dcda8),'currentParticlesSpeed':Util['createTexture'](_0x20e06d,_0x350105),'nextParticlesSpeed':Util[_0x358185(0x124)](_0x20e06d,_0x350105),'postProcessingPosition':Util['createTexture'](_0x20e06d,_0x7dcda8),'postProcessingSpeed':Util[_0x358185(0x124)](_0x20e06d,_0x350105)};}},{'key':'randomizeParticles','value':function _0xeab67b(_0x82b85e,_0x4aeac8){var _0x16aefd=_0x59eb,_0x5e4eef=new Float32Array(0x4*_0x82b85e);for(var _0x2a1063=0x0;_0x2a1063<_0x82b85e;_0x2a1063++){_0x5e4eef[0x4*_0x2a1063]=Cesium$3['Math']['randomBetween'](_0x4aeac8[_0x16aefd(0x14b)]['x'],_0x4aeac8['lonRange']['y']),_0x5e4eef[0x4*_0x2a1063+0x1]=Cesium$3['Math'][_0x16aefd(0x152)](_0x4aeac8[_0x16aefd(0x14e)]['x'],_0x4aeac8['latRange']['y']),_0x5e4eef[0x4*_0x2a1063+0x2]=Cesium$3['Math']['randomBetween'](this[_0x16aefd(0x115)][_0x16aefd(0x175)][_0x16aefd(0x199)],this['data'][_0x16aefd(0x175)]['max']),_0x5e4eef[0x4*_0x2a1063+0x3]=0x0;}return _0x5e4eef;}},{'key':'destroyParticlesTextures','value':function _0x3acdc3(){var _0x1cdb39=this;Object['keys'](this['particlesTextures'])['forEach'](function(_0x1811d1){var _0x416b50=_0x59eb;_0x1cdb39['particlesTextures'][_0x1811d1][_0x416b50(0x150)]();});}},{'key':_0x10c530(0x103),'value':function _0x4ae24f(_0x741556,_0x3000fc,_0x4bf667){var _0x458ad3=_0x10c530,_0xbd5207=new Cesium$3[(_0x458ad3(0x173))](_0x741556['dimensions']['lon'],_0x741556['dimensions'][_0x458ad3(0x1b3)],_0x741556['dimensions']['lev']),_0x40d7cb=new Cesium$3['Cartesian3'](_0x741556[_0x458ad3(0x125)]['min'],_0x741556['lat']['min'],_0x741556['lev']['min']),_0x189da9=new Cesium$3['Cartesian3'](_0x741556['lon']['max'],_0x741556[_0x458ad3(0x1b3)]['max'],_0x741556['lev']['max']),_0x3a3871=new Cesium$3[(_0x458ad3(0x173))]((_0x189da9['x']-_0x40d7cb['x'])/(_0xbd5207['x']-0x1),(_0x189da9['y']-_0x40d7cb['y'])/(_0xbd5207['y']-0x1),_0xbd5207['z']>0x1?(_0x189da9['z']-_0x40d7cb['z'])/(_0xbd5207['z']-0x1):0x1),_0x1f5f5a=new Cesium$3[(_0x458ad3(0x15e))](_0x741556['U']['min'],_0x741556['U']['max']),_0x400e4a=new Cesium$3['Cartesian2'](_0x741556['V']['min'],_0x741556['V']['max']),_0xbee220=this;this['primitives']={'getWind':new CustomPrimitive({'commandType':'Compute','uniformMap':{'U':function _0x151091(){return _0xbee220['windTextures']['U'];},'V':function _0x2d2b38(){var _0x583644=_0x458ad3;return _0xbee220[_0x583644(0xf7)]['V'];},'currentParticlesPosition':function _0x269db3(){var _0x94170d=_0x458ad3;return _0xbee220['particlesTextures'][_0x94170d(0x131)];},'dimension':function _0x3566ce(){return _0xbd5207;},'minimum':function _0x2fdc4f(){return _0x40d7cb;},'maximum':function _0x1e3953(){return _0x189da9;},'interval':function _0x405c97(){return _0x3a3871;}},'fragmentShaderSource':new Cesium$3[(_0x458ad3(0x154))]({'sources':[getWind_frag]}),'outputTexture':this[_0x458ad3(0x1a1)]['particlesWind'],'preExecute':function _0x437afd(){var _0x22c31e=_0x458ad3;_0xbee220['primitives'][_0x22c31e(0x1ae)]['commandToExecute']['outputTexture']=_0xbee220['particlesTextures']['particlesWind'];}}),'updateSpeed':new CustomPrimitive({'commandType':_0x458ad3(0x147),'uniformMap':{'currentParticlesSpeed':function _0x3684c7(){return _0xbee220['particlesTextures']['currentParticlesSpeed'];},'particlesWind':function _0xd58a27(){var _0x3dbfe9=_0x458ad3;return _0xbee220[_0x3dbfe9(0x1a1)]['particlesWind'];},'uSpeedRange':function _0x11c344(){return _0x1f5f5a;},'vSpeedRange':function _0x191624(){return _0x400e4a;},'pixelSize':function _0x57e21b(){return _0x4bf667['pixelSize'];},'speedFactor':function _0x333b26(){return _0x3000fc['speedFactor'];}},'fragmentShaderSource':new Cesium$3[(_0x458ad3(0x154))]({'sources':[updateSpeed_frag]}),'outputTexture':this[_0x458ad3(0x1a1)]['nextParticlesSpeed'],'preExecute':function _0x335510(){var _0x17b8ce=_0x458ad3,_0xb1a9dc=_0xbee220[_0x17b8ce(0x1a1)]['currentParticlesSpeed'];_0xbee220[_0x17b8ce(0x1a1)]['currentParticlesSpeed']=_0xbee220['particlesTextures']['postProcessingSpeed'],_0xbee220['particlesTextures']['postProcessingSpeed']=_0xb1a9dc,_0xbee220['primitives'][_0x17b8ce(0x180)][_0x17b8ce(0x182)]['outputTexture']=_0xbee220['particlesTextures']['nextParticlesSpeed'];}}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':function _0x37e72b(){var _0x33e9c4=_0x458ad3;return _0xbee220[_0x33e9c4(0x1a1)]['currentParticlesPosition'];},'currentParticlesSpeed':function _0x170800(){return _0xbee220['particlesTextures']['currentParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[updatePosition_frag]}),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':function _0x2c86b6(){var _0x4222d4=_0x458ad3,_0x35d040=_0xbee220[_0x4222d4(0x1a1)]['currentParticlesPosition'];_0xbee220['particlesTextures'][_0x4222d4(0x131)]=_0xbee220['particlesTextures'][_0x4222d4(0x169)],_0xbee220['particlesTextures']['postProcessingPosition']=_0x35d040,_0xbee220['primitives'][_0x4222d4(0x135)]['commandToExecute'][_0x4222d4(0x176)]=_0xbee220['particlesTextures']['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':_0x458ad3(0x147),'uniformMap':{'nextParticlesPosition':function _0x1fcf0a(){var _0x3414cf=_0x458ad3;return _0xbee220['particlesTextures'][_0x3414cf(0x132)];},'nextParticlesSpeed':function _0x4253a4(){var _0x55104a=_0x458ad3;return _0xbee220['particlesTextures'][_0x55104a(0x190)];},'lonRange':function _0x3e9c17(){var _0x11880f=_0x458ad3;return _0x4bf667[_0x11880f(0x14b)];},'latRange':function _0x38224a(){var _0x3182e0=_0x458ad3;return _0x4bf667[_0x3182e0(0x14e)];},'randomCoefficient':function _0x2879ef(){var _0x31293c=_0x458ad3,_0x373bc4=Math[_0x31293c(0x1d2)]();return _0x373bc4;},'dropRate':function _0x1f197a(){var _0x3847f9=_0x458ad3;return _0x3000fc[_0x3847f9(0xf8)];},'dropRateBump':function _0x5efcd2(){var _0xab49b0=_0x458ad3;return _0x3000fc[_0xab49b0(0x184)];}},'fragmentShaderSource':new Cesium$3[(_0x458ad3(0x154))]({'sources':[postProcessingPosition_frag]}),'outputTexture':this['particlesTextures']['postProcessingPosition'],'preExecute':function _0x1a99ee(){var _0x53b890=_0x458ad3;_0xbee220['primitives'][_0x53b890(0x169)]['commandToExecute']['outputTexture']=_0xbee220['particlesTextures']['postProcessingPosition'];}}),'postProcessingSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'postProcessingPosition':function _0x17f3cb(){return _0xbee220['particlesTextures']['postProcessingPosition'];},'nextParticlesSpeed':function _0x2dc27b(){return _0xbee220['particlesTextures']['nextParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[postProcessingSpeed_frag]}),'outputTexture':this[_0x458ad3(0x1a1)][_0x458ad3(0x1d7)],'preExecute':function _0x243475(){_0xbee220['primitives']['postProcessingSpeed']['commandToExecute']['outputTexture']=_0xbee220['particlesTextures']['postProcessingSpeed'];}})};}}]),_0x45eb0c;}()),Cesium$2=mars3d__namespace['Cesium'],ParticleSystem=(function(){var _0x251963=_0x220891;function _0x46901f(_0x1e6a9b,_0x4e956d,_0x5a6700,_0x521075){var _0x21b003=_0x59eb;_classCallCheck(this,_0x46901f),this[_0x21b003(0x1cf)]=_0x1e6a9b,_0x4e956d=_objectSpread2({},_0x4e956d);if(_0x4e956d[_0x21b003(0xe8)]&&_0x4e956d['vdata']){var _0x2f4741,_0x40ac3e,_0x1087f8,_0x5b77d3,_0x3a88e5,_0x3ffd5d;_0x4e956d['dimensions']={},_0x4e956d[_0x21b003(0x168)]['lon']=_0x4e956d['cols'],_0x4e956d['dimensions']['lat']=_0x4e956d['rows'],_0x4e956d['dimensions']['lev']=_0x4e956d['lev']||0x1,_0x4e956d['lon']={},_0x4e956d['lon']['min']=_0x4e956d['xmin'],_0x4e956d[_0x21b003(0x125)]['max']=_0x4e956d[_0x21b003(0x1d0)],_0x4e956d['lat']={},_0x4e956d[_0x21b003(0x1b3)]['min']=_0x4e956d[_0x21b003(0x106)],_0x4e956d[_0x21b003(0x1b3)]['max']=_0x4e956d['ymax'],_0x4e956d['lev']={},_0x4e956d['lev']['min']=(_0x2f4741=_0x4e956d[_0x21b003(0x111)])!==null&&_0x2f4741!==void 0x0?_0x2f4741:0x1,_0x4e956d['lev'][_0x21b003(0x16b)]=(_0x40ac3e=_0x4e956d['levmax'])!==null&&_0x40ac3e!==void 0x0?_0x40ac3e:0x1,_0x4e956d['U']={},_0x4e956d['U']['array']=new Float32Array(_0x4e956d['udata']),_0x4e956d['U']['min']=(_0x1087f8=_0x4e956d['umin'])!==null&&_0x1087f8!==void 0x0?_0x1087f8:Math['min']['apply'](Math,_toConsumableArray(_0x4e956d['udata'])),_0x4e956d['U']['max']=(_0x5b77d3=_0x4e956d['umax'])!==null&&_0x5b77d3!==void 0x0?_0x5b77d3:Math['max']['apply'](Math,_toConsumableArray(_0x4e956d['udata'])),_0x4e956d['V']={},_0x4e956d['V'][_0x21b003(0x122)]=new Float32Array(_0x4e956d['vdata']),_0x4e956d['V']['min']=(_0x3a88e5=_0x4e956d['vmin'])!==null&&_0x3a88e5!==void 0x0?_0x3a88e5:Math['min']['apply'](Math,_toConsumableArray(_0x4e956d['vdata'])),_0x4e956d['V']['max']=(_0x3ffd5d=_0x4e956d['vmax'])!==null&&_0x3ffd5d!==void 0x0?_0x3ffd5d:Math[_0x21b003(0x16b)]['apply'](Math,_toConsumableArray(_0x4e956d[_0x21b003(0x128)]));}this['data']=_0x4e956d,this['options']=_0x5a6700,this[_0x21b003(0x1b1)]=_0x521075,this['particlesComputing']=new ParticlesComputing(this['context'],this[_0x21b003(0x115)],this['options'],this['viewerParameters']),this[_0x21b003(0x1ba)]=new ParticlesRendering(this[_0x21b003(0x1cf)],this['data'],this[_0x21b003(0xda)],this['viewerParameters'],this['particlesComputing']);}return _createClass(_0x46901f,[{'key':'canvasResize','value':function _0x281efc(_0x1aecb4){var _0x8e12d8=_0x59eb,_0x2bbf0c=this;this['particlesComputing'][_0x8e12d8(0x11a)](),Object['keys'](this['particlesComputing']['windTextures'])['forEach'](function(_0x43b201){var _0x5cc964=_0x8e12d8;_0x2bbf0c['particlesComputing']['windTextures'][_0x43b201][_0x5cc964(0x150)]();}),this['particlesRendering']['textures']['colorTable'][_0x8e12d8(0x150)](),Object['keys'](this['particlesRendering']['framebuffers'])[_0x8e12d8(0x19b)](function(_0x1f8ba5){var _0x238aac=_0x8e12d8;_0x2bbf0c['particlesRendering']['framebuffers'][_0x1f8ba5][_0x238aac(0x150)]();}),this['context']=_0x1aecb4,this['particlesComputing']=new ParticlesComputing(this['context'],this['data'],this['options'],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this['context'],this['data'],this['options'],this['viewerParameters'],this[_0x8e12d8(0x119)]);}},{'key':'clearFramebuffers','value':function _0x5d6893(){var _0x2a1dca=_0x59eb,_0x4622ce=this,_0x4485bc=new Cesium$2['ClearCommand']({'color':new Cesium$2[(_0x2a1dca(0x15c))](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2['Pass']['OPAQUE']});Object['keys'](this['particlesRendering'][_0x2a1dca(0xdf)])['forEach'](function(_0x5a7ff4){_0x4485bc['framebuffer']=_0x4622ce['particlesRendering']['framebuffers'][_0x5a7ff4],_0x4485bc['execute'](_0x4622ce['context']);});}},{'key':_0x251963(0x164),'value':function _0x5f2453(_0x439252){var _0x5df3aa=_0x251963;this[_0x5df3aa(0x1a6)](),this[_0x5df3aa(0x119)]['destroyParticlesTextures'](),this[_0x5df3aa(0x119)]['createParticlesTextures'](this[_0x5df3aa(0x1cf)],this['options'],this['viewerParameters']);if(_0x439252){var _0x279cc7=this['particlesRendering']['createSegmentsGeometry'](this[_0x5df3aa(0xda)]);this['particlesRendering']['primitives']['segments']['geometry']=_0x279cc7;var _0x1a00c2=Cesium$2['VertexArray'][_0x5df3aa(0x1b7)]({'context':this['context'],'geometry':_0x279cc7,'attributeLocations':this['particlesRendering']['primitives'][_0x5df3aa(0x1d1)]['attributeLocations'],'bufferUsage':Cesium$2['BufferUsage'][_0x5df3aa(0x1d6)]});this['particlesRendering']['primitives']['segments']['commandToExecute']['vertexArray']=_0x1a00c2;}}},{'key':'setOptions','value':function _0x16dfaf(_0x5a3e5d){var _0x2c2c3b=_0x251963,_0x3a0e5c=this,_0x4598c6=![];this['options']['maxParticles']!==_0x5a3e5d['maxParticles']&&(_0x4598c6=!![]),Object['keys'](_0x5a3e5d)['forEach'](function(_0x5c1f7d){_0x3a0e5c['options'][_0x5c1f7d]=_0x5a3e5d[_0x5c1f7d];}),this[_0x2c2c3b(0x164)](_0x4598c6);}},{'key':'applyViewerParameters','value':function _0x5b7be6(_0x3de41c){var _0x266464=_0x251963,_0x492178=this;Object['keys'](_0x3de41c)[_0x266464(0x19b)](function(_0x454f1d){_0x492178['viewerParameters'][_0x454f1d]=_0x3de41c[_0x454f1d];}),this['refreshParticles'](![]);}},{'key':_0x251963(0x150),'value':function _0x2be752(){var _0x14b788=_0x251963,_0x43f5a4=this;clearTimeout(this[_0x14b788(0x156)]),this['particlesComputing'][_0x14b788(0x11a)](),Object['keys'](this['particlesComputing']['windTextures'])[_0x14b788(0x19b)](function(_0x2a0a07){var _0x1daa6d=_0x14b788;_0x43f5a4[_0x1daa6d(0x119)][_0x1daa6d(0xf7)][_0x2a0a07]['destroy']();}),this[_0x14b788(0x1ba)][_0x14b788(0x160)]['colorTable'][_0x14b788(0x150)](),Object[_0x14b788(0x165)](this['particlesRendering'][_0x14b788(0xdf)])['forEach'](function(_0x706a20){var _0x1e193c=_0x14b788;_0x43f5a4['particlesRendering']['framebuffers'][_0x706a20][_0x1e193c(0x150)]();});for(var _0xaebf31 in this){delete this[_0xaebf31];}}}]),_0x46901f;}()),Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],DEF_OPTIONS={'particlesNumber':0x1000,'fixedHeight':0x0,'fadeOpacity':0.996,'dropRate':0.003,'dropRateBump':0.01,'speedFactor':0.5,'lineWidth':0x2,'colors':['rgb(206,255,255)']},WindLayer=function(_0x27c7c2){var _0x5df996=_0x220891;_inherits(_0x58c8e0,_0x27c7c2);var _0x2c62c7=_createSuper(_0x58c8e0);function _0x58c8e0(){var _0x51b5ee=_0x59eb,_0x30f3df,_0x2e3653=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x58c8e0),_0x2e3653=_objectSpread2(_objectSpread2({},DEF_OPTIONS),_0x2e3653),_0x30f3df=_0x2c62c7[_0x51b5ee(0x134)](this,_0x2e3653),_0x30f3df['_setOptionsHook'](_0x2e3653),_0x30f3df;}return _createClass(_0x58c8e0,[{'key':'layer','get':function _0x58e008(){return this['primitives'];}},{'key':_0x5df996(0x115),'get':function _0x3952df(){var _0x599618=_0x5df996;return this[_0x599618(0x18d)];},'set':function _0x240293(_0x33e983){this['setData'](_0x33e983);}},{'key':'colors','get':function _0x5e7043(){return this['options']['colors'];},'set':function _0x5d6a50(_0xd99bd0){this['options']['colors']=_0xd99bd0,this['particleSystem']&&this['particleSystem']['setOptions']({'colors':_0xd99bd0}),this['resize']();}},{'key':_0x5df996(0x1ad),'value':function _0x12510a(){}},{'key':_0x5df996(0x1d3),'value':function _0x25b802(){var _0x267d7c=_0x5df996;this['scene']=this['_map']['scene'],this['camera']=this[_0x267d7c(0x1c2)][_0x267d7c(0x1bc)],this[_0x267d7c(0x14a)]=new Cesium$1['PrimitiveCollection'](),this['_map']['scene']['primitives']['add'](this['primitives']),this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](),'latRange':new Cesium$1['Cartesian2'](),'pixelSize':0x0},this[_0x267d7c(0x12b)]=new Cesium$1['BoundingSphere'](Cesium$1['Cartesian3']['ZERO'],0.99*0x615299),this[_0x267d7c(0x171)](),window[_0x267d7c(0x12f)]('resize',this['resize']['bind'](this),![]),this['mouse_down']=![],this['mouse_move']=![],this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this[_0x267d7c(0x1c2)]['on'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this[_0x267d7c(0x1c2)]['on'](mars3d__namespace['EventType'][_0x267d7c(0x108)],this['_onMouseUpEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this),this['_data']&&this['setData'](this[_0x267d7c(0x18d)]);}},{'key':'_removedHook','value':function _0x8d9ee7(){var _0x233e01=_0x5df996;window[_0x233e01(0x149)]('resize',this['resize']),this['_map'][_0x233e01(0x1a9)](mars3d__namespace['EventType'][_0x233e01(0x155)],this['_onMap_preRenderEvent'],this),this['_map']['off'](mars3d__namespace[_0x233e01(0x193)]['wheel'],this[_0x233e01(0x11e)],this),this['_map']['off'](mars3d__namespace['EventType']['mouseDown'],this[_0x233e01(0x145)],this),this['_map']['off'](mars3d__namespace['EventType'][_0x233e01(0x108)],this['_onMouseUpEvent'],this),this['_map'][_0x233e01(0x1a9)](mars3d__namespace[_0x233e01(0x193)][_0x233e01(0x13e)],this['_onMouseMoveEvent'],this),this[_0x233e01(0x14a)][_0x233e01(0x1ac)](),this['_map']['scene']['primitives'][_0x233e01(0x163)](this['primitives']);}},{'key':'resize','value':function _0x48a3d6(){var _0x4d78a7=_0x5df996;if(!this[_0x4d78a7(0x104)]||!this['particleSystem'])return;this[_0x4d78a7(0x14a)][_0x4d78a7(0x104)]=![],this['primitives']['removeAll'](),this[_0x4d78a7(0x1c2)]['once'](mars3d__namespace['EventType'][_0x4d78a7(0x155)],this['_onMap_preRenderEvent'],this);}},{'key':_0x5df996(0x140),'value':function _0x210f91(_0x4946b9){var _0x5de480=_0x5df996;this['particleSystem']['canvasResize'](this['scene'][_0x5de480(0x1cf)]),this['addPrimitives'](),this['primitives'][_0x5de480(0x104)]=!![];}},{'key':'_onMapWhellEvent','value':function _0x5b2816(_0x1d4b84){var _0x5c7785=_0x5df996,_0xbc652a=this;clearTimeout(this['refreshTimer']);if(!this['show']||!this[_0x5c7785(0x1dc)])return;this[_0x5c7785(0x14a)][_0x5c7785(0x104)]=![],this['refreshTimer']=setTimeout(function(){var _0x129db0=_0x5c7785;if(!_0xbc652a[_0x129db0(0x104)])return;_0xbc652a[_0x129db0(0x18b)]();},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x2e1722(_0x170db8){this['mouse_down']=!![];}},{'key':'_onMouseMoveEvent','value':function _0x35418e(_0x579d2b){var _0x1262ba=_0x5df996;if(!this['show']||!this['particleSystem'])return;this['mouse_down']&&(this[_0x1262ba(0x14a)][_0x1262ba(0x104)]=![],this[_0x1262ba(0xdd)]=!![]);}},{'key':_0x5df996(0xe3),'value':function _0x80f6f7(_0x57a201){var _0x2bdbbd=_0x5df996;if(!this['show']||!this[_0x2bdbbd(0x1dc)])return;this[_0x2bdbbd(0x126)]&&this['mouse_move']&&this['redraw'](),this['primitives'][_0x2bdbbd(0x104)]=!![],this['mouse_down']=![],this['mouse_move']=![];}},{'key':'redraw','value':function _0x51dd1e(){var _0x228e91=_0x5df996;if(!this['_map']||!this[_0x228e91(0x104)])return;this['updateViewerParameters'](),this['particleSystem']['applyViewerParameters'](this['viewerParameters']),this['primitives']['show']=!![];}},{'key':'setData','value':function _0x222c85(_0x4f7fa5){var _0x57e3b4=_0x5df996;this[_0x57e3b4(0x18d)]=_0x4f7fa5,this[_0x57e3b4(0x1dc)]&&this['particleSystem'][_0x57e3b4(0x150)](),this[_0x57e3b4(0x1dc)]=new ParticleSystem(this['scene']['context'],_0x4f7fa5,this['getOptions'](),this['viewerParameters']),this['addPrimitives']();}},{'key':_0x5df996(0x101),'value':function _0x1c8382(_0x480006,_0x451b94){var _0x33aa1b=_0x5df996;if(_0x480006)for(var _0x3567f7 in _0x480006){this[_0x3567f7]=_0x480006[_0x3567f7];}this['particleSystem']&&this['particleSystem']['setOptions'](this[_0x33aa1b(0x170)]());}},{'key':'getOptions','value':function _0x409916(){var _0x3a0b5a=_0x5df996,_0x5ac446=Math['ceil'](Math['sqrt'](this[_0x3a0b5a(0x1bd)]));return this['particlesNumber']=_0x5ac446*_0x5ac446,{'particlesTextureSize':_0x5ac446,'maxParticles':this['particlesNumber'],'particleHeight':this['fixedHeight'],'fadeOpacity':this[_0x3a0b5a(0x181)],'dropRate':this['dropRate'],'dropRateBump':this['dropRateBump'],'speedFactor':this['speedFactor'],'lineWidth':this['lineWidth'],'colors':this['colors']};}},{'key':'addPrimitives','value':function _0x40b3f3(){var _0x692696=_0x5df996;this['primitives']['add'](this['particleSystem']['particlesComputing'][_0x692696(0x14a)][_0x692696(0x1ae)]),this['primitives']['add'](this[_0x692696(0x1dc)]['particlesComputing']['primitives']['updateSpeed']),this['primitives']['add'](this['particleSystem'][_0x692696(0x119)]['primitives']['updatePosition']),this['primitives']['add'](this['particleSystem']['particlesComputing']['primitives']['postProcessingPosition']),this['primitives'][_0x692696(0x158)](this['particleSystem'][_0x692696(0x119)]['primitives']['postProcessingSpeed']),this['primitives'][_0x692696(0x158)](this[_0x692696(0x1dc)]['particlesRendering']['primitives'][_0x692696(0x1d1)]),this['primitives']['add'](this['particleSystem'][_0x692696(0x1ba)]['primitives']['trails']),this['primitives']['add'](this[_0x692696(0x1dc)][_0x692696(0x1ba)]['primitives']['screen']);}},{'key':_0x5df996(0x171),'value':function _0x5d274f(){var _0x504f81=_0x5df996,_0x358b0e=this['camera']['computeViewRectangle'](this['scene']['globe']['ellipsoid']);if(!_0x358b0e){var _0x2cf4d5=this['_map']['getExtent']();_0x358b0e=Cesium$1[_0x504f81(0xee)]['fromDegrees'](_0x2cf4d5['xmin'],_0x2cf4d5[_0x504f81(0x106)],_0x2cf4d5['xmax'],_0x2cf4d5[_0x504f81(0x130)]);}var _0x4c80b0=Util[_0x504f81(0x1a3)](_0x358b0e);this['viewerParameters']['lonRange']['x']=_0x4c80b0[_0x504f81(0x125)][_0x504f81(0x199)],this[_0x504f81(0x1b1)][_0x504f81(0x14b)]['y']=_0x4c80b0['lon']['max'],this[_0x504f81(0x1b1)]['latRange']['x']=_0x4c80b0[_0x504f81(0x1b3)]['min'],this['viewerParameters'][_0x504f81(0x14e)]['y']=_0x4c80b0['lat']['max'];var _0x5755b0=this['camera'][_0x504f81(0x1ca)](this['globeBoundingSphere'],this['scene'][_0x504f81(0x18f)],this[_0x504f81(0x1bf)]['drawingBufferHeight']);_0x5755b0>0x0&&(this['viewerParameters'][_0x504f81(0x12a)]=_0x5755b0);}}]),_0x58c8e0;}(BaseLayer$1);mars3d__namespace['LayerUtil']['register']('wind',WindLayer),mars3d__namespace[_0x220891(0x12d)]['WindLayer']=WindLayer;var CanvasParticle=(function(){var _0x535c10=_0x220891;function _0x17e8ce(){var _0x599a9d=_0x59eb;_classCallCheck(this,_0x17e8ce),this['lng']=null,this['lat']=null,this['tlng']=null,this[_0x599a9d(0x1c1)]=null,this['age']=null;}return _createClass(_0x17e8ce,[{'key':_0x535c10(0x150),'value':function _0x10ce09(){for(var _0x2cf1ce in this){delete this[_0x2cf1ce];}}}]),_0x17e8ce;}()),CanvasWindField=(function(){var _0x38195f=_0x220891;function _0x36e498(_0x51d02d){var _0x47cd4d=_0x59eb;_classCallCheck(this,_0x36e498),this[_0x47cd4d(0xfc)](_0x51d02d);}return _createClass(_0x36e498,[{'key':_0x38195f(0x13d),'get':function _0x4ed364(){return this['_speedRate'];},'set':function _0x2c7fd6(_0x5afa0b){var _0x4b0a53=_0x38195f;this['_speedRate']=(0x64-(_0x5afa0b>0x63?0x63:_0x5afa0b))*0x64,this['_calc_speedRate']=[(this[_0x4b0a53(0x1d0)]-this['xmin'])/this[_0x4b0a53(0x118)],(this['ymax']-this['ymin'])/this['_speedRate']];}},{'key':'maxAge','get':function _0x240993(){return this['_maxAge'];},'set':function _0xa3db5b(_0x4ee3e6){this['_maxAge']=_0x4ee3e6;}},{'key':'setOptions','value':function _0x546d16(_0x297050){var _0x32ea5c=_0x38195f;this[_0x32ea5c(0xda)]=_0x297050,this['maxAge']=_0x297050['maxAge']||0x78,this['speedRate']=_0x297050[_0x32ea5c(0x13d)]||0x32,this['particles']=[];var _0x494dd3=_0x297050['particlesNumber']||0x1000;for(var _0x25b1bc=0x0;_0x25b1bc<_0x494dd3;_0x25b1bc++){var _0xb9dcf9=this['_randomParticle'](new CanvasParticle());this['particles']['push'](_0xb9dcf9);}}},{'key':_0x38195f(0xe0),'value':function _0xa37708(_0x11f35c){var _0x8dad4e=_0x38195f;this['rows']=_0x11f35c['rows'],this['cols']=_0x11f35c['cols'],this[_0x8dad4e(0x1a7)]=_0x11f35c['xmin'],this[_0x8dad4e(0x1d0)]=_0x11f35c['xmax'],this['ymin']=_0x11f35c['ymin'],this['ymax']=_0x11f35c['ymax'],this[_0x8dad4e(0xed)]=[];var _0x5a3ad9=_0x11f35c[_0x8dad4e(0xe8)],_0x2a18ed=_0x11f35c['vdata'],_0x509d4e=![];_0x5a3ad9['length']===this['rows']&&_0x5a3ad9[0x0][_0x8dad4e(0x19d)]===this[_0x8dad4e(0x105)]&&(_0x509d4e=!![]);var _0x3502dc=0x0,_0x515dae=null,_0x577f6d=null;for(var _0x5901e1=0x0;_0x5901e1<this[_0x8dad4e(0x16f)];_0x5901e1++){_0x515dae=[];for(var _0xb580dc=0x0;_0xb580dc<this[_0x8dad4e(0x105)];_0xb580dc++,_0x3502dc++){_0x509d4e?_0x577f6d=this['_calcUV'](_0x5a3ad9[_0x5901e1][_0xb580dc],_0x2a18ed[_0x5901e1][_0xb580dc]):_0x577f6d=this[_0x8dad4e(0x1c9)](_0x5a3ad9[_0x3502dc],_0x2a18ed[_0x3502dc]),_0x515dae['push'](_0x577f6d);}this['grid']['push'](_0x515dae);}this['options']['reverseY']&&this['grid'][_0x8dad4e(0x1c8)]();}},{'key':'clear','value':function _0xb58098(){var _0x3d82f0=_0x38195f;delete this['rows'],delete this['cols'],delete this['xmin'],delete this['xmax'],delete this[_0x3d82f0(0x106)],delete this['ymax'],delete this['grid'],delete this['particles'];}},{'key':'toGridXY','value':function _0x15a803(_0x384143,_0x43371f){var _0x318160=_0x38195f,_0x43bf6f=(_0x384143-this['xmin'])/(this[_0x318160(0x1d0)]-this['xmin'])*(this['cols']-0x1),_0x3587fe=(this[_0x318160(0x130)]-_0x43371f)/(this[_0x318160(0x130)]-this['ymin'])*(this['rows']-0x1);return[_0x43bf6f,_0x3587fe];}},{'key':_0x38195f(0x18c),'value':function _0x3af245(_0x5806f1,_0x51a5b7){var _0x34d610=_0x38195f;if(_0x5806f1<0x0||_0x5806f1>=this[_0x34d610(0x105)]||_0x51a5b7>=this['rows'])return[0x0,0x0,0x0];var _0x4b35b4=Math['floor'](_0x5806f1),_0xc2810=Math['floor'](_0x51a5b7);if(_0x4b35b4===_0x5806f1&&_0xc2810===_0x51a5b7)return this['grid'][_0x51a5b7][_0x5806f1];var _0x4e3c4c=_0x4b35b4+0x1,_0x1b9e62=_0xc2810+0x1,_0x49e518=this['getUVByXY'](_0x4b35b4,_0xc2810),_0x40b930=this[_0x34d610(0x18c)](_0x4e3c4c,_0xc2810),_0x3b0ccd=this[_0x34d610(0x18c)](_0x4b35b4,_0x1b9e62),_0x1cb70e=this[_0x34d610(0x18c)](_0x4e3c4c,_0x1b9e62),_0x2548ec=null;try{_0x2548ec=this['_bilinearInterpolation'](_0x5806f1-_0x4b35b4,_0x51a5b7-_0xc2810,_0x49e518,_0x40b930,_0x3b0ccd,_0x1cb70e);}catch(_0x2c9987){console['log'](_0x5806f1,_0x51a5b7);}return _0x2548ec;}},{'key':_0x38195f(0x1b5),'value':function _0x2d321b(_0x433069,_0x25a2dc,_0x28a8b9,_0x9be019,_0x191669,_0x435ce1){var _0x400180=0x1-_0x433069,_0x3b6c57=0x1-_0x25a2dc,_0x1f5396=_0x400180*_0x3b6c57,_0x319491=_0x433069*_0x3b6c57,_0x5f2b1c=_0x400180*_0x25a2dc,_0x3edd6d=_0x433069*_0x25a2dc,_0x174963=_0x28a8b9[0x0]*_0x1f5396+_0x9be019[0x0]*_0x319491+_0x191669[0x0]*_0x5f2b1c+_0x435ce1[0x0]*_0x3edd6d,_0x2431ad=_0x28a8b9[0x1]*_0x1f5396+_0x9be019[0x1]*_0x319491+_0x191669[0x1]*_0x5f2b1c+_0x435ce1[0x1]*_0x3edd6d;return this['_calcUV'](_0x174963,_0x2431ad);}},{'key':'_calcUV','value':function _0x588231(_0x3abaaf,_0x54424c){return[+_0x3abaaf,+_0x54424c,Math['sqrt'](_0x3abaaf*_0x3abaaf+_0x54424c*_0x54424c)];}},{'key':'getUVByPoint','value':function _0x34265a(_0x35d850,_0x823ef5){var _0xb5a503=_0x38195f;if(!this[_0xb5a503(0x1b0)](_0x35d850,_0x823ef5))return null;var _0x31fa6e=this['toGridXY'](_0x35d850,_0x823ef5),_0x478993=this['getUVByXY'](_0x31fa6e[0x0],_0x31fa6e[0x1]);return _0x478993;}},{'key':'isInExtent','value':function _0x599923(_0xf9aca6,_0x83871){return _0xf9aca6>=this['xmin']&&_0xf9aca6<=this['xmax']&&_0x83871>=this['ymin']&&_0x83871<=this['ymax']?!![]:![];}},{'key':'getRandomLatLng','value':function _0x506eea(){var _0x46d462=fRandomByfloat(this['xmin'],this['xmax']),_0x8312ee=fRandomByfloat(this['ymin'],this['ymax']);return{'lat':_0x8312ee,'lng':_0x46d462};}},{'key':'getParticles','value':function _0x4cd629(){var _0xad3d5d=_0x38195f,_0x40db0a,_0x51af85,_0x1eed63;for(var _0x6844c2=0x0,_0x593ad1=this['particles']['length'];_0x6844c2<_0x593ad1;_0x6844c2++){var _0x23912c=this[_0xad3d5d(0x19a)][_0x6844c2];_0x23912c['age']<=0x0&&(_0x23912c=this['_randomParticle'](_0x23912c));if(_0x23912c[_0xad3d5d(0x1a8)]>0x0){var _0x95cd53=_0x23912c['tlng'],_0x149bb2=_0x23912c['tlat'];_0x1eed63=this['getUVByPoint'](_0x95cd53,_0x149bb2),_0x1eed63?(_0x40db0a=_0x95cd53+this['_calc_speedRate'][0x0]*_0x1eed63[0x0],_0x51af85=_0x149bb2+this['_calc_speedRate'][0x1]*_0x1eed63[0x1],_0x23912c['lng']=_0x95cd53,_0x23912c[_0xad3d5d(0x1b3)]=_0x149bb2,_0x23912c['tlng']=_0x40db0a,_0x23912c['tlat']=_0x51af85,_0x23912c['age']--):_0x23912c['age']=0x0;}}return this['particles'];}},{'key':'_randomParticle','value':function _0x27e9d3(_0x3d258c){var _0x52988c=_0x38195f,_0x54e636,_0x2746d9;for(var _0x23a991=0x0;_0x23a991<0x1e;_0x23a991++){_0x54e636=this['getRandomLatLng'](),_0x2746d9=this[_0x52988c(0xfa)](_0x54e636['lng'],_0x54e636[_0x52988c(0x1b3)]);if(_0x2746d9&&_0x2746d9[0x2]>0x0)break;}if(!_0x2746d9)return _0x3d258c;var _0x20ea89=_0x54e636['lng']+this['_calc_speedRate'][0x0]*_0x2746d9[0x0],_0xf4c9c8=_0x54e636['lat']+this['_calc_speedRate'][0x1]*_0x2746d9[0x1];return _0x3d258c['lng']=_0x54e636['lng'],_0x3d258c['lat']=_0x54e636['lat'],_0x3d258c['tlng']=_0x20ea89,_0x3d258c[_0x52988c(0x1c1)]=_0xf4c9c8,_0x3d258c['age']=Math['round'](Math['random']()*this['maxAge']),_0x3d258c;}},{'key':'destroy','value':function _0x142022(){for(var _0x29a051 in this){delete this[_0x29a051];}}}]),_0x36e498;}());function fRandomByfloat(_0x562812,_0x2d4f74){return _0x562812+Math['random']()*(_0x2d4f74-_0x562812);}var Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x220891(0xde)],CanvasWindLayer=function(_0x25cb5c){var _0x3a6c49=_0x220891;_inherits(_0x2a017c,_0x25cb5c);var _0x2aa769=_createSuper(_0x2a017c);function _0x2a017c(){var _0x38b5fc=_0x59eb,_0x414ab1,_0x1f5572=arguments[_0x38b5fc(0x19d)]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x2a017c),_0x414ab1=_0x2aa769['call'](this,_0x1f5572),_0x414ab1['_setOptionsHook'](_0x1f5572),_0x414ab1[_0x38b5fc(0x196)]=null,_0x414ab1;}return _createClass(_0x2a017c,[{'key':'_setOptionsHook','value':function _0x3cf193(_0x572783,_0x6fd4d7){var _0x301813=_0x59eb,_0x4595d6,_0x37399b,_0x337ccb;this[_0x301813(0x116)]=0x3e8/(_0x572783['frameRate']||0xa),this[_0x301813(0x110)]=(_0x4595d6=this[_0x301813(0xda)]['pointerEvents'])!==null&&_0x4595d6!==void 0x0?_0x4595d6:![],this['color']=_0x572783['color']||_0x301813(0x11b),this[_0x301813(0x159)]=_0x572783['lineWidth']||0x1,this['fixedHeight']=(_0x37399b=_0x572783['fixedHeight'])!==null&&_0x37399b!==void 0x0?_0x37399b:0x0,this[_0x301813(0x177)]=(_0x337ccb=_0x572783['reverseY'])!==null&&_0x337ccb!==void 0x0?_0x337ccb:![],this['windField']&&this['windField']['setOptions'](_0x572783);}},{'key':'layer','get':function _0x4801f2(){var _0x584bed=_0x59eb;return this[_0x584bed(0x196)];}},{'key':'canvasWidth','get':function _0x680a1d(){var _0x2fea58=_0x59eb;return this['_map'][_0x2fea58(0x1bf)]['canvas']['clientWidth'];}},{'key':'canvasHeight','get':function _0x276ea8(){return this['_map']['scene']['canvas']['clientHeight'];}},{'key':'pointerEvents','get':function _0x5b368a(){var _0x4f69f9=_0x59eb;return this[_0x4f69f9(0x110)];},'set':function _0x189a1c(_0x3beffb){var _0xbb7534=_0x59eb;this['_pointerEvents']=_0x3beffb;if(!this['canvas'])return;_0x3beffb?this['canvas']['style'][_0xbb7534(0x1c3)]='all':this['canvas']['style']['pointer-events']=_0xbb7534(0x19f);}},{'key':'particlesNumber','get':function _0x30d6a1(){return this['options']['particlesNumber'];},'set':function _0x597a08(_0x58faee){var _0x16db16=_0x59eb,_0x1e2079=this;this['options']['particlesNumber']=_0x58faee,clearTimeout(this['_canrefresh']),this[_0x16db16(0x16e)]=setTimeout(function(){var _0x2e0e35=_0x16db16;_0x1e2079[_0x2e0e35(0x18b)]();},0x1f4);}},{'key':'speedRate','get':function _0x48f8e3(){var _0x465ae5=_0x59eb;return this['options'][_0x465ae5(0x13d)];},'set':function _0x297ec1(_0xe1b86c){var _0x261895=_0x59eb;this['options'][_0x261895(0x13d)]=_0xe1b86c,this['windField']&&(this['windField']['speedRate']=_0xe1b86c);}},{'key':'maxAge','get':function _0x35233a(){return this['options']['maxAge'];},'set':function _0x15646a(_0x5225a1){var _0x5e1b47=_0x59eb;this['options']['maxAge']=_0x5225a1,this['windField']&&(this[_0x5e1b47(0x12c)][_0x5e1b47(0x186)]=_0x5225a1);}},{'key':'data','get':function _0x53183e(){return this['windData'];},'set':function _0xd31803(_0x3a82f6){this['setData'](_0x3a82f6);}},{'key':'_showHook','value':function _0x473462(_0x28df6f){var _0x457a79=_0x59eb;_0x28df6f?this[_0x457a79(0x1d3)]():(this['windData']&&(this[_0x457a79(0xda)][_0x457a79(0x115)]=this[_0x457a79(0x1b9)]),this[_0x457a79(0x151)]());}},{'key':_0x3a6c49(0x1ad),'value':function _0x43061d(){var _0x9fbfb8=_0x3a6c49;this[_0x9fbfb8(0xda)][_0x9fbfb8(0x185)]?this[_0x9fbfb8(0x127)]():this[_0x9fbfb8(0x12c)]=new CanvasWindField(this[_0x9fbfb8(0xda)]);}},{'key':'_addedHook','value':function _0x39534e(){var _0x16a54f=_0x3a6c49;this[_0x16a54f(0x196)]=this[_0x16a54f(0x15f)](),this[_0x16a54f(0x1d5)]=this['canvas']['getContext']('2d',{'willReadFrequently':!![]}),this['bindEvent'](),this[_0x16a54f(0xda)]['data']&&this['setData'](this['options'][_0x16a54f(0x115)]);}},{'key':_0x3a6c49(0x151),'value':function _0x1d9fb9(){var _0x111657=_0x3a6c49;this['clear'](),this['unbindEvent'](),this['canvas']&&(this[_0x111657(0x1c2)]['container'][_0x111657(0xea)](this['canvas']),delete this['canvas']);}},{'key':_0x3a6c49(0x15f),'value':function _0x1a0820(){var _0x2b6980=_0x3a6c49,_0x2e75f2=document['createElement']('canvas');_0x2e75f2['style'][_0x2b6980(0x10b)]='absolute',_0x2e75f2['style']['top']=_0x2b6980(0xfe),_0x2e75f2['style']['left']='0px',_0x2e75f2[_0x2b6980(0x100)]['width']='100%',_0x2e75f2[_0x2b6980(0x100)]['height']='100%',_0x2e75f2['style']['pointerEvents']=this['_pointerEvents']?_0x2b6980(0x17f):'none',_0x2e75f2['style']['zIndex']=0xa,_0x2e75f2['setAttribute']('id',_0x2b6980(0x136)),_0x2e75f2[_0x2b6980(0xdc)](_0x2b6980(0x195),'canvasWindy'),this[_0x2b6980(0x1c2)]['container']['appendChild'](_0x2e75f2);var _0x26600f=this[_0x2b6980(0x1c2)][_0x2b6980(0x1bf)];return _0x2e75f2['width']=_0x26600f[_0x2b6980(0x196)]['clientWidth'],_0x2e75f2[_0x2b6980(0x178)]=_0x26600f['canvas'][_0x2b6980(0x17e)],_0x2e75f2;}},{'key':'resize','value':function _0x2ed915(){var _0xbc1b3e=_0x3a6c49;this[_0xbc1b3e(0x196)]&&(this['canvas'][_0xbc1b3e(0x1da)]=this['canvasWidth'],this['canvas']['height']=this['canvasHeight']);}},{'key':'bindEvent','value':function _0x5a89c9(){var _0xf901e=_0x3a6c49,_0x502083=this,_0x59f397=Date['now']();(function _0x33a36a(){var _0x53aa0d=_0x59eb;_0x502083[_0x53aa0d(0x14d)]=window['requestAnimationFrame'](_0x33a36a);if(_0x502083['show']&&_0x502083['windField']){var _0x282e94=Date['now'](),_0x3af9c1=_0x282e94-_0x59f397;_0x3af9c1>_0x502083['frameTime']&&(_0x59f397=_0x282e94-_0x3af9c1%_0x502083['frameTime'],_0x502083['update']());}}(),window['addEventListener']('resize',this['resize'][_0xf901e(0x179)](this),![]),this['mouse_down']=![],this['mouse_move']=![],this['options']['mouseHidden']&&(this['_map']['on'](mars3d__namespace[_0xf901e(0x193)][_0xf901e(0x120)],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0xf901e(0x108)],this['_onMouseUpEvent'],this)));}},{'key':'unbindEvent','value':function _0x31f00f(){var _0x4149ca=_0x3a6c49;window[_0x4149ca(0xf3)](this['animateFrame']),delete this[_0x4149ca(0x14d)],window['removeEventListener'](_0x4149ca(0x172),this['resize']),this['options']['mouseHidden']&&(this[_0x4149ca(0x1c2)]['off'](mars3d__namespace[_0x4149ca(0x193)]['wheel'],this['_onMapWhellEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace['EventType'][_0x4149ca(0x108)],this[_0x4149ca(0xe3)],this),this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x4149ca(0x1cb)],this));}},{'key':'_onMapWhellEvent','value':function _0x5e9c95(_0x4fb5c3){var _0x547758=_0x3a6c49,_0x3e793c=this;clearTimeout(this[_0x547758(0x1b2)]);if(!this[_0x547758(0x104)]||!this['canvas'])return;this[_0x547758(0x196)][_0x547758(0x100)]['visibility']='hidden',this['refreshTimer']=setTimeout(function(){var _0xb49eb9=_0x547758;if(!_0x3e793c[_0xb49eb9(0x104)])return;_0x3e793c['redraw'](),_0x3e793c['canvas']['style'][_0xb49eb9(0x1cc)]='visible';},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x2fbd45(_0x3b22be){var _0x16963a=_0x3a6c49;this['mouse_down']=!![],this['_map']['off'](mars3d__namespace[_0x16963a(0x193)]['mouseMove'],this['_onMouseMoveEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x16963a(0x13e)],this[_0x16963a(0x1cb)],this);}},{'key':'_onMouseMoveEvent','value':function _0x322372(_0xf3a213){var _0x1264c4=_0x3a6c49;if(!this[_0x1264c4(0x104)]||!this['canvas'])return;this['mouse_down']&&(this['canvas']['style']['visibility']=_0x1264c4(0xf9),this['mouse_move']=!![]);}},{'key':'_onMouseUpEvent','value':function _0x1648d2(_0x4543df){var _0xb12414=_0x3a6c49;if(!this['show']||!this['canvas'])return;this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0xb12414(0x1cb)],this),this['mouse_down']&&this[_0xb12414(0xdd)]&&this[_0xb12414(0x18b)](),this['canvas'][_0xb12414(0x100)]['visibility']='visible',this['mouse_down']=![],this['mouse_move']=![];}},{'key':'setData','value':function _0x1d4275(_0x1cd2b9){var _0x430a3b=_0x3a6c49;this['clear'](),this['windData']=_0x1cd2b9,this['windField'][_0x430a3b(0xe0)](_0x1cd2b9),this['redraw']();}},{'key':'redraw','value':function _0x524338(){var _0xdadef9=_0x3a6c49;if(!this[_0xdadef9(0x104)])return;this['windField']['setOptions'](this['options']),this[_0xdadef9(0x1dd)]();}},{'key':'update','value':function _0x276298(){var _0x163218=_0x3a6c49;if(this[_0x163218(0x192)])return;this[_0x163218(0x192)]=!![];if(this['worker'])this['windField']['update']();else{var _0x5d1695=this['windField']['getParticles']();this['_drawLines'](_0x5d1695);}this[_0x163218(0x192)]=![];}},{'key':'_drawLines','value':function _0x511322(_0x2f9152){var _0x1347d7=_0x3a6c49;this['canvasContext']['globalCompositeOperation']='destination-in',this[_0x1347d7(0x1d5)]['fillRect'](0x0,0x0,this[_0x1347d7(0x174)],this['canvasHeight']),this['canvasContext']['globalCompositeOperation']=_0x1347d7(0x1b4),this['canvasContext']['globalAlpha']=0.9,this[_0x1347d7(0x1d5)]['beginPath'](),this['canvasContext']['lineWidth']=this[_0x1347d7(0x159)],this['canvasContext']['strokeStyle']=this['color'];var _0x2a902b=this['_map']['scene'][_0x1347d7(0xfd)]!==Cesium['SceneMode'][_0x1347d7(0x10f)];for(var _0x5460f6=0x0,_0x4a7ce1=_0x2f9152['length'];_0x5460f6<_0x4a7ce1;_0x5460f6++){var _0x47779d=_0x2f9152[_0x5460f6],_0x45a291=this[_0x1347d7(0x189)](_0x47779d['lng'],_0x47779d[_0x1347d7(0x1b3)],_0x47779d),_0x49e947=this['_tomap'](_0x47779d[_0x1347d7(0x141)],_0x47779d['tlat'],_0x47779d);if(!_0x45a291||!_0x49e947)continue;if(_0x2a902b&&Math[_0x1347d7(0x17d)](_0x45a291[0x0]-_0x49e947[0x0])>=this['canvasWidth'])continue;this['canvasContext']['moveTo'](_0x45a291[0x0],_0x45a291[0x1]),this[_0x1347d7(0x1d5)]['lineTo'](_0x49e947[0x0],_0x49e947[0x1]);}this['canvasContext'][_0x1347d7(0x107)]();}},{'key':_0x3a6c49(0x189),'value':function _0x114324(_0x28865c,_0x5d04c2,_0x7f8cb3){var _0x94dd28=_0x3a6c49,_0x2737c0=Cesium['Cartesian3']['fromDegrees'](_0x28865c,_0x5d04c2,this['fixedHeight']),_0x4716ee=this[_0x94dd28(0x1c2)]['scene'];if(_0x4716ee['mode']===Cesium['SceneMode'][_0x94dd28(0x10f)]){var _0x257a50=new Cesium['EllipsoidalOccluder'](_0x4716ee[_0x94dd28(0x11d)]['ellipsoid'],_0x4716ee[_0x94dd28(0x1bc)]['positionWC']),_0x4c6172=_0x257a50['isPointVisible'](_0x2737c0);if(!_0x4c6172)return _0x7f8cb3['age']=0x0,null;}var _0x44f42a=Cesium['SceneTransforms']['wgs84ToWindowCoordinates'](this['_map']['scene'],_0x2737c0);return _0x44f42a?[_0x44f42a['x'],_0x44f42a['y']]:null;}},{'key':_0x3a6c49(0xdb),'value':function _0x3ab9c8(){var _0x2acf37=_0x3a6c49;this['windField'][_0x2acf37(0xdb)](),delete this['windData'];}},{'key':_0x3a6c49(0x127),'value':function _0x14175e(){var _0x2b26e8=_0x3a6c49,_0x4db195=this;this['worker']=new Worker(this['options']['worker']),this['worker'][_0x2b26e8(0x1ab)]=function(_0x196950){var _0x27d4e2=_0x2b26e8;_0x4db195[_0x27d4e2(0x15b)](_0x196950[_0x27d4e2(0x115)]['particles']),_0x4db195[_0x27d4e2(0x1a4)]=![];},this['windField']={'init':function _0x480492(_0x2cfd4f){var _0x3867dc=_0x2b26e8;_0x4db195[_0x3867dc(0x185)][_0x3867dc(0x197)]({'type':'init','options':_0x2cfd4f});},'setOptions':function _0x3fca73(_0x396c18){var _0x5493e3=_0x2b26e8;_0x4db195[_0x5493e3(0x185)]['postMessage']({'type':_0x5493e3(0xfc),'options':_0x396c18});},'setDate':function _0x329fa7(_0x1063f8){var _0x1e3d62=_0x2b26e8;_0x4db195['worker']['postMessage']({'type':_0x1e3d62(0xe0),'data':_0x1063f8});},'update':function _0x1cccd9(){var _0x31d335=_0x2b26e8;if(_0x4db195[_0x31d335(0x1a4)])return;_0x4db195['_updateIng2']=!![],_0x4db195[_0x31d335(0x185)]['postMessage']({'type':'update'});},'clear':function _0x32d439(){var _0x3ee760=_0x2b26e8;_0x4db195[_0x3ee760(0x185)][_0x3ee760(0x197)]({'type':'clear'});}},this[_0x2b26e8(0x12c)][_0x2b26e8(0x129)](this['options']);}}]),_0x2a017c;}(BaseLayer);mars3d__namespace[_0x220891(0x13a)][_0x220891(0x16c)]('canvasWind',CanvasWindLayer),mars3d__namespace['layer'][_0x220891(0x17c)]=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace['WindUtil']=WindUtil,exports[_0x220891(0xf6)]=CanvasWindField,exports[_0x220891(0x17c)]=CanvasWindLayer,exports['WindLayer']=WindLayer,exports[_0x220891(0x15a)]=WindUtil,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
