/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.6
 * 编译日期：2023-05-07 18:41:19
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';var _0x37e260=_0x2c63;(function(_0x37000a,_0x5813a7){var _0x45c3a2={_0x5089f7:0x6d,_0x414692:0x81,_0x49aaec:0x9c,_0x53ddc0:0xc7},_0x2f24d6=_0x2c63,_0x568af2=_0x37000a();while(!![]){try{var _0x4119ff=-parseInt(_0x2f24d6(_0x45c3a2._0x5089f7))/0x1+parseInt(_0x2f24d6(_0x45c3a2._0x414692))/0x2*(-parseInt(_0x2f24d6(0xcb))/0x3)+parseInt(_0x2f24d6(_0x45c3a2._0x49aaec))/0x4+parseInt(_0x2f24d6(0xa6))/0x5+parseInt(_0x2f24d6(0xbc))/0x6+parseInt(_0x2f24d6(_0x45c3a2._0x53ddc0))/0x7+-parseInt(_0x2f24d6(0x6e))/0x8;if(_0x4119ff===_0x5813a7)break;else _0x568af2['push'](_0x568af2['shift']());}catch(_0x39b3fc){_0x568af2['push'](_0x568af2['shift']());}}}(_0x3ee7,0xb7f92));function _interopNamespace(_0x3a32c9){var _0x192fc5={_0xf8c9bd:0x95},_0x4819f7={_0x34bd39:0x95,_0x2699a4:0xcc},_0xd527e1=_0x2c63;if(_0x3a32c9&&_0x3a32c9['__esModule'])return _0x3a32c9;var _0x395e5f=Object['create'](null);return _0x3a32c9&&Object['keys'](_0x3a32c9)['forEach'](function(_0x24d99d){var _0x1aa80e=_0x2c63;if(_0x24d99d!==_0x1aa80e(_0x4819f7._0x34bd39)){var _0x429c5b=Object[_0x1aa80e(_0x4819f7._0x2699a4)](_0x3a32c9,_0x24d99d);Object['defineProperty'](_0x395e5f,_0x24d99d,_0x429c5b['get']?_0x429c5b:{'enumerable':!![],'get':function(){return _0x3a32c9[_0x24d99d];}});}}),_0x395e5f[_0xd527e1(_0x192fc5._0xf8c9bd)]=_0x3a32c9,_0x395e5f;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337);function ownKeys(_0x3606ec,_0x185450){var _0x199b92=Object['keys'](_0x3606ec);if(Object['getOwnPropertySymbols']){var _0x433a84=Object['getOwnPropertySymbols'](_0x3606ec);_0x185450&&(_0x433a84=_0x433a84['filter'](function(_0x425d63){return Object['getOwnPropertyDescriptor'](_0x3606ec,_0x425d63)['enumerable'];})),_0x199b92['push']['apply'](_0x199b92,_0x433a84);}return _0x199b92;}function _objectSpread2(_0x300fac){var _0x7ea2c={_0x1aad0d:0xca},_0x6e6d86=_0x2c63;for(var _0x53e982=0x1;_0x53e982<arguments['length'];_0x53e982++){var _0xa230c2=null!=arguments[_0x53e982]?arguments[_0x53e982]:{};_0x53e982%0x2?ownKeys(Object(_0xa230c2),!0x0)['forEach'](function(_0xe5a4bb){_defineProperty(_0x300fac,_0xe5a4bb,_0xa230c2[_0xe5a4bb]);}):Object['getOwnPropertyDescriptors']?Object['defineProperties'](_0x300fac,Object['getOwnPropertyDescriptors'](_0xa230c2)):ownKeys(Object(_0xa230c2))[_0x6e6d86(_0x7ea2c._0x1aad0d)](function(_0x24d9ca){Object['defineProperty'](_0x300fac,_0x24d9ca,Object['getOwnPropertyDescriptor'](_0xa230c2,_0x24d9ca));});}return _0x300fac;}function _classCallCheck(_0x5f05be,_0x503b11){var _0x2ea0a2=_0x2c63;if(!(_0x5f05be instanceof _0x503b11))throw new TypeError(_0x2ea0a2(0x89));}function _defineProperties(_0x273dcb,_0x47f333){var _0x137f63=_0x2c63;for(var _0xeb72f7=0x0;_0xeb72f7<_0x47f333['length'];_0xeb72f7++){var _0x45de91=_0x47f333[_0xeb72f7];_0x45de91['enumerable']=_0x45de91['enumerable']||![],_0x45de91['configurable']=!![];if('value'in _0x45de91)_0x45de91[_0x137f63(0xbd)]=!![];Object[_0x137f63(0x7d)](_0x273dcb,_0x45de91['key'],_0x45de91);}}function _createClass(_0x55a7f5,_0x963c36,_0x44d152){var _0x4b3c27=_0x2c63;if(_0x963c36)_defineProperties(_0x55a7f5[_0x4b3c27(0xa4)],_0x963c36);if(_0x44d152)_defineProperties(_0x55a7f5,_0x44d152);return Object['defineProperty'](_0x55a7f5,_0x4b3c27(0xa4),{'writable':![]}),_0x55a7f5;}function _defineProperty(_0x493929,_0x187237,_0x1682bd){var _0x5af274=_0x2c63;return _0x187237 in _0x493929?Object[_0x5af274(0x7d)](_0x493929,_0x187237,{'value':_0x1682bd,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x493929[_0x187237]=_0x1682bd,_0x493929;}function _inherits(_0xb27634,_0x52aa51){var _0x3aebff={_0x3a4e25:0x7d},_0x4a4523=_0x2c63;if(typeof _0x52aa51!=='function'&&_0x52aa51!==null)throw new TypeError('Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function');_0xb27634['prototype']=Object['create'](_0x52aa51&&_0x52aa51['prototype'],{'constructor':{'value':_0xb27634,'writable':!![],'configurable':!![]}}),Object[_0x4a4523(_0x3aebff._0x3a4e25)](_0xb27634,'prototype',{'writable':![]});if(_0x52aa51)_setPrototypeOf(_0xb27634,_0x52aa51);}function _0x3ee7(){var _0x468fcc=['_last_mBounds','width:','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','positions','8687448ZGOETf','radius','data','forEach','999uhyFuV','getOwnPropertyDescriptor','_getArcHeatCanvas','lng','Rectangle','arc','layer','diffHeight','196455AqyBEN','14656976sWntEO','gradientArc','floor','EllipsoidSurfaceAppearance','_rectangle','blur','red','register','clientHeight','arcBlurScale','rgb(0,0,0)','setPrototypeOf','ymax','getImageData','length','defineProperty','BaseLayer','__esModule','construct','4928erpPUX','body','container','RenderState','ctx','_scale','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','GraphicLayer','Cannot\x20call\x20a\x20class\x20as\x20a\x20function','PointTrans','heatStyle','StencilOperation','lonlat2mercator','_graphic2','_graphic','uniforms','getPointData','mercator2lonlat','image/png','minCanvasSize','default','_layer','xmax','type','options','_mBoundsMax','bumpMap','1367584OmYRHh','Util','max','__proto__','RectanglePrimitive','ymin','concat','constructor','prototype','fromDegrees','6255125gxtNGa','_heat','rectangle','DomUtil','style','image','addGraphic','Color','object','round','granularity','Cartesian2','KEEP','undefined','_positions','removeGraphic','toArray','canvas','configure','maxCanvasSize','xmin','_map','4611948SCTjVb','writable','call','Material','min','valueOf','merge'];_0x3ee7=function(){return _0x468fcc;};return _0x3ee7();}function _getPrototypeOf(_0x213a6d){var _0x3ecc1a={_0xb39b71:0x9f};return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf']:function _0x5c5bfe(_0xcb0ca9){var _0x5d3fda=_0x2c63;return _0xcb0ca9[_0x5d3fda(_0x3ecc1a._0xb39b71)]||Object['getPrototypeOf'](_0xcb0ca9);},_getPrototypeOf(_0x213a6d);}function _setPrototypeOf(_0x4612f8,_0x26ea5c){var _0x828df6={_0x2d3bb9:0x79},_0x3700f2={_0x59d9a2:0x9f},_0x5119f3=_0x2c63;return _setPrototypeOf=Object[_0x5119f3(_0x828df6._0x2d3bb9)]||function _0x13274a(_0xdf37ea,_0x1e0b4d){var _0x2f169c=_0x5119f3;return _0xdf37ea[_0x2f169c(_0x3700f2._0x59d9a2)]=_0x1e0b4d,_0xdf37ea;},_setPrototypeOf(_0x4612f8,_0x26ea5c);}function _isNativeReflectConstruct(){var _0x2505f8={_0x1dedf2:0xb3,_0x11764b:0x80,_0x344485:0xc1,_0x51ab95:0x80},_0xd844fa=_0x2c63;if(typeof Reflect===_0xd844fa(_0x2505f8._0x1dedf2)||!Reflect['construct'])return![];if(Reflect[_0xd844fa(_0x2505f8._0x11764b)]['sham'])return![];if(typeof Proxy==='function')return!![];try{return Boolean['prototype'][_0xd844fa(_0x2505f8._0x344485)][_0xd844fa(0xbe)](Reflect[_0xd844fa(_0x2505f8._0x51ab95)](Boolean,[],function(){})),!![];}catch(_0xae4239){return![];}}function _assertThisInitialized(_0x263b53){if(_0x263b53===void 0x0)throw new ReferenceError('this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called');return _0x263b53;}function _possibleConstructorReturn(_0x375718,_0x25bd87){var _0x1bc9e9={_0x920e10:0xae},_0x3bd049=_0x2c63;if(_0x25bd87&&(typeof _0x25bd87===_0x3bd049(_0x1bc9e9._0x920e10)||typeof _0x25bd87==='function'))return _0x25bd87;else{if(_0x25bd87!==void 0x0)throw new TypeError('Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined');}return _assertThisInitialized(_0x375718);}function _createSuper(_0x2835dd){var _0x2fe1d3={_0x7d9743:0xa3},_0x29cbc7=_isNativeReflectConstruct();return function _0x1e72ea(){var _0x2cae1d=_0x2c63,_0x40dbcd=_getPrototypeOf(_0x2835dd),_0xe0d037;if(_0x29cbc7){var _0x29e20a=_getPrototypeOf(this)[_0x2cae1d(_0x2fe1d3._0x7d9743)];_0xe0d037=Reflect['construct'](_0x40dbcd,arguments,_0x29e20a);}else _0xe0d037=_0x40dbcd['apply'](this,arguments);return _possibleConstructorReturn(this,_0xe0d037);};}var HeatMaterial=_0x37e260(0x87);function _0x2c63(_0x59981d,_0x29f8e5){var _0x3ee752=_0x3ee7();return _0x2c63=function(_0x2c638d,_0xd9463f){_0x2c638d=_0x2c638d-0x67;var _0x5b3d3a=_0x3ee752[_0x2c638d];return _0x5b3d3a;},_0x2c63(_0x59981d,_0x29f8e5);}if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');var Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x37e260(0x6b)][_0x37e260(0x7e)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:_0x37e260(0x74)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']},HeatLayer=function(_0x51b3ee){var _0x266dd5={_0x574403:0x86},_0x5ffc18={_0x20f66a:0xb8,_0x2ef2e0:0xaa,_0x32b78a:0x6f,_0x34243d:0x78,_0x33ad96:0x99},_0x35590f={_0x37356c:0x99,_0x2f599d:0xb9,_0x3548b4:0x94,_0x52682b:0xb9,_0x11ecd5:0x8b,_0x223648:0x72,_0x19a90d:0x69,_0x4cdd53:0xa5,_0x4dbe7f:0xba,_0x407ccb:0xa1,_0xac3b99:0x97,_0x247db4:0x83,_0x3f42e9:0x8b,_0x31ad51:0xa7},_0x4588ab={_0x1f4e3b:0xb2,_0x340098:0x8c,_0x2a46ac:0xaa,_0x209bd1:0x9e,_0x259719:0xbf,_0xcbac78:0xb1,_0x3a52c0:0x67,_0x5ab666:0xaa,_0x2c342f:0x8e,_0xfc18f6:0x72},_0x1e874b={_0x528b92:0x71},_0x19ea48={_0x331b1b:0xbb,_0xc2bd61:0xab,_0x5962eb:0xaa,_0x1b563d:0x6a,_0x42257a:0x9b,_0x195900:0x67,_0x340b49:0x8e},_0x3bfefe={_0x222244:0x96,_0x3b09d0:0xb5},_0x57f65c={_0x2bd5ca:0xb4,_0x5f3a2e:0xb4},_0x3a31e6={_0x270e07:0xa9,_0x585727:0xbb},_0x56fe75={_0x1df8f8:0xc6},_0x126ddd={_0x1637ae:0xc2},_0x5073f2={_0x3d2f71:0xaa},_0xfbc2fb={_0x38f9f6:0x8b},_0x3ea8df={_0xffaaca:0xb9,_0x3011aa:0x99,_0x389ef8:0x76},_0x35bfea=_0x37e260;_inherits(_0x1ecc5e,_0x51b3ee);var _0x5c2932=_createSuper(_0x1ecc5e);function _0x1ecc5e(){var _0x955bae=_0x2c63,_0x51423f,_0x51bd10,_0x38c8fc,_0x4a5738=arguments[_0x955bae(0x7c)]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x1ecc5e),_0x38c8fc=_0x5c2932['call'](this,_0x4a5738),_0x38c8fc['options'][_0x955bae(_0x3ea8df._0xffaaca)]=(_0x51423f=_0x38c8fc[_0x955bae(0x99)]['maxCanvasSize'])!==null&&_0x51423f!==void 0x0?_0x51423f:document['body']['clientWidth'],_0x38c8fc[_0x955bae(_0x3ea8df._0x3011aa)][_0x955bae(0xb9)]=Math['min'](_0x38c8fc[_0x955bae(0x99)]['maxCanvasSize'],0x1388),_0x38c8fc['options'][_0x955bae(0x94)]=(_0x51bd10=_0x38c8fc['options']['minCanvasSize'])!==null&&_0x51bd10!==void 0x0?_0x51bd10:document[_0x955bae(0x82)][_0x955bae(_0x3ea8df._0x389ef8)],_0x38c8fc[_0x955bae(0x99)]['minCanvasSize']=Math['max'](_0x38c8fc['options']['minCanvasSize'],0x2bc),_0x38c8fc[_0x955bae(_0x3ea8df._0x3011aa)]['heatStyle']=_objectSpread2(_objectSpread2({},DEF_HEATSTYLE),_0x38c8fc[_0x955bae(0x99)]['heatStyle']||{}),_0x38c8fc[_0x955bae(0x99)]['style']=_objectSpread2(_objectSpread2({},DEF_STYLE),_0x38c8fc[_0x955bae(0x99)]['style']||{}),_0x38c8fc;}return _createClass(_0x1ecc5e,[{'key':'layer','get':function _0x326e04(){return this['_layer'];}},{'key':'heatStyle','get':function _0x16fcb9(){return this['options']['heatStyle'];},'set':function _0x50911f(_0x3bf0f7){var _0x532052=_0x2c63;this['options']['heatStyle']=mars3d__namespace[_0x532052(0x9d)]['merge'](this['options'][_0x532052(_0xfbc2fb._0x38f9f6)],_0x3bf0f7),this[_0x532052(0xa7)]&&(this[_0x532052(0xa7)]['configure'](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}},{'key':'style','get':function _0x15e425(){var _0x15cb22=_0x2c63;return this['options'][_0x15cb22(_0x5073f2._0x3d2f71)];},'set':function _0x3e356b(_0x4cc7e3){var _0x4b85f5=_0x2c63;this[_0x4b85f5(0x99)]['style']=mars3d__namespace['Util'][_0x4b85f5(_0x126ddd._0x1637ae)](this['options']['style'],_0x4cc7e3);}},{'key':'positions','get':function _0xfa997d(){return this['_positions'];},'set':function _0x27b180(_0x287326){this['setPositions'](_0x287326);}},{'key':'coordinates','get':function _0x2851cc(){var _0x16a0e8={_0x9b16fd:0xb6},_0x1ca36c=_0x2c63,_0x3a620e=[];return this['points'][_0x1ca36c(0xca)](function(_0x1c20c0){var _0x10c3ec=_0x1ca36c;_0x3a620e['push'](_0x1c20c0[_0x10c3ec(_0x16a0e8._0x9b16fd)]());}),_0x3a620e;}},{'key':'rectangle','get':function _0x103b80(){return this['_rectangle'];}},{'key':'_setOptionsHook','value':function _0x18c1b4(_0x11379a,_0x16e75f){var _0xf54944=_0x2c63;_0x11379a[_0xf54944(_0x56fe75._0x1df8f8)]&&(this['positions']=_0x11379a[_0xf54944(_0x56fe75._0x1df8f8)]);}},{'key':'_mountedHook','value':function _0x59ca5c(){var _0xc13465=_0x2c63;this['style']['type']==='image'?this['_layer']=new mars3d__namespace[(_0xc13465(0x6b))]['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this[_0xc13465(0x96)]=new mars3d__namespace['layer'][(_0xc13465(0x88))]({'private':!![]});}},{'key':'_addedHook','value':function _0x3c9dee(){this['_map']['addLayer'](this['_layer']),this['options']['positions']&&(this['positions']=this['options']['positions']),this['options']['flyTo']&&this['flyToByAnimationEnd']();}},{'key':'_removedHook','value':function _0x3cc648(){var _0x5c6169=_0x2c63;this[_0x5c6169(0x8b)]['container']&&(mars3d__namespace[_0x5c6169(_0x3a31e6._0x270e07)]['remove'](this['heatStyle']['container']),delete this['heatStyle'][_0x5c6169(0x83)]),this['clear'](),this[_0x5c6169(_0x3a31e6._0x585727)]['removeLayer'](this['_layer']);}},{'key':'addPosition','value':function _0x4866fd(_0x5cf126,_0x58035f){var _0x3120ba=_0x2c63;this[_0x3120ba(_0x57f65c._0x2bd5ca)]=this[_0x3120ba(_0x57f65c._0x5f3a2e)]||[],this['_positions']['push'](_0x5cf126),this['_updatePositionsHook'](_0x58035f);}},{'key':'setPositions','value':function _0x3b5502(_0x5b0b36,_0x2ec7ca){var _0x53632a=_0x2c63;this[_0x53632a(0xb4)]=_0x5b0b36,this['_updatePositionsHook'](_0x2ec7ca);}},{'key':'clear','value':function _0x2aa3a4(){var _0x1aafcb=_0x2c63;this['_graphic']&&(this[_0x1aafcb(_0x3bfefe._0x222244)][_0x1aafcb(_0x3bfefe._0x3b09d0)](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}},{'key':'_updatePositionsHook','value':function _0xd9017f(_0x5ef3fe){var _0x50b9a4=_0x2c63;if(!this['show']||!this[_0x50b9a4(_0x19ea48._0x331b1b)]||!this['positions']||this[_0x50b9a4(0xc6)][_0x50b9a4(0x7c)]===0x0)return this;var _0x36a874=this['_getHeatCanvas']();if(this['style'][_0x50b9a4(0x98)]===_0x50b9a4(_0x19ea48._0xc2bd61))this['_layer']['setOptions']({'url':_0x36a874['toDataURL'](_0x50b9a4(0x93)),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this[_0x50b9a4(_0x19ea48._0x5962eb)][_0x50b9a4(_0x19ea48._0x1b563d)]?this['_graphic']&&_0x5ef3fe?(this['_graphic']['uniforms']['image']=_0x36a874,this[_0x50b9a4(0x8f)]['uniforms'][_0x50b9a4(_0x19ea48._0x42257a)]=this[_0x50b9a4(_0x19ea48._0x195900)](),this['_graphic2']&&(this[_0x50b9a4(_0x19ea48._0x340b49)]['uniforms']['image']=_0x36a874,this['_graphic2'][_0x50b9a4(0x90)]['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x36a874):this['_graphic']&&_0x5ef3fe?this['_graphic']['uniforms']['image']=_0x36a874:this['_createGraphic'](_0x36a874);return this;}},{'key':'_createGraphic','value':function _0x206c37(_0x5e7f2f){var _0x2ae1eb=_0x2c63;this['clear'](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive'](_objectSpread2(_objectSpread2({},this[_0x2ae1eb(0x99)]),{},{'rectangle':this[_0x2ae1eb(0x72)],'appearance':new Cesium[(_0x2ae1eb(_0x1e874b._0x528b92))]({'material':new Cesium[(_0x2ae1eb(0xbf))]({'fabric':{'uniforms':{'image':_0x5e7f2f},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})})),this['_layer'][_0x2ae1eb(0xac)](this['_graphic']);}},{'key':'_createArcGraphic','value':function _0x1dd4ef(_0x45f356){var _0x1f5588=_0x2c63,_0xf5fdc2;this['clear']();var _0x27fe7e=Cesium[_0x1f5588(0x84)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x1f5588(_0x4588ab._0x1f4e3b)],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x1f5588(_0x4588ab._0x340098)]['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x44da69=Math[_0x1f5588(0x70)]((_0xf5fdc2=this['style']['diffHeight'])!==null&&_0xf5fdc2!==void 0x0?_0xf5fdc2:this[_0x1f5588(0x9a)]*0.02)+0.1;this[_0x1f5588(0xaa)][_0x1f5588(0x6c)]&&delete this['style']['diffHeight'];var _0x4f67c7=(this[_0x1f5588(_0x4588ab._0x2a46ac)]['splitNum'],0x64),_0x3cdd72=Math[_0x1f5588(_0x4588ab._0x209bd1)](this['_rectangle']['height'],this['_rectangle']['width']);this['style'][_0x1f5588(0xb0)]=_0x3cdd72/=_0x4f67c7;var _0x5dc8ee=new Cesium[(_0x1f5588(_0x4588ab._0x259719))]({'fabric':{'uniforms':{'image':_0x45f356,'repeat':new Cesium[(_0x1f5588(_0x4588ab._0xcbac78))](0x1,0x1),'color':new Cesium[(_0x1f5588(0xad))](0x1,0x1,0x1,0x0),'bumpMap':this[_0x1f5588(_0x4588ab._0x3a52c0)]()},'source':HeatMaterial},'translucent':!![]}),_0x21ead5=this[_0x1f5588(_0x4588ab._0x5ab666)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive'](_objectSpread2(_objectSpread2({},this[_0x1f5588(0x99)]),{},{'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x27fe7e,'material':_0x5dc8ee,'vertexShaderSource':getVertexShaderSource(_0x44da69*_0x21ead5)})})),this['_layer']['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this[_0x1f5588(_0x4588ab._0x2c342f)]=new mars3d__namespace['graphic'][(_0x1f5588(0xa0))](_objectSpread2(_objectSpread2({},this['options']),{},{'rectangle':this[_0x1f5588(_0x4588ab._0xfc18f6)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x27fe7e,'material':_0x5dc8ee,'vertexShaderSource':getVertexShaderSource(-_0x44da69)})})),this['_layer']['addGraphic'](this['_graphic2']));}},{'key':'getRectangle','value':function _0x821de4(_0x15b532){return _0x15b532!==null&&_0x15b532!==void 0x0&&_0x15b532['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}},{'key':'_getHeatCanvas','value':function _0x1d77c9(){var _0x163a04={_0x4bf913:0x8d,_0x354f44:0x7a,_0x3eac49:0xc0},_0x3f4e82={_0x3079aa:0xc0,_0x116332:0x68},_0x50906b=_0x2c63,_0x29c3c9=this,_0xb18006,_0x134043,_0x361d9b,_0xaf6dcf,_0x4820bf=this['_positions'],_0x103443=[],_0x488e47,_0x4ecc60,_0x4c6d52,_0x32af31;_0x4820bf['forEach'](function(_0x1a3318){var _0x361b7f=_0x2c63,_0xbbc8=mars3d__namespace['LngLatPoint']['parse'](_0x1a3318);if(!_0xbbc8)return;_0xbbc8['value']=_0x1a3318['value']||0x1,!_0x29c3c9['options'][_0x361b7f(0xa8)]&&(_0x488e47===undefined?(_0x488e47=_0xbbc8['lng'],_0x4ecc60=_0xbbc8['lng'],_0x4c6d52=_0xbbc8['lat'],_0x32af31=_0xbbc8['lat']):(_0x488e47=Math[_0x361b7f(_0x3f4e82._0x3079aa)](_0x488e47,_0xbbc8[_0x361b7f(_0x3f4e82._0x116332)]),_0x4ecc60=Math['max'](_0x4ecc60,_0xbbc8[_0x361b7f(_0x3f4e82._0x116332)]),_0x4c6d52=Math['min'](_0x4c6d52,_0xbbc8['lat']),_0x32af31=Math[_0x361b7f(0x9e)](_0x32af31,_0xbbc8['lat']))),_0x103443['push'](_0xbbc8);});var _0x56286a=this[_0x50906b(_0x35590f._0x37356c)]['rectangle']||{'xmin':_0x488e47,'xmax':_0x4ecc60,'ymin':_0x4c6d52,'ymax':_0x32af31},_0x1af49b=getMercatorBounds(_0x56286a),_0x664f04=Math['abs'](_0x1af49b['xmax']-_0x1af49b['xmin']),_0x2e80aa=Math['abs'](_0x1af49b['ymax']-_0x1af49b['ymin']),_0xbcdd91=Math[_0x50906b(0x9e)](_0x664f04,_0x2e80aa),_0x359149=Math[_0x50906b(0xc0)](_0x664f04,_0x2e80aa);this['_mBoundsMax']=_0xbcdd91;var _0x667f99=0x1;if(_0xbcdd91>this['options'][_0x50906b(_0x35590f._0x2f599d)])_0x667f99=_0xbcdd91/this[_0x50906b(0x99)]['maxCanvasSize'],_0x359149/_0x667f99<this['options'][_0x50906b(0x94)]&&(_0x667f99=_0x359149/this['options']['minCanvasSize']);else _0x359149<this['options']['minCanvasSize']&&(_0x667f99=_0x359149/this['options'][_0x50906b(_0x35590f._0x3548b4)],_0xbcdd91/_0x667f99>this['options']['maxCanvasSize']&&(_0x667f99=_0xbcdd91/this[_0x50906b(0x99)][_0x50906b(_0x35590f._0x52682b)]));var _0x3bee87=this[_0x50906b(_0x35590f._0x11ecd5)][_0x50906b(0xc8)]*1.5,_0x231a8b=_0x664f04/_0x667f99+_0x3bee87*0x2,_0x5775d7=_0x2e80aa/_0x667f99+_0x3bee87*0x2,_0x16f216=_0x3bee87*_0x667f99;_0x1af49b['xmin']-=_0x16f216,_0x1af49b['ymin']-=_0x16f216,_0x1af49b['xmax']+=_0x16f216,_0x1af49b['ymax']+=_0x16f216,this['_scale']=_0x667f99,_0x56286a=geLatLngBounds(_0x1af49b),this[_0x50906b(_0x35590f._0x223648)]=Cesium[_0x50906b(_0x35590f._0x19a90d)][_0x50906b(_0x35590f._0x4cdd53)](_0x56286a['xmin'],_0x56286a[_0x50906b(0xa1)],_0x56286a['xmax'],_0x56286a['ymax']);var _0x1d611b=(_0xb18006=_0x103443[0x0]['value'])!==null&&_0xb18006!==void 0x0?_0xb18006:0x1,_0x4ae9e3=(_0x134043=_0x103443[0x0]['value'])!==null&&_0x134043!==void 0x0?_0x134043:0x0,_0xb831b5=[];_0x103443[_0x50906b(0xca)](function(_0x350f50){var _0x46e01e=_0x50906b,_0x2e2fb5=mars3d__namespace['PointTrans'][_0x46e01e(_0x163a04._0x4bf913)]([_0x350f50['lng'],_0x350f50['lat']]),_0x4ddbc4=_0x350f50['value']||0x1,_0x1f8aa4=Math[_0x46e01e(0xaf)]((_0x2e2fb5[0x0]-_0x1af49b['xmin'])/_0x667f99),_0x14e77a=Math['round']((_0x1af49b[_0x46e01e(_0x163a04._0x354f44)]-_0x2e2fb5[0x1])/_0x667f99);_0x1d611b=Math['max'](_0x1d611b,_0x4ddbc4),_0x4ae9e3=Math[_0x46e01e(_0x163a04._0x3eac49)](_0x4ae9e3,_0x4ddbc4),_0xb831b5['push']({'x':_0x1f8aa4,'y':_0x14e77a,'value':_0x4ddbc4});});var _0x4cc122={'min':(_0x361d9b=this['options']['min'])!==null&&_0x361d9b!==void 0x0?_0x361d9b:_0x4ae9e3,'max':(_0xaf6dcf=this['options']['max'])!==null&&_0xaf6dcf!==void 0x0?_0xaf6dcf:_0x1d611b,'data':_0xb831b5};this['_last_heatData']=_0x4cc122;(!this['_last_mBounds']||_0x1af49b['xmin']!==this[_0x50906b(0xc3)][_0x50906b(_0x35590f._0x4dbe7f)]||_0x1af49b[_0x50906b(_0x35590f._0x407ccb)]!==this[_0x50906b(0xc3)]['ymin']||_0x1af49b['xmax']!==this['_last_mBounds'][_0x50906b(_0x35590f._0xac3b99)]||_0x1af49b[_0x50906b(0x7a)]!==this['_last_mBounds']['ymax'])&&(this['_last_mBounds']=_0x1af49b,!this['heatStyle']['container']&&(this['heatStyle']['container']=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container'])),this['heatStyle'][_0x50906b(_0x35590f._0x247db4)]['style']['cssText']=_0x50906b(0xc4)['concat'](_0x231a8b,'px;height:')[_0x50906b(0xa2)](_0x5775d7,'px;'),!this['_heat']?this['_heat']=h337__namespace['create'](this[_0x50906b(_0x35590f._0x3f42e9)]):this[_0x50906b(_0x35590f._0x31ad51)][_0x50906b(0xb8)](this['heatStyle']));this['_heat']['setData'](_0x4cc122);var _0x12f684=mars3d__namespace[_0x50906b(0xa9)]['copyCanvas'](this['_heat']['_renderer'][_0x50906b(0xb7)]);return _0x12f684;}},{'key':'_getArcHeatCanvas','value':function _0x35c475(){var _0xa4a2b1=_0x2c63;this['_heat'][_0xa4a2b1(_0x5ffc18._0x20f66a)]({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle'][_0xa4a2b1(0x73)]*this[_0xa4a2b1(_0x5ffc18._0x2ef2e0)][_0xa4a2b1(0x77)],'gradient':this['heatStyle'][_0xa4a2b1(_0x5ffc18._0x32b78a)]||{0.25:_0xa4a2b1(_0x5ffc18._0x34243d),0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});var _0x368063=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this[_0xa4a2b1(_0x5ffc18._0x33ad96)]['heatStyle']),_0x368063;}},{'key':_0x35bfea(0x91),'value':function _0x3df4de(_0xd72385){var _0x59fd4c=_0x35bfea,_0x22a1ed=mars3d__namespace['LngLatPoint']['parse'](_0xd72385);if(!_0x22a1ed)return{};var _0x43d039=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x22a1ed['lng'],_0x22a1ed['lat']]),_0x173682=this['_last_mBounds'],_0xa7a97c=Math['round']((_0x43d039[0x0]-_0x173682['xmin'])/this['_scale']),_0x3a09a9=Math['round']((_0x173682['ymax']-_0x43d039[0x1])/this[_0x59fd4c(_0x266dd5._0x574403)]),_0x1220c3=this[_0x59fd4c(0xa7)]['getValueAt']({'x':_0xa7a97c,'y':_0x3a09a9}),_0x1fbb66=this['_heat']['_renderer'][_0x59fd4c(0x85)][_0x59fd4c(0x7b)](_0xa7a97c-0x1,_0x3a09a9-0x1,0x1,0x1)[_0x59fd4c(0xc9)];return{'x':_0xa7a97c,'y':_0x3a09a9,'value':_0x1220c3,'color':'rgba('+_0x1fbb66[0x0]+','+_0x1fbb66[0x1]+','+_0x1fbb66[0x2]+','+_0x1fbb66[0x3]+')'};}}]),_0x1ecc5e;}(BaseLayer);mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['LayerUtil'][_0x37e260(0x75)]('heat',HeatLayer);function getMercatorBounds(_0x23080e){var _0xb6eb5b=_0x37e260,_0x53bdb7=mars3d__namespace[_0xb6eb5b(0x8a)]['lonlat2mercator']([_0x23080e['xmin'],_0x23080e['ymin']]),_0x3f8738=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x23080e['xmax'],_0x23080e['ymax']]);return{'xmin':_0x53bdb7[0x0],'ymin':_0x53bdb7[0x1],'xmax':_0x3f8738[0x0],'ymax':_0x3f8738[0x1]};}function geLatLngBounds(_0x53cadc){var _0x138c9e={_0x4405cb:0x8a,_0x1266c7:0xba,_0x51bcaa:0x7a},_0x5101f9=_0x37e260,_0x364e4e=mars3d__namespace[_0x5101f9(_0x138c9e._0x4405cb)]['mercator2lonlat']([_0x53cadc[_0x5101f9(_0x138c9e._0x1266c7)],_0x53cadc['ymin']]),_0x1f4f00=mars3d__namespace['PointTrans'][_0x5101f9(0x92)]([_0x53cadc['xmax'],_0x53cadc[_0x5101f9(_0x138c9e._0x51bcaa)]]);return{'xmin':_0x364e4e[0x0],'ymin':_0x364e4e[0x1],'xmax':_0x1f4f00[0x0],'ymax':_0x1f4f00[0x1]};}function getVertexShaderSource(_0x4ed391){var _0x71c719=_0x37e260;return _0x71c719(0xc5)['concat'](_0x4ed391,';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a');}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x37e260(0x7f),{'value':!![]});
}));
