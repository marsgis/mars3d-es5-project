/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.5.6
 * 编译日期：2023-05-08 17:38:04
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x5e2b17=_0x322d;(function(_0x39e72c,_0x3eb2c6){var _0x582807=_0x322d,_0x3a2a5d=_0x39e72c();while(!![]){try{var _0x23cb58=parseInt(_0x582807(0x1be))/0x1+parseInt(_0x582807(0x242))/0x2*(parseInt(_0x582807(0x1de))/0x3)+parseInt(_0x582807(0x1e6))/0x4+-parseInt(_0x582807(0x188))/0x5+parseInt(_0x582807(0x160))/0x6+parseInt(_0x582807(0x202))/0x7+-parseInt(_0x582807(0x23a))/0x8;if(_0x23cb58===_0x3eb2c6)break;else _0x3a2a5d['push'](_0x3a2a5d['shift']());}catch(_0x468587){_0x3a2a5d['push'](_0x3a2a5d['shift']());}}}(_0x5644,0xcc109));function _interopNamespace(_0x907b8c){var _0x1e00c1=_0x322d;if(_0x907b8c&&_0x907b8c['__esModule'])return _0x907b8c;var _0x5cfc81=Object['create'](null);return _0x907b8c&&Object['keys'](_0x907b8c)['forEach'](function(_0x324f10){var _0x664919=_0x322d;if(_0x324f10!==_0x664919(0x16c)){var _0x4846d9=Object['getOwnPropertyDescriptor'](_0x907b8c,_0x324f10);Object['defineProperty'](_0x5cfc81,_0x324f10,_0x4846d9[_0x664919(0x18c)]?_0x4846d9:{'enumerable':!![],'get':function(){return _0x907b8c[_0x324f10];}});}}),_0x5cfc81[_0x1e00c1(0x16c)]=_0x907b8c,_0x5cfc81;}var mars3d__namespace=_interopNamespace(mars3d),Cesium$7=mars3d__namespace[_0x5e2b17(0x1f5)];function getU(_0x547f93,_0x28ca6c){var _0x539209=_0x5e2b17,_0x18a1c9=_0x547f93*Math['cos'](Cesium$7[_0x539209(0x232)][_0x539209(0x235)](_0x28ca6c));return _0x18a1c9;}function getV(_0x449f6b,_0x163f44){var _0x34cc3f=_0x5e2b17,_0x41a7ed=_0x449f6b*Math['sin'](Cesium$7['Math'][_0x34cc3f(0x235)](_0x163f44));return _0x41a7ed;}function getSpeed(_0x39cbd,_0x335f15){var _0x59dedc=_0x5e2b17,_0x674a44=Math[_0x59dedc(0x234)](Math['pow'](_0x39cbd,0x2)+Math['pow'](_0x335f15,0x2));return _0x674a44;}function getDirection(_0x521da9,_0x3ad6e5){var _0x400d=_0x5e2b17,_0x5c0882=Cesium$7['Math'][_0x400d(0x152)](Math['atan2'](_0x3ad6e5,_0x521da9));return _0x5c0882+=_0x5c0882<0x0?0x168:0x0,_0x5c0882;}var WindUtil={'__proto__':null,'getU':getU,'getV':getV,'getSpeed':getSpeed,'getDirection':getDirection};function ownKeys(_0x32f96b,_0x20f5e7){var _0x46f279=_0x5e2b17,_0x278a8c=Object['keys'](_0x32f96b);if(Object['getOwnPropertySymbols']){var _0x190c05=Object['getOwnPropertySymbols'](_0x32f96b);_0x20f5e7&&(_0x190c05=_0x190c05[_0x46f279(0x238)](function(_0x4a47be){return Object['getOwnPropertyDescriptor'](_0x32f96b,_0x4a47be)['enumerable'];})),_0x278a8c[_0x46f279(0x1d3)]['apply'](_0x278a8c,_0x190c05);}return _0x278a8c;}function _objectSpread2(_0xb7a69){var _0x3c595d=_0x5e2b17;for(var _0x8ed615=0x1;_0x8ed615<arguments[_0x3c595d(0x18d)];_0x8ed615++){var _0x43dceb=null!=arguments[_0x8ed615]?arguments[_0x8ed615]:{};_0x8ed615%0x2?ownKeys(Object(_0x43dceb),!0x0)[_0x3c595d(0x23d)](function(_0x3440f3){_defineProperty(_0xb7a69,_0x3440f3,_0x43dceb[_0x3440f3]);}):Object['getOwnPropertyDescriptors']?Object['defineProperties'](_0xb7a69,Object['getOwnPropertyDescriptors'](_0x43dceb)):ownKeys(Object(_0x43dceb))['forEach'](function(_0x1c726f){Object['defineProperty'](_0xb7a69,_0x1c726f,Object['getOwnPropertyDescriptor'](_0x43dceb,_0x1c726f));});}return _0xb7a69;}function _classCallCheck(_0x3c3c5f,_0xaaf745){if(!(_0x3c3c5f instanceof _0xaaf745))throw new TypeError('Cannot\x20call\x20a\x20class\x20as\x20a\x20function');}function _defineProperties(_0x4b9363,_0x4ddc97){for(var _0x5b8f26=0x0;_0x5b8f26<_0x4ddc97['length'];_0x5b8f26++){var _0x10678d=_0x4ddc97[_0x5b8f26];_0x10678d['enumerable']=_0x10678d['enumerable']||![],_0x10678d['configurable']=!![];if('value'in _0x10678d)_0x10678d['writable']=!![];Object['defineProperty'](_0x4b9363,_0x10678d['key'],_0x10678d);}}function _createClass(_0x3af036,_0x45154f,_0x2f3e79){var _0x48a064=_0x5e2b17;if(_0x45154f)_defineProperties(_0x3af036[_0x48a064(0x22f)],_0x45154f);if(_0x2f3e79)_defineProperties(_0x3af036,_0x2f3e79);return Object['defineProperty'](_0x3af036,'prototype',{'writable':![]}),_0x3af036;}function _defineProperty(_0x535bd2,_0x67cea3,_0x1e583e){var _0x5ede7b=_0x5e2b17;return _0x67cea3 in _0x535bd2?Object[_0x5ede7b(0x17f)](_0x535bd2,_0x67cea3,{'value':_0x1e583e,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x535bd2[_0x67cea3]=_0x1e583e,_0x535bd2;}function _inherits(_0x3a1fd5,_0x313761){var _0x165d22=_0x5e2b17;if(typeof _0x313761!==_0x165d22(0x1f2)&&_0x313761!==null)throw new TypeError('Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function');_0x3a1fd5['prototype']=Object[_0x165d22(0x223)](_0x313761&&_0x313761['prototype'],{'constructor':{'value':_0x3a1fd5,'writable':!![],'configurable':!![]}}),Object[_0x165d22(0x17f)](_0x3a1fd5,'prototype',{'writable':![]});if(_0x313761)_setPrototypeOf(_0x3a1fd5,_0x313761);}function _getPrototypeOf(_0x3087f2){return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf']:function _0x2d6bd0(_0x1180db){var _0x34f07b=_0x322d;return _0x1180db['__proto__']||Object[_0x34f07b(0x219)](_0x1180db);},_getPrototypeOf(_0x3087f2);}function _setPrototypeOf(_0x426615,_0x313981){return _setPrototypeOf=Object['setPrototypeOf']||function _0x3df520(_0x162be2,_0xe28d80){var _0x156d29=_0x322d;return _0x162be2[_0x156d29(0x19d)]=_0xe28d80,_0x162be2;},_setPrototypeOf(_0x426615,_0x313981);}function _isNativeReflectConstruct(){var _0x417621=_0x5e2b17;if(typeof Reflect==='undefined'||!Reflect['construct'])return![];if(Reflect['construct']['sham'])return![];if(typeof Proxy===_0x417621(0x1f2))return!![];try{return Boolean['prototype'][_0x417621(0x1bc)][_0x417621(0x198)](Reflect['construct'](Boolean,[],function(){})),!![];}catch(_0x32913e){return![];}}function _assertThisInitialized(_0x378d55){if(_0x378d55===void 0x0)throw new ReferenceError('this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called');return _0x378d55;}function _possibleConstructorReturn(_0x253b55,_0x394dd2){if(_0x394dd2&&(typeof _0x394dd2==='object'||typeof _0x394dd2==='function'))return _0x394dd2;else{if(_0x394dd2!==void 0x0)throw new TypeError('Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined');}return _assertThisInitialized(_0x253b55);}function _createSuper(_0x5b0024){var _0x5b7dce=_isNativeReflectConstruct();return function _0x15c625(){var _0x3f9ece=_0x322d,_0xb8b456=_getPrototypeOf(_0x5b0024),_0x2f7563;if(_0x5b7dce){var _0x5d458d=_getPrototypeOf(this)[_0x3f9ece(0x19b)];_0x2f7563=Reflect[_0x3f9ece(0x1c1)](_0xb8b456,arguments,_0x5d458d);}else _0x2f7563=_0xb8b456['apply'](this,arguments);return _possibleConstructorReturn(this,_0x2f7563);};}function _0x5644(){var _0x46d4b0=['constructor','currentParticlesSpeed','__proto__','xmax','none','apply','ceil','clearFramebuffers','particlesRendering','fragmentShaderSource','currentTrails','ShaderProgram','maxParticles','speedFactor','postProcessingPosition','FLOAT','_updateIng2','updateViewerParameters','Object','tlat','createComputingPrimitives','tlng','Cartesian2','primitives','addPrimitives','hidden','grid','commandToExecute','vmin','dropRateBump','UNSIGNED_INT','auto','GeometryAttributes','valueOf','mouseDown','485309GJKxHG','ShaderSource','createTexture','construct','textures','_pointerEvents','globalCompositeOperation','createCommand','context','Compute','unbindEvent','RenderState','particlesNumber','mouseUp','maxAge','speedRate','redraw','uniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20\x20\x20float\x20term1\x20=\x20111132.92;\x0a\x20\x20\x20\x20float\x20term2\x20=\x20559.82\x20*\x20cos(2.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term3\x20=\x201.175\x20*\x20cos(4.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term4\x20=\x200.0023\x20*\x20cos(6.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20\x20\x20float\x20term5\x20=\x20111412.84\x20*\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20term6\x20=\x2093.5\x20*\x20cos(3.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term7\x20=\x200.118\x20*\x20cos(5.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avoid\x20updatePosition(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20windVectorInLonLatLev;\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20speed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20updatePosition(lonLatLev,\x20speed);\x0a}\x0a','off','randomizeParticles','xmin','push','udata','lat','Matrix4','postProcessingSpeed','createRenderingTextures','canvas','PixelDatatype','container','west','north','4155594HPyLRe','max','ymax','geometry','Map','options','_onMapWhellEvent','mod','4184180ifZxcr','mouse_move','updateSpeed','top','PrimitiveCollection','LINEAR','drawingBufferHeight','createParticlesTextures','attributeLocations','windData','_onMouseMoveEvent','update','function','moveTo','rows','Cesium','lev','abs','test','data','register','randomBetween','min','DomUtil','getParticles','ellipsoid','preExecute','CanvasWindField','9925321bYeXjJ','segmentsColor','drawingBufferWidth','uniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0auniform\x20float\x20dropRate;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0auniform\x20float\x20dropRateBump;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0,\x201.0);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0);\x0a\x20\x20\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20lev);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20\x20\x20return\x20particle.y\x20<\x20-90.0\x20||\x20particle.y\x20>\x2090.0;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20nextSpeed.a;\x0a\x0a\x20\x20\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20\x20\x20if\x20(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(randomParticle,\x201.0);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a\x20\x20\x20\x20}\x0a}\x0a','setDate','mouseHidden','SceneTransforms','pointerEvents','preRender','camera','TextureMagnificationFilter','STATIC_DRAW','particlesWind','clearCommand','color','lon','fill','rawRenderState','pixelSize','_onMouseUpEvent','commandList','arrayBufferView','ymin','getPrototypeOf','currentTrailsDepth','Sampler','canvasWidth','canvasHeight','canvasContext','particlesTextureSize','cols','EllipsoidalOccluder','getUVByXY','create','uniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20randomParticle\x20=\x20texture(postProcessingPosition,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20vec4\x20particleSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x0a\x20\x20\x20\x20if\x20(randomParticle.a\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20particleSpeed;\x0a\x20\x20\x20\x20}\x0a}\x0a','windTextures','_calc_speedRate','vdata','_map','createRenderingPrimitives','currentParticlesPosition','visible','dimensions','shaderProgram','animateFrame','prototype','frameTime','width','Math','commandType','sqrt','toRadians','uniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0auniform\x20sampler2D\x20particlesWind;\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20speedFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec3\x20percent\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20\x20\x20float\x20normalization\x20=\x20length(percent);\x0a\x0a\x20\x20\x20\x20return\x20normalization;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20//\x20vec3\x20currentSpeed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20texture(particlesWind,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20vec4(speedFactor\x20*\x20pixelSize\x20*\x20windVector,\x20calculateWindNorm(windVector));\x0a\x20\x20\x20\x20out_FragColor\x20=\x20nextSpeed;\x0a}\x0a','resize','filter','viewerParameters','23067088yprJpK','_canrefresh','absolute','forEach','framebuffers','colors','fromGeometry','PrimitiveType','2egdXBh','segments','_speedRate','remove','style','setGeometry','clientWidth','BufferUsage','once','getUVByPoint','EventType','vertexArray','LayerUtil','particles','wheel','lonRange','beginPath','NEAREST','Geometry','Framebuffer','PixelFormat','fixedHeight','SceneMode','mouse_down','nextTrails','toDegrees','_calcUV','WindLayer','lng','fromCssColorString','_data','Draw','_bilinearInterpolation','setOptions','windField','Cartesian3','screen','canvasWind','clientHeight','4703328vSbNAe','getPixelSize','slice','particleSystem','_mountedHook','height','vertexShaderSource','_drawLines','wind','getWind','_onMouseDownEvent','refreshTimer','default','BaseLayer','show','getRandomLatLng','_updateIng','keys','getColorTexture','clear','outputTexture','segmentsDepth','particlesTextures','DEPTH_COMPONENT','_randomParticle','TextureMinificationFilter','mars3d-canvasWind','layer','postMessage','ComponentDatatype','refreshParticles','defineProperty','defined','lighter','_setOptionsHook','scene','TWO_PI','SCENE3D','source','isPointVisible','6995540hiFyDe','add','lineWidth','destroy','get','length','particlesComputing','globeBoundingSphere','depthMask','visibility','trails','createWindTextures','array','age','reverseY','pointer-events','call','DepthFunction','framebuffer'];_0x5644=function(){return _0x46d4b0;};return _0x5644();}function _toConsumableArray(_0x41f58b){return _arrayWithoutHoles(_0x41f58b)||_iterableToArray(_0x41f58b)||_unsupportedIterableToArray(_0x41f58b)||_nonIterableSpread();}function _arrayWithoutHoles(_0x1869b0){if(Array['isArray'](_0x1869b0))return _arrayLikeToArray(_0x1869b0);}function _iterableToArray(_0x4dbe10){if(typeof Symbol!=='undefined'&&_0x4dbe10[Symbol['iterator']]!=null||_0x4dbe10['@@iterator']!=null)return Array['from'](_0x4dbe10);}function _unsupportedIterableToArray(_0x273614,_0xc44e83){var _0x12935e=_0x5e2b17;if(!_0x273614)return;if(typeof _0x273614==='string')return _arrayLikeToArray(_0x273614,_0xc44e83);var _0x2cd5e1=Object['prototype']['toString']['call'](_0x273614)[_0x12935e(0x162)](0x8,-0x1);if(_0x2cd5e1===_0x12935e(0x1ad)&&_0x273614[_0x12935e(0x19b)])_0x2cd5e1=_0x273614['constructor']['name'];if(_0x2cd5e1===_0x12935e(0x1e2)||_0x2cd5e1==='Set')return Array['from'](_0x273614);if(_0x2cd5e1==='Arguments'||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/[_0x12935e(0x1f8)](_0x2cd5e1))return _arrayLikeToArray(_0x273614,_0xc44e83);}function _arrayLikeToArray(_0x2ad33a,_0x417d3e){if(_0x417d3e==null||_0x417d3e>_0x2ad33a['length'])_0x417d3e=_0x2ad33a['length'];for(var _0x152c90=0x0,_0x2861a6=new Array(_0x417d3e);_0x152c90<_0x417d3e;_0x152c90++)_0x2861a6[_0x152c90]=_0x2ad33a[_0x152c90];return _0x2861a6;}function _nonIterableSpread(){throw new TypeError('Invalid\x20attempt\x20to\x20spread\x20non-iterable\x20instance.\x0aIn\x20order\x20to\x20be\x20iterable,\x20non-array\x20objects\x20must\x20have\x20a\x20[Symbol.iterator]()\x20method.');}var Cesium$6=mars3d__namespace[_0x5e2b17(0x1f5)],CustomPrimitive=(function(){var _0x236f8f=_0x5e2b17;function _0x2fc943(_0x2d46d9){var _0x268408=_0x322d,_0x18bedb;_classCallCheck(this,_0x2fc943),this['commandType']=_0x2d46d9[_0x268408(0x233)],this[_0x268408(0x1e1)]=_0x2d46d9[_0x268408(0x1e1)],this['attributeLocations']=_0x2d46d9['attributeLocations'],this['primitiveType']=_0x2d46d9['primitiveType'],this['uniformMap']=_0x2d46d9['uniformMap'],this['vertexShaderSource']=_0x2d46d9['vertexShaderSource'],this[_0x268408(0x1a4)]=_0x2d46d9['fragmentShaderSource'],this[_0x268408(0x213)]=_0x2d46d9['rawRenderState'],this[_0x268408(0x19a)]=_0x2d46d9['framebuffer'],this[_0x268408(0x174)]=_0x2d46d9['outputTexture'],this['autoClear']=(_0x18bedb=_0x2d46d9['autoClear'])!==null&&_0x18bedb!==void 0x0?_0x18bedb:![],this[_0x268408(0x200)]=_0x2d46d9['preExecute'],this[_0x268408(0x16e)]=!![],this[_0x268408(0x1b6)]=undefined,this['clearCommand']=undefined,this['autoClear']&&(this['clearCommand']=new Cesium$6['ClearCommand']({'color':new Cesium$6['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Cesium$6['Pass']['OPAQUE']}));}return _createClass(_0x2fc943,[{'key':_0x236f8f(0x1c5),'value':function _0x34f737(_0x5b1b5a){var _0x37fe52=_0x236f8f;switch(this['commandType']){case'Draw':{var _0x2bbb7c=Cesium$6['VertexArray']['fromGeometry']({'context':_0x5b1b5a,'geometry':this['geometry'],'attributeLocations':this[_0x37fe52(0x1ee)],'bufferUsage':Cesium$6['BufferUsage'][_0x37fe52(0x20d)]}),_0x45bbe6=Cesium$6[_0x37fe52(0x1a6)]['fromCache']({'context':_0x5b1b5a,'attributeLocations':this['attributeLocations'],'vertexShaderSource':this[_0x37fe52(0x166)],'fragmentShaderSource':this[_0x37fe52(0x1a4)]}),_0x5b62c6=Cesium$6[_0x37fe52(0x1c9)]['fromCache'](this['rawRenderState']);return new Cesium$6['DrawCommand']({'primitiveType':this['primitiveType'],'shaderProgram':_0x45bbe6,'vertexArray':_0x2bbb7c,'modelMatrix':Cesium$6[_0x37fe52(0x1d6)]['IDENTITY'],'renderState':_0x5b62c6,'uniformMap':this['uniformMap'],'castShadows':![],'receiveShadows':![],'framebuffer':this['framebuffer'],'pass':Cesium$6['Pass']['OPAQUE'],'pickOnly':!![],'owner':this});}case'Compute':{return new Cesium$6['ComputeCommand']({'owner':this,'fragmentShaderSource':this['fragmentShaderSource'],'uniformMap':this['uniformMap'],'outputTexture':this['outputTexture'],'persists':!![]});}}}},{'key':_0x236f8f(0x247),'value':function _0x406271(_0x13b7a1,_0x89297b){var _0x2c922c=_0x236f8f;this['geometry']=_0x89297b;var _0x4d5a99=Cesium$6['VertexArray'][_0x2c922c(0x240)]({'context':_0x13b7a1,'geometry':this['geometry'],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6[_0x2c922c(0x140)][_0x2c922c(0x20d)]});this[_0x2c922c(0x1b6)]['vertexArray']=_0x4d5a99;}},{'key':_0x236f8f(0x1f1),'value':function _0x38d30b(_0x557fa1){var _0x5b532e=_0x236f8f;if(!this[_0x5b532e(0x16e)])return;if(_0x557fa1['mode']!==Cesium$6[_0x5b532e(0x14f)][_0x5b532e(0x185)])return;!Cesium$6['defined'](this['commandToExecute'])&&(this[_0x5b532e(0x1b6)]=this['createCommand'](_0x557fa1['context'])),Cesium$6['defined'](this['preExecute'])&&this[_0x5b532e(0x200)](),Cesium$6['defined'](this['clearCommand'])&&_0x557fa1[_0x5b532e(0x216)]['push'](this[_0x5b532e(0x20f)]),_0x557fa1['commandList']['push'](this[_0x5b532e(0x1b6)]);}},{'key':'isDestroyed','value':function _0x5ce645(){return![];}},{'key':_0x236f8f(0x18b),'value':function _0x1f5d7a(){var _0x55f72c=_0x236f8f;if(this['clearCommand']){var _0x1f548a,_0x30a088;(_0x1f548a=this['clearCommand'])!==null&&_0x1f548a!==void 0x0&&_0x1f548a[_0x55f72c(0x144)]&&this['clearCommand']['vertexArray']['destroy'](),(_0x30a088=this[_0x55f72c(0x20f)])!==null&&_0x30a088!==void 0x0&&_0x30a088['shaderProgram']&&this[_0x55f72c(0x20f)][_0x55f72c(0x22d)]['destroy'](),delete this[_0x55f72c(0x20f)];}return this[_0x55f72c(0x1b6)]&&(this['commandToExecute']['vertexArray']&&this[_0x55f72c(0x1b6)]['vertexArray'][_0x55f72c(0x18b)](),this['commandToExecute'][_0x55f72c(0x22d)]&&this['commandToExecute']['shaderProgram']['destroy'](),delete this[_0x55f72c(0x1b6)]),Cesium$6['destroyObject'](this);}}]),_0x2fc943;}()),Cesium$5=mars3d__namespace[_0x5e2b17(0x1f5)],Util=(function(){var _0x21902c=function _0x1962c7(){var _0x3507ff=_0x322d,_0x39d967=new Cesium$5[(_0x3507ff(0x14b))]({'attributes':new Cesium$5['GeometryAttributes']({'position':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5[_0x3507ff(0x17d)]['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype'][_0x3507ff(0x1aa)],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});return _0x39d967;},_0x9ddd15=function _0x253aa1(_0x45ae4e,_0x5e522b){var _0x2b830e=_0x322d;if(Cesium$5[_0x2b830e(0x180)](_0x5e522b)){var _0x416cfc={};_0x416cfc[_0x2b830e(0x217)]=_0x5e522b,_0x45ae4e[_0x2b830e(0x186)]=_0x416cfc;}var _0x328a43=new Cesium$5['Texture'](_0x45ae4e);return _0x328a43;},_0x31f294=function _0x53edf3(_0x157a81,_0x90aeb0,_0x27c2fc){var _0x4d0b7b=_0x322d,_0x31f806=new Cesium$5[(_0x4d0b7b(0x14c))]({'context':_0x157a81,'colorTextures':[_0x90aeb0],'depthTexture':_0x27c2fc});return _0x31f806;},_0x482d21=function _0x58b163(_0x2d35e0){var _0x6fb9bf=_0x322d,_0x33eecd=!![],_0x59ed2d=![],_0x9c432f={'viewport':_0x2d35e0['viewport'],'depthTest':_0x2d35e0['depthTest'],'depthMask':_0x2d35e0[_0x6fb9bf(0x190)],'blending':_0x2d35e0['blending']},_0x2376b0=Cesium$5['Appearance']['getDefaultRenderState'](_0x33eecd,_0x59ed2d,_0x9c432f);return _0x2376b0;},_0x2f5c00=function _0x3f8444(_0xe81dc9){var _0x52dd0b=_0x322d,_0x4e4347={},_0x2c5dc4=Cesium$5['Math'][_0x52dd0b(0x1e5)](_0xe81dc9[_0x52dd0b(0x1dc)],Cesium$5[_0x52dd0b(0x232)][_0x52dd0b(0x184)]),_0x2d8a87=Cesium$5[_0x52dd0b(0x232)]['mod'](_0xe81dc9['east'],Cesium$5['Math']['TWO_PI']),_0x2a7c39=_0xe81dc9['width'],_0x1402f9,_0x4f5e29;_0x2a7c39>Cesium$5['Math']['THREE_PI_OVER_TWO']?(_0x1402f9=0x0,_0x4f5e29=Cesium$5[_0x52dd0b(0x232)]['TWO_PI']):_0x2d8a87-_0x2c5dc4<_0x2a7c39?(_0x1402f9=_0x2c5dc4,_0x4f5e29=_0x2c5dc4+_0x2a7c39):(_0x1402f9=_0x2c5dc4,_0x4f5e29=_0x2d8a87);_0x4e4347['lon']={'min':Cesium$5['Math']['toDegrees'](_0x1402f9),'max':Cesium$5['Math'][_0x52dd0b(0x152)](_0x4f5e29)};var _0x3fba03=_0xe81dc9['south'],_0x503bc8=_0xe81dc9[_0x52dd0b(0x1dd)],_0x1610ba=_0xe81dc9['height'],_0x9603f=_0x1610ba>Cesium$5['Math']['PI']/0xc?_0x1610ba/0x2:0x0,_0x2361c3=Cesium$5['Math']['clampToLatitudeRange'](_0x3fba03-_0x9603f),_0x40e57=Cesium$5[_0x52dd0b(0x232)]['clampToLatitudeRange'](_0x503bc8+_0x9603f);return _0x2361c3<-Cesium$5[_0x52dd0b(0x232)]['PI_OVER_THREE']&&(_0x2361c3=-Cesium$5['Math']['PI_OVER_TWO']),_0x40e57>Cesium$5['Math']['PI_OVER_THREE']&&(_0x40e57=Cesium$5['Math']['PI_OVER_TWO']),_0x4e4347['lat']={'min':Cesium$5['Math'][_0x52dd0b(0x152)](_0x2361c3),'max':Cesium$5['Math']['toDegrees'](_0x40e57)},_0x4e4347;};return{'getFullscreenQuad':_0x21902c,'createTexture':_0x9ddd15,'createFramebuffer':_0x31f294,'createRawRenderState':_0x482d21,'viewRectangleToLonLatRange':_0x2f5c00};}()),segmentDraw_vert='in\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20normal\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20postProcessingSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0aout\x20float\x20speedNormalization;\x0a\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20\x20\x20float\x20a\x20=\x206378137.0;\x20//\x20Semi-major\x20axis\x0a\x20\x20\x20\x20float\x20b\x20=\x206356752.3142;\x20//\x20Semi-minor\x20axis\x0a\x20\x20\x20\x20float\x20e2\x20=\x206.69437999014e-3;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x0a\x20\x20\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calcProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0,\x20360.0)\x20-\x20180.0;\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0);\x0a\x20\x20\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calcOffset(vec4\x20currentProjectedCoordinate,\x20vec4\x20nextProjectedCoordinate,\x20float\x20offsetSign)\x20{\x0a\x20\x20\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0);\x0a\x20\x20\x20\x20vec2\x20currentXY\x20=\x20(currentProjectedCoordinate.xy\x20/\x20currentProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x20\x20\x20\x20vec2\x20nextXY\x20=\x20(nextProjectedCoordinate.xy\x20/\x20nextProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0;\x0a\x20\x20\x20\x20vec2\x20direction\x20=\x20normalize(nextXY\x20-\x20currentXY);\x0a\x20\x20\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0,\x200.0);\x0a\x20\x20\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20\x20\x20vec4\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex);\x0a\x0a\x20\x20\x20\x20vec4\x20currentProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20vec4\x20nextProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(nextPosition.w\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(nextPosition.xyz);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20float\x20pointToUse\x20=\x20normal.x;\x20//\x20-1\x20is\x20currentProjectedCoordinate\x20and\x20+1\x20is\x20nextProjectedCoordinate\x0a\x20\x20\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20pixelSize\x20*\x20calcOffset(currentProjectedCoordinate,\x20nextProjectedCoordinate,\x20offsetSign);\x0a\x20\x20\x20\x20if\x20(pointToUse\x20<\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20currentProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20nextProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20speedNormalization\x20=\x20texture(postProcessingSpeed,\x20particleIndex).a;\x0a}\x0a',segmentDraw_frag='uniform\x20sampler2D\x20colorTable;\x0a\x0ain\x20float\x20speedNormalization;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x200.0));\x0a}\x0a',fullscreen_vert='in\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(position,\x201.0);\x0a}\x0a',trailDraw_frag='uniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x0a\x20\x20\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0\x20*\x20trailsColor)\x20/\x20255.0;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20pointsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20trailsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a',screenDraw_frag='uniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20trailsColor;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x0a}\x0a',Cesium$4=mars3d__namespace['Cesium'],ParticlesRendering=(function(){function _0x230b1d(_0x16e665,_0x302426,_0x57856f,_0x53081a,_0x99e7b9){var _0x3be5ee=_0x322d;_classCallCheck(this,_0x230b1d),this[_0x3be5ee(0x1d8)](_0x16e665,_0x302426,_0x57856f['colors']),this['createRenderingFramebuffers'](_0x16e665),this[_0x3be5ee(0x229)](_0x16e665,_0x57856f,_0x53081a,_0x99e7b9);}return _createClass(_0x230b1d,[{'key':'createRenderingTextures','value':function _0x23f58d(_0x2d4723,_0x3dcaa2,_0x4c3f1b){var _0x4f49be=_0x322d,_0x24f9c1={'context':_0x2d4723,'width':_0x2d4723['drawingBufferWidth'],'height':_0x2d4723[_0x4f49be(0x1ec)],'pixelFormat':Cesium$4[_0x4f49be(0x14d)]['RGBA'],'pixelDatatype':Cesium$4['PixelDatatype']['UNSIGNED_BYTE']},_0x3bfd8f={'context':_0x2d4723,'width':_0x2d4723[_0x4f49be(0x204)],'height':_0x2d4723['drawingBufferHeight'],'pixelFormat':Cesium$4['PixelFormat'][_0x4f49be(0x177)],'pixelDatatype':Cesium$4[_0x4f49be(0x1da)][_0x4f49be(0x1b9)]},_0x4b2fe2=_0x4c3f1b['length'],_0x2afd68=new Float32Array(_0x4b2fe2*0x3);for(var _0x2a4cf9=0x0;_0x2a4cf9<_0x4b2fe2;_0x2a4cf9++){var _0x2db788=Cesium$4['Color'][_0x4f49be(0x156)](_0x4c3f1b[_0x2a4cf9]);_0x2afd68[0x3*_0x2a4cf9]=_0x2db788['red'],_0x2afd68[0x3*_0x2a4cf9+0x1]=_0x2db788['green'],_0x2afd68[0x3*_0x2a4cf9+0x2]=_0x2db788['blue'];}var _0x855823={'context':_0x2d4723,'width':_0x4b2fe2,'height':0x1,'pixelFormat':Cesium$4['PixelFormat']['RGB'],'pixelDatatype':Cesium$4['PixelDatatype']['FLOAT'],'sampler':new Cesium$4[(_0x4f49be(0x21b))]({'minificationFilter':Cesium$4['TextureMinificationFilter'][_0x4f49be(0x1eb)],'magnificationFilter':Cesium$4['TextureMagnificationFilter']['LINEAR']})};this[_0x4f49be(0x1c2)]={'segmentsColor':Util['createTexture'](_0x24f9c1),'segmentsDepth':Util[_0x4f49be(0x1c0)](_0x3bfd8f),'currentTrailsColor':Util['createTexture'](_0x24f9c1),'currentTrailsDepth':Util['createTexture'](_0x3bfd8f),'nextTrailsColor':Util[_0x4f49be(0x1c0)](_0x24f9c1),'nextTrailsDepth':Util['createTexture'](_0x3bfd8f),'colorTable':Util[_0x4f49be(0x1c0)](_0x855823,_0x2afd68)};}},{'key':'createRenderingFramebuffers','value':function _0x3c1156(_0x5487b9){var _0x3a1602=_0x322d;this['framebuffers']={'segments':Util['createFramebuffer'](_0x5487b9,this['textures'][_0x3a1602(0x203)],this['textures'][_0x3a1602(0x175)]),'currentTrails':Util['createFramebuffer'](_0x5487b9,this['textures']['currentTrailsColor'],this[_0x3a1602(0x1c2)][_0x3a1602(0x21a)]),'nextTrails':Util['createFramebuffer'](_0x5487b9,this['textures']['nextTrailsColor'],this['textures']['nextTrailsDepth'])};}},{'key':'createSegmentsGeometry','value':function _0x9ba55(_0x4cf399){var _0x22a4a6=_0x322d,_0x4854fb=0x4,_0x4aab8a=[];for(var _0x202186=0x0;_0x202186<_0x4cf399['particlesTextureSize'];_0x202186++){for(var _0x1d96c6=0x0;_0x1d96c6<_0x4cf399[_0x22a4a6(0x21f)];_0x1d96c6++){for(var _0x528423=0x0;_0x528423<_0x4854fb;_0x528423++){_0x4aab8a['push'](_0x202186/_0x4cf399['particlesTextureSize']),_0x4aab8a['push'](_0x1d96c6/_0x4cf399[_0x22a4a6(0x21f)]);}}}_0x4aab8a=new Float32Array(_0x4aab8a);var _0x12763f=[],_0x7c5440=[-0x1,0x1],_0x3e58ac=[-0x1,0x1];for(var _0xb04b76=0x0;_0xb04b76<_0x4cf399['maxParticles'];_0xb04b76++){for(var _0x1fca90=0x0;_0x1fca90<_0x4854fb/0x2;_0x1fca90++){for(var _0x5d44e0=0x0;_0x5d44e0<_0x4854fb/0x2;_0x5d44e0++){_0x12763f['push'](_0x7c5440[_0x1fca90]),_0x12763f['push'](_0x3e58ac[_0x5d44e0]),_0x12763f['push'](0x0);}}}_0x12763f=new Float32Array(_0x12763f);var _0x5015e3=0x6*_0x4cf399['maxParticles'],_0x4d05bc=new Uint32Array(_0x5015e3);for(var _0x116c6c=0x0,_0x31271b=0x0,_0x4b2c3c=0x0;_0x116c6c<_0x4cf399['maxParticles'];_0x116c6c++){_0x4d05bc[_0x31271b++]=_0x4b2c3c+0x0,_0x4d05bc[_0x31271b++]=_0x4b2c3c+0x1,_0x4d05bc[_0x31271b++]=_0x4b2c3c+0x2,_0x4d05bc[_0x31271b++]=_0x4b2c3c+0x2,_0x4d05bc[_0x31271b++]=_0x4b2c3c+0x1,_0x4d05bc[_0x31271b++]=_0x4b2c3c+0x3,_0x4b2c3c+=0x4;}var _0x9c18d3=new Cesium$4['Geometry']({'attributes':new Cesium$4[(_0x22a4a6(0x1bb))]({'st':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':_0x4aab8a}),'normal':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype'][_0x22a4a6(0x1aa)],'componentsPerAttribute':0x3,'values':_0x12763f})}),'indices':_0x4d05bc});return _0x9c18d3;}},{'key':'createRenderingPrimitives','value':function _0x431a72(_0x216906,_0x13e8e6,_0x49337d,_0x5c6d35){var _0x2ad212=_0x322d,_0x1297a4=this;this['primitives']={'segments':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'st':0x0,'normal':0x1},'geometry':this['createSegmentsGeometry'](_0x13e8e6),'primitiveType':Cesium$4[_0x2ad212(0x241)]['TRIANGLES'],'uniformMap':{'currentParticlesPosition':function _0x175e78(){return _0x5c6d35['particlesTextures']['currentParticlesPosition'];},'postProcessingPosition':function _0x473844(){var _0x5797d7=_0x2ad212;return _0x5c6d35['particlesTextures'][_0x5797d7(0x1a9)];},'postProcessingSpeed':function _0x36bd12(){return _0x5c6d35['particlesTextures']['postProcessingSpeed'];},'colorTable':function _0x291eb4(){return _0x1297a4['textures']['colorTable'];},'aspect':function _0x71348f(){return _0x216906['drawingBufferWidth']/_0x216906['drawingBufferHeight'];},'pixelSize':function _0x539a72(){return _0x49337d['pixelSize'];},'lineWidth':function _0x522d58(){return _0x13e8e6['lineWidth'];},'particleHeight':function _0x181053(){return _0x13e8e6['particleHeight'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':!![]},'depthMask':!![]}),'framebuffer':this['framebuffers']['segments'],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4[_0x2ad212(0x241)]['TRIANGLES'],'uniformMap':{'segmentsColorTexture':function _0x4b60c4(){return _0x1297a4['textures']['segmentsColor'];},'segmentsDepthTexture':function _0x1e7595(){var _0x4c1010=_0x2ad212;return _0x1297a4['textures'][_0x4c1010(0x175)];},'currentTrailsColor':function _0x346978(){var _0xaab6ab=_0x2ad212;return _0x1297a4['framebuffers'][_0xaab6ab(0x1a5)]['getColorTexture'](0x0);},'trailsDepthTexture':function _0x3e850c(){var _0x36aeaf=_0x2ad212;return _0x1297a4['framebuffers'][_0x36aeaf(0x1a5)]['depthTexture'];},'fadeOpacity':function _0x1e0fb4(){return _0x13e8e6['fadeOpacity'];}},'vertexShaderSource':new Cesium$4[(_0x2ad212(0x1bf))]({'defines':['DISABLE_GL_POSITION_LOG_DEPTH'],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],'sources':[trailDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4[_0x2ad212(0x199)]['ALWAYS']},'depthMask':!![]}),'framebuffer':this['framebuffers'][_0x2ad212(0x151)],'autoClear':!![],'preExecute':function _0x3be7f3(){var _0x25d336=_0x2ad212,_0x212c91=_0x1297a4['framebuffers'][_0x25d336(0x1a5)];_0x1297a4['framebuffers'][_0x25d336(0x1a5)]=_0x1297a4['framebuffers'][_0x25d336(0x151)],_0x1297a4[_0x25d336(0x23e)]['nextTrails']=_0x212c91,_0x1297a4[_0x25d336(0x1b2)][_0x25d336(0x192)]['commandToExecute']['framebuffer']=_0x1297a4['framebuffers']['nextTrails'],_0x1297a4[_0x25d336(0x1b2)]['trails']['clearCommand']['framebuffer']=_0x1297a4[_0x25d336(0x23e)]['nextTrails'];}}),'screen':new CustomPrimitive({'commandType':_0x2ad212(0x158),'attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'trailsColorTexture':function _0x144001(){var _0x465739=_0x2ad212;return _0x1297a4['framebuffers']['nextTrails'][_0x465739(0x172)](0x0);},'trailsDepthTexture':function _0x2c6655(){var _0x2b7cbc=_0x2ad212;return _0x1297a4['framebuffers'][_0x2b7cbc(0x151)]['depthTexture'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_GL_POSITION_LOG_DEPTH'],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],'sources':[screenDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':![]},'depthMask':!![],'blending':{'enabled':!![]}}),'framebuffer':undefined})};}}]),_0x230b1d;}()),getWind_frag='//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x,\x20360.0);\x0a\x20\x20\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20-90.0,\x2090.0);\x0a\x0a\x20\x20\x20\x20vec3\x20index3D\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20index3D.z\x20=\x20(lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z;\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205],\x20width\x20=\x203,\x20height\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x203\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x202\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWind(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20\x20\x20float\x20result\x20=\x20texture(windTexture,\x20normalizedIndex2D).r;\x0a\x20\x20\x20\x20return\x20result;\x0a}\x0a\x0aconst\x20mat4\x20kernelMatrix\x20=\x20mat4(\x0a\x20\x20\x20\x200.0,\x20-1.0,\x202.0,\x20-1.0,\x20//\x20first\x20column\x0a\x20\x20\x20\x202.0,\x200.0,\x20-5.0,\x203.0,\x20//\x20second\x20column\x0a\x20\x20\x20\x200.0,\x201.0,\x204.0,\x20-3.0,\x20//\x20third\x20column\x0a\x20\x20\x20\x200.0,\x200.0,\x20-1.0,\x201.0\x20//\x20fourth\x20column\x0a);\x0afloat\x20oneDimensionInterpolation(float\x20t,\x20float\x20p0,\x20float\x20p1,\x20float\x20p2,\x20float\x20p3)\x20{\x0a\x20\x20\x20\x20vec4\x20tVec4\x20=\x20vec4(1.0,\x20t,\x20t\x20*\x20t,\x20t\x20*\x20t\x20*\x20t);\x0a\x20\x20\x20\x20tVec4\x20=\x20tVec4\x20/\x202.0;\x0a\x20\x20\x20\x20vec4\x20pVec4\x20=\x20vec4(p0,\x20p1,\x20p2,\x20p3);\x0a\x20\x20\x20\x20return\x20dot((tVec4\x20*\x20kernelMatrix),\x20pVec4);\x0a}\x0a\x0afloat\x20calculateB(sampler2D\x20windTexture,\x20float\x20t,\x20float\x20lon,\x20float\x20lat,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20float\x20lon0\x20=\x20floor(lon)\x20-\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon1\x20=\x20floor(lon);\x0a\x20\x20\x20\x20float\x20lon2\x20=\x20floor(lon)\x20+\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon3\x20=\x20floor(lon)\x20+\x202.0\x20*\x20interval.x;\x0a\x0a\x20\x20\x20\x20float\x20p0\x20=\x20getWind(windTexture,\x20vec3(lon0,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p1\x20=\x20getWind(windTexture,\x20vec3(lon1,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p2\x20=\x20getWind(windTexture,\x20vec3(lon2,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p3\x20=\x20getWind(windTexture,\x20vec3(lon3,\x20lat,\x20lev));\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(t,\x20p0,\x20p1,\x20p2,\x20p3);\x0a}\x0a\x0afloat\x20interpolateOneTexture(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20\x20\x20float\x20lat0\x20=\x20floor(lat)\x20-\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat1\x20=\x20floor(lat);\x0a\x20\x20\x20\x20float\x20lat2\x20=\x20floor(lat)\x20+\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat3\x20=\x20floor(lat)\x20+\x202.0\x20*\x20interval.y;\x0a\x0a\x20\x20\x20\x20vec2\x20coefficient\x20=\x20lonLatLev.xy\x20-\x20floor(lonLatLev.xy);\x0a\x20\x20\x20\x20float\x20b0\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat0,\x20lev);\x0a\x20\x20\x20\x20float\x20b1\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat1,\x20lev);\x0a\x20\x20\x20\x20float\x20b2\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat2,\x20lev);\x0a\x20\x20\x20\x20float\x20b3\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat3,\x20lev);\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(coefficient.y,\x20b0,\x20b1,\x20b2,\x20b3);\x0a}\x0a\x0avec3\x20bicubic(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bicubic_interpolation#Bicubic_convolution_algorithm\x0a\x20\x20\x20\x20float\x20u\x20=\x20interpolateOneTexture(U,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20v\x20=\x20interpolateOneTexture(V,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20bicubic(lonLatLev);\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(windVector,\x200.0);\x0a}\x0a',updateSpeed_frag=_0x5e2b17(0x236),updatePosition_frag=_0x5e2b17(0x1cf),postProcessingPosition_frag=_0x5e2b17(0x205),postProcessingSpeed_frag=_0x5e2b17(0x224),Cesium$3=mars3d__namespace[_0x5e2b17(0x1f5)],ParticlesComputing=(function(){var _0x3e6ec1=_0x5e2b17;function _0x20a4ca(_0x2e00be,_0x2c9962,_0x18fe3a,_0x5db01a){var _0x32bb61=_0x322d;_classCallCheck(this,_0x20a4ca),this['data']=_0x2c9962,this['createWindTextures'](_0x2e00be,_0x2c9962),this[_0x32bb61(0x1ed)](_0x2e00be,_0x18fe3a,_0x5db01a),this[_0x32bb61(0x1af)](_0x2c9962,_0x18fe3a,_0x5db01a);}return _createClass(_0x20a4ca,[{'key':_0x3e6ec1(0x193),'value':function _0x8ea5f6(_0x10295d,_0x21f982){var _0x4dc2d3=_0x3e6ec1,_0x35d528={'context':_0x10295d,'width':_0x21f982[_0x4dc2d3(0x22c)]['lon'],'height':_0x21f982[_0x4dc2d3(0x22c)][_0x4dc2d3(0x1d5)]*(_0x21f982['dimensions']['lev']||0x1),'pixelFormat':Cesium$3[_0x4dc2d3(0x14d)]['LUMINANCE'],'pixelDatatype':Cesium$3['PixelDatatype']['FLOAT'],'flipY':![],'sampler':new Cesium$3[(_0x4dc2d3(0x21b))]({'minificationFilter':Cesium$3[_0x4dc2d3(0x179)][_0x4dc2d3(0x14a)],'magnificationFilter':Cesium$3[_0x4dc2d3(0x20c)][_0x4dc2d3(0x14a)]})};this[_0x4dc2d3(0x225)]={'U':Util['createTexture'](_0x35d528,_0x21f982['U'][_0x4dc2d3(0x194)]),'V':Util['createTexture'](_0x35d528,_0x21f982['V']['array'])};}},{'key':_0x3e6ec1(0x1ed),'value':function _0x3fe3df(_0x3748c2,_0x16a5e2,_0x302c6c){var _0x58d4ed=_0x3e6ec1,_0x11cb4c={'context':_0x3748c2,'width':_0x16a5e2['particlesTextureSize'],'height':_0x16a5e2['particlesTextureSize'],'pixelFormat':Cesium$3[_0x58d4ed(0x14d)]['RGBA'],'pixelDatatype':Cesium$3['PixelDatatype']['FLOAT'],'flipY':![],'sampler':new Cesium$3[(_0x58d4ed(0x21b))]({'minificationFilter':Cesium$3[_0x58d4ed(0x179)][_0x58d4ed(0x14a)],'magnificationFilter':Cesium$3[_0x58d4ed(0x20c)]['NEAREST']})},_0x307358=this[_0x58d4ed(0x1d1)](_0x16a5e2['maxParticles'],_0x302c6c),_0x206741=new Float32Array(0x4*_0x16a5e2['maxParticles'])[_0x58d4ed(0x212)](0x0);this['particlesTextures']={'particlesWind':Util['createTexture'](_0x11cb4c),'currentParticlesPosition':Util[_0x58d4ed(0x1c0)](_0x11cb4c,_0x307358),'nextParticlesPosition':Util['createTexture'](_0x11cb4c,_0x307358),'currentParticlesSpeed':Util[_0x58d4ed(0x1c0)](_0x11cb4c,_0x206741),'nextParticlesSpeed':Util[_0x58d4ed(0x1c0)](_0x11cb4c,_0x206741),'postProcessingPosition':Util['createTexture'](_0x11cb4c,_0x307358),'postProcessingSpeed':Util['createTexture'](_0x11cb4c,_0x206741)};}},{'key':_0x3e6ec1(0x1d1),'value':function _0x2158f5(_0x434d6b,_0x22d5aa){var _0x1f199c=_0x3e6ec1,_0x543d52=new Float32Array(0x4*_0x434d6b);for(var _0x3afdaa=0x0;_0x3afdaa<_0x434d6b;_0x3afdaa++){_0x543d52[0x4*_0x3afdaa]=Cesium$3[_0x1f199c(0x232)]['randomBetween'](_0x22d5aa['lonRange']['x'],_0x22d5aa[_0x1f199c(0x148)]['y']),_0x543d52[0x4*_0x3afdaa+0x1]=Cesium$3['Math']['randomBetween'](_0x22d5aa['latRange']['x'],_0x22d5aa['latRange']['y']),_0x543d52[0x4*_0x3afdaa+0x2]=Cesium$3[_0x1f199c(0x232)][_0x1f199c(0x1fb)](this[_0x1f199c(0x1f9)]['lev'][_0x1f199c(0x1fc)],this['data']['lev'][_0x1f199c(0x1df)]),_0x543d52[0x4*_0x3afdaa+0x3]=0x0;}return _0x543d52;}},{'key':'destroyParticlesTextures','value':function _0x154bc4(){var _0x49bc69=_0x3e6ec1,_0x577150=this;Object[_0x49bc69(0x171)](this['particlesTextures'])['forEach'](function(_0x23064c){var _0x370dfd=_0x49bc69;_0x577150[_0x370dfd(0x176)][_0x23064c]['destroy']();});}},{'key':'createComputingPrimitives','value':function _0x220cde(_0x4d178f,_0x2bd272,_0x10e04c){var _0x2fdce4=_0x3e6ec1,_0x1ddea1=new Cesium$3['Cartesian3'](_0x4d178f[_0x2fdce4(0x22c)]['lon'],_0x4d178f['dimensions'][_0x2fdce4(0x1d5)],_0x4d178f['dimensions'][_0x2fdce4(0x1f6)]),_0x364702=new Cesium$3[(_0x2fdce4(0x15c))](_0x4d178f[_0x2fdce4(0x211)][_0x2fdce4(0x1fc)],_0x4d178f[_0x2fdce4(0x1d5)]['min'],_0x4d178f['lev']['min']),_0x246bf8=new Cesium$3['Cartesian3'](_0x4d178f['lon']['max'],_0x4d178f['lat']['max'],_0x4d178f[_0x2fdce4(0x1f6)]['max']),_0x241f9c=new Cesium$3[(_0x2fdce4(0x15c))]((_0x246bf8['x']-_0x364702['x'])/(_0x1ddea1['x']-0x1),(_0x246bf8['y']-_0x364702['y'])/(_0x1ddea1['y']-0x1),_0x1ddea1['z']>0x1?(_0x246bf8['z']-_0x364702['z'])/(_0x1ddea1['z']-0x1):0x1),_0x438b5e=new Cesium$3['Cartesian2'](_0x4d178f['U']['min'],_0x4d178f['U']['max']),_0x232a91=new Cesium$3[(_0x2fdce4(0x1b1))](_0x4d178f['V']['min'],_0x4d178f['V']['max']),_0x3fc94c=this;this[_0x2fdce4(0x1b2)]={'getWind':new CustomPrimitive({'commandType':'Compute','uniformMap':{'U':function _0x5d45e5(){var _0x56dea5=_0x2fdce4;return _0x3fc94c[_0x56dea5(0x225)]['U'];},'V':function _0x45e82d(){var _0x2e5622=_0x2fdce4;return _0x3fc94c[_0x2e5622(0x225)]['V'];},'currentParticlesPosition':function _0x1aba9b(){var _0x48afce=_0x2fdce4;return _0x3fc94c[_0x48afce(0x176)][_0x48afce(0x22a)];},'dimension':function _0x4c0084(){return _0x1ddea1;},'minimum':function _0x11248a(){return _0x364702;},'maximum':function _0x3e8a4b(){return _0x246bf8;},'interval':function _0x48215f(){return _0x241f9c;}},'fragmentShaderSource':new Cesium$3[(_0x2fdce4(0x1bf))]({'sources':[getWind_frag]}),'outputTexture':this['particlesTextures']['particlesWind'],'preExecute':function _0x2b3b0e(){var _0xdd7a50=_0x2fdce4;_0x3fc94c[_0xdd7a50(0x1b2)][_0xdd7a50(0x169)]['commandToExecute']['outputTexture']=_0x3fc94c['particlesTextures']['particlesWind'];}}),'updateSpeed':new CustomPrimitive({'commandType':_0x2fdce4(0x1c7),'uniformMap':{'currentParticlesSpeed':function _0x5aebab(){return _0x3fc94c['particlesTextures']['currentParticlesSpeed'];},'particlesWind':function _0x3061ee(){var _0x500299=_0x2fdce4;return _0x3fc94c['particlesTextures'][_0x500299(0x20e)];},'uSpeedRange':function _0x3c344f(){return _0x438b5e;},'vSpeedRange':function _0x2b7dd9(){return _0x232a91;},'pixelSize':function _0x60d364(){var _0x24e964=_0x2fdce4;return _0x10e04c[_0x24e964(0x214)];},'speedFactor':function _0x579c4d(){var _0x49bb09=_0x2fdce4;return _0x2bd272[_0x49bb09(0x1a8)];}},'fragmentShaderSource':new Cesium$3[(_0x2fdce4(0x1bf))]({'sources':[updateSpeed_frag]}),'outputTexture':this['particlesTextures']['nextParticlesSpeed'],'preExecute':function _0x23f257(){var _0x2de3c5=_0x2fdce4,_0x590e1d=_0x3fc94c['particlesTextures'][_0x2de3c5(0x19c)];_0x3fc94c['particlesTextures']['currentParticlesSpeed']=_0x3fc94c[_0x2de3c5(0x176)]['postProcessingSpeed'],_0x3fc94c[_0x2de3c5(0x176)]['postProcessingSpeed']=_0x590e1d,_0x3fc94c['primitives']['updateSpeed'][_0x2de3c5(0x1b6)]['outputTexture']=_0x3fc94c[_0x2de3c5(0x176)]['nextParticlesSpeed'];}}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':function _0x2470a1(){return _0x3fc94c['particlesTextures']['currentParticlesPosition'];},'currentParticlesSpeed':function _0xbabf53(){var _0x3e3fe8=_0x2fdce4;return _0x3fc94c['particlesTextures'][_0x3e3fe8(0x19c)];}},'fragmentShaderSource':new Cesium$3[(_0x2fdce4(0x1bf))]({'sources':[updatePosition_frag]}),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':function _0x2e7ee3(){var _0x427fa8=_0x2fdce4,_0x224877=_0x3fc94c[_0x427fa8(0x176)]['currentParticlesPosition'];_0x3fc94c['particlesTextures']['currentParticlesPosition']=_0x3fc94c[_0x427fa8(0x176)]['postProcessingPosition'],_0x3fc94c[_0x427fa8(0x176)][_0x427fa8(0x1a9)]=_0x224877,_0x3fc94c['primitives']['updatePosition']['commandToExecute']['outputTexture']=_0x3fc94c['particlesTextures']['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':_0x2fdce4(0x1c7),'uniformMap':{'nextParticlesPosition':function _0x4c1ad0(){return _0x3fc94c['particlesTextures']['nextParticlesPosition'];},'nextParticlesSpeed':function _0x4d4a83(){return _0x3fc94c['particlesTextures']['nextParticlesSpeed'];},'lonRange':function _0x1a95d0(){return _0x10e04c['lonRange'];},'latRange':function _0x172b3e(){return _0x10e04c['latRange'];},'randomCoefficient':function _0x263d2b(){var _0x241efb=Math['random']();return _0x241efb;},'dropRate':function _0x5aaee4(){return _0x2bd272['dropRate'];},'dropRateBump':function _0x51128f(){var _0x3f8bd2=_0x2fdce4;return _0x2bd272[_0x3f8bd2(0x1b8)];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[postProcessingPosition_frag]}),'outputTexture':this['particlesTextures']['postProcessingPosition'],'preExecute':function _0x595ec0(){var _0x564d77=_0x2fdce4;_0x3fc94c['primitives']['postProcessingPosition']['commandToExecute']['outputTexture']=_0x3fc94c[_0x564d77(0x176)][_0x564d77(0x1a9)];}}),'postProcessingSpeed':new CustomPrimitive({'commandType':_0x2fdce4(0x1c7),'uniformMap':{'postProcessingPosition':function _0xd53e56(){return _0x3fc94c['particlesTextures']['postProcessingPosition'];},'nextParticlesSpeed':function _0x51b8d5(){var _0x2f134a=_0x2fdce4;return _0x3fc94c[_0x2f134a(0x176)]['nextParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[postProcessingSpeed_frag]}),'outputTexture':this[_0x2fdce4(0x176)][_0x2fdce4(0x1d7)],'preExecute':function _0x19e220(){var _0xd0f7bf=_0x2fdce4;_0x3fc94c['primitives']['postProcessingSpeed']['commandToExecute']['outputTexture']=_0x3fc94c['particlesTextures'][_0xd0f7bf(0x1d7)];}})};}}]),_0x20a4ca;}()),Cesium$2=mars3d__namespace['Cesium'],ParticleSystem=(function(){var _0x3a1b11=_0x5e2b17;function _0x5d49cd(_0x11942c,_0x5c9bbe,_0x31de35,_0x1b0dc6){var _0x2ad51b=_0x322d;_classCallCheck(this,_0x5d49cd),this['context']=_0x11942c,_0x5c9bbe=_objectSpread2({},_0x5c9bbe);if(_0x5c9bbe[_0x2ad51b(0x1d4)]&&_0x5c9bbe['vdata']){var _0x1a5670,_0x5de23,_0x1ad681,_0x3ee29c,_0x15b0bd,_0x509c2e;_0x5c9bbe['dimensions']={},_0x5c9bbe['dimensions']['lon']=_0x5c9bbe['cols'],_0x5c9bbe['dimensions']['lat']=_0x5c9bbe['rows'],_0x5c9bbe['dimensions']['lev']=_0x5c9bbe[_0x2ad51b(0x1f6)]||0x1,_0x5c9bbe['lon']={},_0x5c9bbe['lon'][_0x2ad51b(0x1fc)]=_0x5c9bbe[_0x2ad51b(0x1d2)],_0x5c9bbe['lon']['max']=_0x5c9bbe['xmax'],_0x5c9bbe['lat']={},_0x5c9bbe['lat'][_0x2ad51b(0x1fc)]=_0x5c9bbe['ymin'],_0x5c9bbe['lat']['max']=_0x5c9bbe['ymax'],_0x5c9bbe['lev']={},_0x5c9bbe['lev']['min']=(_0x1a5670=_0x5c9bbe['levmin'])!==null&&_0x1a5670!==void 0x0?_0x1a5670:0x1,_0x5c9bbe['lev']['max']=(_0x5de23=_0x5c9bbe['levmax'])!==null&&_0x5de23!==void 0x0?_0x5de23:0x1,_0x5c9bbe['U']={},_0x5c9bbe['U']['array']=new Float32Array(_0x5c9bbe['udata']),_0x5c9bbe['U']['min']=(_0x1ad681=_0x5c9bbe['umin'])!==null&&_0x1ad681!==void 0x0?_0x1ad681:Math['min'][_0x2ad51b(0x1a0)](Math,_toConsumableArray(_0x5c9bbe['udata'])),_0x5c9bbe['U']['max']=(_0x3ee29c=_0x5c9bbe['umax'])!==null&&_0x3ee29c!==void 0x0?_0x3ee29c:Math['max']['apply'](Math,_toConsumableArray(_0x5c9bbe[_0x2ad51b(0x1d4)])),_0x5c9bbe['V']={},_0x5c9bbe['V'][_0x2ad51b(0x194)]=new Float32Array(_0x5c9bbe['vdata']),_0x5c9bbe['V'][_0x2ad51b(0x1fc)]=(_0x15b0bd=_0x5c9bbe[_0x2ad51b(0x1b7)])!==null&&_0x15b0bd!==void 0x0?_0x15b0bd:Math['min']['apply'](Math,_toConsumableArray(_0x5c9bbe['vdata'])),_0x5c9bbe['V']['max']=(_0x509c2e=_0x5c9bbe['vmax'])!==null&&_0x509c2e!==void 0x0?_0x509c2e:Math['max']['apply'](Math,_toConsumableArray(_0x5c9bbe[_0x2ad51b(0x227)]));}this['data']=_0x5c9bbe,this[_0x2ad51b(0x1e3)]=_0x31de35,this['viewerParameters']=_0x1b0dc6,this['particlesComputing']=new ParticlesComputing(this['context'],this['data'],this['options'],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this['context'],this['data'],this['options'],this['viewerParameters'],this['particlesComputing']);}return _createClass(_0x5d49cd,[{'key':'canvasResize','value':function _0x44c80a(_0x33a5c9){var _0x34e2a4=_0x322d,_0x3bdc45=this;this['particlesComputing']['destroyParticlesTextures'](),Object['keys'](this['particlesComputing']['windTextures'])['forEach'](function(_0x2dc0a4){_0x3bdc45['particlesComputing']['windTextures'][_0x2dc0a4]['destroy']();}),this[_0x34e2a4(0x1a3)]['textures']['colorTable']['destroy'](),Object['keys'](this[_0x34e2a4(0x1a3)][_0x34e2a4(0x23e)])['forEach'](function(_0x331f07){var _0x289df4=_0x34e2a4;_0x3bdc45['particlesRendering'][_0x289df4(0x23e)][_0x331f07][_0x289df4(0x18b)]();}),this['context']=_0x33a5c9,this[_0x34e2a4(0x18e)]=new ParticlesComputing(this['context'],this['data'],this[_0x34e2a4(0x1e3)],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this['context'],this['data'],this['options'],this[_0x34e2a4(0x239)],this['particlesComputing']);}},{'key':_0x3a1b11(0x1a2),'value':function _0x2bee05(){var _0x5cd292=_0x3a1b11,_0x2ece59=this,_0x18435e=new Cesium$2['ClearCommand']({'color':new Cesium$2['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2['Pass']['OPAQUE']});Object['keys'](this[_0x5cd292(0x1a3)][_0x5cd292(0x23e)])[_0x5cd292(0x23d)](function(_0x27b7c6){var _0x1e37f4=_0x5cd292;_0x18435e['framebuffer']=_0x2ece59[_0x1e37f4(0x1a3)]['framebuffers'][_0x27b7c6],_0x18435e['execute'](_0x2ece59['context']);});}},{'key':'refreshParticles','value':function _0x3ea96b(_0x1f6c63){var _0x8ecc68=_0x3a1b11;this['clearFramebuffers'](),this[_0x8ecc68(0x18e)]['destroyParticlesTextures'](),this['particlesComputing'][_0x8ecc68(0x1ed)](this['context'],this['options'],this['viewerParameters']);if(_0x1f6c63){var _0x33092d=this['particlesRendering']['createSegmentsGeometry'](this['options']);this['particlesRendering']['primitives'][_0x8ecc68(0x243)][_0x8ecc68(0x1e1)]=_0x33092d;var _0x2d9f28=Cesium$2['VertexArray'][_0x8ecc68(0x240)]({'context':this['context'],'geometry':_0x33092d,'attributeLocations':this['particlesRendering']['primitives']['segments'][_0x8ecc68(0x1ee)],'bufferUsage':Cesium$2['BufferUsage']['STATIC_DRAW']});this['particlesRendering']['primitives']['segments']['commandToExecute']['vertexArray']=_0x2d9f28;}}},{'key':'setOptions','value':function _0x13aea5(_0xcb8c7b){var _0x94ce25=_0x3a1b11,_0x3c06f6=this,_0x1c754a=![];this['options'][_0x94ce25(0x1a7)]!==_0xcb8c7b['maxParticles']&&(_0x1c754a=!![]),Object['keys'](_0xcb8c7b)['forEach'](function(_0x4ea919){var _0xc41ebb=_0x94ce25;_0x3c06f6[_0xc41ebb(0x1e3)][_0x4ea919]=_0xcb8c7b[_0x4ea919];}),this[_0x94ce25(0x17e)](_0x1c754a);}},{'key':'applyViewerParameters','value':function _0x26887e(_0x3360a0){var _0x294b1f=this;Object['keys'](_0x3360a0)['forEach'](function(_0x2c2c6f){var _0xea3c81=_0x322d;_0x294b1f[_0xea3c81(0x239)][_0x2c2c6f]=_0x3360a0[_0x2c2c6f];}),this['refreshParticles'](![]);}},{'key':'destroy','value':function _0x428518(){var _0x577600=_0x3a1b11,_0x144327=this;clearTimeout(this['canrefresh']),this[_0x577600(0x18e)]['destroyParticlesTextures'](),Object[_0x577600(0x171)](this[_0x577600(0x18e)]['windTextures'])['forEach'](function(_0x24e149){var _0xdb9eb9=_0x577600;_0x144327['particlesComputing']['windTextures'][_0x24e149][_0xdb9eb9(0x18b)]();}),this['particlesRendering'][_0x577600(0x1c2)]['colorTable'][_0x577600(0x18b)](),Object[_0x577600(0x171)](this['particlesRendering']['framebuffers'])['forEach'](function(_0x514cae){var _0xe1311e=_0x577600;_0x144327[_0xe1311e(0x1a3)]['framebuffers'][_0x514cae]['destroy']();});for(var _0x431c2b in this){delete this[_0x431c2b];}}}]),_0x5d49cd;}()),Cesium$1=mars3d__namespace['Cesium'],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],DEF_OPTIONS={'particlesNumber':0x1000,'fixedHeight':0x0,'fadeOpacity':0.996,'dropRate':0.003,'dropRateBump':0.01,'speedFactor':0.5,'lineWidth':0x2,'colors':['rgb(206,255,255)']},WindLayer=function(_0x2e7674){var _0x4729af=_0x5e2b17;_inherits(_0x48d55f,_0x2e7674);var _0x3f2d4a=_createSuper(_0x48d55f);function _0x48d55f(){var _0x2302c3=_0x322d,_0x57195f,_0x4c8796=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x48d55f),_0x4c8796=_objectSpread2(_objectSpread2({},DEF_OPTIONS),_0x4c8796),_0x57195f=_0x3f2d4a[_0x2302c3(0x198)](this,_0x4c8796),_0x57195f[_0x2302c3(0x182)](_0x4c8796),_0x57195f;}return _createClass(_0x48d55f,[{'key':_0x4729af(0x17b),'get':function _0x3f532d(){var _0xace0f4=_0x4729af;return this[_0xace0f4(0x1b2)];}},{'key':_0x4729af(0x1f9),'get':function _0x2b0890(){return this['_data'];},'set':function _0x4946f5(_0x46f374){this['setData'](_0x46f374);}},{'key':_0x4729af(0x23f),'get':function _0x4d3a52(){var _0xc87cae=_0x4729af;return this['options'][_0xc87cae(0x23f)];},'set':function _0x24f218(_0x3a21ee){var _0x334748=_0x4729af;this['options']['colors']=_0x3a21ee,this['particleSystem']&&this['particleSystem'][_0x334748(0x15a)]({'colors':_0x3a21ee}),this['resize']();}},{'key':_0x4729af(0x164),'value':function _0x4cfe8e(){}},{'key':'_addedHook','value':function _0x1590af(){var _0x46de38=_0x4729af;this[_0x46de38(0x183)]=this['_map']['scene'],this[_0x46de38(0x20b)]=this['_map']['camera'],this['primitives']=new Cesium$1[(_0x46de38(0x1ea))](),this[_0x46de38(0x228)]['scene'][_0x46de38(0x1b2)]['add'](this['primitives']),this['viewerParameters']={'lonRange':new Cesium$1[(_0x46de38(0x1b1))](),'latRange':new Cesium$1['Cartesian2'](),'pixelSize':0x0},this['globeBoundingSphere']=new Cesium$1['BoundingSphere'](Cesium$1['Cartesian3']['ZERO'],0.99*0x615299),this['updateViewerParameters'](),window['addEventListener']('resize',this['resize']['bind'](this),![]),this[_0x46de38(0x150)]=![],this[_0x46de38(0x1e7)]=![],this[_0x46de38(0x228)]['on'](mars3d__namespace['EventType'][_0x46de38(0x147)],this['_onMapWhellEvent'],this),this[_0x46de38(0x228)]['on'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this[_0x46de38(0x228)]['on'](mars3d__namespace['EventType']['mouseUp'],this[_0x46de38(0x215)],this),this[_0x46de38(0x228)]['on'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this),this['_data']&&this['setData'](this[_0x46de38(0x157)]);}},{'key':'_removedHook','value':function _0x570d5a(){var _0x46466e=_0x4729af;window['removeEventListener']('resize',this['resize']),this[_0x46466e(0x228)]['off'](mars3d__namespace['EventType']['preRender'],this['_onMap_preRenderEvent'],this),this['_map'][_0x46466e(0x1d0)](mars3d__namespace['EventType']['wheel'],this[_0x46466e(0x1e4)],this),this[_0x46466e(0x228)][_0x46466e(0x1d0)](mars3d__namespace['EventType'][_0x46466e(0x1bd)],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace[_0x46466e(0x143)][_0x46466e(0x1cb)],this['_onMouseUpEvent'],this),this['_map'][_0x46466e(0x1d0)](mars3d__namespace[_0x46466e(0x143)]['mouseMove'],this[_0x46466e(0x1f0)],this),this[_0x46466e(0x1b2)]['removeAll'](),this['_map']['scene']['primitives'][_0x46466e(0x245)](this[_0x46466e(0x1b2)]);}},{'key':'resize','value':function _0x4fb41f(){var _0x33691d=_0x4729af;if(!this[_0x33691d(0x16e)]||!this['particleSystem'])return;this[_0x33691d(0x1b2)]['show']=![],this[_0x33691d(0x1b2)]['removeAll'](),this['_map'][_0x33691d(0x141)](mars3d__namespace['EventType'][_0x33691d(0x20a)],this['_onMap_preRenderEvent'],this);}},{'key':'_onMap_preRenderEvent','value':function _0x4c195c(_0x1f610f){var _0x3775d5=_0x4729af;this['particleSystem']['canvasResize'](this[_0x3775d5(0x183)][_0x3775d5(0x1c6)]),this['addPrimitives'](),this['primitives'][_0x3775d5(0x16e)]=!![];}},{'key':'_onMapWhellEvent','value':function _0x547b57(_0x97b3da){var _0x25a74b=_0x4729af,_0x4df3f1=this;clearTimeout(this[_0x25a74b(0x16b)]);if(!this[_0x25a74b(0x16e)]||!this['particleSystem'])return;this['primitives'][_0x25a74b(0x16e)]=![],this[_0x25a74b(0x16b)]=setTimeout(function(){var _0x55e8db=_0x25a74b;if(!_0x4df3f1['show'])return;_0x4df3f1[_0x55e8db(0x1ce)]();},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x37abc2(_0x393e4e){this['mouse_down']=!![];}},{'key':'_onMouseMoveEvent','value':function _0x35331b(_0x340c9e){var _0x490321=_0x4729af;if(!this['show']||!this['particleSystem'])return;this['mouse_down']&&(this[_0x490321(0x1b2)]['show']=![],this['mouse_move']=!![]);}},{'key':'_onMouseUpEvent','value':function _0x1387bb(_0xc06120){var _0x3a24fd=_0x4729af;if(!this['show']||!this[_0x3a24fd(0x163)])return;this['mouse_down']&&this['mouse_move']&&this['redraw'](),this[_0x3a24fd(0x1b2)][_0x3a24fd(0x16e)]=!![],this['mouse_down']=![],this[_0x3a24fd(0x1e7)]=![];}},{'key':_0x4729af(0x1ce),'value':function _0x268e27(){var _0x2bd9a=_0x4729af;if(!this['_map']||!this['show'])return;this[_0x2bd9a(0x1ac)](),this['particleSystem']['applyViewerParameters'](this['viewerParameters']),this['primitives'][_0x2bd9a(0x16e)]=!![];}},{'key':'setData','value':function _0x16459b(_0x292fd7){var _0x2e759d=_0x4729af;this['_data']=_0x292fd7,this[_0x2e759d(0x163)]&&this[_0x2e759d(0x163)][_0x2e759d(0x18b)](),this['particleSystem']=new ParticleSystem(this['scene']['context'],_0x292fd7,this['getOptions'](),this['viewerParameters']),this[_0x2e759d(0x1b3)]();}},{'key':'_setOptionsHook','value':function _0x315b8c(_0x48a85a,_0x22a2b7){if(_0x48a85a)for(var _0x4e0786 in _0x48a85a){this[_0x4e0786]=_0x48a85a[_0x4e0786];}this['particleSystem']&&this['particleSystem']['setOptions'](this['getOptions']());}},{'key':'getOptions','value':function _0x88aa99(){var _0x2f1afb=_0x4729af,_0x11c084=Math[_0x2f1afb(0x1a1)](Math['sqrt'](this['particlesNumber']));return this['particlesNumber']=_0x11c084*_0x11c084,{'particlesTextureSize':_0x11c084,'maxParticles':this[_0x2f1afb(0x1ca)],'particleHeight':this['fixedHeight'],'fadeOpacity':this['fadeOpacity'],'dropRate':this['dropRate'],'dropRateBump':this['dropRateBump'],'speedFactor':this[_0x2f1afb(0x1a8)],'lineWidth':this['lineWidth'],'colors':this['colors']};}},{'key':'addPrimitives','value':function _0x35d411(){var _0x33619c=_0x4729af;this['primitives']['add'](this['particleSystem']['particlesComputing']['primitives']['getWind']),this['primitives']['add'](this['particleSystem']['particlesComputing']['primitives'][_0x33619c(0x1e8)]),this['primitives'][_0x33619c(0x189)](this[_0x33619c(0x163)]['particlesComputing']['primitives']['updatePosition']),this['primitives']['add'](this['particleSystem']['particlesComputing']['primitives']['postProcessingPosition']),this['primitives'][_0x33619c(0x189)](this['particleSystem'][_0x33619c(0x18e)]['primitives'][_0x33619c(0x1d7)]),this[_0x33619c(0x1b2)]['add'](this['particleSystem'][_0x33619c(0x1a3)][_0x33619c(0x1b2)][_0x33619c(0x243)]),this['primitives'][_0x33619c(0x189)](this['particleSystem']['particlesRendering'][_0x33619c(0x1b2)]['trails']),this[_0x33619c(0x1b2)][_0x33619c(0x189)](this['particleSystem']['particlesRendering']['primitives'][_0x33619c(0x15d)]);}},{'key':'updateViewerParameters','value':function _0x39264c(){var _0x5de72f=_0x4729af,_0x140b6d=this['camera']['computeViewRectangle'](this['scene']['globe'][_0x5de72f(0x1ff)]);if(!_0x140b6d){var _0x87bbf7=this['_map']['getExtent']();_0x140b6d=Cesium$1['Rectangle']['fromDegrees'](_0x87bbf7[_0x5de72f(0x1d2)],_0x87bbf7['ymin'],_0x87bbf7['xmax'],_0x87bbf7['ymax']);}var _0x5eb107=Util['viewRectangleToLonLatRange'](_0x140b6d);this['viewerParameters']['lonRange']['x']=_0x5eb107['lon']['min'],this['viewerParameters'][_0x5de72f(0x148)]['y']=_0x5eb107['lon']['max'],this[_0x5de72f(0x239)]['latRange']['x']=_0x5eb107[_0x5de72f(0x1d5)][_0x5de72f(0x1fc)],this['viewerParameters']['latRange']['y']=_0x5eb107['lat']['max'];var _0xbc2f05=this['camera'][_0x5de72f(0x161)](this[_0x5de72f(0x18f)],this[_0x5de72f(0x183)]['drawingBufferWidth'],this[_0x5de72f(0x183)]['drawingBufferHeight']);_0xbc2f05>0x0&&(this['viewerParameters'][_0x5de72f(0x214)]=_0xbc2f05);}}]),_0x48d55f;}(BaseLayer$1);mars3d__namespace[_0x5e2b17(0x145)][_0x5e2b17(0x1fa)](_0x5e2b17(0x168),WindLayer),mars3d__namespace[_0x5e2b17(0x17b)][_0x5e2b17(0x154)]=WindLayer;var CanvasParticle=(function(){var _0x5a67ae=_0x5e2b17;function _0x4c8b1c(){var _0x403efd=_0x322d;_classCallCheck(this,_0x4c8b1c),this['lng']=null,this['lat']=null,this[_0x403efd(0x1b0)]=null,this['tlat']=null,this['age']=null;}return _createClass(_0x4c8b1c,[{'key':_0x5a67ae(0x18b),'value':function _0xec6b47(){for(var _0x54b39c in this){delete this[_0x54b39c];}}}]),_0x4c8b1c;}()),CanvasWindField=(function(){var _0x456c2a=_0x5e2b17;function _0x1bfd64(_0x1679b2){_classCallCheck(this,_0x1bfd64),this['setOptions'](_0x1679b2);}return _createClass(_0x1bfd64,[{'key':'speedRate','get':function _0x356827(){return this['_speedRate'];},'set':function _0x30602f(_0x21b36a){var _0x187d62=_0x322d;this[_0x187d62(0x244)]=(0x64-(_0x21b36a>0x63?0x63:_0x21b36a))*0x64,this['_calc_speedRate']=[(this['xmax']-this['xmin'])/this[_0x187d62(0x244)],(this['ymax']-this['ymin'])/this[_0x187d62(0x244)]];}},{'key':'maxAge','get':function _0x2574bc(){return this['_maxAge'];},'set':function _0xdd7afe(_0x19a886){this['_maxAge']=_0x19a886;}},{'key':'setOptions','value':function _0x4b3401(_0x3dcc96){var _0x2adc34=_0x322d;this[_0x2adc34(0x1e3)]=_0x3dcc96,this['maxAge']=_0x3dcc96[_0x2adc34(0x1cc)]||0x78,this[_0x2adc34(0x1cd)]=_0x3dcc96['speedRate']||0x32,this['particles']=[];var _0x136df9=_0x3dcc96['particlesNumber']||0x1000;for(var _0x32d1ca=0x0;_0x32d1ca<_0x136df9;_0x32d1ca++){var _0x5764c0=this['_randomParticle'](new CanvasParticle());this['particles']['push'](_0x5764c0);}}},{'key':'setDate','value':function _0x18e61d(_0x319bc4){var _0x46f424=_0x322d;this['rows']=_0x319bc4[_0x46f424(0x1f4)],this['cols']=_0x319bc4[_0x46f424(0x220)],this['xmin']=_0x319bc4['xmin'],this['xmax']=_0x319bc4[_0x46f424(0x19e)],this['ymin']=_0x319bc4[_0x46f424(0x218)],this['ymax']=_0x319bc4[_0x46f424(0x1e0)],this['grid']=[];var _0xcb38c2=_0x319bc4['udata'],_0x48a15b=_0x319bc4['vdata'],_0x281500=![];_0xcb38c2['length']===this[_0x46f424(0x1f4)]&&_0xcb38c2[0x0][_0x46f424(0x18d)]===this['cols']&&(_0x281500=!![]);var _0x5e4606=0x0,_0x4dfffd=null,_0x460cfa=null;for(var _0x1ae11b=0x0;_0x1ae11b<this[_0x46f424(0x1f4)];_0x1ae11b++){_0x4dfffd=[];for(var _0x594d69=0x0;_0x594d69<this[_0x46f424(0x220)];_0x594d69++,_0x5e4606++){_0x281500?_0x460cfa=this[_0x46f424(0x153)](_0xcb38c2[_0x1ae11b][_0x594d69],_0x48a15b[_0x1ae11b][_0x594d69]):_0x460cfa=this['_calcUV'](_0xcb38c2[_0x5e4606],_0x48a15b[_0x5e4606]),_0x4dfffd['push'](_0x460cfa);}this['grid']['push'](_0x4dfffd);}this[_0x46f424(0x1e3)]['reverseY']&&this[_0x46f424(0x1b5)]['reverse']();}},{'key':_0x456c2a(0x173),'value':function _0x728ca2(){var _0x3d2335=_0x456c2a;delete this['rows'],delete this[_0x3d2335(0x220)],delete this['xmin'],delete this['xmax'],delete this['ymin'],delete this['ymax'],delete this['grid'],delete this[_0x3d2335(0x146)];}},{'key':'toGridXY','value':function _0x29ea78(_0xe6346f,_0x3fa1d8){var _0x381e73=_0x456c2a,_0x381899=(_0xe6346f-this['xmin'])/(this[_0x381e73(0x19e)]-this[_0x381e73(0x1d2)])*(this[_0x381e73(0x220)]-0x1),_0xb98135=(this['ymax']-_0x3fa1d8)/(this['ymax']-this['ymin'])*(this[_0x381e73(0x1f4)]-0x1);return[_0x381899,_0xb98135];}},{'key':'getUVByXY','value':function _0x33a4b4(_0x5c36b3,_0x38bc3e){var _0x24fd54=_0x456c2a;if(_0x5c36b3<0x0||_0x5c36b3>=this['cols']||_0x38bc3e>=this['rows'])return[0x0,0x0,0x0];var _0x4d82aa=Math['floor'](_0x5c36b3),_0x154225=Math['floor'](_0x38bc3e);if(_0x4d82aa===_0x5c36b3&&_0x154225===_0x38bc3e)return this['grid'][_0x38bc3e][_0x5c36b3];var _0x513e44=_0x4d82aa+0x1,_0x7d2830=_0x154225+0x1,_0x35afcf=this['getUVByXY'](_0x4d82aa,_0x154225),_0x1cdf08=this[_0x24fd54(0x222)](_0x513e44,_0x154225),_0x3106aa=this['getUVByXY'](_0x4d82aa,_0x7d2830),_0x34bb44=this['getUVByXY'](_0x513e44,_0x7d2830),_0x2ce571=null;try{_0x2ce571=this['_bilinearInterpolation'](_0x5c36b3-_0x4d82aa,_0x38bc3e-_0x154225,_0x35afcf,_0x1cdf08,_0x3106aa,_0x34bb44);}catch(_0x42c34d){console['log'](_0x5c36b3,_0x38bc3e);}return _0x2ce571;}},{'key':_0x456c2a(0x159),'value':function _0x1969db(_0x550b16,_0x24ada9,_0x45e954,_0x5293a6,_0x222633,_0x548189){var _0x129e6c=_0x456c2a,_0x59eb7d=0x1-_0x550b16,_0x874a3c=0x1-_0x24ada9,_0x57883d=_0x59eb7d*_0x874a3c,_0x59b07c=_0x550b16*_0x874a3c,_0x3a7e38=_0x59eb7d*_0x24ada9,_0x3f7f95=_0x550b16*_0x24ada9,_0x151e99=_0x45e954[0x0]*_0x57883d+_0x5293a6[0x0]*_0x59b07c+_0x222633[0x0]*_0x3a7e38+_0x548189[0x0]*_0x3f7f95,_0x5bf116=_0x45e954[0x1]*_0x57883d+_0x5293a6[0x1]*_0x59b07c+_0x222633[0x1]*_0x3a7e38+_0x548189[0x1]*_0x3f7f95;return this[_0x129e6c(0x153)](_0x151e99,_0x5bf116);}},{'key':'_calcUV','value':function _0x3ef58d(_0x1b6bcd,_0x47b2aa){return[+_0x1b6bcd,+_0x47b2aa,Math['sqrt'](_0x1b6bcd*_0x1b6bcd+_0x47b2aa*_0x47b2aa)];}},{'key':_0x456c2a(0x142),'value':function _0x5b04aa(_0x261cca,_0xd4441b){var _0x1729c9=_0x456c2a;if(!this['isInExtent'](_0x261cca,_0xd4441b))return null;var _0x4113ff=this['toGridXY'](_0x261cca,_0xd4441b),_0xb89b3c=this[_0x1729c9(0x222)](_0x4113ff[0x0],_0x4113ff[0x1]);return _0xb89b3c;}},{'key':'isInExtent','value':function _0x3c6739(_0x353cc6,_0x14d0dd){var _0x2de8ad=_0x456c2a;return _0x353cc6>=this['xmin']&&_0x353cc6<=this['xmax']&&_0x14d0dd>=this[_0x2de8ad(0x218)]&&_0x14d0dd<=this['ymax']?!![]:![];}},{'key':'getRandomLatLng','value':function _0x3b3ab7(){var _0x3c7c7f=_0x456c2a,_0x3070a1=fRandomByfloat(this['xmin'],this['xmax']),_0x3630a1=fRandomByfloat(this[_0x3c7c7f(0x218)],this[_0x3c7c7f(0x1e0)]);return{'lat':_0x3630a1,'lng':_0x3070a1};}},{'key':'getParticles','value':function _0x46a268(){var _0x16c0ec=_0x456c2a,_0x492d58,_0x1cb339,_0x602c95;for(var _0x2322e7=0x0,_0x132e39=this['particles'][_0x16c0ec(0x18d)];_0x2322e7<_0x132e39;_0x2322e7++){var _0x5244fe=this['particles'][_0x2322e7];_0x5244fe['age']<=0x0&&(_0x5244fe=this['_randomParticle'](_0x5244fe));if(_0x5244fe['age']>0x0){var _0x35b2bb=_0x5244fe['tlng'],_0x59dd47=_0x5244fe[_0x16c0ec(0x1ae)];_0x602c95=this['getUVByPoint'](_0x35b2bb,_0x59dd47),_0x602c95?(_0x492d58=_0x35b2bb+this[_0x16c0ec(0x226)][0x0]*_0x602c95[0x0],_0x1cb339=_0x59dd47+this['_calc_speedRate'][0x1]*_0x602c95[0x1],_0x5244fe['lng']=_0x35b2bb,_0x5244fe['lat']=_0x59dd47,_0x5244fe['tlng']=_0x492d58,_0x5244fe[_0x16c0ec(0x1ae)]=_0x1cb339,_0x5244fe['age']--):_0x5244fe['age']=0x0;}}return this['particles'];}},{'key':_0x456c2a(0x178),'value':function _0x3f6fa6(_0x287f89){var _0x547ced=_0x456c2a,_0x52875d,_0x15b285;for(var _0x3c8b50=0x0;_0x3c8b50<0x1e;_0x3c8b50++){_0x52875d=this[_0x547ced(0x16f)](),_0x15b285=this['getUVByPoint'](_0x52875d['lng'],_0x52875d['lat']);if(_0x15b285&&_0x15b285[0x2]>0x0)break;}if(!_0x15b285)return _0x287f89;var _0x308c70=_0x52875d['lng']+this['_calc_speedRate'][0x0]*_0x15b285[0x0],_0xd84da9=_0x52875d[_0x547ced(0x1d5)]+this['_calc_speedRate'][0x1]*_0x15b285[0x1];return _0x287f89[_0x547ced(0x155)]=_0x52875d['lng'],_0x287f89['lat']=_0x52875d['lat'],_0x287f89['tlng']=_0x308c70,_0x287f89['tlat']=_0xd84da9,_0x287f89['age']=Math['round'](Math['random']()*this['maxAge']),_0x287f89;}},{'key':'destroy','value':function _0x11ac72(){for(var _0x55d2f4 in this){delete this[_0x55d2f4];}}}]),_0x1bfd64;}());function fRandomByfloat(_0x4a1439,_0x475905){return _0x4a1439+Math['random']()*(_0x475905-_0x4a1439);}var Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x5e2b17(0x16d)],CanvasWindLayer=function(_0x52e1ea){var _0x236099=_0x5e2b17;_inherits(_0x3abbbb,_0x52e1ea);var _0x2533ee=_createSuper(_0x3abbbb);function _0x3abbbb(){var _0x14e133=_0x322d,_0x19c34b,_0x492f46=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x3abbbb),_0x19c34b=_0x2533ee['call'](this,_0x492f46),_0x19c34b[_0x14e133(0x182)](_0x492f46),_0x19c34b['canvas']=null,_0x19c34b;}return _createClass(_0x3abbbb,[{'key':'_setOptionsHook','value':function _0x14dc47(_0x645f88,_0x25ff44){var _0x103d9b=_0x322d,_0x263809,_0x28a24b,_0x2993d1;this['frameTime']=0x3e8/(_0x645f88['frameRate']||0xa),this['_pointerEvents']=(_0x263809=this['options'][_0x103d9b(0x209)])!==null&&_0x263809!==void 0x0?_0x263809:![],this['color']=_0x645f88[_0x103d9b(0x210)]||'#ffffff',this[_0x103d9b(0x18a)]=_0x645f88['lineWidth']||0x1,this['fixedHeight']=(_0x28a24b=_0x645f88['fixedHeight'])!==null&&_0x28a24b!==void 0x0?_0x28a24b:0x0,this['reverseY']=(_0x2993d1=_0x645f88[_0x103d9b(0x196)])!==null&&_0x2993d1!==void 0x0?_0x2993d1:![],this[_0x103d9b(0x15b)]&&this['windField']['setOptions'](_0x645f88);}},{'key':_0x236099(0x17b),'get':function _0x176045(){return this['canvas'];}},{'key':_0x236099(0x21c),'get':function _0x47b3c7(){var _0x39d679=_0x236099;return this['_map']['scene']['canvas'][_0x39d679(0x248)];}},{'key':_0x236099(0x21d),'get':function _0x1fb363(){return this['_map']['scene']['canvas']['clientHeight'];}},{'key':_0x236099(0x209),'get':function _0x612064(){return this['_pointerEvents'];},'set':function _0x12bcad(_0x3eb82d){var _0x5df92f=_0x236099;this['_pointerEvents']=_0x3eb82d;if(!this[_0x5df92f(0x1d9)])return;_0x3eb82d?this['canvas'][_0x5df92f(0x246)]['pointer-events']='all':this[_0x5df92f(0x1d9)]['style'][_0x5df92f(0x197)]='none';}},{'key':'particlesNumber','get':function _0x4a9303(){var _0x40da58=_0x236099;return this[_0x40da58(0x1e3)]['particlesNumber'];},'set':function _0x433efa(_0xfddbe4){var _0x2ab2fd=_0x236099,_0x194ade=this;this['options']['particlesNumber']=_0xfddbe4,clearTimeout(this[_0x2ab2fd(0x23b)]),this['_canrefresh']=setTimeout(function(){_0x194ade['redraw']();},0x1f4);}},{'key':'speedRate','get':function _0x49dfca(){var _0x31a983=_0x236099;return this[_0x31a983(0x1e3)]['speedRate'];},'set':function _0x18614f(_0x3e252b){var _0x4f3061=_0x236099;this['options']['speedRate']=_0x3e252b,this['windField']&&(this[_0x4f3061(0x15b)][_0x4f3061(0x1cd)]=_0x3e252b);}},{'key':_0x236099(0x1cc),'get':function _0x52d790(){var _0x5e9f86=_0x236099;return this[_0x5e9f86(0x1e3)][_0x5e9f86(0x1cc)];},'set':function _0x52731a(_0x5e2289){var _0x6d0118=_0x236099;this[_0x6d0118(0x1e3)][_0x6d0118(0x1cc)]=_0x5e2289,this[_0x6d0118(0x15b)]&&(this['windField'][_0x6d0118(0x1cc)]=_0x5e2289);}},{'key':'data','get':function _0x1920cb(){var _0x1d644c=_0x236099;return this[_0x1d644c(0x1ef)];},'set':function _0x27910f(_0x2ff8b7){this['setData'](_0x2ff8b7);}},{'key':'_showHook','value':function _0x4ba9e6(_0x5092fc){var _0x775927=_0x236099;_0x5092fc?this['_addedHook']():(this[_0x775927(0x1ef)]&&(this['options'][_0x775927(0x1f9)]=this[_0x775927(0x1ef)]),this['_removedHook']());}},{'key':'_mountedHook','value':function _0x175c95(){this['options']['worker']?this['initWorker']():this['windField']=new CanvasWindField(this['options']);}},{'key':'_addedHook','value':function _0x43ce70(){this['canvas']=this['_createCanvas'](),this['canvasContext']=this['canvas']['getContext']('2d',{'willReadFrequently':!![]}),this['bindEvent'](),this['options']['data']&&this['setData'](this['options']['data']);}},{'key':'_removedHook','value':function _0x39da20(){var _0x4f6aad=_0x236099;this[_0x4f6aad(0x173)](),this[_0x4f6aad(0x1c8)](),this[_0x4f6aad(0x1d9)]&&(this['_map'][_0x4f6aad(0x1db)]['removeChild'](this['canvas']),delete this['canvas']);}},{'key':'_createCanvas','value':function _0x12abcf(){var _0x808d82=_0x236099,_0x5b8f2e,_0x24d635=mars3d__namespace[_0x808d82(0x1fd)]['create']('canvas',_0x808d82(0x17a),this['_map'][_0x808d82(0x1db)]);return _0x24d635['style']['position']=_0x808d82(0x23c),_0x24d635['style'][_0x808d82(0x1e9)]='0px',_0x24d635['style']['left']='0px',_0x24d635['style'][_0x808d82(0x231)]=this['_map']['scene']['canvas']['clientWidth']+'px',_0x24d635['style']['height']=this['_map'][_0x808d82(0x183)]['canvas']['clientHeight']+'px',_0x24d635['style']['pointerEvents']=this[_0x808d82(0x1c3)]?_0x808d82(0x1ba):_0x808d82(0x19f),_0x24d635[_0x808d82(0x246)]['zIndex']=(_0x5b8f2e=this['options']['zIndex'])!==null&&_0x5b8f2e!==void 0x0?_0x5b8f2e:0x9,_0x24d635['width']=this['_map'][_0x808d82(0x183)][_0x808d82(0x1d9)]['clientWidth'],_0x24d635['height']=this[_0x808d82(0x228)]['scene'][_0x808d82(0x1d9)][_0x808d82(0x15f)],_0x24d635;}},{'key':_0x236099(0x237),'value':function _0x545ebd(){var _0x3b5548=_0x236099;this[_0x3b5548(0x1d9)]&&(this['canvas']['style']['width']=this['_map']['scene'][_0x3b5548(0x1d9)][_0x3b5548(0x248)]+'px',this[_0x3b5548(0x1d9)]['style'][_0x3b5548(0x165)]=this[_0x3b5548(0x228)]['scene']['canvas']['clientHeight']+'px',this['canvas']['width']=this['_map']['scene']['canvas']['clientWidth'],this[_0x3b5548(0x1d9)][_0x3b5548(0x165)]=this['_map']['scene']['canvas']['clientHeight']);}},{'key':'bindEvent','value':function _0x5cb99b(){var _0x54def4=_0x236099,_0x1437ba=this,_0x3f6600=Date['now']();(function _0x8ed85a(){var _0x32e368=_0x322d;_0x1437ba[_0x32e368(0x22e)]=window['requestAnimationFrame'](_0x8ed85a);if(_0x1437ba['show']&&_0x1437ba['windField']){var _0x202eef=Date['now'](),_0xb52edc=_0x202eef-_0x3f6600;_0xb52edc>_0x1437ba['frameTime']&&(_0x3f6600=_0x202eef-_0xb52edc%_0x1437ba[_0x32e368(0x230)],_0x1437ba['update']());}}(),window['addEventListener']('resize',this['resize']['bind'](this),![]),this['mouse_down']=![],this['mouse_move']=![],this[_0x54def4(0x1e3)][_0x54def4(0x207)]&&(this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x54def4(0x1bd)],this['_onMouseDownEvent'],this),this[_0x54def4(0x228)]['on'](mars3d__namespace[_0x54def4(0x143)][_0x54def4(0x1cb)],this['_onMouseUpEvent'],this)));}},{'key':_0x236099(0x1c8),'value':function _0x6b6055(){var _0x45582c=_0x236099;window['cancelAnimationFrame'](this[_0x45582c(0x22e)]),delete this['animateFrame'],window['removeEventListener']('resize',this['resize']),this['options'][_0x45582c(0x207)]&&(this['_map']['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map'][_0x45582c(0x1d0)](mars3d__namespace[_0x45582c(0x143)]['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace[_0x45582c(0x143)]['mouseUp'],this[_0x45582c(0x215)],this),this[_0x45582c(0x228)]['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this));}},{'key':'_onMapWhellEvent','value':function _0x7b9e88(_0x883ef3){var _0x461605=_0x236099,_0x599da1=this;clearTimeout(this['refreshTimer']);if(!this['show']||!this['canvas'])return;this['canvas']['style'][_0x461605(0x191)]=_0x461605(0x1b4),this['refreshTimer']=setTimeout(function(){var _0x295cea=_0x461605;if(!_0x599da1['show'])return;_0x599da1['redraw'](),_0x599da1['canvas']['style']['visibility']=_0x295cea(0x22b);},0xc8);}},{'key':_0x236099(0x16a),'value':function _0x561724(_0x1c7e72){var _0x55fdc1=_0x236099;this['mouse_down']=!![],this[_0x55fdc1(0x228)]['off'](mars3d__namespace[_0x55fdc1(0x143)]['mouseMove'],this['_onMouseMoveEvent'],this),this['_map']['on'](mars3d__namespace[_0x55fdc1(0x143)]['mouseMove'],this[_0x55fdc1(0x1f0)],this);}},{'key':'_onMouseMoveEvent','value':function _0x24a4a3(_0x10b69d){var _0x207da4=_0x236099;if(!this['show']||!this['canvas'])return;this['mouse_down']&&(this['canvas'][_0x207da4(0x246)][_0x207da4(0x191)]='hidden',this[_0x207da4(0x1e7)]=!![]);}},{'key':'_onMouseUpEvent','value':function _0x372a7f(_0x4b7f48){var _0x3f72bb=_0x236099;if(!this['show']||!this['canvas'])return;this['_map'][_0x3f72bb(0x1d0)](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this),this['mouse_down']&&this[_0x3f72bb(0x1e7)]&&this['redraw'](),this['canvas']['style'][_0x3f72bb(0x191)]='visible',this['mouse_down']=![],this[_0x3f72bb(0x1e7)]=![];}},{'key':'setData','value':function _0x3e1908(_0x4603e0){var _0x54b3eb=_0x236099;this['clear'](),this['windData']=_0x4603e0,this['windField'][_0x54b3eb(0x206)](_0x4603e0),this['redraw']();}},{'key':_0x236099(0x1ce),'value':function _0x402de1(){var _0x38fff4=_0x236099;if(!this['show'])return;this['windField']['setOptions'](this[_0x38fff4(0x1e3)]),this['update']();}},{'key':_0x236099(0x1f1),'value':function _0x1603c1(){var _0x227cd2=_0x236099;if(this['_updateIng'])return;this['_updateIng']=!![];if(this['worker'])this['windField']['update']();else{var _0x40554b=this['windField'][_0x227cd2(0x1fe)]();this[_0x227cd2(0x167)](_0x40554b);}this[_0x227cd2(0x170)]=![];}},{'key':'_drawLines','value':function _0x3fa8e3(_0x1640b4){var _0x50588d=_0x236099;this['canvasContext'][_0x50588d(0x1c4)]='destination-in',this[_0x50588d(0x21e)]['fillRect'](0x0,0x0,this[_0x50588d(0x21c)],this['canvasHeight']),this[_0x50588d(0x21e)][_0x50588d(0x1c4)]=_0x50588d(0x181),this['canvasContext']['globalAlpha']=0.9,this[_0x50588d(0x21e)][_0x50588d(0x149)](),this['canvasContext'][_0x50588d(0x18a)]=this['lineWidth'],this['canvasContext']['strokeStyle']=this['color'];var _0x3360e8=this['_map'][_0x50588d(0x183)]['mode']!==Cesium['SceneMode']['SCENE3D'],_0x3c8473=this[_0x50588d(0x21c)]*0.25;for(var _0x28888b=0x0,_0x529649=_0x1640b4[_0x50588d(0x18d)];_0x28888b<_0x529649;_0x28888b++){var _0x1e0081=_0x1640b4[_0x28888b],_0x30a5ea=this['_tomap'](_0x1e0081['lng'],_0x1e0081['lat'],_0x1e0081),_0xb48604=this['_tomap'](_0x1e0081['tlng'],_0x1e0081['tlat'],_0x1e0081);if(!_0x30a5ea||!_0xb48604)continue;if(_0x3360e8&&Math[_0x50588d(0x1f7)](_0x30a5ea[0x0]-_0xb48604[0x0])>=_0x3c8473)continue;this['canvasContext'][_0x50588d(0x1f3)](_0x30a5ea[0x0],_0x30a5ea[0x1]),this['canvasContext']['lineTo'](_0xb48604[0x0],_0xb48604[0x1]);}this['canvasContext']['stroke']();}},{'key':'_tomap','value':function _0x2ac2cb(_0x18a954,_0x18bf79,_0x1ace1b){var _0x4512b3=_0x236099,_0x4156dc=Cesium['Cartesian3']['fromDegrees'](_0x18a954,_0x18bf79,this[_0x4512b3(0x14e)]),_0x1aa844=this[_0x4512b3(0x228)]['scene'];if(_0x1aa844['mode']===Cesium[_0x4512b3(0x14f)][_0x4512b3(0x185)]){var _0x95e7ec=new Cesium[(_0x4512b3(0x221))](_0x1aa844['globe']['ellipsoid'],_0x1aa844['camera']['positionWC']),_0x39e7ad=_0x95e7ec[_0x4512b3(0x187)](_0x4156dc);if(!_0x39e7ad)return _0x1ace1b[_0x4512b3(0x195)]=0x0,null;}var _0x4185d8=Cesium[_0x4512b3(0x208)]['wgs84ToWindowCoordinates'](this[_0x4512b3(0x228)]['scene'],_0x4156dc);return _0x4185d8?[_0x4185d8['x'],_0x4185d8['y']]:null;}},{'key':'clear','value':function _0x464b69(){var _0x28965a=_0x236099;this['windField'][_0x28965a(0x173)](),delete this[_0x28965a(0x1ef)];}},{'key':'initWorker','value':function _0x409bf0(){var _0x1d60bf=_0x236099,_0x3e4ca9=this;this['worker']=new Worker(this[_0x1d60bf(0x1e3)]['worker']),this['worker']['onmessage']=function(_0x406778){var _0x58e8d0=_0x1d60bf;_0x3e4ca9['_drawLines'](_0x406778['data'][_0x58e8d0(0x146)]),_0x3e4ca9['_updateIng2']=![];},this[_0x1d60bf(0x15b)]={'init':function _0x47934f(_0x30688d){_0x3e4ca9['worker']['postMessage']({'type':'init','options':_0x30688d});},'setOptions':function _0x1f8aec(_0x2fc99d){_0x3e4ca9['worker']['postMessage']({'type':'setOptions','options':_0x2fc99d});},'setDate':function _0x171b20(_0x4758b2){var _0x2ad0ee=_0x1d60bf;_0x3e4ca9['worker']['postMessage']({'type':_0x2ad0ee(0x206),'data':_0x4758b2});},'update':function _0xcc86ba(){var _0x56cbad=_0x1d60bf;if(_0x3e4ca9['_updateIng2'])return;_0x3e4ca9[_0x56cbad(0x1ab)]=!![],_0x3e4ca9['worker'][_0x56cbad(0x17c)]({'type':_0x56cbad(0x1f1)});},'clear':function _0xb5ec41(){var _0x746b2c=_0x1d60bf;_0x3e4ca9['worker']['postMessage']({'type':_0x746b2c(0x173)});}},this['windField']['init'](this['options']);}}]),_0x3abbbb;}(BaseLayer);function _0x322d(_0x2f275c,_0x163247){var _0x564455=_0x5644();return _0x322d=function(_0x322de3,_0x473761){_0x322de3=_0x322de3-0x140;var _0x94e69e=_0x564455[_0x322de3];return _0x94e69e;},_0x322d(_0x2f275c,_0x163247);}mars3d__namespace['LayerUtil'][_0x5e2b17(0x1fa)](_0x5e2b17(0x15e),CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace[_0x5e2b17(0x201)]=CanvasWindField,mars3d__namespace['WindUtil']=WindUtil,exports['CanvasWindField']=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports['WindLayer']=WindLayer,exports['WindUtil']=WindUtil,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
