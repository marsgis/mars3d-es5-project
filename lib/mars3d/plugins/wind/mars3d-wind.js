/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.5.2
 * 编译日期：2023-04-03 18:06:45
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x4e7c89=_0x53f5;(function(_0x39b321,_0x29c9f1){var _0x2252fb=_0x53f5,_0x43d39a=_0x39b321();while(!![]){try{var _0x2cf333=-parseInt(_0x2252fb(0x1da))/0x1*(-parseInt(_0x2252fb(0x17d))/0x2)+-parseInt(_0x2252fb(0x226))/0x3*(parseInt(_0x2252fb(0x263))/0x4)+parseInt(_0x2252fb(0x1b8))/0x5+parseInt(_0x2252fb(0x19f))/0x6+parseInt(_0x2252fb(0x20a))/0x7+-parseInt(_0x2252fb(0x18b))/0x8+-parseInt(_0x2252fb(0x177))/0x9*(-parseInt(_0x2252fb(0x1cc))/0xa);if(_0x2cf333===_0x29c9f1)break;else _0x43d39a['push'](_0x43d39a['shift']());}catch(_0x590107){_0x43d39a['push'](_0x43d39a['shift']());}}}(_0x4e48,0x9f3f9));function _0x4e48(){var _0x2ceced=['setData','framebuffer','north','redraw','width','layer','preExecute','sqrt','ShaderSource','EventType','createTexture','UNSIGNED_BYTE','_bilinearInterpolation','rawRenderState','nextParticlesPosition','drawingBufferHeight','particles','randomizeParticles','enumerable','destroyParticlesTextures','627NXGRXp','createCommand','rgb(206,255,255)','push','pointer-events','DISABLE_GL_POSITION_LOG_DEPTH','mouseHidden','ZERO','round','WindUtil','currentParticlesPosition','_data','particlesTextureSize','mouseUp','rows','red','once','constructor','lev','absolute','createRenderingPrimitives','postMessage','_randomParticle','destroy','TextureMinificationFilter','maxParticles','tlat','vdata','_setOptionsHook','LayerUtil','Pass','udata','umax','register','_pointerEvents','drawingBufferWidth','maxAge','ymax','applyViewerParameters','tlng','clearCommand','name','mouseDown','key','uniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0auniform\x20float\x20dropRate;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0auniform\x20float\x20dropRateBump;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0,\x201.0);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0);\x0a\x20\x20\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20lev);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20\x20\x20return\x20particle.y\x20<\x20-90.0\x20||\x20particle.y\x20>\x2090.0;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20nextSpeed.a;\x0a\x0a\x20\x20\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20\x20\x20if\x20(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(randomParticle,\x201.0);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a\x20\x20\x20\x20}\x0a}\x0a','ymin','mouseMove','postProcessingPosition','latRange','off','WindLayer','segmentsDepth','height','RGBA','pointerEvents','fromCache','particlesRendering','_onMouseDownEvent','max','windData','style','8404KNwtgb','grid','umin','array','setAttribute','currentParticlesSpeed','PrimitiveCollection','shaderProgram','dropRate','_map','lon','reverse','9XjFLgP','lineWidth','SceneMode','canvasWidth','slice','createRawRenderState','932yWQyjM','//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x,\x20360.0);\x0a\x20\x20\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20-90.0,\x2090.0);\x0a\x0a\x20\x20\x20\x20vec3\x20index3D\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20index3D.z\x20=\x20(lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z;\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205],\x20width\x20=\x203,\x20height\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x203\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x202\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWind(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20\x20\x20float\x20result\x20=\x20texture(windTexture,\x20normalizedIndex2D).r;\x0a\x20\x20\x20\x20return\x20result;\x0a}\x0a\x0aconst\x20mat4\x20kernelMatrix\x20=\x20mat4(\x0a\x20\x20\x20\x200.0,\x20-1.0,\x202.0,\x20-1.0,\x20//\x20first\x20column\x0a\x20\x20\x20\x202.0,\x200.0,\x20-5.0,\x203.0,\x20//\x20second\x20column\x0a\x20\x20\x20\x200.0,\x201.0,\x204.0,\x20-3.0,\x20//\x20third\x20column\x0a\x20\x20\x20\x200.0,\x200.0,\x20-1.0,\x201.0\x20//\x20fourth\x20column\x0a);\x0afloat\x20oneDimensionInterpolation(float\x20t,\x20float\x20p0,\x20float\x20p1,\x20float\x20p2,\x20float\x20p3)\x20{\x0a\x20\x20\x20\x20vec4\x20tVec4\x20=\x20vec4(1.0,\x20t,\x20t\x20*\x20t,\x20t\x20*\x20t\x20*\x20t);\x0a\x20\x20\x20\x20tVec4\x20=\x20tVec4\x20/\x202.0;\x0a\x20\x20\x20\x20vec4\x20pVec4\x20=\x20vec4(p0,\x20p1,\x20p2,\x20p3);\x0a\x20\x20\x20\x20return\x20dot((tVec4\x20*\x20kernelMatrix),\x20pVec4);\x0a}\x0a\x0afloat\x20calculateB(sampler2D\x20windTexture,\x20float\x20t,\x20float\x20lon,\x20float\x20lat,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20float\x20lon0\x20=\x20floor(lon)\x20-\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon1\x20=\x20floor(lon);\x0a\x20\x20\x20\x20float\x20lon2\x20=\x20floor(lon)\x20+\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon3\x20=\x20floor(lon)\x20+\x202.0\x20*\x20interval.x;\x0a\x0a\x20\x20\x20\x20float\x20p0\x20=\x20getWind(windTexture,\x20vec3(lon0,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p1\x20=\x20getWind(windTexture,\x20vec3(lon1,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p2\x20=\x20getWind(windTexture,\x20vec3(lon2,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p3\x20=\x20getWind(windTexture,\x20vec3(lon3,\x20lat,\x20lev));\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(t,\x20p0,\x20p1,\x20p2,\x20p3);\x0a}\x0a\x0afloat\x20interpolateOneTexture(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20\x20\x20float\x20lat0\x20=\x20floor(lat)\x20-\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat1\x20=\x20floor(lat);\x0a\x20\x20\x20\x20float\x20lat2\x20=\x20floor(lat)\x20+\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat3\x20=\x20floor(lat)\x20+\x202.0\x20*\x20interval.y;\x0a\x0a\x20\x20\x20\x20vec2\x20coefficient\x20=\x20lonLatLev.xy\x20-\x20floor(lonLatLev.xy);\x0a\x20\x20\x20\x20float\x20b0\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat0,\x20lev);\x0a\x20\x20\x20\x20float\x20b1\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat1,\x20lev);\x0a\x20\x20\x20\x20float\x20b2\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat2,\x20lev);\x0a\x20\x20\x20\x20float\x20b3\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat3,\x20lev);\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(coefficient.y,\x20b0,\x20b1,\x20b2,\x20b3);\x0a}\x0a\x0avec3\x20bicubic(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bicubic_interpolation#Bicubic_convolution_algorithm\x0a\x20\x20\x20\x20float\x20u\x20=\x20interpolateOneTexture(U,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20v\x20=\x20interpolateOneTexture(V,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20bicubic(lonLatLev);\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(windVector,\x200.0);\x0a}\x0a','speedRate','windField','_updateIng2','getOwnPropertySymbols','frameTime','computeViewRectangle','worker','isInExtent','createRenderingFramebuffers','canvas','resize','outputTexture','6574344DWIYuX','wheel','attributeLocations','mouse_move','moveTo','Sampler','globalCompositeOperation','geometry','_speedRate','cols','toRadians','primitives','BufferUsage','Color','setOptions','preRender','_onMouseUpEvent','animateFrame','camera','Draw','3409554LmeVHy','_onMapWhellEvent','refreshTimer','NEAREST','getColorTexture','dropRateBump','isArray','options','show','postProcessingSpeed','Set','mode','Geometry','getOwnPropertyDescriptor','textures','age','fixedHeight','lat','length','Matrix4','Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined','construct','nextTrails','Math','data','4077810eUEQmb','PixelDatatype','call','east','filter','globe','apply','levmax','defined','scene','ComponentDatatype','dimensions','trails','_onMouseMoveEvent','TWO_PI','__esModule','toDegrees','uniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x0a\x20\x20\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0\x20*\x20trailsColor)\x20/\x20255.0;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20pointsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20trailsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a','particleSystem','viewerParameters','76530RTLKKj','Arguments','prototype','value','fromDegrees','__proto__','autoClear','_removedHook','particlesTextures','windTextures','uniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20randomParticle\x20=\x20texture(postProcessingPosition,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20vec4\x20particleSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x0a\x20\x20\x20\x20if\x20(randomParticle.a\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20particleSpeed;\x0a\x20\x20\x20\x20}\x0a}\x0a','color','DrawCommand','segments','844PVneMz','PixelFormat','getWind','forEach','clearFramebuffers','colors','hidden','TextureMagnificationFilter','Cartesian3','getParticles','GeometryAttribute','context','_createCanvas','visibility','framebuffers','default','_onMap_preRenderEvent','fillRect','getOptions','Cesium','mouse_down','getDefaultRenderState','from','min','reverseY','vertexArray','auto','Cartesian2','xmin','uniformMap','update','segmentsColor','_calc_speedRate','uniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20trailsColor;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x0a}\x0a','lng','TRIANGLES','FLOAT','ClearCommand','STATIC_DRAW','createRenderingTextures','add','particlesComputing','bindEvent','canvasContext','commandToExecute','createWindTextures','updatePosition','keys','898835dkrZSN','PrimitiveType','sham','defineProperty','particlesNumber','random','Compute','particlesWind'];_0x4e48=function(){return _0x2ceced;};return _0x4e48();}function _interopNamespace(_0x130a25){var _0x19ff71=_0x53f5;if(_0x130a25&&_0x130a25[_0x19ff71(0x1c7)])return _0x130a25;var _0x544dab=Object['create'](null);return _0x130a25&&Object['keys'](_0x130a25)[_0x19ff71(0x1dd)](function(_0x136618){var _0x47ca83=_0x19ff71;if(_0x136618!=='default'){var _0x58d8fc=Object['getOwnPropertyDescriptor'](_0x130a25,_0x136618);Object[_0x47ca83(0x20d)](_0x544dab,_0x136618,_0x58d8fc['get']?_0x58d8fc:{'enumerable':!![],'get':function(){return _0x130a25[_0x136618];}});}}),_0x544dab[_0x19ff71(0x1e9)]=_0x130a25,_0x544dab;}var mars3d__namespace=_interopNamespace(mars3d),Cesium$7=mars3d__namespace['Cesium'];function getU(_0xfc3287,_0x269152){var _0x3edc0b=_0x53f5,_0x50ed78=_0xfc3287*Math['cos'](Cesium$7[_0x3edc0b(0x1b6)][_0x3edc0b(0x195)](_0x269152));return _0x50ed78;}function getV(_0x1019f5,_0x48a4b0){var _0x4bd5fc=_0x1019f5*Math['sin'](Cesium$7['Math']['toRadians'](_0x48a4b0));return _0x4bd5fc;}function getSpeed(_0x41a45e,_0x4910e8){var _0x50cf92=_0x53f5,_0x523695=Math[_0x50cf92(0x219)](Math['pow'](_0x41a45e,0x2)+Math['pow'](_0x4910e8,0x2));return _0x523695;}function getDirection(_0x4a6a02,_0x2db78b){var _0x2f7e9c=_0x53f5,_0x431b7e=Cesium$7['Math'][_0x2f7e9c(0x1c8)](Math['atan2'](_0x2db78b,_0x4a6a02));return _0x431b7e+=_0x431b7e<0x0?0x168:0x0,_0x431b7e;}var WindUtil={'__proto__':null,'getU':getU,'getV':getV,'getSpeed':getSpeed,'getDirection':getDirection};function ownKeys(_0x34ae35,_0x273f45){var _0x1fa97a=_0x53f5,_0x37b93f=Object[_0x1fa97a(0x209)](_0x34ae35);if(Object['getOwnPropertySymbols']){var _0x42b197=Object[_0x1fa97a(0x182)](_0x34ae35);_0x273f45&&(_0x42b197=_0x42b197[_0x1fa97a(0x1bc)](function(_0x2bae71){var _0x136c24=_0x1fa97a;return Object[_0x136c24(0x1ac)](_0x34ae35,_0x2bae71)[_0x136c24(0x224)];})),_0x37b93f['push'][_0x1fa97a(0x1be)](_0x37b93f,_0x42b197);}return _0x37b93f;}function _objectSpread2(_0x4bfe25){for(var _0x453937=0x1;_0x453937<arguments['length'];_0x453937++){var _0x5ea726=null!=arguments[_0x453937]?arguments[_0x453937]:{};_0x453937%0x2?ownKeys(Object(_0x5ea726),!0x0)['forEach'](function(_0x580858){_defineProperty(_0x4bfe25,_0x580858,_0x5ea726[_0x580858]);}):Object['getOwnPropertyDescriptors']?Object['defineProperties'](_0x4bfe25,Object['getOwnPropertyDescriptors'](_0x5ea726)):ownKeys(Object(_0x5ea726))['forEach'](function(_0x269a19){Object['defineProperty'](_0x4bfe25,_0x269a19,Object['getOwnPropertyDescriptor'](_0x5ea726,_0x269a19));});}return _0x4bfe25;}function _classCallCheck(_0x558498,_0x1807ca){if(!(_0x558498 instanceof _0x1807ca))throw new TypeError('Cannot\x20call\x20a\x20class\x20as\x20a\x20function');}function _defineProperties(_0x400c68,_0x1d92b7){var _0x5464a7=_0x53f5;for(var _0x152b52=0x0;_0x152b52<_0x1d92b7['length'];_0x152b52++){var _0x4a39a9=_0x1d92b7[_0x152b52];_0x4a39a9['enumerable']=_0x4a39a9['enumerable']||![],_0x4a39a9['configurable']=!![];if(_0x5464a7(0x1cf)in _0x4a39a9)_0x4a39a9['writable']=!![];Object['defineProperty'](_0x400c68,_0x4a39a9[_0x5464a7(0x251)],_0x4a39a9);}}function _createClass(_0x351266,_0x4ce0ae,_0xde2b23){var _0x1445c6=_0x53f5;if(_0x4ce0ae)_defineProperties(_0x351266['prototype'],_0x4ce0ae);if(_0xde2b23)_defineProperties(_0x351266,_0xde2b23);return Object[_0x1445c6(0x20d)](_0x351266,'prototype',{'writable':![]}),_0x351266;}function _defineProperty(_0x35a763,_0x336908,_0x507e01){return _0x336908 in _0x35a763?Object['defineProperty'](_0x35a763,_0x336908,{'value':_0x507e01,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x35a763[_0x336908]=_0x507e01,_0x35a763;}function _0x53f5(_0x2c663d,_0x368997){var _0x4e4844=_0x4e48();return _0x53f5=function(_0x53f5eb,_0x5b93eb){_0x53f5eb=_0x53f5eb-0x16d;var _0x19b2a9=_0x4e4844[_0x53f5eb];return _0x19b2a9;},_0x53f5(_0x2c663d,_0x368997);}function _inherits(_0xd098c8,_0x3f2131){if(typeof _0x3f2131!=='function'&&_0x3f2131!==null)throw new TypeError('Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function');_0xd098c8['prototype']=Object['create'](_0x3f2131&&_0x3f2131['prototype'],{'constructor':{'value':_0xd098c8,'writable':!![],'configurable':!![]}}),Object['defineProperty'](_0xd098c8,'prototype',{'writable':![]});if(_0x3f2131)_setPrototypeOf(_0xd098c8,_0x3f2131);}function _getPrototypeOf(_0x54785f){return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf']:function _0x367904(_0xff5a06){var _0x4cdf19=_0x53f5;return _0xff5a06[_0x4cdf19(0x1d1)]||Object['getPrototypeOf'](_0xff5a06);},_getPrototypeOf(_0x54785f);}function _setPrototypeOf(_0x2c3c18,_0x33869b){return _setPrototypeOf=Object['setPrototypeOf']||function _0x5aacd5(_0x54ba1b,_0x417c87){return _0x54ba1b['__proto__']=_0x417c87,_0x54ba1b;},_setPrototypeOf(_0x2c3c18,_0x33869b);}function _isNativeReflectConstruct(){var _0x5717dc=_0x53f5;if(typeof Reflect==='undefined'||!Reflect['construct'])return![];if(Reflect[_0x5717dc(0x1b4)][_0x5717dc(0x20c)])return![];if(typeof Proxy==='function')return!![];try{return Boolean['prototype']['valueOf'][_0x5717dc(0x1ba)](Reflect['construct'](Boolean,[],function(){})),!![];}catch(_0x376e78){return![];}}function _assertThisInitialized(_0x13707f){if(_0x13707f===void 0x0)throw new ReferenceError('this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called');return _0x13707f;}function _possibleConstructorReturn(_0x1aa7a0,_0x183054){var _0x27b615=_0x53f5;if(_0x183054&&(typeof _0x183054==='object'||typeof _0x183054==='function'))return _0x183054;else{if(_0x183054!==void 0x0)throw new TypeError(_0x27b615(0x1b3));}return _assertThisInitialized(_0x1aa7a0);}function _createSuper(_0xd8e12){var _0x4fcc4a=_isNativeReflectConstruct();return function _0x102c98(){var _0x915b82=_0x53f5,_0x25921d=_getPrototypeOf(_0xd8e12),_0x2de6ca;if(_0x4fcc4a){var _0x4ad534=_getPrototypeOf(this)[_0x915b82(0x237)];_0x2de6ca=Reflect['construct'](_0x25921d,arguments,_0x4ad534);}else _0x2de6ca=_0x25921d['apply'](this,arguments);return _possibleConstructorReturn(this,_0x2de6ca);};}function _toConsumableArray(_0x45d23d){return _arrayWithoutHoles(_0x45d23d)||_iterableToArray(_0x45d23d)||_unsupportedIterableToArray(_0x45d23d)||_nonIterableSpread();}function _arrayWithoutHoles(_0xe50dcb){var _0x51a69b=_0x53f5;if(Array[_0x51a69b(0x1a5)](_0xe50dcb))return _arrayLikeToArray(_0xe50dcb);}function _iterableToArray(_0x3ec4bf){var _0x240fac=_0x53f5;if(typeof Symbol!=='undefined'&&_0x3ec4bf[Symbol['iterator']]!=null||_0x3ec4bf['@@iterator']!=null)return Array[_0x240fac(0x1f0)](_0x3ec4bf);}function _unsupportedIterableToArray(_0x4d8db7,_0x3ca98c){var _0x495635=_0x53f5;if(!_0x4d8db7)return;if(typeof _0x4d8db7==='string')return _arrayLikeToArray(_0x4d8db7,_0x3ca98c);var _0x161320=Object[_0x495635(0x1ce)]['toString']['call'](_0x4d8db7)[_0x495635(0x17b)](0x8,-0x1);if(_0x161320==='Object'&&_0x4d8db7['constructor'])_0x161320=_0x4d8db7[_0x495635(0x237)][_0x495635(0x24f)];if(_0x161320==='Map'||_0x161320===_0x495635(0x1a9))return Array['from'](_0x4d8db7);if(_0x161320===_0x495635(0x1cd)||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/['test'](_0x161320))return _arrayLikeToArray(_0x4d8db7,_0x3ca98c);}function _arrayLikeToArray(_0x283d87,_0x1a3b8d){var _0x393828=_0x53f5;if(_0x1a3b8d==null||_0x1a3b8d>_0x283d87[_0x393828(0x1b1)])_0x1a3b8d=_0x283d87['length'];for(var _0xd037f7=0x0,_0x426daf=new Array(_0x1a3b8d);_0xd037f7<_0x1a3b8d;_0xd037f7++)_0x426daf[_0xd037f7]=_0x283d87[_0xd037f7];return _0x426daf;}function _nonIterableSpread(){throw new TypeError('Invalid\x20attempt\x20to\x20spread\x20non-iterable\x20instance.\x0aIn\x20order\x20to\x20be\x20iterable,\x20non-array\x20objects\x20must\x20have\x20a\x20[Symbol.iterator]()\x20method.');}var Cesium$6=mars3d__namespace['Cesium'],CustomPrimitive=(function(){var _0x3bfa06=_0x53f5;function _0x3d975c(_0x1ecf1b){var _0x506d78=_0x53f5,_0x3c82e8;_classCallCheck(this,_0x3d975c),this['commandType']=_0x1ecf1b['commandType'],this['geometry']=_0x1ecf1b['geometry'],this[_0x506d78(0x18d)]=_0x1ecf1b[_0x506d78(0x18d)],this['primitiveType']=_0x1ecf1b['primitiveType'],this[_0x506d78(0x1f7)]=_0x1ecf1b['uniformMap'],this['vertexShaderSource']=_0x1ecf1b['vertexShaderSource'],this['fragmentShaderSource']=_0x1ecf1b['fragmentShaderSource'],this['rawRenderState']=_0x1ecf1b['rawRenderState'],this['framebuffer']=_0x1ecf1b['framebuffer'],this['outputTexture']=_0x1ecf1b[_0x506d78(0x18a)],this['autoClear']=(_0x3c82e8=_0x1ecf1b[_0x506d78(0x1d2)])!==null&&_0x3c82e8!==void 0x0?_0x3c82e8:![],this[_0x506d78(0x218)]=_0x1ecf1b['preExecute'],this['show']=!![],this['commandToExecute']=undefined,this['clearCommand']=undefined,this['autoClear']&&(this[_0x506d78(0x24e)]=new Cesium$6[(_0x506d78(0x1ff))]({'color':new Cesium$6['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Cesium$6[_0x506d78(0x244)]['OPAQUE']}));}return _createClass(_0x3d975c,[{'key':_0x3bfa06(0x227),'value':function _0x49c532(_0x56192e){var _0x19d79d=_0x3bfa06;switch(this['commandType']){case'Draw':{var _0x11ea55=Cesium$6['VertexArray']['fromGeometry']({'context':_0x56192e,'geometry':this[_0x19d79d(0x192)],'attributeLocations':this[_0x19d79d(0x18d)],'bufferUsage':Cesium$6[_0x19d79d(0x197)][_0x19d79d(0x200)]}),_0xe107c1=Cesium$6['ShaderProgram']['fromCache']({'context':_0x56192e,'attributeLocations':this['attributeLocations'],'vertexShaderSource':this['vertexShaderSource'],'fragmentShaderSource':this['fragmentShaderSource']}),_0x334e6a=Cesium$6['RenderState'][_0x19d79d(0x25d)](this[_0x19d79d(0x21f)]);return new Cesium$6[(_0x19d79d(0x1d8))]({'primitiveType':this['primitiveType'],'shaderProgram':_0xe107c1,'vertexArray':_0x11ea55,'modelMatrix':Cesium$6[_0x19d79d(0x1b2)]['IDENTITY'],'renderState':_0x334e6a,'uniformMap':this['uniformMap'],'castShadows':![],'receiveShadows':![],'framebuffer':this[_0x19d79d(0x213)],'pass':Cesium$6['Pass']['OPAQUE'],'pickOnly':!![],'owner':this});}case'Compute':{return new Cesium$6['ComputeCommand']({'owner':this,'fragmentShaderSource':this['fragmentShaderSource'],'uniformMap':this[_0x19d79d(0x1f7)],'outputTexture':this[_0x19d79d(0x18a)],'persists':!![]});}}}},{'key':'setGeometry','value':function _0x5c7f2c(_0x1037bf,_0xbb7e94){var _0x25a380=_0x3bfa06;this['geometry']=_0xbb7e94;var _0x46d58d=Cesium$6['VertexArray']['fromGeometry']({'context':_0x1037bf,'geometry':this[_0x25a380(0x192)],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6['BufferUsage'][_0x25a380(0x200)]});this[_0x25a380(0x206)][_0x25a380(0x1f3)]=_0x46d58d;}},{'key':'update','value':function _0x3018a5(_0x8226f0){var _0x2de6da=_0x3bfa06;if(!this['show'])return;if(_0x8226f0['mode']!==Cesium$6['SceneMode']['SCENE3D'])return;!Cesium$6['defined'](this['commandToExecute'])&&(this['commandToExecute']=this['createCommand'](_0x8226f0['context'])),Cesium$6[_0x2de6da(0x1c0)](this[_0x2de6da(0x218)])&&this['preExecute'](),Cesium$6['defined'](this[_0x2de6da(0x24e)])&&_0x8226f0['commandList']['push'](this['clearCommand']),_0x8226f0['commandList']['push'](this[_0x2de6da(0x206)]);}},{'key':'isDestroyed','value':function _0x1a841d(){return![];}},{'key':'destroy','value':function _0x5e397d(){var _0x220518=_0x3bfa06;if(this[_0x220518(0x24e)]){var _0x4d1f50,_0xe88c66;(_0x4d1f50=this['clearCommand'])!==null&&_0x4d1f50!==void 0x0&&_0x4d1f50['vertexArray']&&this['clearCommand']['vertexArray']['destroy'](),(_0xe88c66=this['clearCommand'])!==null&&_0xe88c66!==void 0x0&&_0xe88c66['shaderProgram']&&this[_0x220518(0x24e)][_0x220518(0x172)]['destroy'](),delete this['clearCommand'];}return this['commandToExecute']&&(this['commandToExecute']['vertexArray']&&this['commandToExecute'][_0x220518(0x1f3)][_0x220518(0x23d)](),this[_0x220518(0x206)]['shaderProgram']&&this['commandToExecute']['shaderProgram']['destroy'](),delete this['commandToExecute']),Cesium$6['destroyObject'](this);}}]),_0x3d975c;}()),Cesium$5=mars3d__namespace[_0x4e7c89(0x1ed)],Util=(function(){var _0x36fbb5=function _0x5a1042(){var _0x2d8fbf=_0x53f5,_0x4a02b5=new Cesium$5[(_0x2d8fbf(0x1ab))]({'attributes':new Cesium$5['GeometryAttributes']({'position':new Cesium$5[(_0x2d8fbf(0x1e4))]({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5[_0x2d8fbf(0x1c2)]['FLOAT'],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});return _0x4a02b5;},_0x110205=function _0x353019(_0x83bca,_0x96cd63){if(Cesium$5['defined'](_0x96cd63)){var _0x28c745={};_0x28c745['arrayBufferView']=_0x96cd63,_0x83bca['source']=_0x28c745;}var _0x3554fd=new Cesium$5['Texture'](_0x83bca);return _0x3554fd;},_0x7765f1=function _0x159051(_0x57c181,_0x817cb5,_0x55c31c){var _0x484b6a=new Cesium$5['Framebuffer']({'context':_0x57c181,'colorTextures':[_0x817cb5],'depthTexture':_0x55c31c});return _0x484b6a;},_0xf1c271=function _0x266a77(_0x2ff079){var _0x3be7c8=_0x53f5,_0x3b231b=!![],_0x50783c=![],_0x442f4d={'viewport':_0x2ff079['viewport'],'depthTest':_0x2ff079['depthTest'],'depthMask':_0x2ff079['depthMask'],'blending':_0x2ff079['blending']},_0x54125c=Cesium$5['Appearance'][_0x3be7c8(0x1ef)](_0x3b231b,_0x50783c,_0x442f4d);return _0x54125c;},_0x3926b7=function _0x6f1f1b(_0x5de61b){var _0x2c9044=_0x53f5,_0x2c0340={},_0x39a894=Cesium$5[_0x2c9044(0x1b6)]['mod'](_0x5de61b['west'],Cesium$5['Math'][_0x2c9044(0x1c6)]),_0x264ce9=Cesium$5['Math']['mod'](_0x5de61b[_0x2c9044(0x1bb)],Cesium$5['Math'][_0x2c9044(0x1c6)]),_0x40d77c=_0x5de61b[_0x2c9044(0x216)],_0x1cc371,_0x1df790;_0x40d77c>Cesium$5['Math']['THREE_PI_OVER_TWO']?(_0x1cc371=0x0,_0x1df790=Cesium$5['Math']['TWO_PI']):_0x264ce9-_0x39a894<_0x40d77c?(_0x1cc371=_0x39a894,_0x1df790=_0x39a894+_0x40d77c):(_0x1cc371=_0x39a894,_0x1df790=_0x264ce9);_0x2c0340[_0x2c9044(0x175)]={'min':Cesium$5['Math']['toDegrees'](_0x1cc371),'max':Cesium$5[_0x2c9044(0x1b6)]['toDegrees'](_0x1df790)};var _0x3d9a6b=_0x5de61b['south'],_0x591c54=_0x5de61b[_0x2c9044(0x214)],_0x5992c0=_0x5de61b['height'],_0x2a9861=_0x5992c0>Cesium$5['Math']['PI']/0xc?_0x5992c0/0x2:0x0,_0x25c763=Cesium$5['Math']['clampToLatitudeRange'](_0x3d9a6b-_0x2a9861),_0x1b0417=Cesium$5['Math']['clampToLatitudeRange'](_0x591c54+_0x2a9861);return _0x25c763<-Cesium$5['Math']['PI_OVER_THREE']&&(_0x25c763=-Cesium$5['Math']['PI_OVER_TWO']),_0x1b0417>Cesium$5['Math']['PI_OVER_THREE']&&(_0x1b0417=Cesium$5[_0x2c9044(0x1b6)]['PI_OVER_TWO']),_0x2c0340['lat']={'min':Cesium$5['Math']['toDegrees'](_0x25c763),'max':Cesium$5['Math'][_0x2c9044(0x1c8)](_0x1b0417)},_0x2c0340;};return{'getFullscreenQuad':_0x36fbb5,'createTexture':_0x110205,'createFramebuffer':_0x7765f1,'createRawRenderState':_0xf1c271,'viewRectangleToLonLatRange':_0x3926b7};}()),segmentDraw_vert='in\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20normal\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20postProcessingSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0aout\x20float\x20speedNormalization;\x0a\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20\x20\x20float\x20a\x20=\x206378137.0;\x20//\x20Semi-major\x20axis\x0a\x20\x20\x20\x20float\x20b\x20=\x206356752.3142;\x20//\x20Semi-minor\x20axis\x0a\x20\x20\x20\x20float\x20e2\x20=\x206.69437999014e-3;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x0a\x20\x20\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calcProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0,\x20360.0)\x20-\x20180.0;\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0);\x0a\x20\x20\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calcOffset(vec4\x20currentProjectedCoordinate,\x20vec4\x20nextProjectedCoordinate,\x20float\x20offsetSign)\x20{\x0a\x20\x20\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0);\x0a\x20\x20\x20\x20vec2\x20currentXY\x20=\x20(currentProjectedCoordinate.xy\x20/\x20currentProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x20\x20\x20\x20vec2\x20nextXY\x20=\x20(nextProjectedCoordinate.xy\x20/\x20nextProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0;\x0a\x20\x20\x20\x20vec2\x20direction\x20=\x20normalize(nextXY\x20-\x20currentXY);\x0a\x20\x20\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0,\x200.0);\x0a\x20\x20\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20\x20\x20vec4\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex);\x0a\x0a\x20\x20\x20\x20vec4\x20currentProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20vec4\x20nextProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(nextPosition.w\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(nextPosition.xyz);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20float\x20pointToUse\x20=\x20normal.x;\x20//\x20-1\x20is\x20currentProjectedCoordinate\x20and\x20+1\x20is\x20nextProjectedCoordinate\x0a\x20\x20\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20pixelSize\x20*\x20calcOffset(currentProjectedCoordinate,\x20nextProjectedCoordinate,\x20offsetSign);\x0a\x20\x20\x20\x20if\x20(pointToUse\x20<\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20currentProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20nextProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20speedNormalization\x20=\x20texture(postProcessingSpeed,\x20particleIndex).a;\x0a}\x0a',segmentDraw_frag='uniform\x20sampler2D\x20colorTable;\x0a\x0ain\x20float\x20speedNormalization;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x200.0));\x0a}\x0a',fullscreen_vert='in\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(position,\x201.0);\x0a}\x0a',trailDraw_frag=_0x4e7c89(0x1c9),screenDraw_frag=_0x4e7c89(0x1fb),Cesium$4=mars3d__namespace['Cesium'],ParticlesRendering=(function(){function _0x29996d(_0x10def8,_0x335153,_0x24ad4a,_0x3b239e,_0x248fff){var _0x508614=_0x53f5;_classCallCheck(this,_0x29996d),this[_0x508614(0x201)](_0x10def8,_0x335153,_0x24ad4a['colors']),this[_0x508614(0x187)](_0x10def8),this[_0x508614(0x23a)](_0x10def8,_0x24ad4a,_0x3b239e,_0x248fff);}return _createClass(_0x29996d,[{'key':'createRenderingTextures','value':function _0x323113(_0x226009,_0x1cb9e7,_0x1b17f9){var _0x387d76=_0x53f5,_0x539174={'context':_0x226009,'width':_0x226009['drawingBufferWidth'],'height':_0x226009['drawingBufferHeight'],'pixelFormat':Cesium$4['PixelFormat'][_0x387d76(0x25b)],'pixelDatatype':Cesium$4[_0x387d76(0x1b9)][_0x387d76(0x21d)]},_0x2b40b7={'context':_0x226009,'width':_0x226009['drawingBufferWidth'],'height':_0x226009['drawingBufferHeight'],'pixelFormat':Cesium$4['PixelFormat']['DEPTH_COMPONENT'],'pixelDatatype':Cesium$4['PixelDatatype']['UNSIGNED_INT']},_0x6ec8d2=_0x1b17f9['length'],_0x47d3bc=new Float32Array(_0x6ec8d2*0x3);for(var _0x2bdf88=0x0;_0x2bdf88<_0x6ec8d2;_0x2bdf88++){var _0x446118=Cesium$4[_0x387d76(0x198)]['fromCssColorString'](_0x1b17f9[_0x2bdf88]);_0x47d3bc[0x3*_0x2bdf88]=_0x446118[_0x387d76(0x235)],_0x47d3bc[0x3*_0x2bdf88+0x1]=_0x446118['green'],_0x47d3bc[0x3*_0x2bdf88+0x2]=_0x446118['blue'];}var _0x517604={'context':_0x226009,'width':_0x6ec8d2,'height':0x1,'pixelFormat':Cesium$4['PixelFormat']['RGB'],'pixelDatatype':Cesium$4['PixelDatatype'][_0x387d76(0x1fe)],'sampler':new Cesium$4[(_0x387d76(0x190))]({'minificationFilter':Cesium$4['TextureMinificationFilter']['LINEAR'],'magnificationFilter':Cesium$4['TextureMagnificationFilter']['LINEAR']})};this['textures']={'segmentsColor':Util['createTexture'](_0x539174),'segmentsDepth':Util[_0x387d76(0x21c)](_0x2b40b7),'currentTrailsColor':Util[_0x387d76(0x21c)](_0x539174),'currentTrailsDepth':Util[_0x387d76(0x21c)](_0x2b40b7),'nextTrailsColor':Util['createTexture'](_0x539174),'nextTrailsDepth':Util[_0x387d76(0x21c)](_0x2b40b7),'colorTable':Util['createTexture'](_0x517604,_0x47d3bc)};}},{'key':'createRenderingFramebuffers','value':function _0x1188cd(_0x462171){var _0x25db7d=_0x53f5;this[_0x25db7d(0x1e8)]={'segments':Util['createFramebuffer'](_0x462171,this['textures'][_0x25db7d(0x1f9)],this['textures'][_0x25db7d(0x259)]),'currentTrails':Util['createFramebuffer'](_0x462171,this[_0x25db7d(0x1ad)]['currentTrailsColor'],this['textures']['currentTrailsDepth']),'nextTrails':Util['createFramebuffer'](_0x462171,this['textures']['nextTrailsColor'],this[_0x25db7d(0x1ad)]['nextTrailsDepth'])};}},{'key':'createSegmentsGeometry','value':function _0x166f39(_0xef96c6){var _0x251693=_0x53f5,_0x58ba0f=0x4,_0x272010=[];for(var _0x100a45=0x0;_0x100a45<_0xef96c6[_0x251693(0x232)];_0x100a45++){for(var _0x18b20c=0x0;_0x18b20c<_0xef96c6['particlesTextureSize'];_0x18b20c++){for(var _0x36d480=0x0;_0x36d480<_0x58ba0f;_0x36d480++){_0x272010[_0x251693(0x229)](_0x100a45/_0xef96c6[_0x251693(0x232)]),_0x272010[_0x251693(0x229)](_0x18b20c/_0xef96c6['particlesTextureSize']);}}}_0x272010=new Float32Array(_0x272010);var _0x58d714=[],_0x4ad5d5=[-0x1,0x1],_0x56b8f5=[-0x1,0x1];for(var _0x2690a2=0x0;_0x2690a2<_0xef96c6[_0x251693(0x23f)];_0x2690a2++){for(var _0x292363=0x0;_0x292363<_0x58ba0f/0x2;_0x292363++){for(var _0x1fa598=0x0;_0x1fa598<_0x58ba0f/0x2;_0x1fa598++){_0x58d714['push'](_0x4ad5d5[_0x292363]),_0x58d714['push'](_0x56b8f5[_0x1fa598]),_0x58d714['push'](0x0);}}}_0x58d714=new Float32Array(_0x58d714);var _0xbec510=0x6*_0xef96c6['maxParticles'],_0x3928a8=new Uint32Array(_0xbec510);for(var _0x430fc5=0x0,_0x4456a3=0x0,_0x3304e8=0x0;_0x430fc5<_0xef96c6['maxParticles'];_0x430fc5++){_0x3928a8[_0x4456a3++]=_0x3304e8+0x0,_0x3928a8[_0x4456a3++]=_0x3304e8+0x1,_0x3928a8[_0x4456a3++]=_0x3304e8+0x2,_0x3928a8[_0x4456a3++]=_0x3304e8+0x2,_0x3928a8[_0x4456a3++]=_0x3304e8+0x1,_0x3928a8[_0x4456a3++]=_0x3304e8+0x3,_0x3304e8+=0x4;}var _0x85b462=new Cesium$4['Geometry']({'attributes':new Cesium$4['GeometryAttributes']({'st':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':_0x272010}),'normal':new Cesium$4[(_0x251693(0x1e4))]({'componentDatatype':Cesium$4['ComponentDatatype'][_0x251693(0x1fe)],'componentsPerAttribute':0x3,'values':_0x58d714})}),'indices':_0x3928a8});return _0x85b462;}},{'key':'createRenderingPrimitives','value':function _0x3a0b46(_0x263938,_0x583230,_0x320011,_0x90d6c2){var _0x1b6b32=_0x53f5,_0x3710ce=this;this['primitives']={'segments':new CustomPrimitive({'commandType':_0x1b6b32(0x19e),'attributeLocations':{'st':0x0,'normal':0x1},'geometry':this['createSegmentsGeometry'](_0x583230),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'currentParticlesPosition':function _0x948e5(){var _0x44d89d=_0x1b6b32;return _0x90d6c2[_0x44d89d(0x1d4)][_0x44d89d(0x230)];},'postProcessingPosition':function _0x2fb55b(){var _0xdbe064=_0x1b6b32;return _0x90d6c2[_0xdbe064(0x1d4)]['postProcessingPosition'];},'postProcessingSpeed':function _0x188120(){return _0x90d6c2['particlesTextures']['postProcessingSpeed'];},'colorTable':function _0x5d0319(){var _0x50ce14=_0x1b6b32;return _0x3710ce[_0x50ce14(0x1ad)]['colorTable'];},'aspect':function _0x47c265(){var _0x11b395=_0x1b6b32;return _0x263938[_0x11b395(0x249)]/_0x263938[_0x11b395(0x221)];},'pixelSize':function _0x2f6844(){return _0x320011['pixelSize'];},'lineWidth':function _0x28aaf6(){return _0x583230['lineWidth'];},'particleHeight':function _0x39a88b(){return _0x583230['particleHeight'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_frag]}),'rawRenderState':Util[_0x1b6b32(0x17c)]({'viewport':undefined,'depthTest':{'enabled':!![]},'depthMask':!![]}),'framebuffer':this['framebuffers']['segments'],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4[_0x1b6b32(0x20b)][_0x1b6b32(0x1fd)],'uniformMap':{'segmentsColorTexture':function _0x37daed(){return _0x3710ce['textures']['segmentsColor'];},'segmentsDepthTexture':function _0x10d47f(){return _0x3710ce['textures']['segmentsDepth'];},'currentTrailsColor':function _0x308abe(){var _0x15d2ef=_0x1b6b32;return _0x3710ce['framebuffers']['currentTrails'][_0x15d2ef(0x1a3)](0x0);},'trailsDepthTexture':function _0x41c62d(){return _0x3710ce['framebuffers']['currentTrails']['depthTexture'];},'fadeOpacity':function _0x35a46d(){return _0x583230['fadeOpacity'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'defines':[_0x1b6b32(0x22b)],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4[(_0x1b6b32(0x21a))]({'defines':['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],'sources':[trailDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4['DepthFunction']['ALWAYS']},'depthMask':!![]}),'framebuffer':this[_0x1b6b32(0x1e8)]['nextTrails'],'autoClear':!![],'preExecute':function _0x281665(){var _0x934e57=_0x1b6b32,_0x83289=_0x3710ce['framebuffers']['currentTrails'];_0x3710ce[_0x934e57(0x1e8)]['currentTrails']=_0x3710ce['framebuffers'][_0x934e57(0x1b5)],_0x3710ce['framebuffers']['nextTrails']=_0x83289,_0x3710ce[_0x934e57(0x196)]['trails'][_0x934e57(0x206)][_0x934e57(0x213)]=_0x3710ce['framebuffers']['nextTrails'],_0x3710ce[_0x934e57(0x196)]['trails']['clearCommand']['framebuffer']=_0x3710ce['framebuffers'][_0x934e57(0x1b5)];}}),'screen':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4[_0x1b6b32(0x20b)]['TRIANGLES'],'uniformMap':{'trailsColorTexture':function _0x3167a9(){var _0xab95c4=_0x1b6b32;return _0x3710ce['framebuffers'][_0xab95c4(0x1b5)]['getColorTexture'](0x0);},'trailsDepthTexture':function _0x33d24a(){var _0x541670=_0x1b6b32;return _0x3710ce['framebuffers'][_0x541670(0x1b5)]['depthTexture'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_GL_POSITION_LOG_DEPTH'],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4[(_0x1b6b32(0x21a))]({'defines':['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],'sources':[screenDraw_frag]}),'rawRenderState':Util[_0x1b6b32(0x17c)]({'viewport':undefined,'depthTest':{'enabled':![]},'depthMask':!![],'blending':{'enabled':!![]}}),'framebuffer':undefined})};}}]),_0x29996d;}()),getWind_frag=_0x4e7c89(0x17e),updateSpeed_frag='uniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0auniform\x20sampler2D\x20particlesWind;\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20speedFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec3\x20percent\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20\x20\x20float\x20normalization\x20=\x20length(percent);\x0a\x0a\x20\x20\x20\x20return\x20normalization;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20//\x20vec3\x20currentSpeed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20texture(particlesWind,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20vec4(speedFactor\x20*\x20pixelSize\x20*\x20windVector,\x20calculateWindNorm(windVector));\x0a\x20\x20\x20\x20out_FragColor\x20=\x20nextSpeed;\x0a}\x0a',updatePosition_frag='uniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20\x20\x20float\x20term1\x20=\x20111132.92;\x0a\x20\x20\x20\x20float\x20term2\x20=\x20559.82\x20*\x20cos(2.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term3\x20=\x201.175\x20*\x20cos(4.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term4\x20=\x200.0023\x20*\x20cos(6.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20\x20\x20float\x20term5\x20=\x20111412.84\x20*\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20term6\x20=\x2093.5\x20*\x20cos(3.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term7\x20=\x200.118\x20*\x20cos(5.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avoid\x20updatePosition(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20windVectorInLonLatLev;\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20speed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20updatePosition(lonLatLev,\x20speed);\x0a}\x0a',postProcessingPosition_frag=_0x4e7c89(0x252),postProcessingSpeed_frag=_0x4e7c89(0x1d6),Cesium$3=mars3d__namespace['Cesium'],ParticlesComputing=(function(){var _0x41ba09=_0x4e7c89;function _0x2519a4(_0x1d41d5,_0x1db144,_0x813486,_0x574429){var _0x1e0587=_0x53f5;_classCallCheck(this,_0x2519a4),this[_0x1e0587(0x1b7)]=_0x1db144,this[_0x1e0587(0x207)](_0x1d41d5,_0x1db144),this['createParticlesTextures'](_0x1d41d5,_0x813486,_0x574429),this['createComputingPrimitives'](_0x1db144,_0x813486,_0x574429);}return _createClass(_0x2519a4,[{'key':_0x41ba09(0x207),'value':function _0x9dbcba(_0x24cd41,_0x3de7b7){var _0xf2d5a8=_0x41ba09,_0x414336={'context':_0x24cd41,'width':_0x3de7b7['dimensions']['lon'],'height':_0x3de7b7[_0xf2d5a8(0x1c3)][_0xf2d5a8(0x1b0)]*(_0x3de7b7['dimensions'][_0xf2d5a8(0x238)]||0x1),'pixelFormat':Cesium$3[_0xf2d5a8(0x1db)]['LUMINANCE'],'pixelDatatype':Cesium$3['PixelDatatype'][_0xf2d5a8(0x1fe)],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3[_0xf2d5a8(0x1e1)][_0xf2d5a8(0x1a2)]})};this[_0xf2d5a8(0x1d5)]={'U':Util['createTexture'](_0x414336,_0x3de7b7['U'][_0xf2d5a8(0x16e)]),'V':Util['createTexture'](_0x414336,_0x3de7b7['V']['array'])};}},{'key':'createParticlesTextures','value':function _0x5b93cf(_0x292435,_0x3d14fc,_0x2d0e06){var _0x3c236a=_0x41ba09,_0x17e79a={'context':_0x292435,'width':_0x3d14fc['particlesTextureSize'],'height':_0x3d14fc[_0x3c236a(0x232)],'pixelFormat':Cesium$3['PixelFormat']['RGBA'],'pixelDatatype':Cesium$3[_0x3c236a(0x1b9)]['FLOAT'],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3[_0x3c236a(0x23e)][_0x3c236a(0x1a2)],'magnificationFilter':Cesium$3[_0x3c236a(0x1e1)]['NEAREST']})},_0x5694c8=this[_0x3c236a(0x223)](_0x3d14fc[_0x3c236a(0x23f)],_0x2d0e06),_0x33c607=new Float32Array(0x4*_0x3d14fc['maxParticles'])['fill'](0x0);this['particlesTextures']={'particlesWind':Util['createTexture'](_0x17e79a),'currentParticlesPosition':Util['createTexture'](_0x17e79a,_0x5694c8),'nextParticlesPosition':Util[_0x3c236a(0x21c)](_0x17e79a,_0x5694c8),'currentParticlesSpeed':Util['createTexture'](_0x17e79a,_0x33c607),'nextParticlesSpeed':Util[_0x3c236a(0x21c)](_0x17e79a,_0x33c607),'postProcessingPosition':Util['createTexture'](_0x17e79a,_0x5694c8),'postProcessingSpeed':Util['createTexture'](_0x17e79a,_0x33c607)};}},{'key':'randomizeParticles','value':function _0x40790d(_0x3fb0bb,_0x47c6c8){var _0x515312=_0x41ba09,_0x4a54c8=new Float32Array(0x4*_0x3fb0bb);for(var _0x5939d6=0x0;_0x5939d6<_0x3fb0bb;_0x5939d6++){_0x4a54c8[0x4*_0x5939d6]=Cesium$3['Math']['randomBetween'](_0x47c6c8['lonRange']['x'],_0x47c6c8['lonRange']['y']),_0x4a54c8[0x4*_0x5939d6+0x1]=Cesium$3['Math']['randomBetween'](_0x47c6c8['latRange']['x'],_0x47c6c8['latRange']['y']),_0x4a54c8[0x4*_0x5939d6+0x2]=Cesium$3['Math']['randomBetween'](this[_0x515312(0x1b7)]['lev']['min'],this['data']['lev'][_0x515312(0x260)]),_0x4a54c8[0x4*_0x5939d6+0x3]=0x0;}return _0x4a54c8;}},{'key':'destroyParticlesTextures','value':function _0x1746e5(){var _0x5653e0=_0x41ba09,_0x3315f6=this;Object[_0x5653e0(0x209)](this['particlesTextures'])['forEach'](function(_0x3ea090){var _0x173a09=_0x5653e0;_0x3315f6[_0x173a09(0x1d4)][_0x3ea090]['destroy']();});}},{'key':'createComputingPrimitives','value':function _0x597359(_0x348e68,_0x32b537,_0x32a442){var _0x3e6a5e=_0x41ba09,_0x2f1bd3=new Cesium$3[(_0x3e6a5e(0x1e2))](_0x348e68[_0x3e6a5e(0x1c3)]['lon'],_0x348e68['dimensions']['lat'],_0x348e68['dimensions']['lev']),_0x36c336=new Cesium$3['Cartesian3'](_0x348e68[_0x3e6a5e(0x175)]['min'],_0x348e68['lat']['min'],_0x348e68['lev'][_0x3e6a5e(0x1f1)]),_0x57e92e=new Cesium$3['Cartesian3'](_0x348e68['lon'][_0x3e6a5e(0x260)],_0x348e68['lat']['max'],_0x348e68['lev']['max']),_0x57966f=new Cesium$3['Cartesian3']((_0x57e92e['x']-_0x36c336['x'])/(_0x2f1bd3['x']-0x1),(_0x57e92e['y']-_0x36c336['y'])/(_0x2f1bd3['y']-0x1),_0x2f1bd3['z']>0x1?(_0x57e92e['z']-_0x36c336['z'])/(_0x2f1bd3['z']-0x1):0x1),_0x177abc=new Cesium$3[(_0x3e6a5e(0x1f5))](_0x348e68['U']['min'],_0x348e68['U'][_0x3e6a5e(0x260)]),_0x2076c2=new Cesium$3['Cartesian2'](_0x348e68['V']['min'],_0x348e68['V'][_0x3e6a5e(0x260)]),_0x59c522=this;this['primitives']={'getWind':new CustomPrimitive({'commandType':_0x3e6a5e(0x210),'uniformMap':{'U':function _0x18494a(){var _0x4ee4cd=_0x3e6a5e;return _0x59c522[_0x4ee4cd(0x1d5)]['U'];},'V':function _0x5528aa(){return _0x59c522['windTextures']['V'];},'currentParticlesPosition':function _0x5a25b5(){return _0x59c522['particlesTextures']['currentParticlesPosition'];},'dimension':function _0x2162cd(){return _0x2f1bd3;},'minimum':function _0x28b7a4(){return _0x36c336;},'maximum':function _0xdf449e(){return _0x57e92e;},'interval':function _0x177ec4(){return _0x57966f;}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[getWind_frag]}),'outputTexture':this['particlesTextures']['particlesWind'],'preExecute':function _0x11654b(){var _0x30927d=_0x3e6a5e;_0x59c522[_0x30927d(0x196)][_0x30927d(0x1dc)]['commandToExecute']['outputTexture']=_0x59c522['particlesTextures'][_0x30927d(0x211)];}}),'updateSpeed':new CustomPrimitive({'commandType':_0x3e6a5e(0x210),'uniformMap':{'currentParticlesSpeed':function _0x1b687e(){var _0x5e3111=_0x3e6a5e;return _0x59c522[_0x5e3111(0x1d4)][_0x5e3111(0x170)];},'particlesWind':function _0x3a4d9b(){return _0x59c522['particlesTextures']['particlesWind'];},'uSpeedRange':function _0x46bb4d(){return _0x177abc;},'vSpeedRange':function _0x47c90d(){return _0x2076c2;},'pixelSize':function _0x5a0ca3(){return _0x32a442['pixelSize'];},'speedFactor':function _0x4f474b(){return _0x32b537['speedFactor'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[updateSpeed_frag]}),'outputTexture':this[_0x3e6a5e(0x1d4)]['nextParticlesSpeed'],'preExecute':function _0x467328(){var _0xcebf65=_0x3e6a5e,_0x542098=_0x59c522[_0xcebf65(0x1d4)][_0xcebf65(0x170)];_0x59c522['particlesTextures']['currentParticlesSpeed']=_0x59c522['particlesTextures']['postProcessingSpeed'],_0x59c522[_0xcebf65(0x1d4)][_0xcebf65(0x1a8)]=_0x542098,_0x59c522['primitives']['updateSpeed']['commandToExecute']['outputTexture']=_0x59c522['particlesTextures']['nextParticlesSpeed'];}}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':function _0x434ad6(){return _0x59c522['particlesTextures']['currentParticlesPosition'];},'currentParticlesSpeed':function _0x53f9fd(){return _0x59c522['particlesTextures']['currentParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[updatePosition_frag]}),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':function _0x3fa503(){var _0xb8d605=_0x3e6a5e,_0x8f4c78=_0x59c522['particlesTextures']['currentParticlesPosition'];_0x59c522[_0xb8d605(0x1d4)][_0xb8d605(0x230)]=_0x59c522['particlesTextures']['postProcessingPosition'],_0x59c522['particlesTextures'][_0xb8d605(0x255)]=_0x8f4c78,_0x59c522['primitives']['updatePosition']['commandToExecute']['outputTexture']=_0x59c522['particlesTextures']['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':_0x3e6a5e(0x210),'uniformMap':{'nextParticlesPosition':function _0x79c0ef(){var _0x1b2f4e=_0x3e6a5e;return _0x59c522['particlesTextures'][_0x1b2f4e(0x220)];},'nextParticlesSpeed':function _0x4531c7(){return _0x59c522['particlesTextures']['nextParticlesSpeed'];},'lonRange':function _0x33baa4(){return _0x32a442['lonRange'];},'latRange':function _0x17c58c(){return _0x32a442['latRange'];},'randomCoefficient':function _0xf6853(){var _0x3db8b4=Math['random']();return _0x3db8b4;},'dropRate':function _0x1c92a0(){var _0x5ffbcd=_0x3e6a5e;return _0x32b537[_0x5ffbcd(0x173)];},'dropRateBump':function _0x115636(){var _0x329ee7=_0x3e6a5e;return _0x32b537[_0x329ee7(0x1a4)];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[postProcessingPosition_frag]}),'outputTexture':this['particlesTextures']['postProcessingPosition'],'preExecute':function _0x1c9ad2(){var _0x12d1b7=_0x3e6a5e;_0x59c522['primitives']['postProcessingPosition']['commandToExecute'][_0x12d1b7(0x18a)]=_0x59c522['particlesTextures']['postProcessingPosition'];}}),'postProcessingSpeed':new CustomPrimitive({'commandType':_0x3e6a5e(0x210),'uniformMap':{'postProcessingPosition':function _0x23330e(){var _0x3eccc0=_0x3e6a5e;return _0x59c522[_0x3eccc0(0x1d4)][_0x3eccc0(0x255)];},'nextParticlesSpeed':function _0x4c20c1(){return _0x59c522['particlesTextures']['nextParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[postProcessingSpeed_frag]}),'outputTexture':this['particlesTextures']['postProcessingSpeed'],'preExecute':function _0x750e1e(){var _0x51c0c5=_0x3e6a5e;_0x59c522['primitives']['postProcessingSpeed']['commandToExecute'][_0x51c0c5(0x18a)]=_0x59c522['particlesTextures'][_0x51c0c5(0x1a8)];}})};}}]),_0x2519a4;}()),Cesium$2=mars3d__namespace[_0x4e7c89(0x1ed)],ParticleSystem=(function(){var _0x5e6ec2=_0x4e7c89;function _0x34a963(_0x21dbda,_0x5de8ac,_0xb12660,_0x22d043){var _0xb7d1dd=_0x53f5;_classCallCheck(this,_0x34a963),this[_0xb7d1dd(0x1e5)]=_0x21dbda,_0x5de8ac=_objectSpread2({},_0x5de8ac);if(_0x5de8ac['udata']&&_0x5de8ac['vdata']){var _0x16a39a,_0x43ac0c,_0xfd1618,_0x10c41b,_0x3840a8,_0x403736;_0x5de8ac['dimensions']={},_0x5de8ac['dimensions']['lon']=_0x5de8ac['cols'],_0x5de8ac['dimensions']['lat']=_0x5de8ac['rows'],_0x5de8ac['dimensions']['lev']=_0x5de8ac['lev']||0x1,_0x5de8ac[_0xb7d1dd(0x175)]={},_0x5de8ac[_0xb7d1dd(0x175)]['min']=_0x5de8ac['xmin'],_0x5de8ac[_0xb7d1dd(0x175)][_0xb7d1dd(0x260)]=_0x5de8ac['xmax'],_0x5de8ac['lat']={},_0x5de8ac['lat']['min']=_0x5de8ac['ymin'],_0x5de8ac['lat']['max']=_0x5de8ac['ymax'],_0x5de8ac['lev']={},_0x5de8ac['lev']['min']=(_0x16a39a=_0x5de8ac['levmin'])!==null&&_0x16a39a!==void 0x0?_0x16a39a:0x1,_0x5de8ac[_0xb7d1dd(0x238)]['max']=(_0x43ac0c=_0x5de8ac[_0xb7d1dd(0x1bf)])!==null&&_0x43ac0c!==void 0x0?_0x43ac0c:0x1,_0x5de8ac['U']={},_0x5de8ac['U']['array']=new Float32Array(_0x5de8ac[_0xb7d1dd(0x245)]),_0x5de8ac['U']['min']=(_0xfd1618=_0x5de8ac[_0xb7d1dd(0x16d)])!==null&&_0xfd1618!==void 0x0?_0xfd1618:Math['min']['apply'](Math,_toConsumableArray(_0x5de8ac[_0xb7d1dd(0x245)])),_0x5de8ac['U']['max']=(_0x10c41b=_0x5de8ac[_0xb7d1dd(0x246)])!==null&&_0x10c41b!==void 0x0?_0x10c41b:Math['max']['apply'](Math,_toConsumableArray(_0x5de8ac['udata'])),_0x5de8ac['V']={},_0x5de8ac['V']['array']=new Float32Array(_0x5de8ac[_0xb7d1dd(0x241)]),_0x5de8ac['V']['min']=(_0x3840a8=_0x5de8ac['vmin'])!==null&&_0x3840a8!==void 0x0?_0x3840a8:Math['min']['apply'](Math,_toConsumableArray(_0x5de8ac['vdata'])),_0x5de8ac['V']['max']=(_0x403736=_0x5de8ac['vmax'])!==null&&_0x403736!==void 0x0?_0x403736:Math['max']['apply'](Math,_toConsumableArray(_0x5de8ac[_0xb7d1dd(0x241)]));}this['data']=_0x5de8ac,this['options']=_0xb12660,this[_0xb7d1dd(0x1cb)]=_0x22d043,this['particlesComputing']=new ParticlesComputing(this[_0xb7d1dd(0x1e5)],this['data'],this['options'],this['viewerParameters']),this['particlesRendering']=new ParticlesRendering(this['context'],this['data'],this['options'],this[_0xb7d1dd(0x1cb)],this['particlesComputing']);}return _createClass(_0x34a963,[{'key':'canvasResize','value':function _0x136b9a(_0x26d1d8){var _0x8a1bf4=_0x53f5,_0xa39d31=this;this['particlesComputing'][_0x8a1bf4(0x225)](),Object[_0x8a1bf4(0x209)](this[_0x8a1bf4(0x203)]['windTextures'])['forEach'](function(_0x1c296e){var _0x5b1074=_0x8a1bf4;_0xa39d31[_0x5b1074(0x203)][_0x5b1074(0x1d5)][_0x1c296e]['destroy']();}),this['particlesRendering'][_0x8a1bf4(0x1ad)]['colorTable']['destroy'](),Object[_0x8a1bf4(0x209)](this['particlesRendering']['framebuffers'])['forEach'](function(_0x3db0b2){var _0x4dcf7c=_0x8a1bf4;_0xa39d31[_0x4dcf7c(0x25e)][_0x4dcf7c(0x1e8)][_0x3db0b2][_0x4dcf7c(0x23d)]();}),this['context']=_0x26d1d8,this[_0x8a1bf4(0x203)]=new ParticlesComputing(this[_0x8a1bf4(0x1e5)],this[_0x8a1bf4(0x1b7)],this['options'],this['viewerParameters']),this[_0x8a1bf4(0x25e)]=new ParticlesRendering(this['context'],this[_0x8a1bf4(0x1b7)],this['options'],this['viewerParameters'],this['particlesComputing']);}},{'key':'clearFramebuffers','value':function _0x19a443(){var _0x4a7c2b=_0x53f5,_0x5b2e67=this,_0x8cde2e=new Cesium$2[(_0x4a7c2b(0x1ff))]({'color':new Cesium$2['Color'](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2['Pass']['OPAQUE']});Object['keys'](this['particlesRendering']['framebuffers'])['forEach'](function(_0x26fb88){var _0x892290=_0x4a7c2b;_0x8cde2e['framebuffer']=_0x5b2e67[_0x892290(0x25e)]['framebuffers'][_0x26fb88],_0x8cde2e['execute'](_0x5b2e67['context']);});}},{'key':'refreshParticles','value':function _0x5caddd(_0xe737ae){var _0xc574b8=_0x53f5;this[_0xc574b8(0x1de)](),this['particlesComputing']['destroyParticlesTextures'](),this['particlesComputing']['createParticlesTextures'](this[_0xc574b8(0x1e5)],this['options'],this['viewerParameters']);if(_0xe737ae){var _0x52921a=this['particlesRendering']['createSegmentsGeometry'](this['options']);this['particlesRendering']['primitives']['segments']['geometry']=_0x52921a;var _0x274841=Cesium$2['VertexArray']['fromGeometry']({'context':this['context'],'geometry':_0x52921a,'attributeLocations':this[_0xc574b8(0x25e)]['primitives']['segments']['attributeLocations'],'bufferUsage':Cesium$2['BufferUsage']['STATIC_DRAW']});this[_0xc574b8(0x25e)]['primitives'][_0xc574b8(0x1d9)]['commandToExecute']['vertexArray']=_0x274841;}}},{'key':'setOptions','value':function _0x210f15(_0x5f015d){var _0x711e5a=this,_0x1e2f0a=![];this['options']['maxParticles']!==_0x5f015d['maxParticles']&&(_0x1e2f0a=!![]),Object['keys'](_0x5f015d)['forEach'](function(_0x4233a8){_0x711e5a['options'][_0x4233a8]=_0x5f015d[_0x4233a8];}),this['refreshParticles'](_0x1e2f0a);}},{'key':_0x5e6ec2(0x24c),'value':function _0x2c8514(_0x31005c){var _0x16511e=_0x5e6ec2,_0x44678d=this;Object['keys'](_0x31005c)[_0x16511e(0x1dd)](function(_0x17e23b){_0x44678d['viewerParameters'][_0x17e23b]=_0x31005c[_0x17e23b];}),this['refreshParticles'](![]);}},{'key':'destroy','value':function _0x5eccd(){var _0x2a9561=_0x5e6ec2,_0x400918=this;clearTimeout(this['canrefresh']),this[_0x2a9561(0x203)][_0x2a9561(0x225)](),Object['keys'](this['particlesComputing'][_0x2a9561(0x1d5)])[_0x2a9561(0x1dd)](function(_0x36ba0f){_0x400918['particlesComputing']['windTextures'][_0x36ba0f]['destroy']();}),this['particlesRendering']['textures']['colorTable'][_0x2a9561(0x23d)](),Object[_0x2a9561(0x209)](this[_0x2a9561(0x25e)]['framebuffers'])['forEach'](function(_0x261c4f){_0x400918['particlesRendering']['framebuffers'][_0x261c4f]['destroy']();});for(var _0x472b76 in this){delete this[_0x472b76];}}}]),_0x34a963;}()),Cesium$1=mars3d__namespace[_0x4e7c89(0x1ed)],BaseLayer$1=mars3d__namespace[_0x4e7c89(0x217)]['BaseLayer'],DEF_OPTIONS={'particlesNumber':0x1000,'fixedHeight':0x0,'fadeOpacity':0.996,'dropRate':0.003,'dropRateBump':0.01,'speedFactor':0.5,'lineWidth':0x2,'colors':[_0x4e7c89(0x228)]},WindLayer=function(_0xd3ec2c){var _0xc6732f=_0x4e7c89;_inherits(_0xc98ab,_0xd3ec2c);var _0x141a81=_createSuper(_0xc98ab);function _0xc98ab(){var _0x1ce560,_0x2ebd65=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0xc98ab),_0x2ebd65=_objectSpread2(_objectSpread2({},DEF_OPTIONS),_0x2ebd65),_0x1ce560=_0x141a81['call'](this,_0x2ebd65),_0x1ce560['_setOptionsHook'](_0x2ebd65),_0x1ce560;}return _createClass(_0xc98ab,[{'key':'layer','get':function _0x2c88e9(){return this['primitives'];}},{'key':'data','get':function _0x49e840(){return this['_data'];},'set':function _0x16071d(_0xb753f4){this['setData'](_0xb753f4);}},{'key':'colors','get':function _0x4c0715(){return this['options']['colors'];},'set':function _0x5e9fa4(_0x3435ea){var _0x429909=_0x53f5;this['options']['colors']=_0x3435ea,this['particleSystem']&&this[_0x429909(0x1ca)]['setOptions']({'colors':_0x3435ea}),this['resize']();}},{'key':'_mountedHook','value':function _0x1d4d95(){}},{'key':'_addedHook','value':function _0x46442b(){var _0x2a17cb=_0x53f5;this['scene']=this['_map']['scene'],this[_0x2a17cb(0x19d)]=this['_map']['camera'],this['primitives']=new Cesium$1[(_0x2a17cb(0x171))](),this['_map']['scene'][_0x2a17cb(0x196)][_0x2a17cb(0x202)](this['primitives']),this['viewerParameters']={'lonRange':new Cesium$1['Cartesian2'](),'latRange':new Cesium$1['Cartesian2'](),'pixelSize':0x0},this['globeBoundingSphere']=new Cesium$1['BoundingSphere'](Cesium$1[_0x2a17cb(0x1e2)][_0x2a17cb(0x22d)],0.99*0x615299),this['updateViewerParameters'](),window['addEventListener'](_0x2a17cb(0x189),this['resize']['bind'](this),![]),this['mouse_down']=![],this['mouse_move']=![],this['_map']['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace[_0x2a17cb(0x21b)][_0x2a17cb(0x250)],this['_onMouseDownEvent'],this),this[_0x2a17cb(0x174)]['on'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this),this[_0x2a17cb(0x174)]['on'](mars3d__namespace['EventType'][_0x2a17cb(0x254)],this['_onMouseMoveEvent'],this),this['_data']&&this[_0x2a17cb(0x212)](this['_data']);}},{'key':_0xc6732f(0x1d3),'value':function _0x11dc3c(){var _0x401376=_0xc6732f;window['removeEventListener']('resize',this[_0x401376(0x189)]),this['_map']['off'](mars3d__namespace[_0x401376(0x21b)]['preRender'],this[_0x401376(0x1ea)],this),this['_map']['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map'][_0x401376(0x257)](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this[_0x401376(0x174)]['off'](mars3d__namespace['EventType'][_0x401376(0x233)],this['_onMouseUpEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this[_0x401376(0x1c5)],this),this['primitives']['removeAll'](),this['_map']['scene'][_0x401376(0x196)]['remove'](this['primitives']);}},{'key':'resize','value':function _0x1ff539(){var _0x44a327=_0xc6732f;if(!this[_0x44a327(0x1a7)]||!this['particleSystem'])return;this['primitives']['show']=![],this['primitives']['removeAll'](),this['_map'][_0x44a327(0x236)](mars3d__namespace['EventType'][_0x44a327(0x19a)],this['_onMap_preRenderEvent'],this);}},{'key':'_onMap_preRenderEvent','value':function _0x4e0fea(_0x2457f0){var _0x45ff8c=_0xc6732f;this[_0x45ff8c(0x1ca)]['canvasResize'](this[_0x45ff8c(0x1c1)]['context']),this['addPrimitives'](),this['primitives']['show']=!![];}},{'key':'_onMapWhellEvent','value':function _0x4e2fbb(_0x31a927){var _0x12e49c=_0xc6732f,_0x152032=this;clearTimeout(this['refreshTimer']);if(!this['show']||!this['particleSystem'])return;this[_0x12e49c(0x196)]['show']=![],this['refreshTimer']=setTimeout(function(){if(!_0x152032['show'])return;_0x152032['redraw']();},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x492a14(_0x5d7c61){var _0x22be83=_0xc6732f;this[_0x22be83(0x1ee)]=!![];}},{'key':'_onMouseMoveEvent','value':function _0x55d570(_0x2ad532){var _0x2ae7e7=_0xc6732f;if(!this[_0x2ae7e7(0x1a7)]||!this[_0x2ae7e7(0x1ca)])return;this[_0x2ae7e7(0x1ee)]&&(this[_0x2ae7e7(0x196)]['show']=![],this['mouse_move']=!![]);}},{'key':_0xc6732f(0x19b),'value':function _0x31c14e(_0x5c3669){if(!this['show']||!this['particleSystem'])return;this['mouse_down']&&this['mouse_move']&&this['redraw'](),this['primitives']['show']=!![],this['mouse_down']=![],this['mouse_move']=![];}},{'key':'redraw','value':function _0x11bebd(){var _0x652d20=_0xc6732f;if(!this[_0x652d20(0x174)]||!this['show'])return;this['updateViewerParameters'](),this['particleSystem'][_0x652d20(0x24c)](this['viewerParameters']),this['primitives'][_0x652d20(0x1a7)]=!![];}},{'key':'setData','value':function _0x5e5c09(_0xe14362){var _0x5ad880=_0xc6732f;this[_0x5ad880(0x231)]=_0xe14362,this[_0x5ad880(0x1ca)]&&this['particleSystem']['destroy'](),this['particleSystem']=new ParticleSystem(this['scene']['context'],_0xe14362,this['getOptions'](),this[_0x5ad880(0x1cb)]),this['addPrimitives']();}},{'key':_0xc6732f(0x242),'value':function _0x38fa0d(_0x5d0a22,_0x5e3b3d){var _0xc15068=_0xc6732f;if(_0x5d0a22)for(var _0x2f5273 in _0x5d0a22){this[_0x2f5273]=_0x5d0a22[_0x2f5273];}this['particleSystem']&&this[_0xc15068(0x1ca)]['setOptions'](this['getOptions']());}},{'key':_0xc6732f(0x1ec),'value':function _0x2444ae(){var _0x686caa=_0xc6732f,_0x350eb8=Math['ceil'](Math['sqrt'](this[_0x686caa(0x20e)]));return this['particlesNumber']=_0x350eb8*_0x350eb8,{'particlesTextureSize':_0x350eb8,'maxParticles':this['particlesNumber'],'particleHeight':this[_0x686caa(0x1af)],'fadeOpacity':this['fadeOpacity'],'dropRate':this['dropRate'],'dropRateBump':this['dropRateBump'],'speedFactor':this['speedFactor'],'lineWidth':this['lineWidth'],'colors':this[_0x686caa(0x1df)]};}},{'key':'addPrimitives','value':function _0x56e4dd(){var _0x425d66=_0xc6732f;this['primitives']['add'](this[_0x425d66(0x1ca)]['particlesComputing']['primitives'][_0x425d66(0x1dc)]),this['primitives']['add'](this['particleSystem'][_0x425d66(0x203)]['primitives']['updateSpeed']),this['primitives']['add'](this['particleSystem']['particlesComputing']['primitives'][_0x425d66(0x208)]),this['primitives']['add'](this['particleSystem'][_0x425d66(0x203)]['primitives']['postProcessingPosition']),this['primitives']['add'](this['particleSystem'][_0x425d66(0x203)]['primitives']['postProcessingSpeed']),this['primitives']['add'](this['particleSystem']['particlesRendering'][_0x425d66(0x196)]['segments']),this['primitives'][_0x425d66(0x202)](this['particleSystem']['particlesRendering'][_0x425d66(0x196)][_0x425d66(0x1c4)]),this[_0x425d66(0x196)][_0x425d66(0x202)](this['particleSystem']['particlesRendering']['primitives']['screen']);}},{'key':'updateViewerParameters','value':function _0x23017e(){var _0x1915a7=_0xc6732f,_0x1b7048=this[_0x1915a7(0x19d)][_0x1915a7(0x184)](this[_0x1915a7(0x1c1)]['globe']['ellipsoid']);if(!_0x1b7048){var _0x48b1a5=this['_map']['getExtent']();_0x1b7048=Cesium$1['Rectangle']['fromDegrees'](_0x48b1a5['xmin'],_0x48b1a5['ymin'],_0x48b1a5['xmax'],_0x48b1a5['ymax']);}var _0x347982=Util['viewRectangleToLonLatRange'](_0x1b7048);this[_0x1915a7(0x1cb)]['lonRange']['x']=_0x347982['lon'][_0x1915a7(0x1f1)],this[_0x1915a7(0x1cb)]['lonRange']['y']=_0x347982['lon']['max'],this['viewerParameters'][_0x1915a7(0x256)]['x']=_0x347982[_0x1915a7(0x1b0)]['min'],this['viewerParameters']['latRange']['y']=_0x347982['lat']['max'];var _0x86ff7b=this[_0x1915a7(0x19d)]['getPixelSize'](this['globeBoundingSphere'],this['scene']['drawingBufferWidth'],this['scene']['drawingBufferHeight']);_0x86ff7b>0x0&&(this['viewerParameters']['pixelSize']=_0x86ff7b);}}]),_0xc98ab;}(BaseLayer$1);mars3d__namespace[_0x4e7c89(0x243)][_0x4e7c89(0x247)]('wind',WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;var CanvasParticle=(function(){function _0x5a391b(){var _0x2851c2=_0x53f5;_classCallCheck(this,_0x5a391b),this['lng']=null,this[_0x2851c2(0x1b0)]=null,this[_0x2851c2(0x24d)]=null,this['tlat']=null,this['age']=null;}return _createClass(_0x5a391b,[{'key':'destroy','value':function _0x476fc5(){for(var _0xfde4e4 in this){delete this[_0xfde4e4];}}}]),_0x5a391b;}()),CanvasWindField=(function(){var _0x559924=_0x4e7c89;function _0x4d076(_0x8e8cec){var _0x2eabcb=_0x53f5;_classCallCheck(this,_0x4d076),this[_0x2eabcb(0x199)](_0x8e8cec);}return _createClass(_0x4d076,[{'key':'speedRate','get':function _0x13282a(){return this['_speedRate'];},'set':function _0xfd72ee(_0x28915b){var _0x24c421=_0x53f5;this['_speedRate']=(0x64-(_0x28915b>0x63?0x63:_0x28915b))*0x64,this['_calc_speedRate']=[(this['xmax']-this[_0x24c421(0x1f6)])/this[_0x24c421(0x193)],(this['ymax']-this[_0x24c421(0x253)])/this['_speedRate']];}},{'key':_0x559924(0x24a),'get':function _0x5e0273(){return this['_maxAge'];},'set':function _0x227e14(_0x57acd4){this['_maxAge']=_0x57acd4;}},{'key':_0x559924(0x199),'value':function _0x22e654(_0x5a5cb3){var _0x353368=_0x559924;this['options']=_0x5a5cb3,this['maxAge']=_0x5a5cb3['maxAge']||0x78,this['speedRate']=_0x5a5cb3['speedRate']||0x32,this[_0x353368(0x222)]=[];var _0x103722=_0x5a5cb3[_0x353368(0x20e)]||0x1000;for(var _0x247ae9=0x0;_0x247ae9<_0x103722;_0x247ae9++){var _0x1dd682=this['_randomParticle'](new CanvasParticle());this[_0x353368(0x222)]['push'](_0x1dd682);}}},{'key':'setDate','value':function _0x309d5d(_0x3985d8){var _0x2ab6d0=_0x559924;this[_0x2ab6d0(0x234)]=_0x3985d8[_0x2ab6d0(0x234)],this[_0x2ab6d0(0x194)]=_0x3985d8[_0x2ab6d0(0x194)],this['xmin']=_0x3985d8[_0x2ab6d0(0x1f6)],this['xmax']=_0x3985d8['xmax'],this['ymin']=_0x3985d8['ymin'],this['ymax']=_0x3985d8[_0x2ab6d0(0x24b)],this[_0x2ab6d0(0x264)]=[];var _0x3688a9=_0x3985d8['udata'],_0x128538=_0x3985d8['vdata'],_0x138609=![];_0x3688a9['length']===this[_0x2ab6d0(0x234)]&&_0x3688a9[0x0]['length']===this['cols']&&(_0x138609=!![]);var _0x13409c=0x0,_0x64edaf=null,_0x4b8169=null;for(var _0x32eb0a=0x0;_0x32eb0a<this['rows'];_0x32eb0a++){_0x64edaf=[];for(var _0x23656e=0x0;_0x23656e<this['cols'];_0x23656e++,_0x13409c++){_0x138609?_0x4b8169=this['_calcUV'](_0x3688a9[_0x32eb0a][_0x23656e],_0x128538[_0x32eb0a][_0x23656e]):_0x4b8169=this['_calcUV'](_0x3688a9[_0x13409c],_0x128538[_0x13409c]),_0x64edaf[_0x2ab6d0(0x229)](_0x4b8169);}this['grid']['push'](_0x64edaf);}this[_0x2ab6d0(0x1a6)]['reverseY']&&this['grid'][_0x2ab6d0(0x176)]();}},{'key':'clear','value':function _0x23c3fd(){var _0x54750a=_0x559924;delete this[_0x54750a(0x234)],delete this['cols'],delete this[_0x54750a(0x1f6)],delete this['xmax'],delete this['ymin'],delete this['ymax'],delete this['grid'],delete this[_0x54750a(0x222)];}},{'key':'toGridXY','value':function _0x4b6954(_0x740c9d,_0x4d1061){var _0x34d022=_0x559924,_0x47948e=(_0x740c9d-this['xmin'])/(this['xmax']-this[_0x34d022(0x1f6)])*(this['cols']-0x1),_0x3e293a=(this['ymax']-_0x4d1061)/(this['ymax']-this['ymin'])*(this['rows']-0x1);return[_0x47948e,_0x3e293a];}},{'key':'getUVByXY','value':function _0x5912f2(_0x2f09c4,_0x5153f6){var _0xfbb7bd=_0x559924;if(_0x2f09c4<0x0||_0x2f09c4>=this['cols']||_0x5153f6>=this['rows'])return[0x0,0x0,0x0];var _0x339e76=Math['floor'](_0x2f09c4),_0x358107=Math['floor'](_0x5153f6);if(_0x339e76===_0x2f09c4&&_0x358107===_0x5153f6)return this['grid'][_0x5153f6][_0x2f09c4];var _0x33c293=_0x339e76+0x1,_0x434f58=_0x358107+0x1,_0xef0b86=this['getUVByXY'](_0x339e76,_0x358107),_0x3391c0=this['getUVByXY'](_0x33c293,_0x358107),_0x342a10=this['getUVByXY'](_0x339e76,_0x434f58),_0x50c2ef=this['getUVByXY'](_0x33c293,_0x434f58),_0x32e425=null;try{_0x32e425=this[_0xfbb7bd(0x21e)](_0x2f09c4-_0x339e76,_0x5153f6-_0x358107,_0xef0b86,_0x3391c0,_0x342a10,_0x50c2ef);}catch(_0x1e1ca8){console['log'](_0x2f09c4,_0x5153f6);}return _0x32e425;}},{'key':'_bilinearInterpolation','value':function _0x321e6c(_0x6b232c,_0x38fed1,_0x58c3d5,_0xd0aaeb,_0x273ddd,_0x54b495){var _0x320bb7=0x1-_0x6b232c,_0x3a99f2=0x1-_0x38fed1,_0x35bbc6=_0x320bb7*_0x3a99f2,_0x357b0d=_0x6b232c*_0x3a99f2,_0x46f1f7=_0x320bb7*_0x38fed1,_0x2492d9=_0x6b232c*_0x38fed1,_0x515d26=_0x58c3d5[0x0]*_0x35bbc6+_0xd0aaeb[0x0]*_0x357b0d+_0x273ddd[0x0]*_0x46f1f7+_0x54b495[0x0]*_0x2492d9,_0x18e1df=_0x58c3d5[0x1]*_0x35bbc6+_0xd0aaeb[0x1]*_0x357b0d+_0x273ddd[0x1]*_0x46f1f7+_0x54b495[0x1]*_0x2492d9;return this['_calcUV'](_0x515d26,_0x18e1df);}},{'key':'_calcUV','value':function _0x45c789(_0x4c23d5,_0x126cad){return[+_0x4c23d5,+_0x126cad,Math['sqrt'](_0x4c23d5*_0x4c23d5+_0x126cad*_0x126cad)];}},{'key':'getUVByPoint','value':function _0x51c176(_0x8cb8a8,_0x227468){var _0x243895=_0x559924;if(!this[_0x243895(0x186)](_0x8cb8a8,_0x227468))return null;var _0x2c2f68=this['toGridXY'](_0x8cb8a8,_0x227468),_0x1393bd=this['getUVByXY'](_0x2c2f68[0x0],_0x2c2f68[0x1]);return _0x1393bd;}},{'key':'isInExtent','value':function _0x272dfe(_0x2fba1a,_0x535b32){var _0x488307=_0x559924;return _0x2fba1a>=this['xmin']&&_0x2fba1a<=this['xmax']&&_0x535b32>=this[_0x488307(0x253)]&&_0x535b32<=this['ymax']?!![]:![];}},{'key':'getRandomLatLng','value':function _0x58eb24(){var _0x39b135=_0x559924,_0x2cb5dc=fRandomByfloat(this[_0x39b135(0x1f6)],this['xmax']),_0x235c4c=fRandomByfloat(this[_0x39b135(0x253)],this['ymax']);return{'lat':_0x235c4c,'lng':_0x2cb5dc};}},{'key':'getParticles','value':function _0x57d581(){var _0x128f1f=_0x559924,_0x2ea844,_0x13ae8e,_0x5a8b69;for(var _0x4ef91b=0x0,_0x2fe1ca=this['particles']['length'];_0x4ef91b<_0x2fe1ca;_0x4ef91b++){var _0xcac8fb=this['particles'][_0x4ef91b];_0xcac8fb['age']<=0x0&&(_0xcac8fb=this[_0x128f1f(0x23c)](_0xcac8fb));if(_0xcac8fb['age']>0x0){var _0x455d86=_0xcac8fb[_0x128f1f(0x24d)],_0x2b46e4=_0xcac8fb[_0x128f1f(0x240)];_0x5a8b69=this['getUVByPoint'](_0x455d86,_0x2b46e4),_0x5a8b69?(_0x2ea844=_0x455d86+this['_calc_speedRate'][0x0]*_0x5a8b69[0x0],_0x13ae8e=_0x2b46e4+this['_calc_speedRate'][0x1]*_0x5a8b69[0x1],_0xcac8fb['lng']=_0x455d86,_0xcac8fb[_0x128f1f(0x1b0)]=_0x2b46e4,_0xcac8fb['tlng']=_0x2ea844,_0xcac8fb['tlat']=_0x13ae8e,_0xcac8fb['age']--):_0xcac8fb['age']=0x0;}}return this['particles'];}},{'key':'_randomParticle','value':function _0x4fac3c(_0x388bd3){var _0x3c8510=_0x559924,_0x3d4388,_0x5a3924;for(var _0x31ba57=0x0;_0x31ba57<0x1e;_0x31ba57++){_0x3d4388=this['getRandomLatLng'](),_0x5a3924=this['getUVByPoint'](_0x3d4388[_0x3c8510(0x1fc)],_0x3d4388['lat']);if(_0x5a3924&&_0x5a3924[0x2]>0x0)break;}if(!_0x5a3924)return _0x388bd3;var _0xa3d538=_0x3d4388['lng']+this['_calc_speedRate'][0x0]*_0x5a3924[0x0],_0x47a4ac=_0x3d4388['lat']+this[_0x3c8510(0x1fa)][0x1]*_0x5a3924[0x1];return _0x388bd3['lng']=_0x3d4388['lng'],_0x388bd3[_0x3c8510(0x1b0)]=_0x3d4388['lat'],_0x388bd3['tlng']=_0xa3d538,_0x388bd3['tlat']=_0x47a4ac,_0x388bd3[_0x3c8510(0x1ae)]=Math[_0x3c8510(0x22e)](Math[_0x3c8510(0x20f)]()*this['maxAge']),_0x388bd3;}},{'key':_0x559924(0x23d),'value':function _0x2acbf4(){for(var _0x245e12 in this){delete this[_0x245e12];}}}]),_0x4d076;}());function fRandomByfloat(_0x4629e8,_0x5dfe4a){return _0x4629e8+Math['random']()*(_0x5dfe4a-_0x4629e8);}var Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],CanvasWindLayer=function(_0x431f4a){var _0xb632dc=_0x4e7c89;_inherits(_0x20250a,_0x431f4a);var _0x23145e=_createSuper(_0x20250a);function _0x20250a(){var _0x229ae6,_0x3cfc22=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x20250a),_0x229ae6=_0x23145e['call'](this,_0x3cfc22),_0x229ae6['_setOptionsHook'](_0x3cfc22),_0x229ae6['canvas']=null,_0x229ae6;}return _createClass(_0x20250a,[{'key':'_setOptionsHook','value':function _0x34558e(_0x5eeba1,_0x4799b6){var _0xa96cc8=_0x53f5,_0x1f1beb,_0x52003b,_0x164ef9;this[_0xa96cc8(0x183)]=0x3e8/(_0x5eeba1['frameRate']||0xa),this['_pointerEvents']=(_0x1f1beb=this['options'][_0xa96cc8(0x25c)])!==null&&_0x1f1beb!==void 0x0?_0x1f1beb:![],this['color']=_0x5eeba1['color']||'#ffffff',this[_0xa96cc8(0x178)]=_0x5eeba1['lineWidth']||0x1,this['fixedHeight']=(_0x52003b=_0x5eeba1['fixedHeight'])!==null&&_0x52003b!==void 0x0?_0x52003b:0x0,this[_0xa96cc8(0x1f2)]=(_0x164ef9=_0x5eeba1['reverseY'])!==null&&_0x164ef9!==void 0x0?_0x164ef9:![],this['windField']&&this['windField']['setOptions'](_0x5eeba1);}},{'key':'layer','get':function _0x196810(){var _0x2cf497=_0x53f5;return this[_0x2cf497(0x188)];}},{'key':'canvasWidth','get':function _0x3e83f0(){return this['_map']['scene']['canvas']['clientWidth'];}},{'key':'canvasHeight','get':function _0x5a1e4e(){var _0x3adba7=_0x53f5;return this['_map']['scene'][_0x3adba7(0x188)]['clientHeight'];}},{'key':'pointerEvents','get':function _0x4c9e3d(){return this['_pointerEvents'];},'set':function _0x59613d(_0x1d73c5){var _0x3dad2e=_0x53f5;this[_0x3dad2e(0x248)]=_0x1d73c5;if(!this[_0x3dad2e(0x188)])return;_0x1d73c5?this['canvas'][_0x3dad2e(0x262)][_0x3dad2e(0x22a)]='all':this['canvas']['style']['pointer-events']='none';}},{'key':'particlesNumber','get':function _0x1a2c68(){return this['options']['particlesNumber'];},'set':function _0x1cb2cb(_0x1b1c15){var _0x533942=_0x53f5,_0x383907=this;this[_0x533942(0x1a6)][_0x533942(0x20e)]=_0x1b1c15,clearTimeout(this['_canrefresh']),this['_canrefresh']=setTimeout(function(){var _0x13cece=_0x533942;_0x383907[_0x13cece(0x215)]();},0x1f4);}},{'key':'speedRate','get':function _0x248766(){var _0x188aa9=_0x53f5;return this[_0x188aa9(0x1a6)]['speedRate'];},'set':function _0x27f652(_0x1067b8){var _0x266375=_0x53f5;this['options']['speedRate']=_0x1067b8,this['windField']&&(this['windField'][_0x266375(0x17f)]=_0x1067b8);}},{'key':'maxAge','get':function _0x4b9da4(){return this['options']['maxAge'];},'set':function _0x5cbbbd(_0x336a0a){var _0x2aa154=_0x53f5;this['options']['maxAge']=_0x336a0a,this['windField']&&(this[_0x2aa154(0x180)][_0x2aa154(0x24a)]=_0x336a0a);}},{'key':'data','get':function _0x4600d0(){var _0x2d54f3=_0x53f5;return this[_0x2d54f3(0x261)];},'set':function _0x2bbc99(_0x58179c){this['setData'](_0x58179c);}},{'key':'_showHook','value':function _0x2b6d7c(_0x3a0c18){var _0x54f147=_0x53f5;_0x3a0c18?this['_addedHook']():(this['windData']&&(this[_0x54f147(0x1a6)][_0x54f147(0x1b7)]=this['windData']),this[_0x54f147(0x1d3)]());}},{'key':'_mountedHook','value':function _0x581110(){var _0x1bd9bc=_0x53f5;this[_0x1bd9bc(0x1a6)]['worker']?this['initWorker']():this[_0x1bd9bc(0x180)]=new CanvasWindField(this['options']);}},{'key':'_addedHook','value':function _0x1c00bd(){var _0x7476d2=_0x53f5;this['canvas']=this['_createCanvas'](),this['canvasContext']=this['canvas']['getContext']('2d',{'willReadFrequently':!![]}),this[_0x7476d2(0x204)](),this['options']['data']&&this['setData'](this[_0x7476d2(0x1a6)]['data']);}},{'key':'_removedHook','value':function _0x135730(){var _0xfdc3d6=_0x53f5;this['clear'](),this['unbindEvent'](),this['canvas']&&(this[_0xfdc3d6(0x174)]['container']['removeChild'](this['canvas']),delete this['canvas']);}},{'key':_0xb632dc(0x1e6),'value':function _0x229b90(){var _0x8f8b2c=_0xb632dc,_0x594dbf=document['createElement']('canvas');_0x594dbf['style']['position']=_0x8f8b2c(0x239),_0x594dbf['style']['top']='0px',_0x594dbf[_0x8f8b2c(0x262)]['left']='0px',_0x594dbf[_0x8f8b2c(0x262)][_0x8f8b2c(0x216)]='100%',_0x594dbf[_0x8f8b2c(0x262)][_0x8f8b2c(0x25a)]='100%',_0x594dbf[_0x8f8b2c(0x262)]['pointerEvents']=this['_pointerEvents']?_0x8f8b2c(0x1f4):'none',_0x594dbf[_0x8f8b2c(0x262)]['zIndex']=0xa,_0x594dbf['setAttribute']('id','canvasWindy'),_0x594dbf[_0x8f8b2c(0x16f)]('class','canvasWindy'),this['_map']['container']['appendChild'](_0x594dbf);var _0x23215b=this['_map']['scene'];return _0x594dbf[_0x8f8b2c(0x216)]=_0x23215b['canvas']['clientWidth'],_0x594dbf[_0x8f8b2c(0x25a)]=_0x23215b['canvas']['clientHeight'],_0x594dbf;}},{'key':_0xb632dc(0x189),'value':function _0x1189f5(){this['canvas']&&(this['canvas']['width']=this['canvasWidth'],this['canvas']['height']=this['canvasHeight']);}},{'key':'bindEvent','value':function _0x5f381d(){var _0x33721f=_0xb632dc,_0x17927e=this,_0x18b14c=Date['now']();(function _0x584ddf(){var _0x4d42ab=_0x53f5;_0x17927e['animateFrame']=window['requestAnimationFrame'](_0x584ddf);if(_0x17927e[_0x4d42ab(0x1a7)]&&_0x17927e[_0x4d42ab(0x180)]){var _0xed21bc=Date['now'](),_0x4b02bc=_0xed21bc-_0x18b14c;_0x4b02bc>_0x17927e[_0x4d42ab(0x183)]&&(_0x18b14c=_0xed21bc-_0x4b02bc%_0x17927e[_0x4d42ab(0x183)],_0x17927e['update']());}}(),window['addEventListener']('resize',this['resize']['bind'](this),![]),this['mouse_down']=![],this[_0x33721f(0x18e)]=![],this['options'][_0x33721f(0x22c)]&&(this[_0x33721f(0x174)]['on'](mars3d__namespace['EventType'][_0x33721f(0x18c)],this[_0x33721f(0x1a0)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseDown'],this[_0x33721f(0x25f)],this),this[_0x33721f(0x174)]['on'](mars3d__namespace[_0x33721f(0x21b)][_0x33721f(0x233)],this[_0x33721f(0x19b)],this)));}},{'key':'unbindEvent','value':function _0x39ed35(){var _0x16c257=_0xb632dc;window['cancelAnimationFrame'](this[_0x16c257(0x19c)]),delete this['animateFrame'],window['removeEventListener']('resize',this['resize']),this['options']['mouseHidden']&&(this['_map']['off'](mars3d__namespace[_0x16c257(0x21b)]['wheel'],this[_0x16c257(0x1a0)],this),this[_0x16c257(0x174)]['off'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map'][_0x16c257(0x257)](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this),this['_map'][_0x16c257(0x257)](mars3d__namespace[_0x16c257(0x21b)]['mouseMove'],this[_0x16c257(0x1c5)],this));}},{'key':_0xb632dc(0x1a0),'value':function _0x4668a7(_0x14516a){var _0x1e5d02=_0xb632dc,_0x4328ad=this;clearTimeout(this[_0x1e5d02(0x1a1)]);if(!this['show']||!this['canvas'])return;this['canvas']['style']['visibility']='hidden',this[_0x1e5d02(0x1a1)]=setTimeout(function(){var _0x1d553b=_0x1e5d02;if(!_0x4328ad['show'])return;_0x4328ad['redraw'](),_0x4328ad['canvas'][_0x1d553b(0x262)][_0x1d553b(0x1e7)]='visible';},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x11c9be(_0x2b46cf){var _0x28945c=_0xb632dc;this['mouse_down']=!![],this['_map']['off'](mars3d__namespace['EventType'][_0x28945c(0x254)],this['_onMouseMoveEvent'],this),this[_0x28945c(0x174)]['on'](mars3d__namespace['EventType'][_0x28945c(0x254)],this['_onMouseMoveEvent'],this);}},{'key':_0xb632dc(0x1c5),'value':function _0x30343c(_0xe9e613){var _0x2d9d43=_0xb632dc;if(!this['show']||!this['canvas'])return;this['mouse_down']&&(this['canvas']['style']['visibility']=_0x2d9d43(0x1e0),this[_0x2d9d43(0x18e)]=!![]);}},{'key':'_onMouseUpEvent','value':function _0x142909(_0x3b2e0f){var _0x44eb42=_0xb632dc;if(!this['show']||!this['canvas'])return;this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this),this['mouse_down']&&this['mouse_move']&&this['redraw'](),this[_0x44eb42(0x188)]['style']['visibility']='visible',this['mouse_down']=![],this['mouse_move']=![];}},{'key':'setData','value':function _0x3d9961(_0x20c77b){var _0x146b4c=_0xb632dc;this['clear'](),this['windData']=_0x20c77b,this[_0x146b4c(0x180)]['setDate'](_0x20c77b),this['redraw']();}},{'key':_0xb632dc(0x215),'value':function _0x15ced3(){var _0x2eaaba=_0xb632dc;if(!this['show'])return;this[_0x2eaaba(0x180)]['setOptions'](this['options']),this[_0x2eaaba(0x1f8)]();}},{'key':'update','value':function _0x126a84(){var _0x85485c=_0xb632dc;if(this['_updateIng'])return;this['_updateIng']=!![];if(this[_0x85485c(0x185)])this['windField']['update']();else{var _0x36c832=this[_0x85485c(0x180)][_0x85485c(0x1e3)]();this['_drawLines'](_0x36c832);}this['_updateIng']=![];}},{'key':'_drawLines','value':function _0x4186d5(_0x2483d7){var _0x526e0b=_0xb632dc;this['canvasContext'][_0x526e0b(0x191)]='destination-in',this[_0x526e0b(0x205)][_0x526e0b(0x1eb)](0x0,0x0,this['canvasWidth'],this['canvasHeight']),this['canvasContext']['globalCompositeOperation']='lighter',this['canvasContext']['globalAlpha']=0.9,this['canvasContext']['beginPath'](),this['canvasContext']['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this[_0x526e0b(0x1d7)];var _0x249d06=this['_map']['scene'][_0x526e0b(0x1aa)]!==Cesium[_0x526e0b(0x179)]['SCENE3D'];for(var _0x2618c1=0x0,_0x30f1f2=_0x2483d7['length'];_0x2618c1<_0x30f1f2;_0x2618c1++){var _0x9b0661=_0x2483d7[_0x2618c1],_0x5466ef=this['_tomap'](_0x9b0661['lng'],_0x9b0661['lat'],_0x9b0661),_0x5e200=this['_tomap'](_0x9b0661[_0x526e0b(0x24d)],_0x9b0661['tlat'],_0x9b0661);if(!_0x5466ef||!_0x5e200)continue;if(_0x249d06&&Math['abs'](_0x5466ef[0x0]-_0x5e200[0x0])>=this[_0x526e0b(0x17a)])continue;this['canvasContext'][_0x526e0b(0x18f)](_0x5466ef[0x0],_0x5466ef[0x1]),this['canvasContext']['lineTo'](_0x5e200[0x0],_0x5e200[0x1]);}this[_0x526e0b(0x205)]['stroke']();}},{'key':'_tomap','value':function _0x378fd2(_0x4b59ca,_0x452346,_0xe99a34){var _0x2153db=_0xb632dc,_0x25fda4=Cesium['Cartesian3'][_0x2153db(0x1d0)](_0x4b59ca,_0x452346,this[_0x2153db(0x1af)]),_0x5d8e38=this[_0x2153db(0x174)][_0x2153db(0x1c1)];if(_0x5d8e38['mode']===Cesium['SceneMode']['SCENE3D']){var _0x4a0197=new Cesium['EllipsoidalOccluder'](_0x5d8e38[_0x2153db(0x1bd)]['ellipsoid'],_0x5d8e38[_0x2153db(0x19d)]['positionWC']),_0x57531f=_0x4a0197['isPointVisible'](_0x25fda4);if(!_0x57531f)return _0xe99a34[_0x2153db(0x1ae)]=0x0,null;}var _0x502a09=Cesium['SceneTransforms']['wgs84ToWindowCoordinates'](this['_map']['scene'],_0x25fda4);return _0x502a09?[_0x502a09['x'],_0x502a09['y']]:null;}},{'key':'clear','value':function _0x3723a6(){var _0x382303=_0xb632dc;this['windField']['clear'](),delete this[_0x382303(0x261)];}},{'key':'initWorker','value':function _0x4f85ba(){var _0x2d5c38=_0xb632dc,_0x5920e7=this;this['worker']=new Worker(this['options']['worker']),this[_0x2d5c38(0x185)]['onmessage']=function(_0xd449c3){var _0x56fcaa=_0x2d5c38;_0x5920e7['_drawLines'](_0xd449c3['data']['particles']),_0x5920e7[_0x56fcaa(0x181)]=![];},this['windField']={'init':function _0x298d6f(_0x55621c){_0x5920e7['worker']['postMessage']({'type':'init','options':_0x55621c});},'setOptions':function _0x1eb003(_0x372b75){var _0x25dd63=_0x2d5c38;_0x5920e7['worker'][_0x25dd63(0x23b)]({'type':'setOptions','options':_0x372b75});},'setDate':function _0x1521a0(_0x49fbc7){var _0x4c5d17=_0x2d5c38;_0x5920e7['worker'][_0x4c5d17(0x23b)]({'type':'setDate','data':_0x49fbc7});},'update':function _0x3c552a(){var _0x454876=_0x2d5c38;if(_0x5920e7['_updateIng2'])return;_0x5920e7[_0x454876(0x181)]=!![],_0x5920e7['worker']['postMessage']({'type':'update'});},'clear':function _0x130fa5(){var _0x774d9d=_0x2d5c38;_0x5920e7['worker'][_0x774d9d(0x23b)]({'type':'clear'});}},this[_0x2d5c38(0x180)]['init'](this['options']);}}]),_0x20250a;}(BaseLayer);mars3d__namespace['LayerUtil'][_0x4e7c89(0x247)]('canvasWind',CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace['WindUtil']=WindUtil,exports['CanvasWindField']=CanvasWindField,exports['CanvasWindLayer']=CanvasWindLayer,exports[_0x4e7c89(0x258)]=WindLayer,exports[_0x4e7c89(0x22f)]=WindUtil,Object[_0x4e7c89(0x20d)](exports,'__esModule',{'value':!![]});
}));
