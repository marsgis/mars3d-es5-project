/**
 * Mars3D平台插件,支持气象 风向图 功能插件  mars3d-wind
 *
 * 版本信息：v3.5.4
 * 编译日期：2023-04-24 10:59:08
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-wind"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x2906f7=_0x5a79;(function(_0x1f0985,_0xa6b7fd){var _0x55fb33=_0x5a79,_0x2d8bc5=_0x1f0985();while(!![]){try{var _0x3380f3=parseInt(_0x55fb33(0x1a6))/0x1*(parseInt(_0x55fb33(0x10b))/0x2)+parseInt(_0x55fb33(0x178))/0x3*(-parseInt(_0x55fb33(0x134))/0x4)+parseInt(_0x55fb33(0x1ff))/0x5*(-parseInt(_0x55fb33(0x170))/0x6)+parseInt(_0x55fb33(0x1fc))/0x7+parseInt(_0x55fb33(0x205))/0x8*(parseInt(_0x55fb33(0x190))/0x9)+parseInt(_0x55fb33(0x107))/0xa*(parseInt(_0x55fb33(0x1a5))/0xb)+parseInt(_0x55fb33(0x114))/0xc*(parseInt(_0x55fb33(0x1b7))/0xd);if(_0x3380f3===_0xa6b7fd)break;else _0x2d8bc5['push'](_0x2d8bc5['shift']());}catch(_0x29f719){_0x2d8bc5['push'](_0x2d8bc5['shift']());}}}(_0x5bbe,0xeed39));function _interopNamespace(_0x36804f){var _0x5d9501=_0x5a79;if(_0x36804f&&_0x36804f[_0x5d9501(0x1e5)])return _0x36804f;var _0x1f5387=Object['create'](null);return _0x36804f&&Object['keys'](_0x36804f)['forEach'](function(_0x1c6daf){var _0x362204=_0x5d9501;if(_0x1c6daf!==_0x362204(0x1d8)){var _0x580d82=Object['getOwnPropertyDescriptor'](_0x36804f,_0x1c6daf);Object['defineProperty'](_0x1f5387,_0x1c6daf,_0x580d82['get']?_0x580d82:{'enumerable':!![],'get':function(){return _0x36804f[_0x1c6daf];}});}}),_0x1f5387['default']=_0x36804f,_0x1f5387;}var mars3d__namespace=_interopNamespace(mars3d),Cesium$7=mars3d__namespace[_0x2906f7(0x183)];function getU(_0xba732f,_0x201b2e){var _0x5361af=_0x2906f7,_0x48a0e6=_0xba732f*Math[_0x5361af(0x16d)](Cesium$7['Math'][_0x5361af(0x121)](_0x201b2e));return _0x48a0e6;}function getV(_0x44bb18,_0x4ccbff){var _0x395272=_0x2906f7,_0x13e863=_0x44bb18*Math['sin'](Cesium$7[_0x395272(0x13b)][_0x395272(0x121)](_0x4ccbff));return _0x13e863;}function getSpeed(_0x3967fd,_0x2dc49d){var _0x46f748=Math['sqrt'](Math['pow'](_0x3967fd,0x2)+Math['pow'](_0x2dc49d,0x2));return _0x46f748;}function getDirection(_0xf46873,_0x3c960e){var _0x341213=_0x2906f7,_0x2ede3d=Cesium$7['Math']['toDegrees'](Math[_0x341213(0x16f)](_0x3c960e,_0xf46873));return _0x2ede3d+=_0x2ede3d<0x0?0x168:0x0,_0x2ede3d;}var WindUtil={'__proto__':null,'getU':getU,'getV':getV,'getSpeed':getSpeed,'getDirection':getDirection};function ownKeys(_0x4c45a7,_0x13505f){var _0x34fc29=_0x2906f7,_0x29f1cb=Object['keys'](_0x4c45a7);if(Object['getOwnPropertySymbols']){var _0x83c514=Object['getOwnPropertySymbols'](_0x4c45a7);_0x13505f&&(_0x83c514=_0x83c514['filter'](function(_0x32d143){return Object['getOwnPropertyDescriptor'](_0x4c45a7,_0x32d143)['enumerable'];})),_0x29f1cb[_0x34fc29(0x209)][_0x34fc29(0x137)](_0x29f1cb,_0x83c514);}return _0x29f1cb;}function _objectSpread2(_0x576470){var _0x4e46f9=_0x2906f7;for(var _0x30248c=0x1;_0x30248c<arguments[_0x4e46f9(0x111)];_0x30248c++){var _0x329f30=null!=arguments[_0x30248c]?arguments[_0x30248c]:{};_0x30248c%0x2?ownKeys(Object(_0x329f30),!0x0)[_0x4e46f9(0x124)](function(_0x2039b7){_defineProperty(_0x576470,_0x2039b7,_0x329f30[_0x2039b7]);}):Object[_0x4e46f9(0x206)]?Object[_0x4e46f9(0x157)](_0x576470,Object['getOwnPropertyDescriptors'](_0x329f30)):ownKeys(Object(_0x329f30))['forEach'](function(_0x3627ef){Object['defineProperty'](_0x576470,_0x3627ef,Object['getOwnPropertyDescriptor'](_0x329f30,_0x3627ef));});}return _0x576470;}function _0x5bbe(){var _0x3f8aa7=['Cartesian2','setData','85AsCbvV','nextParticlesSpeed','lat','particlesTextures','PixelDatatype','canvasWind','8vrCOOT','getOwnPropertyDescriptors','preRender','_data','push','postProcessingSpeed','log','pointer-events','PrimitiveType','class','bind','createComputingPrimitives','bindEvent','SCENE3D','postProcessingPosition','lon','autoClear','segmentsDepth','init','EventType','170gKLEUV','shaderProgram','tlng','key','2080uAATly','viewport','udata','particlesNumber','randomBetween','_updateIng2','length','viewerParameters','updatePosition','761976NRslcI','layer','FLOAT','setDate','levmin','LINEAR','scene','windField','style','setGeometry','preExecute','_removedHook','GeometryAttributes','toRadians','lng','xmax','forEach','clear','WindUtil','addEventListener','_updateIng','defined','removeEventListener','redraw','applyViewerParameters','resize','pixelSize','levmax','_onMap_preRenderEvent','vdata','lineWidth','lev','4348gfTQOi','currentTrails','getUVByXY','apply','speedFactor','Framebuffer','destroy','Math','canrefresh','segments','currentTrailsDepth','addPrimitives','colors','createRenderingTextures','toString','GeometryAttribute','fromDegrees','getOptions','uniform\x20sampler2D\x20colorTable;\x0a\x0ain\x20float\x20speedNormalization;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20out_FragColor\x20=\x20texture(colorTable,\x20vec2(speedNormalization,\x200.0));\x0a}\x0a','latRange','green','rawRenderState','keys','defineProperty','maxParticles','xmin','Compute','currentParticlesPosition','dropRateBump','from','uniformMap','canvasHeight','nextTrailsDepth','_onMapWhellEvent','maxAge','defineProperties','context','height','IDENTITY','wgs84ToWindowCoordinates','construct','vertexShaderSource','off','fragmentShaderSource','string','nextTrails','reverseY','canvasContext','random','data','isPointVisible','age','options','Cartesian3','geometry','clientWidth','Invalid\x20attempt\x20to\x20spread\x20non-iterable\x20instance.\x0aIn\x20order\x20to\x20be\x20iterable,\x20non-array\x20objects\x20must\x20have\x20a\x20[Symbol.iterator]()\x20method.','cos','100%','atan2','480690otmyud','uniform\x20sampler2D\x20nextParticlesPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0a//\x20range\x20(min,\x20max)\x0auniform\x20vec2\x20lonRange;\x0auniform\x20vec2\x20latRange;\x0a\x0auniform\x20float\x20randomCoefficient;\x20//\x20use\x20to\x20improve\x20the\x20pseudo-random\x20generator\x0auniform\x20float\x20dropRate;\x20//\x20drop\x20rate\x20is\x20a\x20chance\x20a\x20particle\x20will\x20restart\x20at\x20random\x20position\x20to\x20avoid\x20degeneration\x0auniform\x20float\x20dropRateBump;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0a//\x20pseudo-random\x20generator\x0aconst\x20vec3\x20randomConstants\x20=\x20vec3(12.9898,\x2078.233,\x204375.85453);\x0aconst\x20vec2\x20normalRange\x20=\x20vec2(0.0,\x201.0);\x0afloat\x20rand(vec2\x20seed,\x20vec2\x20range)\x20{\x0a\x20\x20\x20\x20vec2\x20randomSeed\x20=\x20randomCoefficient\x20*\x20seed;\x0a\x20\x20\x20\x20float\x20temp\x20=\x20dot(randomConstants.xy,\x20randomSeed);\x0a\x20\x20\x20\x20temp\x20=\x20fract(sin(temp)\x20*\x20(randomConstants.z\x20+\x20temp));\x0a\x20\x20\x20\x20return\x20temp\x20*\x20(range.y\x20-\x20range.x)\x20+\x20range.x;\x0a}\x0a\x0avec3\x20generateRandomParticle(vec2\x20seed,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20longitude\x20is\x20in\x20[0,\x20360]\x0a\x20\x20\x20\x20float\x20randomLon\x20=\x20mod(rand(seed,\x20lonRange),\x20360.0);\x0a\x20\x20\x20\x20float\x20randomLat\x20=\x20rand(-seed,\x20latRange);\x0a\x0a\x20\x20\x20\x20return\x20vec3(randomLon,\x20randomLat,\x20lev);\x0a}\x0a\x0abool\x20particleOutbound(vec3\x20particle)\x20{\x0a\x20\x20\x20\x20return\x20particle.y\x20<\x20-90.0\x20||\x20particle.y\x20>\x2090.0;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20texture(nextParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20float\x20particleDropRate\x20=\x20dropRate\x20+\x20dropRateBump\x20*\x20nextSpeed.a;\x0a\x0a\x20\x20\x20\x20vec2\x20seed1\x20=\x20nextParticle.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec2\x20seed2\x20=\x20nextSpeed.xy\x20+\x20v_textureCoordinates;\x0a\x20\x20\x20\x20vec3\x20randomParticle\x20=\x20generateRandomParticle(seed1,\x20nextParticle.z);\x0a\x20\x20\x20\x20float\x20randomNumber\x20=\x20rand(seed2,\x20normalRange);\x0a\x0a\x20\x20\x20\x20if\x20(randomNumber\x20<\x20particleDropRate\x20||\x20particleOutbound(nextParticle))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(randomParticle,\x201.0);\x20//\x201.0\x20means\x20this\x20is\x20a\x20random\x20particle\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a\x20\x20\x20\x20}\x0a}\x0a','Object','_calc_speedRate','particles','framebuffers','ShaderProgram','unbindEvent','4353BPyuSr','visible','updateSpeed','ClearCommand','_onMouseMoveEvent','dropRate','Cannot\x20call\x20a\x20class\x20as\x20a\x20function','uniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20lengthOfLonLat(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20unit\x20conversion:\x20meters\x20->\x20longitude\x20latitude\x20degrees\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_system#Length_of_a_degree\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20Calculate\x20the\x20length\x20of\x20a\x20degree\x20of\x20latitude\x20and\x20longitude\x20in\x20meters\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x0a\x20\x20\x20\x20float\x20term1\x20=\x20111132.92;\x0a\x20\x20\x20\x20float\x20term2\x20=\x20559.82\x20*\x20cos(2.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term3\x20=\x201.175\x20*\x20cos(4.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term4\x20=\x200.0023\x20*\x20cos(6.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20latLength\x20=\x20term1\x20-\x20term2\x20+\x20term3\x20-\x20term4;\x0a\x0a\x20\x20\x20\x20float\x20term5\x20=\x20111412.84\x20*\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20term6\x20=\x2093.5\x20*\x20cos(3.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20term7\x20=\x200.118\x20*\x20cos(5.0\x20*\x20latitude);\x0a\x20\x20\x20\x20float\x20longLength\x20=\x20term5\x20-\x20term6\x20+\x20term7;\x0a\x0a\x20\x20\x20\x20return\x20vec2(longLength,\x20latLength);\x0a}\x0a\x0avoid\x20updatePosition(vec3\x20lonLatLev,\x20vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec2\x20lonLatLength\x20=\x20lengthOfLonLat(lonLatLev);\x0a\x20\x20\x20\x20float\x20u\x20=\x20speed.x\x20/\x20lonLatLength.x;\x0a\x20\x20\x20\x20float\x20v\x20=\x20speed.y\x20/\x20lonLatLength.y;\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20vec3\x20windVectorInLonLatLev\x20=\x20vec3(u,\x20v,\x20w);\x0a\x0a\x20\x20\x20\x20vec3\x20nextParticle\x20=\x20lonLatLev\x20+\x20windVectorInLonLatLev;\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(nextParticle,\x200.0);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20speed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20updatePosition(lonLatLev,\x20speed);\x0a}\x0a','update','commandType','north','Cesium','animateFrame','_drawLines','canvasWidth','PI_OVER_TWO','frameRate','createSegmentsGeometry','call','framebuffer','requestAnimationFrame','show','CanvasWindLayer','__proto__','8930547eixObX','beginPath','nextParticlesPosition','_speedRate','windData','vertexArray','createFramebuffer','worker','primitives','east','THREE_PI_OVER_TWO','mouse_move','_onMouseDownEvent','reverse','canvas','visibility','//\x20the\x20size\x20of\x20UV\x20textures:\x20width\x20=\x20lon,\x20height\x20=\x20lat*lev\x0auniform\x20sampler2D\x20U;\x20//\x20eastward\x20wind\x0auniform\x20sampler2D\x20V;\x20//\x20northward\x20wind\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x20//\x20(lon,\x20lat,\x20lev)\x0a\x0auniform\x20vec3\x20dimension;\x20//\x20(lon,\x20lat,\x20lev)\x0auniform\x20vec3\x20minimum;\x20//\x20minimum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20maximum;\x20//\x20maximum\x20of\x20each\x20dimension\x0auniform\x20vec3\x20interval;\x20//\x20interval\x20of\x20each\x20dimension\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avec2\x20mapPositionToNormalizedIndex2D(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20ensure\x20the\x20range\x20of\x20longitude\x20and\x20latitude\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x,\x20360.0);\x0a\x20\x20\x20\x20lonLatLev.y\x20=\x20clamp(lonLatLev.y,\x20-90.0,\x2090.0);\x0a\x0a\x20\x20\x20\x20vec3\x20index3D\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20index3D.x\x20=\x20(lonLatLev.x\x20-\x20minimum.x)\x20/\x20interval.x;\x0a\x20\x20\x20\x20index3D.y\x20=\x20(lonLatLev.y\x20-\x20minimum.y)\x20/\x20interval.y;\x0a\x20\x20\x20\x20index3D.z\x20=\x20(lonLatLev.z\x20-\x20minimum.z)\x20/\x20interval.z;\x0a\x0a\x20\x20\x20\x20//\x20the\x20st\x20texture\x20coordinate\x20corresponding\x20to\x20(col,\x20row)\x20index\x0a\x20\x20\x20\x20//\x20example\x0a\x20\x20\x20\x20//\x20data\x20array\x20is\x20[0,\x201,\x202,\x203,\x204,\x205],\x20width\x20=\x203,\x20height\x20=\x202\x0a\x20\x20\x20\x20//\x20the\x20content\x20of\x20texture\x20will\x20be\x0a\x20\x20\x20\x20//\x20t\x201.0\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x203\x204\x205\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x0a\x20\x20\x20\x20//\x20\x20\x20\x20|\x20\x200\x201\x202\x0a\x20\x20\x20\x20//\x20\x20\x200.0------1.0\x20s\x0a\x0a\x20\x20\x20\x20vec2\x20index2D\x20=\x20vec2(index3D.x,\x20index3D.z\x20*\x20dimension.y\x20+\x20index3D.y);\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20vec2(index2D.x\x20/\x20dimension.x,\x20index2D.y\x20/\x20(dimension.y\x20*\x20dimension.z));\x0a\x20\x20\x20\x20return\x20normalizedIndex2D;\x0a}\x0a\x0afloat\x20getWind(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20vec2\x20normalizedIndex2D\x20=\x20mapPositionToNormalizedIndex2D(lonLatLev);\x0a\x20\x20\x20\x20float\x20result\x20=\x20texture(windTexture,\x20normalizedIndex2D).r;\x0a\x20\x20\x20\x20return\x20result;\x0a}\x0a\x0aconst\x20mat4\x20kernelMatrix\x20=\x20mat4(\x0a\x20\x20\x20\x200.0,\x20-1.0,\x202.0,\x20-1.0,\x20//\x20first\x20column\x0a\x20\x20\x20\x202.0,\x200.0,\x20-5.0,\x203.0,\x20//\x20second\x20column\x0a\x20\x20\x20\x200.0,\x201.0,\x204.0,\x20-3.0,\x20//\x20third\x20column\x0a\x20\x20\x20\x200.0,\x200.0,\x20-1.0,\x201.0\x20//\x20fourth\x20column\x0a);\x0afloat\x20oneDimensionInterpolation(float\x20t,\x20float\x20p0,\x20float\x20p1,\x20float\x20p2,\x20float\x20p3)\x20{\x0a\x20\x20\x20\x20vec4\x20tVec4\x20=\x20vec4(1.0,\x20t,\x20t\x20*\x20t,\x20t\x20*\x20t\x20*\x20t);\x0a\x20\x20\x20\x20tVec4\x20=\x20tVec4\x20/\x202.0;\x0a\x20\x20\x20\x20vec4\x20pVec4\x20=\x20vec4(p0,\x20p1,\x20p2,\x20p3);\x0a\x20\x20\x20\x20return\x20dot((tVec4\x20*\x20kernelMatrix),\x20pVec4);\x0a}\x0a\x0afloat\x20calculateB(sampler2D\x20windTexture,\x20float\x20t,\x20float\x20lon,\x20float\x20lat,\x20float\x20lev)\x20{\x0a\x20\x20\x20\x20float\x20lon0\x20=\x20floor(lon)\x20-\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon1\x20=\x20floor(lon);\x0a\x20\x20\x20\x20float\x20lon2\x20=\x20floor(lon)\x20+\x201.0\x20*\x20interval.x;\x0a\x20\x20\x20\x20float\x20lon3\x20=\x20floor(lon)\x20+\x202.0\x20*\x20interval.x;\x0a\x0a\x20\x20\x20\x20float\x20p0\x20=\x20getWind(windTexture,\x20vec3(lon0,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p1\x20=\x20getWind(windTexture,\x20vec3(lon1,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p2\x20=\x20getWind(windTexture,\x20vec3(lon2,\x20lat,\x20lev));\x0a\x20\x20\x20\x20float\x20p3\x20=\x20getWind(windTexture,\x20vec3(lon3,\x20lat,\x20lev));\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(t,\x20p0,\x20p1,\x20p2,\x20p3);\x0a}\x0a\x0afloat\x20interpolateOneTexture(sampler2D\x20windTexture,\x20vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20float\x20lon\x20=\x20lonLatLev.x;\x0a\x20\x20\x20\x20float\x20lat\x20=\x20lonLatLev.y;\x0a\x20\x20\x20\x20float\x20lev\x20=\x20lonLatLev.z;\x0a\x0a\x20\x20\x20\x20float\x20lat0\x20=\x20floor(lat)\x20-\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat1\x20=\x20floor(lat);\x0a\x20\x20\x20\x20float\x20lat2\x20=\x20floor(lat)\x20+\x201.0\x20*\x20interval.y;\x0a\x20\x20\x20\x20float\x20lat3\x20=\x20floor(lat)\x20+\x202.0\x20*\x20interval.y;\x0a\x0a\x20\x20\x20\x20vec2\x20coefficient\x20=\x20lonLatLev.xy\x20-\x20floor(lonLatLev.xy);\x0a\x20\x20\x20\x20float\x20b0\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat0,\x20lev);\x0a\x20\x20\x20\x20float\x20b1\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat1,\x20lev);\x0a\x20\x20\x20\x20float\x20b2\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat2,\x20lev);\x0a\x20\x20\x20\x20float\x20b3\x20=\x20calculateB(windTexture,\x20coefficient.x,\x20lon,\x20lat3,\x20lev);\x0a\x0a\x20\x20\x20\x20return\x20oneDimensionInterpolation(coefficient.y,\x20b0,\x20b1,\x20b2,\x20b3);\x0a}\x0a\x0avec3\x20bicubic(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20https://en.wikipedia.org/wiki/Bicubic_interpolation#Bicubic_convolution_algorithm\x0a\x20\x20\x20\x20float\x20u\x20=\x20interpolateOneTexture(U,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20v\x20=\x20interpolateOneTexture(V,\x20lonLatLev);\x0a\x20\x20\x20\x20float\x20w\x20=\x200.0;\x0a\x20\x20\x20\x20return\x20vec3(u,\x20v,\x20w);\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20vec3\x20lonLatLev\x20=\x20texture(currentParticlesPosition,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20bicubic(lonLatLev);\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(windVector,\x200.0);\x0a}\x0a','setOptions','getUVByPoint','clientHeight','Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined','654467RfSFdN','56KmzWYH','RGBA','currentParticlesSpeed','windTextures','0px','canvasResize','_randomParticle','enumerable','fillRect','container','now','DepthFunction','_canrefresh','_map','_mountedHook','Pass','particlesWind','13rdZPNq','textures','pointerEvents','createRawRenderState','particlesTextureSize','postMessage','commandToExecute','attributeLocations','function','createTexture','red','TextureMinificationFilter','BaseLayer','mouseMove','_maxAge','ShaderSource','NEAREST','refreshParticles','value','Color','_addedHook','particlesComputing','_createCanvas','DrawCommand','_onMouseUpEvent','#ffffff','screen','camera','abs','Draw','cols','rows','clearFramebuffers','default','max','particlesRendering','iterator','drawingBufferHeight','DISABLE_LOG_DEPTH_FRAGMENT_WRITE','TWO_PI','_pointerEvents','fadeOpacity','depthTexture','in\x20vec3\x20position;\x0ain\x20vec2\x20st;\x0a\x0aout\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20textureCoordinate\x20=\x20st;\x0a\x20\x20\x20\x20gl_Position\x20=\x20vec4(position,\x201.0);\x0a}\x0a','mouse_down','nextTrailsColor','__esModule','particleSystem','round','createElement','prototype','ymax','globeBoundingSphere','clearCommand','mouseDown','getExtent','ZERO','width','uniform\x20sampler2D\x20trailsColorTexture;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(trailsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20trailsColor;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x0a}\x0a','_setOptionsHook','createRenderingFramebuffers','array','dimensions','floor','createCommand','ymin','createRenderingPrimitives','getDefaultRenderState','once','12543685VnKLne'];_0x5bbe=function(){return _0x3f8aa7;};return _0x5bbe();}function _classCallCheck(_0x5c2219,_0x415c33){var _0x533c9a=_0x2906f7;if(!(_0x5c2219 instanceof _0x415c33))throw new TypeError(_0x533c9a(0x17e));}function _defineProperties(_0x25bec9,_0x1c53e7){var _0xf6e161=_0x2906f7;for(var _0x30e16f=0x0;_0x30e16f<_0x1c53e7['length'];_0x30e16f++){var _0x4746b2=_0x1c53e7[_0x30e16f];_0x4746b2[_0xf6e161(0x1ad)]=_0x4746b2['enumerable']||![],_0x4746b2['configurable']=!![];if(_0xf6e161(0x1c9)in _0x4746b2)_0x4746b2['writable']=!![];Object['defineProperty'](_0x25bec9,_0x4746b2[_0xf6e161(0x10a)],_0x4746b2);}}function _createClass(_0x365442,_0x4ab9a7,_0x9b7d05){var _0x45737e=_0x2906f7;if(_0x4ab9a7)_defineProperties(_0x365442['prototype'],_0x4ab9a7);if(_0x9b7d05)_defineProperties(_0x365442,_0x9b7d05);return Object['defineProperty'](_0x365442,_0x45737e(0x1e9),{'writable':![]}),_0x365442;}function _defineProperty(_0x453c19,_0x4b4347,_0x3e3238){return _0x4b4347 in _0x453c19?Object['defineProperty'](_0x453c19,_0x4b4347,{'value':_0x3e3238,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x453c19[_0x4b4347]=_0x3e3238,_0x453c19;}function _inherits(_0x2ef43c,_0x4b2044){if(typeof _0x4b2044!=='function'&&_0x4b2044!==null)throw new TypeError('Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function');_0x2ef43c['prototype']=Object['create'](_0x4b2044&&_0x4b2044['prototype'],{'constructor':{'value':_0x2ef43c,'writable':!![],'configurable':!![]}}),Object['defineProperty'](_0x2ef43c,'prototype',{'writable':![]});if(_0x4b2044)_setPrototypeOf(_0x2ef43c,_0x4b2044);}function _getPrototypeOf(_0x372ce1){return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf']:function _0xbddebd(_0x390055){return _0x390055['__proto__']||Object['getPrototypeOf'](_0x390055);},_getPrototypeOf(_0x372ce1);}function _setPrototypeOf(_0x390959,_0x167c78){return _setPrototypeOf=Object['setPrototypeOf']||function _0x3c2b65(_0x597575,_0x3c8351){var _0x5b1e53=_0x5a79;return _0x597575[_0x5b1e53(0x18f)]=_0x3c8351,_0x597575;},_setPrototypeOf(_0x390959,_0x167c78);}function _isNativeReflectConstruct(){var _0x3180b4=_0x2906f7;if(typeof Reflect==='undefined'||!Reflect[_0x3180b4(0x15c)])return![];if(Reflect['construct']['sham'])return![];if(typeof Proxy==='function')return!![];try{return Boolean['prototype']['valueOf']['call'](Reflect['construct'](Boolean,[],function(){})),!![];}catch(_0x356c14){return![];}}function _assertThisInitialized(_0x239446){if(_0x239446===void 0x0)throw new ReferenceError('this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called');return _0x239446;}function _possibleConstructorReturn(_0x2eaa9e,_0x3c32a3){var _0x44d17b=_0x2906f7;if(_0x3c32a3&&(typeof _0x3c32a3==='object'||typeof _0x3c32a3===_0x44d17b(0x1bf)))return _0x3c32a3;else{if(_0x3c32a3!==void 0x0)throw new TypeError(_0x44d17b(0x1a4));}return _assertThisInitialized(_0x2eaa9e);}function _createSuper(_0x278a66){var _0x1588e4=_isNativeReflectConstruct();return function _0x88665(){var _0x7fb63e=_0x5a79,_0x3e1716=_getPrototypeOf(_0x278a66),_0x4c9670;if(_0x1588e4){var _0x11f122=_getPrototypeOf(this)['constructor'];_0x4c9670=Reflect['construct'](_0x3e1716,arguments,_0x11f122);}else _0x4c9670=_0x3e1716[_0x7fb63e(0x137)](this,arguments);return _possibleConstructorReturn(this,_0x4c9670);};}function _toConsumableArray(_0x2126b1){return _arrayWithoutHoles(_0x2126b1)||_iterableToArray(_0x2126b1)||_unsupportedIterableToArray(_0x2126b1)||_nonIterableSpread();}function _arrayWithoutHoles(_0x4e6fa2){if(Array['isArray'](_0x4e6fa2))return _arrayLikeToArray(_0x4e6fa2);}function _iterableToArray(_0x4ba70b){var _0x15655a=_0x2906f7;if(typeof Symbol!=='undefined'&&_0x4ba70b[Symbol[_0x15655a(0x1db)]]!=null||_0x4ba70b['@@iterator']!=null)return Array['from'](_0x4ba70b);}function _unsupportedIterableToArray(_0x65e0e3,_0x110e7e){var _0x59b40b=_0x2906f7;if(!_0x65e0e3)return;if(typeof _0x65e0e3===_0x59b40b(0x160))return _arrayLikeToArray(_0x65e0e3,_0x110e7e);var _0x4ce922=Object['prototype'][_0x59b40b(0x142)][_0x59b40b(0x18a)](_0x65e0e3)['slice'](0x8,-0x1);if(_0x4ce922===_0x59b40b(0x172)&&_0x65e0e3['constructor'])_0x4ce922=_0x65e0e3['constructor']['name'];if(_0x4ce922==='Map'||_0x4ce922==='Set')return Array[_0x59b40b(0x151)](_0x65e0e3);if(_0x4ce922==='Arguments'||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/['test'](_0x4ce922))return _arrayLikeToArray(_0x65e0e3,_0x110e7e);}function _arrayLikeToArray(_0x11b545,_0x362d52){if(_0x362d52==null||_0x362d52>_0x11b545['length'])_0x362d52=_0x11b545['length'];for(var _0x2efd3a=0x0,_0x40e9d4=new Array(_0x362d52);_0x2efd3a<_0x362d52;_0x2efd3a++)_0x40e9d4[_0x2efd3a]=_0x11b545[_0x2efd3a];return _0x40e9d4;}function _nonIterableSpread(){var _0x27e30c=_0x2906f7;throw new TypeError(_0x27e30c(0x16c));}var Cesium$6=mars3d__namespace['Cesium'],CustomPrimitive=(function(){var _0xcbd15d=_0x2906f7;function _0x505318(_0x36a557){var _0x773f76=_0x5a79,_0x3a11eb;_classCallCheck(this,_0x505318),this[_0x773f76(0x181)]=_0x36a557['commandType'],this[_0x773f76(0x16a)]=_0x36a557['geometry'],this['attributeLocations']=_0x36a557[_0x773f76(0x1be)],this['primitiveType']=_0x36a557['primitiveType'],this['uniformMap']=_0x36a557['uniformMap'],this[_0x773f76(0x15d)]=_0x36a557['vertexShaderSource'],this['fragmentShaderSource']=_0x36a557['fragmentShaderSource'],this[_0x773f76(0x149)]=_0x36a557['rawRenderState'],this['framebuffer']=_0x36a557['framebuffer'],this['outputTexture']=_0x36a557['outputTexture'],this['autoClear']=(_0x3a11eb=_0x36a557['autoClear'])!==null&&_0x3a11eb!==void 0x0?_0x3a11eb:![],this[_0x773f76(0x11e)]=_0x36a557['preExecute'],this['show']=!![],this['commandToExecute']=undefined,this[_0x773f76(0x1ec)]=undefined,this[_0x773f76(0x103)]&&(this['clearCommand']=new Cesium$6[(_0x773f76(0x17b))]({'color':new Cesium$6[(_0x773f76(0x1ca))](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':this['framebuffer'],'pass':Cesium$6['Pass']['OPAQUE']}));}return _createClass(_0x505318,[{'key':_0xcbd15d(0x1f7),'value':function _0x2c268b(_0x2cdfe4){var _0x452a48=_0xcbd15d;switch(this['commandType']){case'Draw':{var _0x1f581b=Cesium$6['VertexArray']['fromGeometry']({'context':_0x2cdfe4,'geometry':this[_0x452a48(0x16a)],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6['BufferUsage']['STATIC_DRAW']}),_0x331b08=Cesium$6[_0x452a48(0x176)]['fromCache']({'context':_0x2cdfe4,'attributeLocations':this['attributeLocations'],'vertexShaderSource':this['vertexShaderSource'],'fragmentShaderSource':this['fragmentShaderSource']}),_0x29edc8=Cesium$6['RenderState']['fromCache'](this[_0x452a48(0x149)]);return new Cesium$6[(_0x452a48(0x1ce))]({'primitiveType':this['primitiveType'],'shaderProgram':_0x331b08,'vertexArray':_0x1f581b,'modelMatrix':Cesium$6['Matrix4'][_0x452a48(0x15a)],'renderState':_0x29edc8,'uniformMap':this['uniformMap'],'castShadows':![],'receiveShadows':![],'framebuffer':this[_0x452a48(0x18b)],'pass':Cesium$6[_0x452a48(0x1b5)]['OPAQUE'],'pickOnly':!![],'owner':this});}case _0x452a48(0x14e):{return new Cesium$6['ComputeCommand']({'owner':this,'fragmentShaderSource':this[_0x452a48(0x15f)],'uniformMap':this[_0x452a48(0x152)],'outputTexture':this['outputTexture'],'persists':!![]});}}}},{'key':_0xcbd15d(0x11d),'value':function _0x488072(_0x5c1fbc,_0xd356cd){var _0x30aa64=_0xcbd15d;this['geometry']=_0xd356cd;var _0x2336a3=Cesium$6['VertexArray']['fromGeometry']({'context':_0x5c1fbc,'geometry':this[_0x30aa64(0x16a)],'attributeLocations':this['attributeLocations'],'bufferUsage':Cesium$6['BufferUsage']['STATIC_DRAW']});this['commandToExecute']['vertexArray']=_0x2336a3;}},{'key':'update','value':function _0x2f78b5(_0x4d7fb1){var _0x28fa5c=_0xcbd15d;if(!this['show'])return;if(_0x4d7fb1['mode']!==Cesium$6['SceneMode']['SCENE3D'])return;!Cesium$6['defined'](this['commandToExecute'])&&(this['commandToExecute']=this['createCommand'](_0x4d7fb1['context'])),Cesium$6['defined'](this[_0x28fa5c(0x11e)])&&this[_0x28fa5c(0x11e)](),Cesium$6[_0x28fa5c(0x129)](this['clearCommand'])&&_0x4d7fb1['commandList']['push'](this[_0x28fa5c(0x1ec)]),_0x4d7fb1['commandList']['push'](this['commandToExecute']);}},{'key':'isDestroyed','value':function _0x29b523(){return![];}},{'key':'destroy','value':function _0x3dafd7(){var _0x3333dd=_0xcbd15d;if(this['clearCommand']){var _0x28da91,_0x123ccf;(_0x28da91=this[_0x3333dd(0x1ec)])!==null&&_0x28da91!==void 0x0&&_0x28da91['vertexArray']&&this['clearCommand'][_0x3333dd(0x195)]['destroy'](),(_0x123ccf=this['clearCommand'])!==null&&_0x123ccf!==void 0x0&&_0x123ccf['shaderProgram']&&this['clearCommand']['shaderProgram'][_0x3333dd(0x13a)](),delete this[_0x3333dd(0x1ec)];}return this['commandToExecute']&&(this[_0x3333dd(0x1bd)]['vertexArray']&&this[_0x3333dd(0x1bd)]['vertexArray']['destroy'](),this[_0x3333dd(0x1bd)][_0x3333dd(0x108)]&&this['commandToExecute']['shaderProgram']['destroy'](),delete this['commandToExecute']),Cesium$6['destroyObject'](this);}}]),_0x505318;}()),Cesium$5=mars3d__namespace['Cesium'],Util=(function(){var _0x35cdb0=function _0x2f9d2c(){var _0x285828=_0x5a79,_0x3d416c=new Cesium$5['Geometry']({'attributes':new Cesium$5[(_0x285828(0x120))]({'position':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype'][_0x285828(0x116)],'componentsPerAttribute':0x3,'values':new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0])}),'st':new Cesium$5['GeometryAttribute']({'componentDatatype':Cesium$5['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':new Float32Array([0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x1])})}),'indices':new Uint32Array([0x3,0x2,0x0,0x0,0x2,0x1])});return _0x3d416c;},_0x355a9f=function _0x2c5c5e(_0x2d72af,_0x12a582){if(Cesium$5['defined'](_0x12a582)){var _0x358f1e={};_0x358f1e['arrayBufferView']=_0x12a582,_0x2d72af['source']=_0x358f1e;}var _0x414303=new Cesium$5['Texture'](_0x2d72af);return _0x414303;},_0x243db2=function _0x2316bf(_0x236537,_0x5f47e5,_0x45ad29){var _0x2027e8=_0x5a79,_0xa38309=new Cesium$5[(_0x2027e8(0x139))]({'context':_0x236537,'colorTextures':[_0x5f47e5],'depthTexture':_0x45ad29});return _0xa38309;},_0x2c3de4=function _0x4b2b67(_0x3f4d33){var _0x149cea=_0x5a79,_0x33714f=!![],_0x2293c5=![],_0x19754e={'viewport':_0x3f4d33[_0x149cea(0x10c)],'depthTest':_0x3f4d33['depthTest'],'depthMask':_0x3f4d33['depthMask'],'blending':_0x3f4d33['blending']},_0x83c11a=Cesium$5['Appearance'][_0x149cea(0x1fa)](_0x33714f,_0x2293c5,_0x19754e);return _0x83c11a;},_0x2d0630=function _0x321a44(_0x36bef2){var _0x386438=_0x5a79,_0x139a83={},_0x47f0c4=Cesium$5['Math']['mod'](_0x36bef2['west'],Cesium$5['Math']['TWO_PI']),_0x2caa3b=Cesium$5['Math']['mod'](_0x36bef2[_0x386438(0x199)],Cesium$5['Math'][_0x386438(0x1de)]),_0x2f2692=_0x36bef2[_0x386438(0x1f0)],_0x1f1275,_0x28d8c0;_0x2f2692>Cesium$5['Math'][_0x386438(0x19a)]?(_0x1f1275=0x0,_0x28d8c0=Cesium$5['Math'][_0x386438(0x1de)]):_0x2caa3b-_0x47f0c4<_0x2f2692?(_0x1f1275=_0x47f0c4,_0x28d8c0=_0x47f0c4+_0x2f2692):(_0x1f1275=_0x47f0c4,_0x28d8c0=_0x2caa3b);_0x139a83[_0x386438(0x214)]={'min':Cesium$5[_0x386438(0x13b)]['toDegrees'](_0x1f1275),'max':Cesium$5['Math']['toDegrees'](_0x28d8c0)};var _0x4f7b29=_0x36bef2['south'],_0x41394a=_0x36bef2[_0x386438(0x182)],_0x180615=_0x36bef2['height'],_0x3aa705=_0x180615>Cesium$5[_0x386438(0x13b)]['PI']/0xc?_0x180615/0x2:0x0,_0x40cf4f=Cesium$5['Math']['clampToLatitudeRange'](_0x4f7b29-_0x3aa705),_0x49600c=Cesium$5[_0x386438(0x13b)]['clampToLatitudeRange'](_0x41394a+_0x3aa705);return _0x40cf4f<-Cesium$5[_0x386438(0x13b)]['PI_OVER_THREE']&&(_0x40cf4f=-Cesium$5['Math'][_0x386438(0x187)]),_0x49600c>Cesium$5[_0x386438(0x13b)]['PI_OVER_THREE']&&(_0x49600c=Cesium$5['Math']['PI_OVER_TWO']),_0x139a83[_0x386438(0x201)]={'min':Cesium$5[_0x386438(0x13b)]['toDegrees'](_0x40cf4f),'max':Cesium$5[_0x386438(0x13b)]['toDegrees'](_0x49600c)},_0x139a83;};return{'getFullscreenQuad':_0x35cdb0,'createTexture':_0x355a9f,'createFramebuffer':_0x243db2,'createRawRenderState':_0x2c3de4,'viewRectangleToLonLatRange':_0x2d0630};}()),segmentDraw_vert='in\x20vec2\x20st;\x0a//\x20it\x20is\x20not\x20normal\x20itself,\x20but\x20used\x20to\x20control\x20normal\x0ain\x20vec3\x20normal;\x20//\x20(point\x20to\x20use,\x20offset\x20sign,\x20not\x20used\x20component)\x0a\x0auniform\x20sampler2D\x20currentParticlesPosition;\x0auniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20postProcessingSpeed;\x0a\x0auniform\x20float\x20particleHeight;\x0a\x0auniform\x20float\x20aspect;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20lineWidth;\x0a\x0aout\x20float\x20speedNormalization;\x0a\x0avec3\x20convertCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20WGS84\x20(lon,\x20lat,\x20lev)\x20->\x20ECEF\x20(x,\x20y,\x20z)\x0a\x20\x20\x20\x20//\x20see\x20https://en.wikipedia.org/wiki/Geographic_coordinate_conversion#From_geodetic_to_ECEF_coordinates\x20for\x20detail\x0a\x0a\x20\x20\x20\x20//\x20WGS\x2084\x20geometric\x20constants\x0a\x20\x20\x20\x20float\x20a\x20=\x206378137.0;\x20//\x20Semi-major\x20axis\x0a\x20\x20\x20\x20float\x20b\x20=\x206356752.3142;\x20//\x20Semi-minor\x20axis\x0a\x20\x20\x20\x20float\x20e2\x20=\x206.69437999014e-3;\x20//\x20First\x20eccentricity\x20squared\x0a\x0a\x20\x20\x20\x20float\x20latitude\x20=\x20radians(lonLatLev.y);\x0a\x20\x20\x20\x20float\x20longitude\x20=\x20radians(lonLatLev.x);\x0a\x0a\x20\x20\x20\x20float\x20cosLat\x20=\x20cos(latitude);\x0a\x20\x20\x20\x20float\x20sinLat\x20=\x20sin(latitude);\x0a\x20\x20\x20\x20float\x20cosLon\x20=\x20cos(longitude);\x0a\x20\x20\x20\x20float\x20sinLon\x20=\x20sin(longitude);\x0a\x0a\x20\x20\x20\x20float\x20N_Phi\x20=\x20a\x20/\x20sqrt(1.0\x20-\x20e2\x20*\x20sinLat\x20*\x20sinLat);\x0a\x20\x20\x20\x20float\x20h\x20=\x20particleHeight;\x20//\x20it\x20should\x20be\x20high\x20enough\x20otherwise\x20the\x20particle\x20may\x20not\x20pass\x20the\x20terrain\x20depth\x20test\x0a\x0a\x20\x20\x20\x20vec3\x20cartesian\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20cartesian.x\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20cosLon;\x0a\x20\x20\x20\x20cartesian.y\x20=\x20(N_Phi\x20+\x20h)\x20*\x20cosLat\x20*\x20sinLon;\x0a\x20\x20\x20\x20cartesian.z\x20=\x20((b\x20*\x20b)\x20/\x20(a\x20*\x20a)\x20*\x20N_Phi\x20+\x20h)\x20*\x20sinLat;\x0a\x20\x20\x20\x20return\x20cartesian;\x0a}\x0a\x0avec4\x20calcProjectedCoordinate(vec3\x20lonLatLev)\x20{\x0a\x20\x20\x20\x20//\x20the\x20range\x20of\x20longitude\x20in\x20Cesium\x20is\x20[-180,\x20180]\x20but\x20the\x20range\x20of\x20longitude\x20in\x20the\x20NetCDF\x20file\x20is\x20[0,\x20360]\x0a\x20\x20\x20\x20//\x20[0,\x20180]\x20is\x20corresponding\x20to\x20[0,\x20180]\x20and\x20[180,\x20360]\x20is\x20corresponding\x20to\x20[-180,\x200]\x0a\x20\x20\x20\x20lonLatLev.x\x20=\x20mod(lonLatLev.x\x20+\x20180.0,\x20360.0)\x20-\x20180.0;\x0a\x20\x20\x20\x20vec3\x20particlePosition\x20=\x20convertCoordinate(lonLatLev);\x0a\x20\x20\x20\x20vec4\x20projectedCoordinate\x20=\x20czm_modelViewProjection\x20*\x20vec4(particlePosition,\x201.0);\x0a\x20\x20\x20\x20return\x20projectedCoordinate;\x0a}\x0a\x0avec4\x20calcOffset(vec4\x20currentProjectedCoordinate,\x20vec4\x20nextProjectedCoordinate,\x20float\x20offsetSign)\x20{\x0a\x20\x20\x20\x20vec2\x20aspectVec2\x20=\x20vec2(aspect,\x201.0);\x0a\x20\x20\x20\x20vec2\x20currentXY\x20=\x20(currentProjectedCoordinate.xy\x20/\x20currentProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x20\x20\x20\x20vec2\x20nextXY\x20=\x20(nextProjectedCoordinate.xy\x20/\x20nextProjectedCoordinate.w)\x20*\x20aspectVec2;\x0a\x0a\x20\x20\x20\x20float\x20offsetLength\x20=\x20lineWidth\x20/\x202.0;\x0a\x20\x20\x20\x20vec2\x20direction\x20=\x20normalize(nextXY\x20-\x20currentXY);\x0a\x20\x20\x20\x20vec2\x20normalVector\x20=\x20vec2(-direction.y,\x20direction.x);\x0a\x20\x20\x20\x20normalVector.x\x20=\x20normalVector.x\x20/\x20aspect;\x0a\x20\x20\x20\x20normalVector\x20=\x20offsetLength\x20*\x20normalVector;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20vec4(offsetSign\x20*\x20normalVector,\x200.0,\x200.0);\x0a\x20\x20\x20\x20return\x20offset;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec2\x20particleIndex\x20=\x20st;\x0a\x0a\x20\x20\x20\x20vec3\x20currentPosition\x20=\x20texture(currentParticlesPosition,\x20particleIndex).rgb;\x0a\x20\x20\x20\x20vec4\x20nextPosition\x20=\x20texture(postProcessingPosition,\x20particleIndex);\x0a\x0a\x20\x20\x20\x20vec4\x20currentProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20vec4\x20nextProjectedCoordinate\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(nextPosition.w\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20currentProjectedCoordinate\x20=\x20calcProjectedCoordinate(currentPosition);\x0a\x20\x20\x20\x20\x20\x20\x20\x20nextProjectedCoordinate\x20=\x20calcProjectedCoordinate(nextPosition.xyz);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20float\x20pointToUse\x20=\x20normal.x;\x20//\x20-1\x20is\x20currentProjectedCoordinate\x20and\x20+1\x20is\x20nextProjectedCoordinate\x0a\x20\x20\x20\x20float\x20offsetSign\x20=\x20normal.y;\x0a\x0a\x20\x20\x20\x20vec4\x20offset\x20=\x20pixelSize\x20*\x20calcOffset(currentProjectedCoordinate,\x20nextProjectedCoordinate,\x20offsetSign);\x0a\x20\x20\x20\x20if\x20(pointToUse\x20<\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20currentProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20nextProjectedCoordinate\x20+\x20offset;\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20speedNormalization\x20=\x20texture(postProcessingSpeed,\x20particleIndex).a;\x0a}\x0a',segmentDraw_frag=_0x2906f7(0x146),fullscreen_vert=_0x2906f7(0x1e2),trailDraw_frag='uniform\x20sampler2D\x20segmentsColorTexture;\x0auniform\x20sampler2D\x20segmentsDepthTexture;\x0a\x0auniform\x20sampler2D\x20currentTrailsColor;\x0auniform\x20sampler2D\x20trailsDepthTexture;\x0a\x0auniform\x20float\x20fadeOpacity;\x0a\x0ain\x20vec2\x20textureCoordinate;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20pointsColor\x20=\x20texture(segmentsColorTexture,\x20textureCoordinate);\x0a\x20\x20\x20\x20vec4\x20trailsColor\x20=\x20texture(currentTrailsColor,\x20textureCoordinate);\x0a\x0a\x20\x20\x20\x20trailsColor\x20=\x20floor(fadeOpacity\x20*\x20255.0\x20*\x20trailsColor)\x20/\x20255.0;\x20//\x20make\x20sure\x20the\x20trailsColor\x20will\x20be\x20strictly\x20decreased\x0a\x0a\x20\x20\x20\x20float\x20pointsDepth\x20=\x20texture(segmentsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20trailsDepth\x20=\x20texture(trailsDepthTexture,\x20textureCoordinate).r;\x0a\x20\x20\x20\x20float\x20globeDepth\x20=\x20czm_unpackDepth(texture(czm_globeDepthTexture,\x20textureCoordinate));\x0a\x0a\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20if\x20(pointsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20pointsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20if\x20(trailsDepth\x20<\x20globeDepth)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20out_FragColor\x20+\x20trailsColor;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20gl_FragDepth\x20=\x20min(pointsDepth,\x20trailsDepth);\x0a}\x0a',screenDraw_frag=_0x2906f7(0x1f1),Cesium$4=mars3d__namespace['Cesium'],ParticlesRendering=(function(){var _0x4815bd=_0x2906f7;function _0x3d5e08(_0xa930f0,_0x19a5a4,_0x2b3309,_0x1ace67,_0x5e9145){var _0x16c6b7=_0x5a79;_classCallCheck(this,_0x3d5e08),this[_0x16c6b7(0x141)](_0xa930f0,_0x19a5a4,_0x2b3309['colors']),this[_0x16c6b7(0x1f3)](_0xa930f0),this[_0x16c6b7(0x1f9)](_0xa930f0,_0x2b3309,_0x1ace67,_0x5e9145);}return _createClass(_0x3d5e08,[{'key':'createRenderingTextures','value':function _0x485a2e(_0x2d83fe,_0x439a3f,_0x26b3d1){var _0x491034=_0x5a79,_0x23f4dc={'context':_0x2d83fe,'width':_0x2d83fe['drawingBufferWidth'],'height':_0x2d83fe[_0x491034(0x1dc)],'pixelFormat':Cesium$4['PixelFormat']['RGBA'],'pixelDatatype':Cesium$4['PixelDatatype']['UNSIGNED_BYTE']},_0x325959={'context':_0x2d83fe,'width':_0x2d83fe['drawingBufferWidth'],'height':_0x2d83fe['drawingBufferHeight'],'pixelFormat':Cesium$4['PixelFormat']['DEPTH_COMPONENT'],'pixelDatatype':Cesium$4[_0x491034(0x203)]['UNSIGNED_INT']},_0xf2db80=_0x26b3d1['length'],_0x1ca2a6=new Float32Array(_0xf2db80*0x3);for(var _0x3edcf0=0x0;_0x3edcf0<_0xf2db80;_0x3edcf0++){var _0x693188=Cesium$4[_0x491034(0x1ca)]['fromCssColorString'](_0x26b3d1[_0x3edcf0]);_0x1ca2a6[0x3*_0x3edcf0]=_0x693188[_0x491034(0x1c1)],_0x1ca2a6[0x3*_0x3edcf0+0x1]=_0x693188[_0x491034(0x148)],_0x1ca2a6[0x3*_0x3edcf0+0x2]=_0x693188['blue'];}var _0xae168f={'context':_0x2d83fe,'width':_0xf2db80,'height':0x1,'pixelFormat':Cesium$4['PixelFormat']['RGB'],'pixelDatatype':Cesium$4['PixelDatatype'][_0x491034(0x116)],'sampler':new Cesium$4['Sampler']({'minificationFilter':Cesium$4[_0x491034(0x1c2)][_0x491034(0x119)],'magnificationFilter':Cesium$4['TextureMagnificationFilter']['LINEAR']})};this['textures']={'segmentsColor':Util['createTexture'](_0x23f4dc),'segmentsDepth':Util['createTexture'](_0x325959),'currentTrailsColor':Util['createTexture'](_0x23f4dc),'currentTrailsDepth':Util['createTexture'](_0x325959),'nextTrailsColor':Util[_0x491034(0x1c0)](_0x23f4dc),'nextTrailsDepth':Util['createTexture'](_0x325959),'colorTable':Util[_0x491034(0x1c0)](_0xae168f,_0x1ca2a6)};}},{'key':'createRenderingFramebuffers','value':function _0x7c708c(_0x587bb7){var _0x2023be=_0x5a79;this[_0x2023be(0x175)]={'segments':Util[_0x2023be(0x196)](_0x587bb7,this['textures']['segmentsColor'],this[_0x2023be(0x1b8)]['segmentsDepth']),'currentTrails':Util['createFramebuffer'](_0x587bb7,this[_0x2023be(0x1b8)]['currentTrailsColor'],this['textures'][_0x2023be(0x13e)]),'nextTrails':Util[_0x2023be(0x196)](_0x587bb7,this['textures'][_0x2023be(0x1e4)],this[_0x2023be(0x1b8)][_0x2023be(0x154)])};}},{'key':_0x4815bd(0x189),'value':function _0x5cede4(_0x52e785){var _0x4ed7a5=_0x4815bd,_0x238b59=0x4,_0x2a117a=[];for(var _0x36a8da=0x0;_0x36a8da<_0x52e785['particlesTextureSize'];_0x36a8da++){for(var _0x430d62=0x0;_0x430d62<_0x52e785[_0x4ed7a5(0x1bb)];_0x430d62++){for(var _0x5b122b=0x0;_0x5b122b<_0x238b59;_0x5b122b++){_0x2a117a['push'](_0x36a8da/_0x52e785[_0x4ed7a5(0x1bb)]),_0x2a117a[_0x4ed7a5(0x209)](_0x430d62/_0x52e785['particlesTextureSize']);}}}_0x2a117a=new Float32Array(_0x2a117a);var _0x4a97bf=[],_0x268ad9=[-0x1,0x1],_0x315761=[-0x1,0x1];for(var _0x3fe28f=0x0;_0x3fe28f<_0x52e785['maxParticles'];_0x3fe28f++){for(var _0x174b87=0x0;_0x174b87<_0x238b59/0x2;_0x174b87++){for(var _0x3c72b=0x0;_0x3c72b<_0x238b59/0x2;_0x3c72b++){_0x4a97bf[_0x4ed7a5(0x209)](_0x268ad9[_0x174b87]),_0x4a97bf['push'](_0x315761[_0x3c72b]),_0x4a97bf['push'](0x0);}}}_0x4a97bf=new Float32Array(_0x4a97bf);var _0x34261f=0x6*_0x52e785['maxParticles'],_0x280eac=new Uint32Array(_0x34261f);for(var _0x1e3fcf=0x0,_0x1b3260=0x0,_0x119d60=0x0;_0x1e3fcf<_0x52e785[_0x4ed7a5(0x14c)];_0x1e3fcf++){_0x280eac[_0x1b3260++]=_0x119d60+0x0,_0x280eac[_0x1b3260++]=_0x119d60+0x1,_0x280eac[_0x1b3260++]=_0x119d60+0x2,_0x280eac[_0x1b3260++]=_0x119d60+0x2,_0x280eac[_0x1b3260++]=_0x119d60+0x1,_0x280eac[_0x1b3260++]=_0x119d60+0x3,_0x119d60+=0x4;}var _0x44005b=new Cesium$4['Geometry']({'attributes':new Cesium$4[(_0x4ed7a5(0x120))]({'st':new Cesium$4[(_0x4ed7a5(0x143))]({'componentDatatype':Cesium$4['ComponentDatatype']['FLOAT'],'componentsPerAttribute':0x2,'values':_0x2a117a}),'normal':new Cesium$4['GeometryAttribute']({'componentDatatype':Cesium$4['ComponentDatatype'][_0x4ed7a5(0x116)],'componentsPerAttribute':0x3,'values':_0x4a97bf})}),'indices':_0x280eac});return _0x44005b;}},{'key':_0x4815bd(0x1f9),'value':function _0x542604(_0x34e69f,_0x4f94f6,_0x2411ea,_0x39a6d6){var _0x4c700b=_0x4815bd,_0x44056a=this;this['primitives']={'segments':new CustomPrimitive({'commandType':_0x4c700b(0x1d4),'attributeLocations':{'st':0x0,'normal':0x1},'geometry':this['createSegmentsGeometry'](_0x4f94f6),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'currentParticlesPosition':function _0x52e59a(){return _0x39a6d6['particlesTextures']['currentParticlesPosition'];},'postProcessingPosition':function _0x36d921(){return _0x39a6d6['particlesTextures']['postProcessingPosition'];},'postProcessingSpeed':function _0x1b4f6f(){var _0x43e7e4=_0x4c700b;return _0x39a6d6['particlesTextures'][_0x43e7e4(0x20a)];},'colorTable':function _0x1625b9(){return _0x44056a['textures']['colorTable'];},'aspect':function _0xc6fc3b(){var _0x13a060=_0x4c700b;return _0x34e69f['drawingBufferWidth']/_0x34e69f[_0x13a060(0x1dc)];},'pixelSize':function _0x38346e(){return _0x2411ea['pixelSize'];},'lineWidth':function _0xccf906(){var _0x35796e=_0x4c700b;return _0x4f94f6[_0x35796e(0x132)];},'particleHeight':function _0x4dd0ee(){return _0x4f94f6['particleHeight'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'sources':[segmentDraw_frag]}),'rawRenderState':Util[_0x4c700b(0x1ba)]({'viewport':undefined,'depthTest':{'enabled':!![]},'depthMask':!![]}),'framebuffer':this['framebuffers']['segments'],'autoClear':!![]}),'trails':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4[_0x4c700b(0x20d)]['TRIANGLES'],'uniformMap':{'segmentsColorTexture':function _0x32e64e(){var _0x4662bd=_0x4c700b;return _0x44056a[_0x4662bd(0x1b8)]['segmentsColor'];},'segmentsDepthTexture':function _0x5afcca(){var _0x50d390=_0x4c700b;return _0x44056a[_0x50d390(0x1b8)][_0x50d390(0x104)];},'currentTrailsColor':function _0x34706e(){var _0x3229be=_0x4c700b;return _0x44056a['framebuffers'][_0x3229be(0x135)]['getColorTexture'](0x0);},'trailsDepthTexture':function _0x49242f(){var _0x2cc0ff=_0x4c700b;return _0x44056a[_0x2cc0ff(0x175)]['currentTrails'][_0x2cc0ff(0x1e1)];},'fadeOpacity':function _0x1bf03a(){return _0x4f94f6['fadeOpacity'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_GL_POSITION_LOG_DEPTH'],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_LOG_DEPTH_FRAGMENT_WRITE'],'sources':[trailDraw_frag]}),'rawRenderState':Util[_0x4c700b(0x1ba)]({'viewport':undefined,'depthTest':{'enabled':!![],'func':Cesium$4[_0x4c700b(0x1b1)]['ALWAYS']},'depthMask':!![]}),'framebuffer':this[_0x4c700b(0x175)]['nextTrails'],'autoClear':!![],'preExecute':function _0x6b9fff(){var _0x317381=_0x4c700b,_0x5c2b42=_0x44056a['framebuffers']['currentTrails'];_0x44056a[_0x317381(0x175)]['currentTrails']=_0x44056a['framebuffers'][_0x317381(0x161)],_0x44056a[_0x317381(0x175)]['nextTrails']=_0x5c2b42,_0x44056a[_0x317381(0x198)]['trails']['commandToExecute']['framebuffer']=_0x44056a[_0x317381(0x175)]['nextTrails'],_0x44056a[_0x317381(0x198)]['trails']['clearCommand']['framebuffer']=_0x44056a[_0x317381(0x175)][_0x317381(0x161)];}}),'screen':new CustomPrimitive({'commandType':'Draw','attributeLocations':{'position':0x0,'st':0x1},'geometry':Util['getFullscreenQuad'](),'primitiveType':Cesium$4['PrimitiveType']['TRIANGLES'],'uniformMap':{'trailsColorTexture':function _0x123db8(){var _0x8411d8=_0x4c700b;return _0x44056a[_0x8411d8(0x175)]['nextTrails']['getColorTexture'](0x0);},'trailsDepthTexture':function _0x537435(){return _0x44056a['framebuffers']['nextTrails']['depthTexture'];}},'vertexShaderSource':new Cesium$4['ShaderSource']({'defines':['DISABLE_GL_POSITION_LOG_DEPTH'],'sources':[fullscreen_vert]}),'fragmentShaderSource':new Cesium$4['ShaderSource']({'defines':[_0x4c700b(0x1dd)],'sources':[screenDraw_frag]}),'rawRenderState':Util['createRawRenderState']({'viewport':undefined,'depthTest':{'enabled':![]},'depthMask':!![],'blending':{'enabled':!![]}}),'framebuffer':undefined})};}}]),_0x3d5e08;}()),getWind_frag=_0x2906f7(0x1a0),updateSpeed_frag='uniform\x20sampler2D\x20currentParticlesSpeed;\x20//\x20(u,\x20v,\x20w,\x20normalization)\x0auniform\x20sampler2D\x20particlesWind;\x0a\x0a//\x20used\x20to\x20calculate\x20the\x20wind\x20norm\x0auniform\x20vec2\x20uSpeedRange;\x20//\x20(min,\x20max);\x0auniform\x20vec2\x20vSpeedRange;\x0auniform\x20float\x20pixelSize;\x0auniform\x20float\x20speedFactor;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0afloat\x20calculateWindNorm(vec3\x20speed)\x20{\x0a\x20\x20\x20\x20vec3\x20percent\x20=\x20vec3(0.0);\x0a\x20\x20\x20\x20percent.x\x20=\x20(speed.x\x20-\x20uSpeedRange.x)\x20/\x20(uSpeedRange.y\x20-\x20uSpeedRange.x);\x0a\x20\x20\x20\x20percent.y\x20=\x20(speed.y\x20-\x20vSpeedRange.x)\x20/\x20(vSpeedRange.y\x20-\x20vSpeedRange.x);\x0a\x20\x20\x20\x20float\x20normalization\x20=\x20length(percent);\x0a\x0a\x20\x20\x20\x20return\x20normalization;\x0a}\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20//\x20texture\x20coordinate\x20must\x20be\x20normalized\x0a\x20\x20\x20\x20//\x20vec3\x20currentSpeed\x20=\x20texture(currentParticlesSpeed,\x20v_textureCoordinates).rgb;\x0a\x20\x20\x20\x20vec3\x20windVector\x20=\x20texture(particlesWind,\x20v_textureCoordinates).rgb;\x0a\x0a\x20\x20\x20\x20vec4\x20nextSpeed\x20=\x20vec4(speedFactor\x20*\x20pixelSize\x20*\x20windVector,\x20calculateWindNorm(windVector));\x0a\x20\x20\x20\x20out_FragColor\x20=\x20nextSpeed;\x0a}\x0a',updatePosition_frag=_0x2906f7(0x17f),postProcessingPosition_frag=_0x2906f7(0x171),postProcessingSpeed_frag='uniform\x20sampler2D\x20postProcessingPosition;\x0auniform\x20sampler2D\x20nextParticlesSpeed;\x0a\x0ain\x20vec2\x20v_textureCoordinates;\x0a\x0avoid\x20main()\x20{\x0a\x20\x20\x20\x20vec4\x20randomParticle\x20=\x20texture(postProcessingPosition,\x20v_textureCoordinates);\x0a\x20\x20\x20\x20vec4\x20particleSpeed\x20=\x20texture(nextParticlesSpeed,\x20v_textureCoordinates);\x0a\x0a\x20\x20\x20\x20if\x20(randomParticle.a\x20>\x200.0)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20vec4(0.0);\x0a\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20out_FragColor\x20=\x20particleSpeed;\x0a\x20\x20\x20\x20}\x0a}\x0a',Cesium$3=mars3d__namespace[_0x2906f7(0x183)],ParticlesComputing=(function(){function _0x40d4c6(_0x460d84,_0xd075f2,_0x544de8,_0x17d14c){var _0x131a91=_0x5a79;_classCallCheck(this,_0x40d4c6),this['data']=_0xd075f2,this['createWindTextures'](_0x460d84,_0xd075f2),this['createParticlesTextures'](_0x460d84,_0x544de8,_0x17d14c),this[_0x131a91(0x210)](_0xd075f2,_0x544de8,_0x17d14c);}return _createClass(_0x40d4c6,[{'key':'createWindTextures','value':function _0x233b5b(_0x5a7d80,_0x32f928){var _0x780e67=_0x5a79,_0x5e1ae2={'context':_0x5a7d80,'width':_0x32f928['dimensions'][_0x780e67(0x214)],'height':_0x32f928['dimensions']['lat']*(_0x32f928['dimensions'][_0x780e67(0x133)]||0x1),'pixelFormat':Cesium$3['PixelFormat']['LUMINANCE'],'pixelDatatype':Cesium$3['PixelDatatype']['FLOAT'],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter']['NEAREST'],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})};this['windTextures']={'U':Util['createTexture'](_0x5e1ae2,_0x32f928['U']['array']),'V':Util[_0x780e67(0x1c0)](_0x5e1ae2,_0x32f928['V'][_0x780e67(0x1f4)])};}},{'key':'createParticlesTextures','value':function _0x397e51(_0x213add,_0x5764e5,_0x38f2e9){var _0x564dc6=_0x5a79,_0x3fe057={'context':_0x213add,'width':_0x5764e5['particlesTextureSize'],'height':_0x5764e5['particlesTextureSize'],'pixelFormat':Cesium$3['PixelFormat'][_0x564dc6(0x1a7)],'pixelDatatype':Cesium$3['PixelDatatype']['FLOAT'],'flipY':![],'sampler':new Cesium$3['Sampler']({'minificationFilter':Cesium$3['TextureMinificationFilter'][_0x564dc6(0x1c7)],'magnificationFilter':Cesium$3['TextureMagnificationFilter']['NEAREST']})},_0x58c33d=this['randomizeParticles'](_0x5764e5[_0x564dc6(0x14c)],_0x38f2e9),_0x33dcd3=new Float32Array(0x4*_0x5764e5[_0x564dc6(0x14c)])['fill'](0x0);this['particlesTextures']={'particlesWind':Util[_0x564dc6(0x1c0)](_0x3fe057),'currentParticlesPosition':Util['createTexture'](_0x3fe057,_0x58c33d),'nextParticlesPosition':Util[_0x564dc6(0x1c0)](_0x3fe057,_0x58c33d),'currentParticlesSpeed':Util['createTexture'](_0x3fe057,_0x33dcd3),'nextParticlesSpeed':Util['createTexture'](_0x3fe057,_0x33dcd3),'postProcessingPosition':Util['createTexture'](_0x3fe057,_0x58c33d),'postProcessingSpeed':Util['createTexture'](_0x3fe057,_0x33dcd3)};}},{'key':'randomizeParticles','value':function _0x60c458(_0xbc652f,_0x2677e1){var _0x4618b2=_0x5a79,_0x483653=new Float32Array(0x4*_0xbc652f);for(var _0x37c1f4=0x0;_0x37c1f4<_0xbc652f;_0x37c1f4++){_0x483653[0x4*_0x37c1f4]=Cesium$3['Math'][_0x4618b2(0x10f)](_0x2677e1['lonRange']['x'],_0x2677e1['lonRange']['y']),_0x483653[0x4*_0x37c1f4+0x1]=Cesium$3[_0x4618b2(0x13b)][_0x4618b2(0x10f)](_0x2677e1[_0x4618b2(0x147)]['x'],_0x2677e1['latRange']['y']),_0x483653[0x4*_0x37c1f4+0x2]=Cesium$3['Math']['randomBetween'](this[_0x4618b2(0x165)]['lev']['min'],this['data'][_0x4618b2(0x133)]['max']),_0x483653[0x4*_0x37c1f4+0x3]=0x0;}return _0x483653;}},{'key':'destroyParticlesTextures','value':function _0x1943b6(){var _0x9533a9=_0x5a79,_0x18a288=this;Object['keys'](this[_0x9533a9(0x202)])[_0x9533a9(0x124)](function(_0xfccba0){_0x18a288['particlesTextures'][_0xfccba0]['destroy']();});}},{'key':'createComputingPrimitives','value':function _0x3bf60a(_0x2f11c8,_0x2e54c9,_0xb6023b){var _0x523ccc=_0x5a79,_0x5cda96=new Cesium$3[(_0x523ccc(0x169))](_0x2f11c8['dimensions']['lon'],_0x2f11c8['dimensions']['lat'],_0x2f11c8['dimensions']['lev']),_0x15a52c=new Cesium$3['Cartesian3'](_0x2f11c8['lon']['min'],_0x2f11c8['lat']['min'],_0x2f11c8['lev']['min']),_0x26507b=new Cesium$3['Cartesian3'](_0x2f11c8['lon'][_0x523ccc(0x1d9)],_0x2f11c8['lat']['max'],_0x2f11c8[_0x523ccc(0x133)]['max']),_0x5b7273=new Cesium$3[(_0x523ccc(0x169))]((_0x26507b['x']-_0x15a52c['x'])/(_0x5cda96['x']-0x1),(_0x26507b['y']-_0x15a52c['y'])/(_0x5cda96['y']-0x1),_0x5cda96['z']>0x1?(_0x26507b['z']-_0x15a52c['z'])/(_0x5cda96['z']-0x1):0x1),_0x35faab=new Cesium$3['Cartesian2'](_0x2f11c8['U']['min'],_0x2f11c8['U']['max']),_0x52a92d=new Cesium$3['Cartesian2'](_0x2f11c8['V']['min'],_0x2f11c8['V']['max']),_0x55eb55=this;this[_0x523ccc(0x198)]={'getWind':new CustomPrimitive({'commandType':_0x523ccc(0x14e),'uniformMap':{'U':function _0x344a57(){return _0x55eb55['windTextures']['U'];},'V':function _0x20f2cb(){return _0x55eb55['windTextures']['V'];},'currentParticlesPosition':function _0x39372e(){var _0x96e48d=_0x523ccc;return _0x55eb55['particlesTextures'][_0x96e48d(0x14f)];},'dimension':function _0x24a891(){return _0x5cda96;},'minimum':function _0x536bb2(){return _0x15a52c;},'maximum':function _0x5353bc(){return _0x26507b;},'interval':function _0x1688c7(){return _0x5b7273;}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[getWind_frag]}),'outputTexture':this['particlesTextures'][_0x523ccc(0x1b6)],'preExecute':function _0x3b2345(){_0x55eb55['primitives']['getWind']['commandToExecute']['outputTexture']=_0x55eb55['particlesTextures']['particlesWind'];}}),'updateSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesSpeed':function _0x37bcc6(){var _0x4638a2=_0x523ccc;return _0x55eb55['particlesTextures'][_0x4638a2(0x1a8)];},'particlesWind':function _0x177b75(){var _0x21f250=_0x523ccc;return _0x55eb55[_0x21f250(0x202)]['particlesWind'];},'uSpeedRange':function _0x4ac798(){return _0x35faab;},'vSpeedRange':function _0x1f2b6b(){return _0x52a92d;},'pixelSize':function _0x4f3062(){var _0x1350d3=_0x523ccc;return _0xb6023b[_0x1350d3(0x12e)];},'speedFactor':function _0xbfac47(){var _0x122174=_0x523ccc;return _0x2e54c9[_0x122174(0x138)];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[updateSpeed_frag]}),'outputTexture':this['particlesTextures'][_0x523ccc(0x200)],'preExecute':function _0xc3bca6(){var _0x11888a=_0x523ccc,_0x76aa=_0x55eb55['particlesTextures']['currentParticlesSpeed'];_0x55eb55[_0x11888a(0x202)]['currentParticlesSpeed']=_0x55eb55['particlesTextures'][_0x11888a(0x20a)],_0x55eb55[_0x11888a(0x202)]['postProcessingSpeed']=_0x76aa,_0x55eb55['primitives'][_0x11888a(0x17a)]['commandToExecute']['outputTexture']=_0x55eb55['particlesTextures']['nextParticlesSpeed'];}}),'updatePosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'currentParticlesPosition':function _0x2ad70d(){return _0x55eb55['particlesTextures']['currentParticlesPosition'];},'currentParticlesSpeed':function _0x26bdc2(){var _0x4e1f56=_0x523ccc;return _0x55eb55[_0x4e1f56(0x202)]['currentParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[updatePosition_frag]}),'outputTexture':this['particlesTextures']['nextParticlesPosition'],'preExecute':function _0x41951e(){var _0xdeeae1=_0x523ccc,_0x3ea0ee=_0x55eb55['particlesTextures']['currentParticlesPosition'];_0x55eb55['particlesTextures'][_0xdeeae1(0x14f)]=_0x55eb55[_0xdeeae1(0x202)]['postProcessingPosition'],_0x55eb55[_0xdeeae1(0x202)]['postProcessingPosition']=_0x3ea0ee,_0x55eb55[_0xdeeae1(0x198)][_0xdeeae1(0x113)]['commandToExecute']['outputTexture']=_0x55eb55['particlesTextures']['nextParticlesPosition'];}}),'postProcessingPosition':new CustomPrimitive({'commandType':'Compute','uniformMap':{'nextParticlesPosition':function _0x50e66d(){var _0x214bac=_0x523ccc;return _0x55eb55['particlesTextures'][_0x214bac(0x192)];},'nextParticlesSpeed':function _0x51c197(){return _0x55eb55['particlesTextures']['nextParticlesSpeed'];},'lonRange':function _0x4f3e25(){return _0xb6023b['lonRange'];},'latRange':function _0x168cb8(){return _0xb6023b['latRange'];},'randomCoefficient':function _0x17274e(){var _0xfe2b5f=_0x523ccc,_0x114cb6=Math[_0xfe2b5f(0x164)]();return _0x114cb6;},'dropRate':function _0x1e9050(){return _0x2e54c9['dropRate'];},'dropRateBump':function _0x292782(){var _0x33892f=_0x523ccc;return _0x2e54c9[_0x33892f(0x150)];}},'fragmentShaderSource':new Cesium$3[(_0x523ccc(0x1c6))]({'sources':[postProcessingPosition_frag]}),'outputTexture':this['particlesTextures']['postProcessingPosition'],'preExecute':function _0x2719ae(){var _0x59ad2b=_0x523ccc;_0x55eb55[_0x59ad2b(0x198)][_0x59ad2b(0x213)]['commandToExecute']['outputTexture']=_0x55eb55['particlesTextures']['postProcessingPosition'];}}),'postProcessingSpeed':new CustomPrimitive({'commandType':'Compute','uniformMap':{'postProcessingPosition':function _0x532712(){return _0x55eb55['particlesTextures']['postProcessingPosition'];},'nextParticlesSpeed':function _0xbc7912(){return _0x55eb55['particlesTextures']['nextParticlesSpeed'];}},'fragmentShaderSource':new Cesium$3['ShaderSource']({'sources':[postProcessingSpeed_frag]}),'outputTexture':this['particlesTextures']['postProcessingSpeed'],'preExecute':function _0x456090(){var _0x41602b=_0x523ccc;_0x55eb55['primitives']['postProcessingSpeed'][_0x41602b(0x1bd)]['outputTexture']=_0x55eb55['particlesTextures'][_0x41602b(0x20a)];}})};}}]),_0x40d4c6;}()),Cesium$2=mars3d__namespace['Cesium'],ParticleSystem=(function(){var _0x30a856=_0x2906f7;function _0x2dd661(_0x540737,_0x50809b,_0x176a21,_0xaed166){var _0x287ac9=_0x5a79;_classCallCheck(this,_0x2dd661),this['context']=_0x540737,_0x50809b=_objectSpread2({},_0x50809b);if(_0x50809b['udata']&&_0x50809b['vdata']){var _0x5867b2,_0x4a8017,_0x48e1d2,_0x381f9d,_0x3b7da6,_0x1b4fe8;_0x50809b['dimensions']={},_0x50809b[_0x287ac9(0x1f5)]['lon']=_0x50809b[_0x287ac9(0x1d5)],_0x50809b['dimensions']['lat']=_0x50809b['rows'],_0x50809b[_0x287ac9(0x1f5)]['lev']=_0x50809b['lev']||0x1,_0x50809b['lon']={},_0x50809b['lon']['min']=_0x50809b['xmin'],_0x50809b[_0x287ac9(0x214)]['max']=_0x50809b[_0x287ac9(0x123)],_0x50809b['lat']={},_0x50809b['lat']['min']=_0x50809b[_0x287ac9(0x1f8)],_0x50809b[_0x287ac9(0x201)][_0x287ac9(0x1d9)]=_0x50809b[_0x287ac9(0x1ea)],_0x50809b['lev']={},_0x50809b['lev']['min']=(_0x5867b2=_0x50809b[_0x287ac9(0x118)])!==null&&_0x5867b2!==void 0x0?_0x5867b2:0x1,_0x50809b['lev']['max']=(_0x4a8017=_0x50809b[_0x287ac9(0x12f)])!==null&&_0x4a8017!==void 0x0?_0x4a8017:0x1,_0x50809b['U']={},_0x50809b['U']['array']=new Float32Array(_0x50809b['udata']),_0x50809b['U']['min']=(_0x48e1d2=_0x50809b['umin'])!==null&&_0x48e1d2!==void 0x0?_0x48e1d2:Math['min']['apply'](Math,_toConsumableArray(_0x50809b['udata'])),_0x50809b['U']['max']=(_0x381f9d=_0x50809b['umax'])!==null&&_0x381f9d!==void 0x0?_0x381f9d:Math[_0x287ac9(0x1d9)]['apply'](Math,_toConsumableArray(_0x50809b[_0x287ac9(0x10d)])),_0x50809b['V']={},_0x50809b['V']['array']=new Float32Array(_0x50809b['vdata']),_0x50809b['V']['min']=(_0x3b7da6=_0x50809b['vmin'])!==null&&_0x3b7da6!==void 0x0?_0x3b7da6:Math['min'][_0x287ac9(0x137)](Math,_toConsumableArray(_0x50809b[_0x287ac9(0x131)])),_0x50809b['V']['max']=(_0x1b4fe8=_0x50809b['vmax'])!==null&&_0x1b4fe8!==void 0x0?_0x1b4fe8:Math[_0x287ac9(0x1d9)]['apply'](Math,_toConsumableArray(_0x50809b[_0x287ac9(0x131)]));}this['data']=_0x50809b,this['options']=_0x176a21,this['viewerParameters']=_0xaed166,this[_0x287ac9(0x1cc)]=new ParticlesComputing(this['context'],this[_0x287ac9(0x165)],this['options'],this['viewerParameters']),this[_0x287ac9(0x1da)]=new ParticlesRendering(this[_0x287ac9(0x158)],this['data'],this[_0x287ac9(0x168)],this['viewerParameters'],this['particlesComputing']);}return _createClass(_0x2dd661,[{'key':_0x30a856(0x1ab),'value':function _0x348a49(_0x652a35){var _0x1a467e=_0x30a856,_0x10def3=this;this['particlesComputing']['destroyParticlesTextures'](),Object[_0x1a467e(0x14a)](this[_0x1a467e(0x1cc)]['windTextures'])['forEach'](function(_0x3875c6){_0x10def3['particlesComputing']['windTextures'][_0x3875c6]['destroy']();}),this[_0x1a467e(0x1da)][_0x1a467e(0x1b8)]['colorTable']['destroy'](),Object['keys'](this['particlesRendering'][_0x1a467e(0x175)])[_0x1a467e(0x124)](function(_0x1c2f5a){var _0x6ca810=_0x1a467e;_0x10def3[_0x6ca810(0x1da)]['framebuffers'][_0x1c2f5a][_0x6ca810(0x13a)]();}),this['context']=_0x652a35,this['particlesComputing']=new ParticlesComputing(this['context'],this[_0x1a467e(0x165)],this['options'],this['viewerParameters']),this[_0x1a467e(0x1da)]=new ParticlesRendering(this[_0x1a467e(0x158)],this[_0x1a467e(0x165)],this['options'],this[_0x1a467e(0x112)],this['particlesComputing']);}},{'key':'clearFramebuffers','value':function _0x487ce5(){var _0x4e75e6=_0x30a856,_0x241137=this,_0x155c3d=new Cesium$2['ClearCommand']({'color':new Cesium$2[(_0x4e75e6(0x1ca))](0x0,0x0,0x0,0x0),'depth':0x1,'framebuffer':undefined,'pass':Cesium$2['Pass']['OPAQUE']});Object[_0x4e75e6(0x14a)](this[_0x4e75e6(0x1da)]['framebuffers'])['forEach'](function(_0x1e4acc){var _0x3d1822=_0x4e75e6;_0x155c3d['framebuffer']=_0x241137['particlesRendering'][_0x3d1822(0x175)][_0x1e4acc],_0x155c3d['execute'](_0x241137['context']);});}},{'key':'refreshParticles','value':function _0x30873c(_0x8509b1){var _0x5ca08b=_0x30a856;this[_0x5ca08b(0x1d7)](),this[_0x5ca08b(0x1cc)]['destroyParticlesTextures'](),this['particlesComputing']['createParticlesTextures'](this[_0x5ca08b(0x158)],this['options'],this['viewerParameters']);if(_0x8509b1){var _0x3a6a29=this[_0x5ca08b(0x1da)]['createSegmentsGeometry'](this['options']);this['particlesRendering'][_0x5ca08b(0x198)][_0x5ca08b(0x13d)][_0x5ca08b(0x16a)]=_0x3a6a29;var _0x3f7951=Cesium$2['VertexArray']['fromGeometry']({'context':this['context'],'geometry':_0x3a6a29,'attributeLocations':this['particlesRendering']['primitives'][_0x5ca08b(0x13d)]['attributeLocations'],'bufferUsage':Cesium$2['BufferUsage']['STATIC_DRAW']});this['particlesRendering'][_0x5ca08b(0x198)][_0x5ca08b(0x13d)]['commandToExecute']['vertexArray']=_0x3f7951;}}},{'key':'setOptions','value':function _0x1759df(_0xd85659){var _0x5973fb=_0x30a856,_0x45e45b=this,_0x29dea1=![];this[_0x5973fb(0x168)][_0x5973fb(0x14c)]!==_0xd85659['maxParticles']&&(_0x29dea1=!![]),Object['keys'](_0xd85659)['forEach'](function(_0x21bf77){var _0x140a2b=_0x5973fb;_0x45e45b[_0x140a2b(0x168)][_0x21bf77]=_0xd85659[_0x21bf77];}),this[_0x5973fb(0x1c8)](_0x29dea1);}},{'key':'applyViewerParameters','value':function _0x5b6c9b(_0x376e06){var _0x326ada=_0x30a856,_0x2a851a=this;Object[_0x326ada(0x14a)](_0x376e06)['forEach'](function(_0x812996){var _0x23b8e1=_0x326ada;_0x2a851a[_0x23b8e1(0x112)][_0x812996]=_0x376e06[_0x812996];}),this['refreshParticles'](![]);}},{'key':'destroy','value':function _0x5df845(){var _0x36e992=_0x30a856,_0x407119=this;clearTimeout(this[_0x36e992(0x13c)]),this['particlesComputing']['destroyParticlesTextures'](),Object['keys'](this[_0x36e992(0x1cc)]['windTextures'])['forEach'](function(_0xc2545b){var _0x581a14=_0x36e992;_0x407119[_0x581a14(0x1cc)][_0x581a14(0x1a9)][_0xc2545b][_0x581a14(0x13a)]();}),this['particlesRendering'][_0x36e992(0x1b8)]['colorTable']['destroy'](),Object['keys'](this[_0x36e992(0x1da)]['framebuffers'])['forEach'](function(_0x55e426){var _0x5589d0=_0x36e992;_0x407119['particlesRendering'][_0x5589d0(0x175)][_0x55e426]['destroy']();});for(var _0x4a19aa in this){delete this[_0x4a19aa];}}}]),_0x2dd661;}()),Cesium$1=mars3d__namespace[_0x2906f7(0x183)],BaseLayer$1=mars3d__namespace['layer']['BaseLayer'],DEF_OPTIONS={'particlesNumber':0x1000,'fixedHeight':0x0,'fadeOpacity':0.996,'dropRate':0.003,'dropRateBump':0.01,'speedFactor':0.5,'lineWidth':0x2,'colors':['rgb(206,255,255)']},WindLayer=function(_0xb7fa55){var _0x5d611f=_0x2906f7;_inherits(_0x392a84,_0xb7fa55);var _0x5ef8a7=_createSuper(_0x392a84);function _0x392a84(){var _0x1ea11c,_0x2ac0da=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x392a84),_0x2ac0da=_objectSpread2(_objectSpread2({},DEF_OPTIONS),_0x2ac0da),_0x1ea11c=_0x5ef8a7['call'](this,_0x2ac0da),_0x1ea11c['_setOptionsHook'](_0x2ac0da),_0x1ea11c;}return _createClass(_0x392a84,[{'key':_0x5d611f(0x115),'get':function _0x583ac5(){var _0x5e31ff=_0x5d611f;return this[_0x5e31ff(0x198)];}},{'key':'data','get':function _0x1037bc(){return this['_data'];},'set':function _0x4d7c29(_0x158c4f){this['setData'](_0x158c4f);}},{'key':'colors','get':function _0x29fd14(){var _0x4e422e=_0x5d611f;return this[_0x4e422e(0x168)]['colors'];},'set':function _0x3f94ca(_0x52a5e5){var _0x5004ff=_0x5d611f;this[_0x5004ff(0x168)]['colors']=_0x52a5e5,this[_0x5004ff(0x1e6)]&&this['particleSystem']['setOptions']({'colors':_0x52a5e5}),this['resize']();}},{'key':_0x5d611f(0x1b4),'value':function _0x237451(){}},{'key':'_addedHook','value':function _0x49fcf9(){var _0x341c3d=_0x5d611f;this['scene']=this['_map']['scene'],this[_0x341c3d(0x1d2)]=this['_map'][_0x341c3d(0x1d2)],this['primitives']=new Cesium$1['PrimitiveCollection'](),this['_map'][_0x341c3d(0x11a)]['primitives']['add'](this['primitives']),this[_0x341c3d(0x112)]={'lonRange':new Cesium$1['Cartesian2'](),'latRange':new Cesium$1[(_0x341c3d(0x1fd))](),'pixelSize':0x0},this[_0x341c3d(0x1eb)]=new Cesium$1['BoundingSphere'](Cesium$1['Cartesian3'][_0x341c3d(0x1ef)],0.99*0x615299),this['updateViewerParameters'](),window[_0x341c3d(0x127)]('resize',this['resize'][_0x341c3d(0x20f)](this),![]),this['mouse_down']=![],this['mouse_move']=![],this[_0x341c3d(0x1b3)]['on'](mars3d__namespace['EventType']['wheel'],this[_0x341c3d(0x155)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['on'](mars3d__namespace[_0x341c3d(0x106)]['mouseUp'],this['_onMouseUpEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x341c3d(0x1c4)],this['_onMouseMoveEvent'],this),this['_data']&&this['setData'](this[_0x341c3d(0x208)]);}},{'key':'_removedHook','value':function _0xf2c340(){var _0x4d85d0=_0x5d611f;window['removeEventListener']('resize',this[_0x4d85d0(0x12d)]),this[_0x4d85d0(0x1b3)]['off'](mars3d__namespace['EventType'][_0x4d85d0(0x207)],this[_0x4d85d0(0x130)],this),this['_map']['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['off'](mars3d__namespace[_0x4d85d0(0x106)]['mouseDown'],this[_0x4d85d0(0x19c)],this),this['_map']['off'](mars3d__namespace[_0x4d85d0(0x106)]['mouseUp'],this['_onMouseUpEvent'],this),this['_map']['off'](mars3d__namespace[_0x4d85d0(0x106)]['mouseMove'],this[_0x4d85d0(0x17c)],this),this[_0x4d85d0(0x198)]['removeAll'](),this['_map']['scene']['primitives']['remove'](this[_0x4d85d0(0x198)]);}},{'key':'resize','value':function _0x29ab2d(){var _0x1abded=_0x5d611f;if(!this['show']||!this['particleSystem'])return;this[_0x1abded(0x198)]['show']=![],this[_0x1abded(0x198)]['removeAll'](),this['_map'][_0x1abded(0x1fb)](mars3d__namespace[_0x1abded(0x106)]['preRender'],this[_0x1abded(0x130)],this);}},{'key':'_onMap_preRenderEvent','value':function _0x3cb688(_0x55e344){var _0x5c0311=_0x5d611f;this['particleSystem'][_0x5c0311(0x1ab)](this['scene']['context']),this['addPrimitives'](),this['primitives']['show']=!![];}},{'key':_0x5d611f(0x155),'value':function _0x21eb0f(_0x40a557){var _0x55339b=_0x5d611f,_0x14d64f=this;clearTimeout(this['refreshTimer']);if(!this['show']||!this['particleSystem'])return;this[_0x55339b(0x198)]['show']=![],this['refreshTimer']=setTimeout(function(){if(!_0x14d64f['show'])return;_0x14d64f['redraw']();},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x3718e7(_0x3d5243){this['mouse_down']=!![];}},{'key':_0x5d611f(0x17c),'value':function _0x5ec9f3(_0x2d459f){var _0x1eb080=_0x5d611f;if(!this[_0x1eb080(0x18d)]||!this[_0x1eb080(0x1e6)])return;this[_0x1eb080(0x1e3)]&&(this['primitives']['show']=![],this[_0x1eb080(0x19b)]=!![]);}},{'key':'_onMouseUpEvent','value':function _0x481f91(_0x40ed66){var _0x5a0137=_0x5d611f;if(!this['show']||!this['particleSystem'])return;this[_0x5a0137(0x1e3)]&&this['mouse_move']&&this['redraw'](),this['primitives']['show']=!![],this['mouse_down']=![],this['mouse_move']=![];}},{'key':'redraw','value':function _0x20b7ad(){var _0x5ede15=_0x5d611f;if(!this['_map']||!this['show'])return;this['updateViewerParameters'](),this['particleSystem'][_0x5ede15(0x12c)](this['viewerParameters']),this['primitives']['show']=!![];}},{'key':_0x5d611f(0x1fe),'value':function _0xaf0b37(_0x3bdee2){var _0x446b21=_0x5d611f;this['_data']=_0x3bdee2,this['particleSystem']&&this[_0x446b21(0x1e6)][_0x446b21(0x13a)](),this[_0x446b21(0x1e6)]=new ParticleSystem(this['scene']['context'],_0x3bdee2,this['getOptions'](),this['viewerParameters']),this['addPrimitives']();}},{'key':'_setOptionsHook','value':function _0x3b59bc(_0x26f06f,_0x368c20){var _0x2c6f7f=_0x5d611f;if(_0x26f06f)for(var _0x37301a in _0x26f06f){this[_0x37301a]=_0x26f06f[_0x37301a];}this['particleSystem']&&this['particleSystem'][_0x2c6f7f(0x1a1)](this['getOptions']());}},{'key':_0x5d611f(0x145),'value':function _0x46d63a(){var _0x53b3bd=_0x5d611f,_0x1015eb=Math['ceil'](Math['sqrt'](this['particlesNumber']));return this[_0x53b3bd(0x10e)]=_0x1015eb*_0x1015eb,{'particlesTextureSize':_0x1015eb,'maxParticles':this['particlesNumber'],'particleHeight':this['fixedHeight'],'fadeOpacity':this[_0x53b3bd(0x1e0)],'dropRate':this[_0x53b3bd(0x17d)],'dropRateBump':this['dropRateBump'],'speedFactor':this[_0x53b3bd(0x138)],'lineWidth':this['lineWidth'],'colors':this[_0x53b3bd(0x140)]};}},{'key':_0x5d611f(0x13f),'value':function _0x44e5fd(){var _0x3d56c7=_0x5d611f;this['primitives']['add'](this['particleSystem']['particlesComputing']['primitives']['getWind']),this[_0x3d56c7(0x198)]['add'](this['particleSystem'][_0x3d56c7(0x1cc)]['primitives']['updateSpeed']),this['primitives']['add'](this['particleSystem']['particlesComputing'][_0x3d56c7(0x198)]['updatePosition']),this[_0x3d56c7(0x198)]['add'](this['particleSystem']['particlesComputing']['primitives']['postProcessingPosition']),this['primitives']['add'](this[_0x3d56c7(0x1e6)][_0x3d56c7(0x1cc)]['primitives'][_0x3d56c7(0x20a)]),this['primitives']['add'](this[_0x3d56c7(0x1e6)]['particlesRendering'][_0x3d56c7(0x198)]['segments']),this['primitives']['add'](this[_0x3d56c7(0x1e6)]['particlesRendering'][_0x3d56c7(0x198)]['trails']),this['primitives']['add'](this['particleSystem'][_0x3d56c7(0x1da)]['primitives'][_0x3d56c7(0x1d1)]);}},{'key':'updateViewerParameters','value':function _0xb258d9(){var _0x1c8b82=_0x5d611f,_0x5f4f10=this['camera']['computeViewRectangle'](this['scene']['globe']['ellipsoid']);if(!_0x5f4f10){var _0x37211d=this['_map'][_0x1c8b82(0x1ee)]();_0x5f4f10=Cesium$1['Rectangle'][_0x1c8b82(0x144)](_0x37211d['xmin'],_0x37211d['ymin'],_0x37211d[_0x1c8b82(0x123)],_0x37211d['ymax']);}var _0xb6068=Util['viewRectangleToLonLatRange'](_0x5f4f10);this['viewerParameters']['lonRange']['x']=_0xb6068['lon']['min'],this['viewerParameters']['lonRange']['y']=_0xb6068['lon'][_0x1c8b82(0x1d9)],this[_0x1c8b82(0x112)]['latRange']['x']=_0xb6068['lat']['min'],this['viewerParameters'][_0x1c8b82(0x147)]['y']=_0xb6068['lat']['max'];var _0x4621db=this['camera']['getPixelSize'](this['globeBoundingSphere'],this['scene']['drawingBufferWidth'],this['scene'][_0x1c8b82(0x1dc)]);_0x4621db>0x0&&(this['viewerParameters']['pixelSize']=_0x4621db);}}]),_0x392a84;}(BaseLayer$1);mars3d__namespace['LayerUtil']['register']('wind',WindLayer),mars3d__namespace['layer']['WindLayer']=WindLayer;var CanvasParticle=(function(){var _0x3f4d3c=_0x2906f7;function _0x3ca255(){var _0x1ff597=_0x5a79;_classCallCheck(this,_0x3ca255),this['lng']=null,this['lat']=null,this[_0x1ff597(0x109)]=null,this['tlat']=null,this['age']=null;}return _createClass(_0x3ca255,[{'key':_0x3f4d3c(0x13a),'value':function _0x203c10(){for(var _0x4deb06 in this){delete this[_0x4deb06];}}}]),_0x3ca255;}()),CanvasWindField=(function(){var _0xd9afa9=_0x2906f7;function _0x545431(_0x361f44){var _0x30e3a8=_0x5a79;_classCallCheck(this,_0x545431),this[_0x30e3a8(0x1a1)](_0x361f44);}return _createClass(_0x545431,[{'key':'speedRate','get':function _0x21c30b(){return this['_speedRate'];},'set':function _0x19c2ed(_0x1fc22b){var _0x24b6f2=_0x5a79;this['_speedRate']=(0x64-(_0x1fc22b>0x63?0x63:_0x1fc22b))*0x64,this[_0x24b6f2(0x173)]=[(this['xmax']-this[_0x24b6f2(0x14d)])/this['_speedRate'],(this['ymax']-this['ymin'])/this[_0x24b6f2(0x193)]];}},{'key':_0xd9afa9(0x156),'get':function _0x41b9f9(){var _0x375c37=_0xd9afa9;return this[_0x375c37(0x1c5)];},'set':function _0x6e9758(_0x649025){this['_maxAge']=_0x649025;}},{'key':'setOptions','value':function _0x5d9fa2(_0x55c7a8){var _0x449fd2=_0xd9afa9;this[_0x449fd2(0x168)]=_0x55c7a8,this['maxAge']=_0x55c7a8['maxAge']||0x78,this['speedRate']=_0x55c7a8['speedRate']||0x32,this[_0x449fd2(0x174)]=[];var _0xc38ac7=_0x55c7a8['particlesNumber']||0x1000;for(var _0x7da769=0x0;_0x7da769<_0xc38ac7;_0x7da769++){var _0x18e57d=this['_randomParticle'](new CanvasParticle());this['particles'][_0x449fd2(0x209)](_0x18e57d);}}},{'key':'setDate','value':function _0x4989e3(_0x526557){var _0x4e00db=_0xd9afa9;this[_0x4e00db(0x1d6)]=_0x526557['rows'],this[_0x4e00db(0x1d5)]=_0x526557['cols'],this[_0x4e00db(0x14d)]=_0x526557['xmin'],this[_0x4e00db(0x123)]=_0x526557['xmax'],this[_0x4e00db(0x1f8)]=_0x526557[_0x4e00db(0x1f8)],this['ymax']=_0x526557[_0x4e00db(0x1ea)],this['grid']=[];var _0x4374f5=_0x526557[_0x4e00db(0x10d)],_0x28c0fa=_0x526557['vdata'],_0x551257=![];_0x4374f5['length']===this[_0x4e00db(0x1d6)]&&_0x4374f5[0x0]['length']===this['cols']&&(_0x551257=!![]);var _0x202398=0x0,_0x3397db=null,_0x575365=null;for(var _0xb5a21c=0x0;_0xb5a21c<this['rows'];_0xb5a21c++){_0x3397db=[];for(var _0x267297=0x0;_0x267297<this[_0x4e00db(0x1d5)];_0x267297++,_0x202398++){_0x551257?_0x575365=this['_calcUV'](_0x4374f5[_0xb5a21c][_0x267297],_0x28c0fa[_0xb5a21c][_0x267297]):_0x575365=this['_calcUV'](_0x4374f5[_0x202398],_0x28c0fa[_0x202398]),_0x3397db[_0x4e00db(0x209)](_0x575365);}this['grid'][_0x4e00db(0x209)](_0x3397db);}this['options'][_0x4e00db(0x162)]&&this['grid'][_0x4e00db(0x19d)]();}},{'key':'clear','value':function _0x1244ac(){delete this['rows'],delete this['cols'],delete this['xmin'],delete this['xmax'],delete this['ymin'],delete this['ymax'],delete this['grid'],delete this['particles'];}},{'key':'toGridXY','value':function _0x21e3f1(_0x5c653a,_0x379e1c){var _0x561f9b=_0xd9afa9,_0x35a7b7=(_0x5c653a-this['xmin'])/(this[_0x561f9b(0x123)]-this[_0x561f9b(0x14d)])*(this['cols']-0x1),_0x41cf5a=(this['ymax']-_0x379e1c)/(this['ymax']-this[_0x561f9b(0x1f8)])*(this['rows']-0x1);return[_0x35a7b7,_0x41cf5a];}},{'key':_0xd9afa9(0x136),'value':function _0xb2e9e7(_0x3e4d2e,_0x410f83){var _0x3f29ef=_0xd9afa9;if(_0x3e4d2e<0x0||_0x3e4d2e>=this[_0x3f29ef(0x1d5)]||_0x410f83>=this[_0x3f29ef(0x1d6)])return[0x0,0x0,0x0];var _0x255e4d=Math['floor'](_0x3e4d2e),_0x5f30d4=Math[_0x3f29ef(0x1f6)](_0x410f83);if(_0x255e4d===_0x3e4d2e&&_0x5f30d4===_0x410f83)return this['grid'][_0x410f83][_0x3e4d2e];var _0x3a8a90=_0x255e4d+0x1,_0x1c6bfc=_0x5f30d4+0x1,_0x2364e9=this['getUVByXY'](_0x255e4d,_0x5f30d4),_0x9a3e1a=this[_0x3f29ef(0x136)](_0x3a8a90,_0x5f30d4),_0x17efa0=this[_0x3f29ef(0x136)](_0x255e4d,_0x1c6bfc),_0x54008e=this['getUVByXY'](_0x3a8a90,_0x1c6bfc),_0x5cc111=null;try{_0x5cc111=this['_bilinearInterpolation'](_0x3e4d2e-_0x255e4d,_0x410f83-_0x5f30d4,_0x2364e9,_0x9a3e1a,_0x17efa0,_0x54008e);}catch(_0x930fdc){console[_0x3f29ef(0x20b)](_0x3e4d2e,_0x410f83);}return _0x5cc111;}},{'key':'_bilinearInterpolation','value':function _0x3ad2d9(_0x49bd5b,_0x47b1d7,_0x4d35a0,_0x39651b,_0x2ba3ee,_0x528225){var _0x3dfc38=0x1-_0x49bd5b,_0x408dba=0x1-_0x47b1d7,_0x108f0f=_0x3dfc38*_0x408dba,_0x57a69e=_0x49bd5b*_0x408dba,_0x44974e=_0x3dfc38*_0x47b1d7,_0x2569e7=_0x49bd5b*_0x47b1d7,_0x44cf45=_0x4d35a0[0x0]*_0x108f0f+_0x39651b[0x0]*_0x57a69e+_0x2ba3ee[0x0]*_0x44974e+_0x528225[0x0]*_0x2569e7,_0x365e70=_0x4d35a0[0x1]*_0x108f0f+_0x39651b[0x1]*_0x57a69e+_0x2ba3ee[0x1]*_0x44974e+_0x528225[0x1]*_0x2569e7;return this['_calcUV'](_0x44cf45,_0x365e70);}},{'key':'_calcUV','value':function _0x4db09(_0x47e48d,_0x431ca7){return[+_0x47e48d,+_0x431ca7,Math['sqrt'](_0x47e48d*_0x47e48d+_0x431ca7*_0x431ca7)];}},{'key':'getUVByPoint','value':function _0x26bcb1(_0x4c6efb,_0x4704c3){if(!this['isInExtent'](_0x4c6efb,_0x4704c3))return null;var _0x24c168=this['toGridXY'](_0x4c6efb,_0x4704c3),_0x5877e8=this['getUVByXY'](_0x24c168[0x0],_0x24c168[0x1]);return _0x5877e8;}},{'key':'isInExtent','value':function _0x4ab2ad(_0x4deb0e,_0x278fd2){var _0x7d16bd=_0xd9afa9;return _0x4deb0e>=this['xmin']&&_0x4deb0e<=this[_0x7d16bd(0x123)]&&_0x278fd2>=this['ymin']&&_0x278fd2<=this['ymax']?!![]:![];}},{'key':'getRandomLatLng','value':function _0x11f924(){var _0x2c0859=_0xd9afa9,_0x301f60=fRandomByfloat(this['xmin'],this[_0x2c0859(0x123)]),_0x239fdc=fRandomByfloat(this[_0x2c0859(0x1f8)],this['ymax']);return{'lat':_0x239fdc,'lng':_0x301f60};}},{'key':'getParticles','value':function _0x4c39a0(){var _0x115e08=_0xd9afa9,_0xec8ffb,_0x1f9760,_0x46c991;for(var _0x1912c2=0x0,_0x133777=this[_0x115e08(0x174)]['length'];_0x1912c2<_0x133777;_0x1912c2++){var _0x1e2ec2=this[_0x115e08(0x174)][_0x1912c2];_0x1e2ec2['age']<=0x0&&(_0x1e2ec2=this[_0x115e08(0x1ac)](_0x1e2ec2));if(_0x1e2ec2[_0x115e08(0x167)]>0x0){var _0x2cebd0=_0x1e2ec2['tlng'],_0x16c42d=_0x1e2ec2['tlat'];_0x46c991=this['getUVByPoint'](_0x2cebd0,_0x16c42d),_0x46c991?(_0xec8ffb=_0x2cebd0+this['_calc_speedRate'][0x0]*_0x46c991[0x0],_0x1f9760=_0x16c42d+this[_0x115e08(0x173)][0x1]*_0x46c991[0x1],_0x1e2ec2['lng']=_0x2cebd0,_0x1e2ec2['lat']=_0x16c42d,_0x1e2ec2[_0x115e08(0x109)]=_0xec8ffb,_0x1e2ec2['tlat']=_0x1f9760,_0x1e2ec2['age']--):_0x1e2ec2['age']=0x0;}}return this['particles'];}},{'key':_0xd9afa9(0x1ac),'value':function _0x161fa4(_0x12a019){var _0x32d95b=_0xd9afa9,_0x546c78,_0x2d99ed;for(var _0x351850=0x0;_0x351850<0x1e;_0x351850++){_0x546c78=this['getRandomLatLng'](),_0x2d99ed=this[_0x32d95b(0x1a2)](_0x546c78[_0x32d95b(0x122)],_0x546c78['lat']);if(_0x2d99ed&&_0x2d99ed[0x2]>0x0)break;}if(!_0x2d99ed)return _0x12a019;var _0x700bcf=_0x546c78['lng']+this['_calc_speedRate'][0x0]*_0x2d99ed[0x0],_0x508320=_0x546c78['lat']+this[_0x32d95b(0x173)][0x1]*_0x2d99ed[0x1];return _0x12a019[_0x32d95b(0x122)]=_0x546c78['lng'],_0x12a019['lat']=_0x546c78[_0x32d95b(0x201)],_0x12a019[_0x32d95b(0x109)]=_0x700bcf,_0x12a019['tlat']=_0x508320,_0x12a019['age']=Math[_0x32d95b(0x1e7)](Math['random']()*this[_0x32d95b(0x156)]),_0x12a019;}},{'key':'destroy','value':function _0x50ab04(){for(var _0x1dd5f5 in this){delete this[_0x1dd5f5];}}}]),_0x545431;}());function fRandomByfloat(_0x395f06,_0xd36625){return _0x395f06+Math['random']()*(_0xd36625-_0x395f06);}var Cesium=mars3d__namespace[_0x2906f7(0x183)],BaseLayer=mars3d__namespace['layer'][_0x2906f7(0x1c3)],CanvasWindLayer=function(_0x14f29a){var _0x573b8b=_0x2906f7;_inherits(_0x1d8d57,_0x14f29a);var _0x3abbb6=_createSuper(_0x1d8d57);function _0x1d8d57(){var _0x4cbaf8=_0x5a79,_0x4cd3df,_0x51828c=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x1d8d57),_0x4cd3df=_0x3abbb6[_0x4cbaf8(0x18a)](this,_0x51828c),_0x4cd3df['_setOptionsHook'](_0x51828c),_0x4cd3df['canvas']=null,_0x4cd3df;}return _createClass(_0x1d8d57,[{'key':_0x573b8b(0x1f2),'value':function _0x433d18(_0x3b88ec,_0x42a198){var _0x2d4ba6=_0x573b8b,_0x5a245d,_0x1f28a5,_0xdec846;this['frameTime']=0x3e8/(_0x3b88ec[_0x2d4ba6(0x188)]||0xa),this[_0x2d4ba6(0x1df)]=(_0x5a245d=this[_0x2d4ba6(0x168)]['pointerEvents'])!==null&&_0x5a245d!==void 0x0?_0x5a245d:![],this['color']=_0x3b88ec['color']||_0x2d4ba6(0x1d0),this['lineWidth']=_0x3b88ec[_0x2d4ba6(0x132)]||0x1,this['fixedHeight']=(_0x1f28a5=_0x3b88ec['fixedHeight'])!==null&&_0x1f28a5!==void 0x0?_0x1f28a5:0x0,this['reverseY']=(_0xdec846=_0x3b88ec['reverseY'])!==null&&_0xdec846!==void 0x0?_0xdec846:![],this['windField']&&this[_0x2d4ba6(0x11b)]['setOptions'](_0x3b88ec);}},{'key':_0x573b8b(0x115),'get':function _0x37005c(){return this['canvas'];}},{'key':'canvasWidth','get':function _0x5024ba(){var _0x3b4eab=_0x573b8b;return this['_map']['scene']['canvas'][_0x3b4eab(0x16b)];}},{'key':_0x573b8b(0x153),'get':function _0x3c32fd(){var _0x220bfb=_0x573b8b;return this[_0x220bfb(0x1b3)]['scene']['canvas']['clientHeight'];}},{'key':'pointerEvents','get':function _0x3724c3(){return this['_pointerEvents'];},'set':function _0x3ac886(_0xc1ad62){var _0x387e14=_0x573b8b;this['_pointerEvents']=_0xc1ad62;if(!this['canvas'])return;_0xc1ad62?this['canvas'][_0x387e14(0x11c)][_0x387e14(0x20c)]='all':this['canvas']['style']['pointer-events']='none';}},{'key':'particlesNumber','get':function _0x37b491(){var _0x50a953=_0x573b8b;return this['options'][_0x50a953(0x10e)];},'set':function _0x5ef0ab(_0x1a0217){var _0x3bf3e9=_0x573b8b,_0x91d529=this;this['options']['particlesNumber']=_0x1a0217,clearTimeout(this['_canrefresh']),this[_0x3bf3e9(0x1b2)]=setTimeout(function(){_0x91d529['redraw']();},0x1f4);}},{'key':'speedRate','get':function _0x2b7573(){return this['options']['speedRate'];},'set':function _0x28c3f5(_0x451345){var _0x2b1b3a=_0x573b8b;this['options']['speedRate']=_0x451345,this['windField']&&(this[_0x2b1b3a(0x11b)]['speedRate']=_0x451345);}},{'key':_0x573b8b(0x156),'get':function _0x1d613f(){return this['options']['maxAge'];},'set':function _0x55f29c(_0x85c874){var _0x51c172=_0x573b8b;this['options'][_0x51c172(0x156)]=_0x85c874,this[_0x51c172(0x11b)]&&(this['windField']['maxAge']=_0x85c874);}},{'key':_0x573b8b(0x165),'get':function _0x269f35(){return this['windData'];},'set':function _0x4ca6de(_0x45990a){this['setData'](_0x45990a);}},{'key':'_showHook','value':function _0x10f88e(_0x47e823){var _0x3812ae=_0x573b8b;_0x47e823?this[_0x3812ae(0x1cb)]():(this[_0x3812ae(0x194)]&&(this['options']['data']=this['windData']),this[_0x3812ae(0x11f)]());}},{'key':'_mountedHook','value':function _0x162725(){var _0x10601a=_0x573b8b;this[_0x10601a(0x168)]['worker']?this['initWorker']():this['windField']=new CanvasWindField(this['options']);}},{'key':'_addedHook','value':function _0x4ec90e(){var _0x1da0ec=_0x573b8b;this['canvas']=this['_createCanvas'](),this['canvasContext']=this['canvas']['getContext']('2d',{'willReadFrequently':!![]}),this['bindEvent'](),this[_0x1da0ec(0x168)]['data']&&this['setData'](this[_0x1da0ec(0x168)]['data']);}},{'key':'_removedHook','value':function _0x53a9d2(){var _0x3185ff=_0x573b8b;this['clear'](),this[_0x3185ff(0x177)](),this['canvas']&&(this[_0x3185ff(0x1b3)][_0x3185ff(0x1af)]['removeChild'](this['canvas']),delete this['canvas']);}},{'key':_0x573b8b(0x1cd),'value':function _0x39bcc7(){var _0x148fb0=_0x573b8b,_0x27edc1=document[_0x148fb0(0x1e8)](_0x148fb0(0x19e));_0x27edc1['style']['position']='absolute',_0x27edc1[_0x148fb0(0x11c)]['top']='0px',_0x27edc1[_0x148fb0(0x11c)]['left']=_0x148fb0(0x1aa),_0x27edc1[_0x148fb0(0x11c)]['width']=_0x148fb0(0x16e),_0x27edc1[_0x148fb0(0x11c)]['height']=_0x148fb0(0x16e),_0x27edc1['style'][_0x148fb0(0x1b9)]=this['_pointerEvents']?'auto':'none',_0x27edc1['style']['zIndex']=0xa,_0x27edc1['setAttribute']('id','canvasWindy'),_0x27edc1['setAttribute'](_0x148fb0(0x20e),'canvasWindy'),this['_map']['container']['appendChild'](_0x27edc1);var _0x2d6d38=this['_map'][_0x148fb0(0x11a)];return _0x27edc1['width']=_0x2d6d38['canvas']['clientWidth'],_0x27edc1[_0x148fb0(0x159)]=_0x2d6d38['canvas'][_0x148fb0(0x1a3)],_0x27edc1;}},{'key':'resize','value':function _0x5821c3(){var _0x11bbda=_0x573b8b;this['canvas']&&(this[_0x11bbda(0x19e)]['width']=this[_0x11bbda(0x186)],this[_0x11bbda(0x19e)]['height']=this['canvasHeight']);}},{'key':_0x573b8b(0x211),'value':function _0x3d2406(){var _0x586e50=_0x573b8b,_0xb1d09b=this,_0x5cd7c9=Date[_0x586e50(0x1b0)]();(function _0x468fda(){var _0x43600a=_0x586e50;_0xb1d09b['animateFrame']=window[_0x43600a(0x18c)](_0x468fda);if(_0xb1d09b[_0x43600a(0x18d)]&&_0xb1d09b['windField']){var _0xef3f8a=Date['now'](),_0x22271b=_0xef3f8a-_0x5cd7c9;_0x22271b>_0xb1d09b['frameTime']&&(_0x5cd7c9=_0xef3f8a-_0x22271b%_0xb1d09b['frameTime'],_0xb1d09b['update']());}}(),window[_0x586e50(0x127)](_0x586e50(0x12d),this[_0x586e50(0x12d)][_0x586e50(0x20f)](this),![]),this['mouse_down']=![],this['mouse_move']=![],this[_0x586e50(0x168)]['mouseHidden']&&(this[_0x586e50(0x1b3)]['on'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map']['on'](mars3d__namespace[_0x586e50(0x106)][_0x586e50(0x1ed)],this[_0x586e50(0x19c)],this),this['_map']['on'](mars3d__namespace['EventType']['mouseUp'],this[_0x586e50(0x1cf)],this)));}},{'key':'unbindEvent','value':function _0xbdb6b9(){var _0x268805=_0x573b8b;window['cancelAnimationFrame'](this[_0x268805(0x184)]),delete this['animateFrame'],window[_0x268805(0x12a)]('resize',this[_0x268805(0x12d)]),this[_0x268805(0x168)]['mouseHidden']&&(this['_map']['off'](mars3d__namespace['EventType']['wheel'],this['_onMapWhellEvent'],this),this['_map'][_0x268805(0x15e)](mars3d__namespace['EventType']['mouseDown'],this['_onMouseDownEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseUp'],this['_onMouseUpEvent'],this),this['_map']['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this));}},{'key':'_onMapWhellEvent','value':function _0x481a5f(_0x46367d){var _0x4ab5d6=_0x573b8b,_0x370d02=this;clearTimeout(this['refreshTimer']);if(!this['show']||!this['canvas'])return;this[_0x4ab5d6(0x19e)][_0x4ab5d6(0x11c)][_0x4ab5d6(0x19f)]='hidden',this['refreshTimer']=setTimeout(function(){var _0x31bc5b=_0x4ab5d6;if(!_0x370d02['show'])return;_0x370d02['redraw'](),_0x370d02['canvas'][_0x31bc5b(0x11c)][_0x31bc5b(0x19f)]='visible';},0xc8);}},{'key':'_onMouseDownEvent','value':function _0x2a9273(_0x44bb26){var _0x3002a9=_0x573b8b;this['mouse_down']=!![],this['_map'][_0x3002a9(0x15e)](mars3d__namespace[_0x3002a9(0x106)]['mouseMove'],this['_onMouseMoveEvent'],this),this['_map']['on'](mars3d__namespace['EventType'][_0x3002a9(0x1c4)],this['_onMouseMoveEvent'],this);}},{'key':'_onMouseMoveEvent','value':function _0xc712bf(_0x266759){var _0xab7c64=_0x573b8b;if(!this['show']||!this['canvas'])return;this['mouse_down']&&(this['canvas'][_0xab7c64(0x11c)]['visibility']='hidden',this['mouse_move']=!![]);}},{'key':'_onMouseUpEvent','value':function _0x222530(_0x34589e){var _0x58a535=_0x573b8b;if(!this[_0x58a535(0x18d)]||!this[_0x58a535(0x19e)])return;this[_0x58a535(0x1b3)]['off'](mars3d__namespace['EventType']['mouseMove'],this['_onMouseMoveEvent'],this),this['mouse_down']&&this['mouse_move']&&this['redraw'](),this['canvas'][_0x58a535(0x11c)][_0x58a535(0x19f)]=_0x58a535(0x179),this[_0x58a535(0x1e3)]=![],this[_0x58a535(0x19b)]=![];}},{'key':_0x573b8b(0x1fe),'value':function _0x45c31e(_0x16ac65){var _0x1fafb1=_0x573b8b;this['clear'](),this['windData']=_0x16ac65,this['windField']['setDate'](_0x16ac65),this[_0x1fafb1(0x12b)]();}},{'key':_0x573b8b(0x12b),'value':function _0x419fc2(){var _0x36413e=_0x573b8b;if(!this['show'])return;this[_0x36413e(0x11b)]['setOptions'](this['options']),this['update']();}},{'key':'update','value':function _0x144d10(){var _0x49eef6=_0x573b8b;if(this['_updateIng'])return;this['_updateIng']=!![];if(this['worker'])this[_0x49eef6(0x11b)][_0x49eef6(0x180)]();else{var _0x48bda6=this['windField']['getParticles']();this[_0x49eef6(0x185)](_0x48bda6);}this[_0x49eef6(0x128)]=![];}},{'key':'_drawLines','value':function _0x5dc235(_0x2863e4){var _0xa97135=_0x573b8b;this[_0xa97135(0x163)]['globalCompositeOperation']='destination-in',this[_0xa97135(0x163)][_0xa97135(0x1ae)](0x0,0x0,this['canvasWidth'],this['canvasHeight']),this['canvasContext']['globalCompositeOperation']='lighter',this[_0xa97135(0x163)]['globalAlpha']=0.9,this['canvasContext'][_0xa97135(0x191)](),this['canvasContext']['lineWidth']=this['lineWidth'],this['canvasContext']['strokeStyle']=this['color'];var _0x1d62e3=this['_map']['scene']['mode']!==Cesium['SceneMode'][_0xa97135(0x212)];for(var _0x3e1887=0x0,_0xcd1822=_0x2863e4['length'];_0x3e1887<_0xcd1822;_0x3e1887++){var _0x235d97=_0x2863e4[_0x3e1887],_0xd3d76e=this['_tomap'](_0x235d97['lng'],_0x235d97[_0xa97135(0x201)],_0x235d97),_0x54a970=this['_tomap'](_0x235d97['tlng'],_0x235d97['tlat'],_0x235d97);if(!_0xd3d76e||!_0x54a970)continue;if(_0x1d62e3&&Math[_0xa97135(0x1d3)](_0xd3d76e[0x0]-_0x54a970[0x0])>=this['canvasWidth'])continue;this[_0xa97135(0x163)]['moveTo'](_0xd3d76e[0x0],_0xd3d76e[0x1]),this[_0xa97135(0x163)]['lineTo'](_0x54a970[0x0],_0x54a970[0x1]);}this['canvasContext']['stroke']();}},{'key':'_tomap','value':function _0x17839c(_0x8a80e,_0x196e28,_0x9f6872){var _0x177449=_0x573b8b,_0x42d45d=Cesium['Cartesian3']['fromDegrees'](_0x8a80e,_0x196e28,this['fixedHeight']),_0x4562bc=this['_map']['scene'];if(_0x4562bc['mode']===Cesium['SceneMode']['SCENE3D']){var _0x2f20a5=new Cesium['EllipsoidalOccluder'](_0x4562bc['globe']['ellipsoid'],_0x4562bc[_0x177449(0x1d2)]['positionWC']),_0x5a153a=_0x2f20a5[_0x177449(0x166)](_0x42d45d);if(!_0x5a153a)return _0x9f6872['age']=0x0,null;}var _0x477fd9=Cesium['SceneTransforms'][_0x177449(0x15b)](this['_map']['scene'],_0x42d45d);return _0x477fd9?[_0x477fd9['x'],_0x477fd9['y']]:null;}},{'key':'clear','value':function _0x4363bc(){var _0x5a8bd4=_0x573b8b;this['windField'][_0x5a8bd4(0x125)](),delete this['windData'];}},{'key':'initWorker','value':function _0x3f0fda(){var _0x2f8339=_0x573b8b,_0x3ea480=this;this['worker']=new Worker(this['options'][_0x2f8339(0x197)]),this['worker']['onmessage']=function(_0x4a6dde){var _0x248844=_0x2f8339;_0x3ea480[_0x248844(0x185)](_0x4a6dde['data']['particles']),_0x3ea480[_0x248844(0x110)]=![];},this['windField']={'init':function _0x481b4c(_0x2a1ecb){var _0x424f1e=_0x2f8339;_0x3ea480[_0x424f1e(0x197)][_0x424f1e(0x1bc)]({'type':'init','options':_0x2a1ecb});},'setOptions':function _0x259b20(_0xe867d2){_0x3ea480['worker']['postMessage']({'type':'setOptions','options':_0xe867d2});},'setDate':function _0x1b13e8(_0x148725){var _0x1339d6=_0x2f8339;_0x3ea480['worker'][_0x1339d6(0x1bc)]({'type':_0x1339d6(0x117),'data':_0x148725});},'update':function _0x4ef255(){var _0x54c35c=_0x2f8339;if(_0x3ea480[_0x54c35c(0x110)])return;_0x3ea480[_0x54c35c(0x110)]=!![],_0x3ea480['worker'][_0x54c35c(0x1bc)]({'type':'update'});},'clear':function _0x1eeb59(){_0x3ea480['worker']['postMessage']({'type':'clear'});}},this['windField'][_0x2f8339(0x105)](this['options']);}}]),_0x1d8d57;}(BaseLayer);function _0x5a79(_0x2fbcbc,_0xad33e5){var _0x5bbe4a=_0x5bbe();return _0x5a79=function(_0x5a791f,_0xfd1f30){_0x5a791f=_0x5a791f-0x103;var _0x25dbfe=_0x5bbe4a[_0x5a791f];return _0x25dbfe;},_0x5a79(_0x2fbcbc,_0xad33e5);}mars3d__namespace['LayerUtil']['register'](_0x2906f7(0x204),CanvasWindLayer),mars3d__namespace['layer']['CanvasWindLayer']=CanvasWindLayer,mars3d__namespace['CanvasWindField']=CanvasWindField,mars3d__namespace['WindUtil']=WindUtil,exports['CanvasWindField']=CanvasWindField,exports[_0x2906f7(0x18e)]=CanvasWindLayer,exports['WindLayer']=WindLayer,exports[_0x2906f7(0x126)]=WindUtil,Object[_0x2906f7(0x14b)](exports,'__esModule',{'value':!![]});
}));
