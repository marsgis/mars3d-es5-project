/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.2
 * 编译日期：2023-08-22 10:38:38
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x2f2c8e=_0x2213;(function(_0x5ee32f,_0x3ae37b){const _0x341e8f={_0x1eae41:0x221,_0x3f78fd:0x21a,_0x3e9482:0x1fc,_0x2f770f:0x21d,_0xd6f3fd:0x1e2,_0x45bb77:0x1f0,_0x3e3f41:0x214},_0x469c98=_0x2213,_0x4e2f00=_0x5ee32f();while(!![]){try{const _0x3e1184=-parseInt(_0x469c98(_0x341e8f._0x1eae41))/0x1*(-parseInt(_0x469c98(_0x341e8f._0x3f78fd))/0x2)+-parseInt(_0x469c98(_0x341e8f._0x3e9482))/0x3+parseInt(_0x469c98(_0x341e8f._0x2f770f))/0x4+-parseInt(_0x469c98(0x20a))/0x5+-parseInt(_0x469c98(_0x341e8f._0xd6f3fd))/0x6+parseInt(_0x469c98(_0x341e8f._0x45bb77))/0x7*(-parseInt(_0x469c98(0x1e6))/0x8)+parseInt(_0x469c98(_0x341e8f._0x3e3f41))/0x9;if(_0x3e1184===_0x3ae37b)break;else _0x4e2f00['push'](_0x4e2f00['shift']());}catch(_0x8e87b){_0x4e2f00['push'](_0x4e2f00['shift']());}}}(_0x330f,0x9b524));function _interopNamespace(_0x9782b9){const _0x5ca03c={_0x2b3433:0x216},_0xb465dd=_0x2213;if(_0x9782b9&&_0x9782b9[_0xb465dd(_0x5ca03c._0x2b3433)])return _0x9782b9;var _0x2065d9=Object['create'](null);return _0x9782b9&&Object['keys'](_0x9782b9)[_0xb465dd(0x213)](function(_0x21a85c){if(_0x21a85c!=='default'){var _0x4f8219=Object['getOwnPropertyDescriptor'](_0x9782b9,_0x21a85c);Object['defineProperty'](_0x2065d9,_0x21a85c,_0x4f8219['get']?_0x4f8219:{'enumerable':!![],'get':function(){return _0x9782b9[_0x21a85c];}});}}),_0x2065d9['default']=_0x9782b9,_0x2065d9;}function _0x2213(_0x243280,_0x40ea08){const _0x330f96=_0x330f();return _0x2213=function(_0x221307,_0x3bce60){_0x221307=_0x221307-0x1db;let _0x3bd04a=_0x330f96[_0x221307];return _0x3bd04a;},_0x2213(_0x243280,_0x40ea08);}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace[_0x2f2c8e(0x1fe)],BaseLayer=mars3d__namespace[_0x2f2c8e(0x224)][_0x2f2c8e(0x1f8)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x2f2c8e(0x215),0.6:_0x2f2c8e(0x1f1),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x2f2c8e(0x21c)]['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x285628={}){const _0x5ceddc={_0x342612:0x201,_0x470cd8:0x1f9},_0x33a12b=_0x2f2c8e;super(_0x285628),this['options']['maxCanvasSize']=this[_0x33a12b(0x1f9)]['maxCanvasSize']??document[_0x33a12b(0x1ed)]['clientWidth'],this['options'][_0x33a12b(_0x5ceddc._0x342612)]=Math['min'](this[_0x33a12b(0x1f9)]['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this[_0x33a12b(_0x5ceddc._0x470cd8)]['minCanvasSize']??document[_0x33a12b(0x1ed)]['clientHeight'],this['options'][_0x33a12b(0x203)]=Math['max'](this['options']['minCanvasSize'],0x2bc),this[_0x33a12b(0x1f9)]['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options'][_0x33a12b(0x22d)]={...DEF_STYLE,...this['options'][_0x33a12b(0x22d)]};}get['layer'](){return this['_layer'];}get['heatStyle'](){const _0x3af109=_0x2f2c8e;return this[_0x3af109(0x1f9)]['heatStyle'];}set['heatStyle'](_0x4a69e1){const _0x546a4c={_0x3a17b8:0x228,_0x53a514:0x1f9,_0x14d5f7:0x20e},_0x51997d=_0x2f2c8e;this['options']['heatStyle']=mars3d__namespace['Util'][_0x51997d(_0x546a4c._0x3a17b8)](this[_0x51997d(_0x546a4c._0x53a514)]['heatStyle'],_0x4a69e1),this[_0x51997d(_0x546a4c._0x14d5f7)]&&(this['_heat']['configure'](this[_0x51997d(_0x546a4c._0x53a514)]['heatStyle']),this[_0x51997d(0x205)](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x500eff){this['options']['style']=mars3d__namespace['Util']['merge'](this['options']['style'],_0x500eff);}get['positions'](){const _0x4f2311={_0x3936aa:0x211},_0x16b403=_0x2f2c8e;return this[_0x16b403(_0x4f2311._0x3936aa)];}set['positions'](_0x1e7a71){this['setPositions'](_0x1e7a71);}get['coordinates'](){const _0x43213c={_0x43e65a:0x1f5},_0x1fcaa2=[];return this['points']['forEach'](_0x423fae=>{const _0x211321=_0x2213;_0x1fcaa2['push'](_0x423fae[_0x211321(_0x43213c._0x43e65a)]());}),_0x1fcaa2;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0xb60c72,_0x333ca5){const _0x2eec2d={_0x3156ec:0x1ef},_0x5d1433=_0x2f2c8e;_0xb60c72['positions']&&(this[_0x5d1433(_0x2eec2d._0x3156ec)]=_0xb60c72['positions']);}[_0x2f2c8e(0x206)](){const _0x14a387=_0x2f2c8e;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace[(_0x14a387(0x224))]['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x4bf240={_0x1b7c3f:0x1f4,_0x381d88:0x208},_0x3c872f=_0x2f2c8e;this[_0x3c872f(0x218)]['addLayer'](this['_layer']),this['_container']=mars3d__namespace[_0x3c872f(_0x4bf240._0x1b7c3f)]['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this['options']['flyTo']&&this[_0x3c872f(_0x4bf240._0x381d88)]();}['_removedHook'](){const _0x1c4f59={_0x4bdfbf:0x204,_0x758136:0x218,_0x531b84:0x1ee},_0x39445f=_0x2f2c8e;this['_container']&&(mars3d__namespace['DomUtil'][_0x39445f(0x22c)](this['_container']),delete this[_0x39445f(_0x1c4f59._0x4bdfbf)]),this['clear'](),this[_0x39445f(_0x1c4f59._0x758136)]['removeLayer'](this[_0x39445f(_0x1c4f59._0x531b84)]);}['addPosition'](_0x129b32,_0x5b3f63){const _0x3d0148={_0x4ad6a7:0x211,_0x3a0b52:0x22b},_0x4449b7=_0x2f2c8e;this[_0x4449b7(0x211)]=this[_0x4449b7(_0x3d0148._0x4ad6a7)]||[],this['_positions'][_0x4449b7(_0x3d0148._0x3a0b52)](_0x129b32),this['_updatePositionsHook'](_0x5b3f63);}['setPositions'](_0x32da0f,_0x1fd362){const _0xdfc8c9=_0x2f2c8e;this[_0xdfc8c9(0x211)]=_0x32da0f,this['_updatePositionsHook'](_0x1fd362);}[_0x2f2c8e(0x219)](){const _0x1fbe7d={_0x5103ad:0x1f7,_0x9bbe09:0x1fa},_0x25baea=_0x2f2c8e;this['_graphic']&&(this['_layer']['removeGraphic'](this[_0x25baea(0x1f7)],!![]),delete this[_0x25baea(_0x1fbe7d._0x5103ad)]),this['_graphic2']&&(this['_layer']['removeGraphic'](this[_0x25baea(_0x1fbe7d._0x9bbe09)],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x3bc8d9){const _0x267cc3={_0x24519e:0x209,_0x4030df:0x22d,_0x59db13:0x1e0,_0x547c97:0x20c,_0xc5280b:0x1fa,_0x4f40f9:0x209,_0x12c180:0x1e5},_0x5693fb=_0x2f2c8e;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x282aee=this['_getHeatCanvas']();if(this['style']['type']===_0x5693fb(_0x267cc3._0x24519e))this['_layer']['setOptions']({'url':_0x282aee['toDataURL'](_0x5693fb(0x1de)),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this[_0x5693fb(_0x267cc3._0x4030df)]['arc']?this[_0x5693fb(0x1f7)]&&_0x3bc8d9?(this['_graphic'][_0x5693fb(_0x267cc3._0x59db13)]['image']=_0x282aee,this['_graphic']['uniforms'][_0x5693fb(_0x267cc3._0x547c97)]=this['_getArcHeatCanvas'](),this[_0x5693fb(_0x267cc3._0xc5280b)]&&(this[_0x5693fb(_0x267cc3._0xc5280b)][_0x5693fb(0x1e0)][_0x5693fb(_0x267cc3._0x4f40f9)]=_0x282aee,this['_graphic2']['uniforms'][_0x5693fb(0x20c)]=this['_graphic'][_0x5693fb(_0x267cc3._0x59db13)]['bumpMap'])):this['_createArcGraphic'](_0x282aee):this['_graphic']&&_0x3bc8d9?this['_graphic'][_0x5693fb(_0x267cc3._0x59db13)]['image']=_0x282aee:this[_0x5693fb(_0x267cc3._0x12c180)](_0x282aee);return this;}['_createGraphic'](_0x406167){const _0x3be8d3={_0x2e016d:0x219,_0xde5a79:0x1f9,_0x5e3470:0x21b},_0x4b34f6=_0x2f2c8e;this[_0x4b34f6(_0x3be8d3._0x2e016d)](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x4b34f6(_0x3be8d3._0xde5a79)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x4b34f6(0x1dd))]({'fabric':{'uniforms':{'image':_0x406167},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer'][_0x4b34f6(_0x3be8d3._0x5e3470)](this['_graphic']);}[_0x2f2c8e(0x21e)](_0x112d47){const _0x238d66={_0x3446df:0x1eb,_0x4c3ff9:0x1f6,_0x13385e:0x1df,_0x364cb4:0x21f,_0x51d337:0x217,_0x2d4490:0x210,_0x930097:0x1fd,_0x3d5c07:0x1f3},_0x1311a7=_0x2f2c8e;this['clear']();const _0x575dd7=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x1311a7(0x1e7)],'zFail':Cesium[_0x1311a7(_0x238d66._0x3446df)]['KEEP'],'zPass':Cesium['StencilOperation'][_0x1311a7(_0x238d66._0x4c3ff9)]},'backFunction':Cesium['StencilFunction'][_0x1311a7(_0x238d66._0x13385e)],'backOperation':{'fail':Cesium[_0x1311a7(0x1eb)]['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x57148f=Math[_0x1311a7(0x22a)](this['style']['diffHeight']??this[_0x1311a7(0x207)]*0.02)+0.1;this['style'][_0x1311a7(_0x238d66._0x364cb4)]&&delete this['style']['diffHeight'];const _0x5ba4a9=(this['style'][_0x1311a7(_0x238d66._0x51d337)],0x64);let _0x391765=Math['max'](this['_rectangle'][_0x1311a7(_0x238d66._0x2d4490)],this['_rectangle']['width']);this[_0x1311a7(0x22d)]['granularity']=_0x391765/=_0x5ba4a9;const _0x2c7e4f=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x112d47,'repeat':new Cesium[(_0x1311a7(0x1e8))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x1311a7(_0x238d66._0x930097)]()},'source':HeatMaterial},'translucent':!![]}),_0x362e21=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x575dd7,'material':_0x2c7e4f,'vertexShaderSource':getVertexShaderSource(_0x57148f*_0x362e21)})}),this['_layer']['addGraphic'](this[_0x1311a7(0x1f7)]),this[_0x1311a7(0x22d)][_0x1311a7(_0x238d66._0x3d5c07)]===0x0&&(this[_0x1311a7(0x1fa)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x575dd7,'material':_0x2c7e4f,'vertexShaderSource':getVertexShaderSource(-_0x57148f)})}),this[_0x1311a7(0x1ee)]['addGraphic'](this['_graphic2']));}['getRectangle'](_0x2658e7){return _0x2658e7!==null&&_0x2658e7!==void 0x0&&_0x2658e7['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x35c32={_0x4da2c8:0x213,_0x10b323:0x1ec,_0x471f5e:0x207,_0xf89312:0x1f9,_0x5062ef:0x201,_0x2a3623:0x1e4,_0x3d04f4:0x1e3,_0x352df6:0x223,_0x10742e:0x204,_0x4ee981:0x20e,_0x81d7c2:0x20e},_0x218ee4={_0x937e13:0x20b},_0x3ecc14={_0x3c8ee8:0x1db,_0x69f14b:0x1dc,_0x287c06:0x22b},_0x5da5a0=_0x2f2c8e,_0x2e9a1d=this[_0x5da5a0(0x211)],_0x2030da=[];let _0x39dd49,_0xd1bf77,_0x35b14a,_0x2b81d5;_0x2e9a1d[_0x5da5a0(_0x35c32._0x4da2c8)](_0x35540a=>{const _0x16bce0=_0x5da5a0,_0xfab53d=mars3d__namespace['LngLatPoint']['parse'](_0x35540a);if(!_0xfab53d)return;_0xfab53d[_0x16bce0(_0x3ecc14._0x3c8ee8)]=_0x35540a['value']||0x1,!this[_0x16bce0(0x1f9)][_0x16bce0(0x22e)]&&(_0x39dd49===undefined?(_0x39dd49=_0xfab53d['lng'],_0xd1bf77=_0xfab53d['lng'],_0x35b14a=_0xfab53d['lat'],_0x2b81d5=_0xfab53d['lat']):(_0x39dd49=Math['min'](_0x39dd49,_0xfab53d['lng']),_0xd1bf77=Math['max'](_0xd1bf77,_0xfab53d[_0x16bce0(0x20b)]),_0x35b14a=Math['min'](_0x35b14a,_0xfab53d[_0x16bce0(_0x3ecc14._0x69f14b)]),_0x2b81d5=Math['max'](_0x2b81d5,_0xfab53d[_0x16bce0(_0x3ecc14._0x69f14b)]))),_0x2030da[_0x16bce0(_0x3ecc14._0x287c06)](_0xfab53d);});_0x39dd49===_0xd1bf77&&(_0x39dd49-=0.000001,_0xd1bf77+=0.000001);_0x35b14a===_0x2b81d5&&(_0x35b14a-=0.000001,_0x2b81d5+=0.000001);let _0xd43dce=this['options']['rectangle']||{'xmin':_0x39dd49,'xmax':_0xd1bf77,'ymin':_0x35b14a,'ymax':_0x2b81d5};const _0x52ee21=getMercatorBounds(_0xd43dce),_0x22d3e0=Math['abs'](_0x52ee21['xmax']-_0x52ee21[_0x5da5a0(0x1fb)]),_0x562aa8=Math['abs'](_0x52ee21[_0x5da5a0(_0x35c32._0x10b323)]-_0x52ee21['ymin']),_0x134303=Math[_0x5da5a0(0x1f2)](_0x22d3e0,_0x562aa8),_0x4b5e70=Math['min'](_0x22d3e0,_0x562aa8);this[_0x5da5a0(_0x35c32._0x471f5e)]=_0x134303;let _0x581ad3=0x1;if(_0x134303>this['options']['maxCanvasSize'])_0x581ad3=_0x134303/this['options']['maxCanvasSize'],_0x4b5e70/_0x581ad3<this['options']['minCanvasSize']&&(_0x581ad3=_0x4b5e70/this[_0x5da5a0(0x1f9)]['minCanvasSize']);else _0x4b5e70<this[_0x5da5a0(0x1f9)][_0x5da5a0(0x203)]&&(_0x581ad3=_0x4b5e70/this['options']['minCanvasSize'],_0x134303/_0x581ad3>this[_0x5da5a0(_0x35c32._0xf89312)]['maxCanvasSize']&&(_0x581ad3=_0x134303/this['options'][_0x5da5a0(_0x35c32._0x5062ef)]));const _0x273734=this[_0x5da5a0(_0x35c32._0x2a3623)]['radius']*1.5,_0x275838=_0x22d3e0/_0x581ad3+_0x273734*0x2,_0x352f68=_0x562aa8/_0x581ad3+_0x273734*0x2,_0x324f16=_0x273734*_0x581ad3;_0x52ee21['xmin']-=_0x324f16,_0x52ee21['ymin']-=_0x324f16,_0x52ee21['xmax']+=_0x324f16,_0x52ee21[_0x5da5a0(0x1ec)]+=_0x324f16,this['_scale']=_0x581ad3,_0xd43dce=geLatLngBounds(_0x52ee21),this['_rectangle']=Cesium['Rectangle']['fromDegrees'](_0xd43dce['xmin'],_0xd43dce[_0x5da5a0(_0x35c32._0x3d04f4)],_0xd43dce['xmax'],_0xd43dce['ymax']);let _0x50bc94=_0x2030da[0x0]['value']??0x1,_0x5bf17f=_0x2030da[0x0]['value']??0x0;const _0x376a6a=[];_0x2030da['forEach'](_0x54bd84=>{const _0x33c58e=_0x5da5a0,_0x337dbe=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x54bd84[_0x33c58e(_0x218ee4._0x937e13)],_0x54bd84['lat']]),_0x30db61=_0x54bd84['value']||0x1,_0x5e9039=Math['round']((_0x337dbe[0x0]-_0x52ee21['xmin'])/_0x581ad3),_0x47be63=Math['round']((_0x52ee21[_0x33c58e(0x1ec)]-_0x337dbe[0x1])/_0x581ad3);_0x50bc94=Math[_0x33c58e(0x1f2)](_0x50bc94,_0x30db61),_0x5bf17f=Math['min'](_0x5bf17f,_0x30db61),_0x376a6a['push']({'x':_0x5e9039,'y':_0x47be63,'value':_0x30db61});});const _0xac11ae={'min':this['options']['min']??_0x5bf17f,'max':this['options']['max']??_0x50bc94,'data':_0x376a6a};this['_last_heatData']=_0xac11ae;if(!this[_0x5da5a0(0x223)]||_0x52ee21[_0x5da5a0(0x1fb)]!==this[_0x5da5a0(_0x35c32._0x352df6)]['xmin']||_0x52ee21['ymin']!==this['_last_mBounds']['ymin']||_0x52ee21['xmax']!==this[_0x5da5a0(_0x35c32._0x352df6)]['xmax']||_0x52ee21['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x52ee21,this['_container']['style']['cssText']='width:'+_0x275838+'px;height:'+_0x352f68+_0x5da5a0(0x1ea);const _0x504887={...this[_0x5da5a0(0x1e4)],'container':this[_0x5da5a0(_0x35c32._0x10742e)]};!this['_heat']?this['_heat']=h337__namespace[_0x5da5a0(0x202)](_0x504887):this[_0x5da5a0(_0x35c32._0x4ee981)]['configure'](_0x504887);}this[_0x5da5a0(_0x35c32._0x81d7c2)]['setData'](_0xac11ae);const _0x52b43e=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer'][_0x5da5a0(0x1e9)]);return _0x52b43e;}['_getArcHeatCanvas'](){const _0x498155={_0x3b9714:0x1e1,_0x46555c:0x1e4,_0x43e016:0x1f9},_0x3d7e79=_0x2f2c8e;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this['style'][_0x3d7e79(_0x498155._0x3b9714)],'blur':this[_0x3d7e79(_0x498155._0x46555c)]['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x475371=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat'][_0x3d7e79(0x1ff)]['canvas']);return this['_heat']['configure'](this[_0x3d7e79(_0x498155._0x43e016)]['heatStyle']),_0x475371;}['getPointData'](_0x4d7be6){const _0x4afde2={_0x4181f8:0x20b,_0x518c5b:0x1dc,_0x33cf2b:0x212,_0x21fea0:0x227,_0x2b3e88:0x20f},_0x269367=_0x2f2c8e,_0x51cc15=mars3d__namespace[_0x269367(0x229)]['parse'](_0x4d7be6);if(!_0x51cc15)return{};const _0x19bea5=mars3d__namespace[_0x269367(0x20d)]['lonlat2mercator']([_0x51cc15[_0x269367(_0x4afde2._0x4181f8)],_0x51cc15[_0x269367(_0x4afde2._0x518c5b)]]),_0x4de71e=this[_0x269367(0x223)],_0x24e5ac=Math[_0x269367(0x212)]((_0x19bea5[0x0]-_0x4de71e['xmin'])/this['_scale']),_0x212434=Math[_0x269367(_0x4afde2._0x33cf2b)]((_0x4de71e['ymax']-_0x19bea5[0x1])/this[_0x269367(_0x4afde2._0x21fea0)]),_0x54a6b1=this['_heat']['getValueAt']({'x':_0x24e5ac,'y':_0x212434}),_0x494fc5=this[_0x269367(0x20e)]['_renderer']['ctx'][_0x269367(0x220)](_0x24e5ac-0x1,_0x212434-0x1,0x1,0x1)[_0x269367(_0x4afde2._0x2b3e88)];return{'x':_0x24e5ac,'y':_0x212434,'value':_0x54a6b1,'color':'rgba('+_0x494fc5[0x0]+','+_0x494fc5[0x1]+','+_0x494fc5[0x2]+','+_0x494fc5[0x3]+')'};}}function _0x330f(){const _0x53e371=['heat','_last_mBounds','layer','HeatLayer','mercator2lonlat','_scale','merge','LngLatPoint','floor','push','remove','style','rectangle','value','lat','Material','image/png','ALWAYS','uniforms','arcRadiusScale','1059978LTCdiJ','ymin','heatStyle','_createGraphic','257008ykrlbi','KEEP','Cartesian2','canvas','px;','StencilOperation','ymax','body','_layer','positions','273zdpHkO','green','max','arcDirection','DomUtil','toArray','REPLACE','_graphic','BaseLayer','options','_graphic2','xmin','2756763JCLbBs','_getArcHeatCanvas','Cesium','_renderer','lonlat2mercator','maxCanvasSize','create','minCanvasSize','_container','_updatePositionsHook','_mountedHook','_mBoundsMax','flyToByAnimationEnd','image','2842490iNAdWp','lng','bumpMap','PointTrans','_heat','data','height','_positions','round','forEach','26313759OYBErO','blue','__esModule','splitNum','_map','clear','10490OMdqpL','addGraphic','EllipsoidSurfaceAppearance','1846404sPDeZN','_createArcGraphic','diffHeight','getImageData','32itpvVo'];_0x330f=function(){return _0x53e371;};return _0x330f();}mars3d__namespace['LayerUtil']['register'](_0x2f2c8e(0x222),HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x45117b){const _0x2d35fc={_0x4e86ab:0x1ec},_0x5f4a8f=_0x2f2c8e,_0x2e0975=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x45117b['xmin'],_0x45117b[_0x5f4a8f(0x1e3)]]),_0x575a33=mars3d__namespace['PointTrans'][_0x5f4a8f(0x200)]([_0x45117b['xmax'],_0x45117b[_0x5f4a8f(_0x2d35fc._0x4e86ab)]]);return{'xmin':_0x2e0975[0x0],'ymin':_0x2e0975[0x1],'xmax':_0x575a33[0x0],'ymax':_0x575a33[0x1]};}function geLatLngBounds(_0x4ae82e){const _0x14c556={_0x49efd1:0x226},_0x49c30e=_0x2f2c8e,_0x185d7c=mars3d__namespace['PointTrans'][_0x49c30e(_0x14c556._0x49efd1)]([_0x4ae82e['xmin'],_0x4ae82e['ymin']]),_0x35a338=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4ae82e['xmax'],_0x4ae82e['ymax']]);return{'xmin':_0x185d7c[0x0],'ymin':_0x185d7c[0x1],'xmax':_0x35a338[0x0],'ymax':_0x35a338[0x1]};}function getVertexShaderSource(_0x5020af){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x5020af+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports[_0x2f2c8e(0x225)]=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
