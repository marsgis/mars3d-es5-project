/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.14
 * 编译日期：2023-07-03 18:40:54
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x3d89cf=_0x2781;function _0x2781(_0x4d54dd,_0x166e54){const _0x39952c=_0x3995();return _0x2781=function(_0x27812b,_0x12a4c0){_0x27812b=_0x27812b-0x1a0;let _0x2a2067=_0x39952c[_0x27812b];return _0x2a2067;},_0x2781(_0x4d54dd,_0x166e54);}(function(_0x2c90df,_0x8c2c5e){const _0x476552={_0x152b33:0x1e5,_0x29240c:0x1a1,_0xe4174b:0x1c1},_0x17cd20=_0x2781,_0x3376fe=_0x2c90df();while(!![]){try{const _0x8583fb=parseInt(_0x17cd20(0x1d7))/0x1+-parseInt(_0x17cd20(0x1b5))/0x2*(-parseInt(_0x17cd20(_0x476552._0x152b33))/0x3)+-parseInt(_0x17cd20(0x1bb))/0x4*(parseInt(_0x17cd20(_0x476552._0x29240c))/0x5)+-parseInt(_0x17cd20(0x1ed))/0x6+parseInt(_0x17cd20(0x1a6))/0x7*(parseInt(_0x17cd20(_0x476552._0xe4174b))/0x8)+parseInt(_0x17cd20(0x1ef))/0x9+-parseInt(_0x17cd20(0x1a8))/0xa;if(_0x8583fb===_0x8c2c5e)break;else _0x3376fe['push'](_0x3376fe['shift']());}catch(_0x53f58b){_0x3376fe['push'](_0x3376fe['shift']());}}}(_0x3995,0x1aa02));function _interopNamespace(_0x25badb){const _0x39ec07={_0x12f2de:0x1ab};if(_0x25badb&&_0x25badb['__esModule'])return _0x25badb;var _0x45a630=Object['create'](null);return _0x25badb&&Object['keys'](_0x25badb)['forEach'](function(_0x53c6cc){const _0x2d0fce=_0x2781;if(_0x53c6cc!=='default'){var _0x18abc9=Object['getOwnPropertyDescriptor'](_0x25badb,_0x53c6cc);Object[_0x2d0fce(_0x39ec07._0x12f2de)](_0x45a630,_0x53c6cc,_0x18abc9[_0x2d0fce(0x1dc)]?_0x18abc9:{'enumerable':!![],'get':function(){return _0x25badb[_0x53c6cc];}});}}),_0x45a630['default']=_0x25badb,_0x45a630;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error(_0x3d89cf(0x1b6));const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:_0x3d89cf(0x1b2)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};function _0x3995(){const _0x1c0d83=['122312NEyKgy','请引入\x20heatmap.js\x20库\x20','lng','arc','minCanvasSize','arcBlurScale','376MtuhRS','_heat','maxCanvasSize','setPositions','container','floor','46568XEDKYf','_last_mBounds','max','ymin','PolyUtil','_positions','_container','_graphic','rgb(216,216,216)','image/png','parse','register','uniforms','merge','REPLACE','splitNum','EPSG:3857','_map','canvas','StencilOperation','clear','_addedHook','163908SoFrDa','value','abs','ymax','__esModule','get','xmin',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','PointTrans','getImageData','image','push','RenderState','rectangle','3aJyzJZ','RectanglePrimitive','_mountedHook','min','gradientArc','_layer','_graphic2','mercator2lonlat','761196zeiiiv','_rectangle','425421LXpalU','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','Cartesian2','isFormat','4690tEafNj','lat','setOptions','heatStyle','options','112BShkxM','fromCache','413730mWbIMG','xmax','_createGraphic','defineProperty','_renderer','addPosition','style','_last_heatData','radius','body','red','width:','positions'];_0x3995=function(){return _0x1c0d83;};return _0x3995();}class HeatLayer extends BaseLayer{constructor(_0x253e2c={}){const _0x369e97={_0x27e3da:0x1a5,_0x9d8025:0x1bd,_0x424475:0x1b9},_0x30201a=_0x3d89cf;super(_0x253e2c),this['options'][_0x30201a(0x1bd)]=this[_0x30201a(_0x369e97._0x27e3da)][_0x30201a(_0x369e97._0x9d8025)]??document['body']['clientWidth'],this[_0x30201a(0x1a5)]['maxCanvasSize']=Math['min'](this[_0x30201a(_0x369e97._0x27e3da)]['maxCanvasSize'],0x1388),this['options'][_0x30201a(_0x369e97._0x424475)]=this[_0x30201a(0x1a5)]['minCanvasSize']??document[_0x30201a(0x1b1)]['clientHeight'],this['options'][_0x30201a(0x1b9)]=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options'][_0x30201a(0x1a4)]={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){const _0x193de5={_0x5e835b:0x1ea},_0x1efe66=_0x3d89cf;return this[_0x1efe66(_0x193de5._0x5e835b)];}get['heatStyle'](){const _0xe1e1f6={_0xa16a3a:0x1a4},_0x2c9eff=_0x3d89cf;return this['options'][_0x2c9eff(_0xe1e1f6._0xa16a3a)];}set[_0x3d89cf(0x1a4)](_0x58896e){const _0x599b9f={_0x2b81bd:0x1a5,_0x15b295:0x1a4,_0x1ff3cf:0x1a5},_0x1e5974=_0x3d89cf;this[_0x1e5974(_0x599b9f._0x2b81bd)][_0x1e5974(_0x599b9f._0x15b295)]=mars3d__namespace['Util'][_0x1e5974(0x1ce)](this[_0x1e5974(_0x599b9f._0x1ff3cf)][_0x1e5974(_0x599b9f._0x15b295)],_0x58896e),this['_heat']&&(this['_heat']['configure'](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set[_0x3d89cf(0x1ae)](_0x36cd8a){const _0x596e31={_0x5b8f87:0x1ae},_0x256e6f=_0x3d89cf;this['options'][_0x256e6f(_0x596e31._0x5b8f87)]=mars3d__namespace['Util'][_0x256e6f(0x1ce)](this['options'][_0x256e6f(0x1ae)],_0x36cd8a);}get[_0x3d89cf(0x1b4)](){return this['_positions'];}set[_0x3d89cf(0x1b4)](_0x918d37){const _0x17aeec={_0x1063d0:0x1be},_0x576b42=_0x3d89cf;this[_0x576b42(_0x17aeec._0x1063d0)](_0x918d37);}get['coordinates'](){const _0x4dcb5c=[];return this['points']['forEach'](_0x4d2adc=>{_0x4dcb5c['push'](_0x4d2adc['toArray']());}),_0x4dcb5c;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x3308c8,_0x43815e){const _0x88cff4=_0x3d89cf;_0x3308c8[_0x88cff4(0x1b4)]&&(this[_0x88cff4(0x1b4)]=_0x3308c8['positions']);}[_0x3d89cf(0x1e7)](){const _0x4b1861=_0x3d89cf;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':_0x4b1861(0x1d1),'private':!![]}):this[_0x4b1861(0x1ea)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}[_0x3d89cf(0x1d6)](){const _0x49f8f1={_0x181c2a:0x1d2,_0x1dbea7:0x1bf},_0x468953=_0x3d89cf;this[_0x468953(_0x49f8f1._0x181c2a)]['addLayer'](this['_layer']),this[_0x468953(0x1c7)]=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map'][_0x468953(_0x49f8f1._0x1dbea7)]),this[_0x468953(0x1a5)]['positions']&&(this['positions']=this['options']['positions']),this[_0x468953(0x1a5)]['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x1522c2=_0x3d89cf;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this[_0x1522c2(0x1ea)]);}[_0x3d89cf(0x1ad)](_0x2d0b21,_0x12a752){const _0x89ac7f={_0x365938:0x1c6},_0x1fbec5=_0x3d89cf;this[_0x1fbec5(_0x89ac7f._0x365938)]=this['_positions']||[],this['_positions']['push'](_0x2d0b21),this['_updatePositionsHook'](_0x12a752);}['setPositions'](_0x4774b1,_0x54e424){const _0x1a420d={_0x5650b4:0x1c6},_0xfedb32=_0x3d89cf;this[_0xfedb32(_0x1a420d._0x5650b4)]=_0x4774b1,this['_updatePositionsHook'](_0x54e424);}[_0x3d89cf(0x1d5)](){const _0x40c68d=_0x3d89cf;this['_graphic']&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this[_0x40c68d(0x1eb)]);}['_updatePositionsHook'](_0x380bc4){const _0x29f637={_0x2a1db8:0x1cd,_0x587866:0x1c8},_0x43a8c9=_0x3d89cf;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x253e48=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer'][_0x43a8c9(0x1a3)]({'url':_0x253e48['toDataURL'](_0x43a8c9(0x1ca)),'rectangle':this[_0x43a8c9(0x1ee)],'opacity':this['style']['opacity']});else this['style'][_0x43a8c9(0x1b8)]?this['_graphic']&&_0x380bc4?(this['_graphic']['uniforms']['image']=_0x253e48,this[_0x43a8c9(0x1c8)]['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this[_0x43a8c9(0x1eb)]&&(this[_0x43a8c9(0x1eb)]['uniforms']['image']=_0x253e48,this['_graphic2']['uniforms']['bumpMap']=this['_graphic'][_0x43a8c9(_0x29f637._0x2a1db8)]['bumpMap'])):this['_createArcGraphic'](_0x253e48):this[_0x43a8c9(_0x29f637._0x587866)]&&_0x380bc4?this['_graphic'][_0x43a8c9(0x1cd)][_0x43a8c9(0x1e1)]=_0x253e48:this['_createGraphic'](_0x253e48);return this;}[_0x3d89cf(0x1aa)](_0x488f54){const _0x1a2957={_0x24eef7:0x1c8,_0x365585:0x1ee},_0x179f24=_0x3d89cf;this['clear'](),this[_0x179f24(_0x1a2957._0x24eef7)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x179f24(_0x1a2957._0x365585)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x488f54},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x57dba9){const _0x164422={_0x1d75af:0x1cf,_0x51ec36:0x1ae,_0x2beb63:0x1ee,_0x43b27a:0x1f1,_0x417150:0x1ea},_0x22bd7b=_0x3d89cf;this['clear']();const _0x35c4f3=Cesium[_0x22bd7b(0x1e3)][_0x22bd7b(0x1a7)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x22bd7b(_0x164422._0x1d75af)]},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x22bd7b(0x1d4)]['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x502b6b=Math[_0x22bd7b(0x1c0)](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style']['diffHeight'];const _0xd384c2=(this[_0x22bd7b(_0x164422._0x51ec36)][_0x22bd7b(0x1d0)],0x64);let _0x2d225e=Math['max'](this['_rectangle']['height'],this[_0x22bd7b(_0x164422._0x2beb63)]['width']);this['style']['granularity']=_0x2d225e/=_0xd384c2;const _0x20aed2=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x57dba9,'repeat':new Cesium[(_0x22bd7b(_0x164422._0x43b27a))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x91373c=this[_0x22bd7b(0x1ae)]['arcDirection']||0x1;this[_0x22bd7b(0x1c8)]=new mars3d__namespace['graphic'][(_0x22bd7b(0x1e6))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x35c4f3,'material':_0x20aed2,'vertexShaderSource':getVertexShaderSource(_0x502b6b*_0x91373c)})}),this['_layer']['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this[_0x22bd7b(0x1eb)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x35c4f3,'material':_0x20aed2,'vertexShaderSource':getVertexShaderSource(-_0x502b6b)})}),this[_0x22bd7b(_0x164422._0x417150)]['addGraphic'](this['_graphic2']));}['getRectangle'](_0xabd312){const _0x2dca19={_0x468811:0x1a0},_0x416c07=_0x3d89cf;return _0xabd312!==null&&_0xabd312!==void 0x0&&_0xabd312[_0x416c07(_0x2dca19._0x468811)]&&this['_rectangle']?mars3d__namespace[_0x416c07(0x1c5)]['formatRectangle'](this['_rectangle']):this[_0x416c07(0x1ee)];}['_getHeatCanvas'](){const _0x351d9b={_0x283c79:0x1e4,_0x233b9b:0x1dd,_0x4f2f3a:0x1e8,_0x42905e:0x1a5,_0x2b38c3:0x1b9,_0x2487de:0x1d8,_0x301cc2:0x1a5,_0x3e072c:0x1af,_0xc049b8:0x1c2,_0x24db3b:0x1a9,_0x49bb9e:0x1c2,_0x3db0c3:0x1c7,_0x4b705d:0x1b3,_0x5d8e3b:0x1bc},_0x7bd2b1={_0x2b8f4b:0x1d8,_0x29e4f9:0x1b7,_0x5cc82a:0x1c3},_0x362a01=_0x3d89cf,_0x4e8664=this[_0x362a01(0x1c6)],_0x5ee0f4=[];let _0x224f29,_0x432c6d,_0x4a103e,_0x5af91c;_0x4e8664['forEach'](_0x3b940f=>{const _0x7a393b=_0x362a01,_0x196c46=mars3d__namespace['LngLatPoint'][_0x7a393b(0x1cb)](_0x3b940f);if(!_0x196c46)return;_0x196c46[_0x7a393b(_0x7bd2b1._0x2b8f4b)]=_0x3b940f['value']||0x1,!this['options']['rectangle']&&(_0x224f29===undefined?(_0x224f29=_0x196c46['lng'],_0x432c6d=_0x196c46[_0x7a393b(_0x7bd2b1._0x29e4f9)],_0x4a103e=_0x196c46['lat'],_0x5af91c=_0x196c46['lat']):(_0x224f29=Math['min'](_0x224f29,_0x196c46[_0x7a393b(_0x7bd2b1._0x29e4f9)]),_0x432c6d=Math[_0x7a393b(_0x7bd2b1._0x5cc82a)](_0x432c6d,_0x196c46[_0x7a393b(0x1b7)]),_0x4a103e=Math['min'](_0x4a103e,_0x196c46['lat']),_0x5af91c=Math['max'](_0x5af91c,_0x196c46['lat']))),_0x5ee0f4[_0x7a393b(0x1e2)](_0x196c46);});_0x224f29===_0x432c6d&&(_0x224f29-=0.000001,_0x432c6d+=0.000001);_0x4a103e===_0x5af91c&&(_0x4a103e-=0.000001,_0x5af91c+=0.000001);let _0x734a12=this['options'][_0x362a01(_0x351d9b._0x283c79)]||{'xmin':_0x224f29,'xmax':_0x432c6d,'ymin':_0x4a103e,'ymax':_0x5af91c};const _0x21139f=getMercatorBounds(_0x734a12),_0x476cba=Math[_0x362a01(0x1d9)](_0x21139f['xmax']-_0x21139f[_0x362a01(_0x351d9b._0x233b9b)]),_0x30c055=Math['abs'](_0x21139f[_0x362a01(0x1da)]-_0x21139f['ymin']),_0x3ea456=Math['max'](_0x476cba,_0x30c055),_0x29db97=Math[_0x362a01(_0x351d9b._0x4f2f3a)](_0x476cba,_0x30c055);this['_mBoundsMax']=_0x3ea456;let _0xed953=0x1;if(_0x3ea456>this['options'][_0x362a01(0x1bd)])_0xed953=_0x3ea456/this[_0x362a01(_0x351d9b._0x42905e)]['maxCanvasSize'],_0x29db97/_0xed953<this[_0x362a01(_0x351d9b._0x42905e)][_0x362a01(0x1b9)]&&(_0xed953=_0x29db97/this[_0x362a01(0x1a5)][_0x362a01(_0x351d9b._0x2b38c3)]);else _0x29db97<this['options'][_0x362a01(0x1b9)]&&(_0xed953=_0x29db97/this[_0x362a01(0x1a5)]['minCanvasSize'],_0x3ea456/_0xed953>this['options']['maxCanvasSize']&&(_0xed953=_0x3ea456/this['options']['maxCanvasSize']));const _0x25864d=this['heatStyle'][_0x362a01(0x1b0)]*1.5,_0x4b8f1e=_0x476cba/_0xed953+_0x25864d*0x2,_0x5f25f9=_0x30c055/_0xed953+_0x25864d*0x2,_0x2e8519=_0x25864d*_0xed953;_0x21139f['xmin']-=_0x2e8519,_0x21139f['ymin']-=_0x2e8519,_0x21139f['xmax']+=_0x2e8519,_0x21139f['ymax']+=_0x2e8519,this['_scale']=_0xed953,_0x734a12=geLatLngBounds(_0x21139f),this[_0x362a01(0x1ee)]=Cesium['Rectangle']['fromDegrees'](_0x734a12[_0x362a01(0x1dd)],_0x734a12['ymin'],_0x734a12['xmax'],_0x734a12['ymax']);let _0x5d1338=_0x5ee0f4[0x0][_0x362a01(_0x351d9b._0x2487de)]??0x1,_0xeec3a9=_0x5ee0f4[0x0]['value']??0x0;const _0x5b2eee=[];_0x5ee0f4['forEach'](_0x1cac54=>{const _0x448b78=_0x362a01,_0x10edfc=mars3d__namespace[_0x448b78(0x1df)]['lonlat2mercator']([_0x1cac54['lng'],_0x1cac54['lat']]),_0x96ea53=_0x1cac54['value']||0x1,_0xdf38fc=Math['round']((_0x10edfc[0x0]-_0x21139f['xmin'])/_0xed953),_0xf4a444=Math['round']((_0x21139f['ymax']-_0x10edfc[0x1])/_0xed953);_0x5d1338=Math['max'](_0x5d1338,_0x96ea53),_0xeec3a9=Math[_0x448b78(0x1e8)](_0xeec3a9,_0x96ea53),_0x5b2eee['push']({'x':_0xdf38fc,'y':_0xf4a444,'value':_0x96ea53});});const _0x309fc0={'min':this[_0x362a01(_0x351d9b._0x301cc2)]['min']??_0xeec3a9,'max':this['options']['max']??_0x5d1338,'data':_0x5b2eee};this[_0x362a01(_0x351d9b._0x3e072c)]=_0x309fc0;if(!this['_last_mBounds']||_0x21139f['xmin']!==this[_0x362a01(_0x351d9b._0xc049b8)]['xmin']||_0x21139f['ymin']!==this['_last_mBounds'][_0x362a01(0x1c4)]||_0x21139f[_0x362a01(_0x351d9b._0x24db3b)]!==this['_last_mBounds']['xmax']||_0x21139f[_0x362a01(0x1da)]!==this[_0x362a01(_0x351d9b._0x49bb9e)]['ymax']){this['_last_mBounds']=_0x21139f,this[_0x362a01(_0x351d9b._0x3db0c3)]['style']['cssText']=_0x362a01(_0x351d9b._0x4b705d)+_0x4b8f1e+'px;height:'+_0x5f25f9+'px;';const _0x2da290={...this['heatStyle'],'container':this['_container']};!this[_0x362a01(_0x351d9b._0x5d8e3b)]?this[_0x362a01(0x1bc)]=h337__namespace['create'](_0x2da290):this['_heat']['configure'](_0x2da290);}this['_heat']['setData'](_0x309fc0);const _0x3356fb=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x362a01(_0x351d9b._0x5d8e3b)][_0x362a01(0x1ac)][_0x362a01(0x1d3)]);return _0x3356fb;}['_getArcHeatCanvas'](){const _0xe0fcca={_0x3f1475:0x1c9,_0x52236b:0x1ac,_0x33b367:0x1bc},_0x393fe0=_0x3d89cf;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this[_0x393fe0(0x1a4)]['blur']*this[_0x393fe0(0x1ae)][_0x393fe0(0x1ba)],'gradient':this['heatStyle'][_0x393fe0(0x1e9)]||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:_0x393fe0(_0xe0fcca._0x3f1475),0x1:'rgb(255,255,255)'}});const _0x2ab992=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat'][_0x393fe0(_0xe0fcca._0x52236b)]['canvas']);return this[_0x393fe0(_0xe0fcca._0x33b367)]['configure'](this[_0x393fe0(0x1a5)]['heatStyle']),_0x2ab992;}['getPointData'](_0x48270f){const _0xb4b87b={_0x456fa3:0x1c2,_0x33f34f:0x1dd,_0x37f3d1:0x1bc},_0x2ff3fd=_0x3d89cf,_0x25848d=mars3d__namespace['LngLatPoint']['parse'](_0x48270f);if(!_0x25848d)return{};const _0x31d3b8=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x25848d['lng'],_0x25848d[_0x2ff3fd(0x1a2)]]),_0x3da0ee=this[_0x2ff3fd(_0xb4b87b._0x456fa3)],_0x1b72d9=Math['round']((_0x31d3b8[0x0]-_0x3da0ee[_0x2ff3fd(_0xb4b87b._0x33f34f)])/this['_scale']),_0x9bb953=Math['round']((_0x3da0ee[_0x2ff3fd(0x1da)]-_0x31d3b8[0x1])/this['_scale']),_0x30fdab=this[_0x2ff3fd(_0xb4b87b._0x37f3d1)]['getValueAt']({'x':_0x1b72d9,'y':_0x9bb953}),_0x22bb8d=this['_heat']['_renderer']['ctx'][_0x2ff3fd(0x1e0)](_0x1b72d9-0x1,_0x9bb953-0x1,0x1,0x1)['data'];return{'x':_0x1b72d9,'y':_0x9bb953,'value':_0x30fdab,'color':'rgba('+_0x22bb8d[0x0]+','+_0x22bb8d[0x1]+','+_0x22bb8d[0x2]+','+_0x22bb8d[0x3]+')'};}}mars3d__namespace['LayerUtil'][_0x3d89cf(0x1cc)]('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x270c81){const _0xce7231=_0x3d89cf,_0x1df176=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x270c81[_0xce7231(0x1dd)],_0x270c81['ymin']]),_0x2203a0=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x270c81['xmax'],_0x270c81['ymax']]);return{'xmin':_0x1df176[0x0],'ymin':_0x1df176[0x1],'xmax':_0x2203a0[0x0],'ymax':_0x2203a0[0x1]};}function geLatLngBounds(_0x20fac3){const _0x2e4731={_0x2c1e65:0x1ec},_0x126d8f=_0x3d89cf,_0xeede25=mars3d__namespace['PointTrans'][_0x126d8f(_0x2e4731._0x2c1e65)]([_0x20fac3['xmin'],_0x20fac3['ymin']]),_0x14c0a7=mars3d__namespace[_0x126d8f(0x1df)][_0x126d8f(0x1ec)]([_0x20fac3['xmax'],_0x20fac3['ymax']]);return{'xmin':_0xeede25[0x0],'ymin':_0xeede25[0x1],'xmax':_0x14c0a7[0x0],'ymax':_0x14c0a7[0x1]};}function getVertexShaderSource(_0x4fdf59){const _0x4767a5=_0x3d89cf;return _0x4767a5(0x1f0)+_0x4fdf59+_0x4767a5(0x1de);}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x3d89cf(0x1db),{'value':!![]});
}));
