/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.15
 * 编译日期：2023-07-10 19:16:32
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x3076df=_0xd62a;(function(_0x5e4abe,_0x239d53){const _0x3f2c51={_0x35d018:0x156,_0x3a73d7:0x155,_0x541e78:0x122,_0x585892:0x131},_0x4eec56=_0xd62a,_0x1dc408=_0x5e4abe();while(!![]){try{const _0x387ed3=parseInt(_0x4eec56(_0x3f2c51._0x35d018))/0x1+-parseInt(_0x4eec56(0x135))/0x2+parseInt(_0x4eec56(0x158))/0x3+parseInt(_0x4eec56(0x12a))/0x4*(-parseInt(_0x4eec56(0x15f))/0x5)+-parseInt(_0x4eec56(0x132))/0x6*(-parseInt(_0x4eec56(0x14e))/0x7)+parseInt(_0x4eec56(_0x3f2c51._0x3a73d7))/0x8*(parseInt(_0x4eec56(_0x3f2c51._0x541e78))/0x9)+parseInt(_0x4eec56(_0x3f2c51._0x585892))/0xa*(parseInt(_0x4eec56(0x127))/0xb);if(_0x387ed3===_0x239d53)break;else _0x1dc408['push'](_0x1dc408['shift']());}catch(_0x597f91){_0x1dc408['push'](_0x1dc408['shift']());}}}(_0x1be1,0x1d5cf));function _interopNamespace(_0x2bff1c){const _0x7c5416={_0x268943:0x138},_0x4c50d5={_0x19794f:0x124,_0x15f620:0x175},_0x34799d=_0xd62a;if(_0x2bff1c&&_0x2bff1c['__esModule'])return _0x2bff1c;var _0x526c42=Object[_0x34799d(0x13a)](null);return _0x2bff1c&&Object[_0x34799d(_0x7c5416._0x268943)](_0x2bff1c)['forEach'](function(_0x127d9b){const _0x399247=_0x34799d;if(_0x127d9b!=='default'){var _0x3b0073=Object[_0x399247(_0x4c50d5._0x19794f)](_0x2bff1c,_0x127d9b);Object[_0x399247(0x14a)](_0x526c42,_0x127d9b,_0x3b0073[_0x399247(_0x4c50d5._0x15f620)]?_0x3b0073:{'enumerable':!![],'get':function(){return _0x2bff1c[_0x127d9b];}});}}),_0x526c42[_0x34799d(0x165)]=_0x2bff1c,_0x526c42;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x3076df(0x160);function _0xd62a(_0x22a285,_0x74acd3){const _0x1be118=_0x1be1();return _0xd62a=function(_0xd62a68,_0x1d76ee){_0xd62a68=_0xd62a68-0x11e;let _0x3d1be5=_0x1be118[_0xd62a68];return _0x3d1be5;},_0xd62a(_0x22a285,_0x74acd3);}if(!h337__namespace[_0x3076df(0x13a)])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace[_0x3076df(0x163)],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x3076df(0x146),0.6:_0x3076df(0x168),0.8:_0x3076df(0x16f),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x277956={}){const _0x50c2ca={_0x3f0592:0x14c,_0x82d6eb:0x16b,_0x5285d5:0x14c,_0xcf3d5f:0x13b,_0x4ce8c5:0x143},_0x3e6028=_0x3076df;super(_0x277956),this[_0x3e6028(_0x50c2ca._0x3f0592)]['maxCanvasSize']=this['options']['maxCanvasSize']??document[_0x3e6028(_0x50c2ca._0x82d6eb)]['clientWidth'],this['options']['maxCanvasSize']=Math['min'](this['options']['maxCanvasSize'],0x1388),this[_0x3e6028(0x14c)]['minCanvasSize']=this['options']['minCanvasSize']??document['body']['clientHeight'],this['options']['minCanvasSize']=Math[_0x3e6028(0x157)](this[_0x3e6028(_0x50c2ca._0x5285d5)][_0x3e6028(_0x50c2ca._0xcf3d5f)],0x2bc),this['options'][_0x3e6028(_0x50c2ca._0x4ce8c5)]={...DEF_HEATSTYLE,...this['options'][_0x3e6028(0x143)]},this[_0x3e6028(0x14c)]['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){const _0x4f88a0=_0x3076df;return this[_0x4f88a0(0x137)];}get['heatStyle'](){const _0x2ed99d=_0x3076df;return this['options'][_0x2ed99d(0x143)];}set['heatStyle'](_0x1ca17e){const _0x495eea={_0x35802a:0x143},_0x165afc=_0x3076df;this['options'][_0x165afc(0x143)]=mars3d__namespace[_0x165afc(0x154)]['merge'](this['options'][_0x165afc(_0x495eea._0x35802a)],_0x1ca17e),this['_heat']&&(this['_heat']['configure'](this[_0x165afc(0x14c)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){const _0xc52d51=_0x3076df;return this[_0xc52d51(0x14c)]['style'];}set[_0x3076df(0x120)](_0x519d58){const _0x15b592={_0xab215a:0x129,_0x2ce59d:0x120},_0x19f247=_0x3076df;this['options']['style']=mars3d__namespace['Util'][_0x19f247(_0x15b592._0xab215a)](this['options'][_0x19f247(_0x15b592._0x2ce59d)],_0x519d58);}get['positions'](){return this['_positions'];}set['positions'](_0x4aef56){const _0x60bb53=_0x3076df;this[_0x60bb53(0x13c)](_0x4aef56);}get[_0x3076df(0x159)](){const _0x19fc07=[];return this['points']['forEach'](_0x498676=>{_0x19fc07['push'](_0x498676['toArray']());}),_0x19fc07;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x2a9eb2,_0x15af29){const _0x27488={_0x1e423c:0x12e},_0x454e76=_0x3076df;_0x2a9eb2['positions']&&(this[_0x454e76(_0x27488._0x1e423c)]=_0x2a9eb2['positions']);}['_mountedHook'](){const _0x4e5a73=_0x3076df;this['style']['type']===_0x4e5a73(0x16a)?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':_0x4e5a73(0x164),'private':!![]}):this['_layer']=new mars3d__namespace[(_0x4e5a73(0x173))]['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x5efbfa={_0xe08248:0x126},_0x117715=_0x3076df;this[_0x117715(_0x5efbfa._0xe08248)]['addLayer'](this['_layer']),this['_container']=mars3d__namespace['DomUtil'][_0x117715(0x13a)]('div',_0x117715(0x130),this['_map']['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this[_0x117715(0x14c)][_0x117715(0x178)]&&this['flyToByAnimationEnd']();}[_0x3076df(0x153)](){const _0x4591e7={_0x4c3e69:0x166,_0x4815e6:0x12b},_0x392817=_0x3076df;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this[_0x392817(_0x4591e7._0x4c3e69)]),this[_0x392817(_0x4591e7._0x4815e6)](),this['_map']['removeLayer'](this['_layer']);}[_0x3076df(0x141)](_0x20d763,_0x196c35){const _0x171b66={_0xd03576:0x162,_0x528119:0x139},_0x488557=_0x3076df;this[_0x488557(_0x171b66._0xd03576)]=this[_0x488557(0x162)]||[],this['_positions'][_0x488557(_0x171b66._0x528119)](_0x20d763),this['_updatePositionsHook'](_0x196c35);}['setPositions'](_0x392606,_0x41919d){this['_positions']=_0x392606,this['_updatePositionsHook'](_0x41919d);}[_0x3076df(0x12b)](){const _0x38dfe6={_0x178b53:0x12d,_0x1f4d05:0x13f,_0x4965d9:0x137},_0x300422=_0x3076df;this['_graphic']&&(this['_layer'][_0x300422(_0x38dfe6._0x178b53)](this[_0x300422(_0x38dfe6._0x1f4d05)],!![]),delete this[_0x300422(0x13f)]),this['_graphic2']&&(this[_0x300422(_0x38dfe6._0x4965d9)]['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x34cbc9){const _0x158cb3={_0x516281:0x12e,_0x45c9d9:0x15e,_0x2a87d9:0x16d,_0xb73189:0x13f},_0x319b27=_0x3076df;if(!this['show']||!this[_0x319b27(0x126)]||!this[_0x319b27(_0x158cb3._0x516281)]||this['positions']['length']===0x0)return this;const _0x27ba7d=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer'][_0x319b27(0x151)]({'url':_0x27ba7d[_0x319b27(_0x158cb3._0x45c9d9)]('image/png'),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this['style']['arc']?this['_graphic']&&_0x34cbc9?(this['_graphic']['uniforms']['image']=_0x27ba7d,this['_graphic']['uniforms'][_0x319b27(_0x158cb3._0x2a87d9)]=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x27ba7d,this['_graphic2']['uniforms'][_0x319b27(_0x158cb3._0x2a87d9)]=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x27ba7d):this[_0x319b27(_0x158cb3._0xb73189)]&&_0x34cbc9?this['_graphic']['uniforms'][_0x319b27(0x16a)]=_0x27ba7d:this['_createGraphic'](_0x27ba7d);return this;}['_createGraphic'](_0x1e0147){const _0x10727d={_0x521c04:0x179,_0x5e5575:0x145,_0x3e2c68:0x172},_0x5426a6=_0x3076df;this['clear'](),this['_graphic']=new mars3d__namespace[(_0x5426a6(_0x10727d._0x521c04))]['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x5426a6(_0x10727d._0x5e5575))]({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1e0147},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x5426a6(0x137)][_0x5426a6(_0x10727d._0x3e2c68)](this['_graphic']);}['_createArcGraphic'](_0x1f5a64){const _0x37d48f={_0x2966e6:0x125,_0x1553e9:0x16e,_0x2df0a7:0x14d,_0x2b6d31:0x11e,_0x5d07a4:0x14d,_0x4c10d5:0x12f,_0x5ba78a:0x120},_0x37b4c5=_0x3076df;this['clear']();const _0x2d57b2=Cesium['RenderState'][_0x37b4c5(0x144)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction'][_0x37b4c5(_0x37d48f._0x2966e6)],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x37b4c5(_0x37d48f._0x1553e9)][_0x37b4c5(_0x37d48f._0x2df0a7)],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium[_0x37b4c5(_0x37d48f._0x2b6d31)]['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x37b4c5(_0x37d48f._0x5d07a4)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x37b4c5(0x170)][_0x37b4c5(_0x37d48f._0x4c10d5)]}),_0x35aa74=Math['floor'](this[_0x37b4c5(_0x37d48f._0x5ba78a)][_0x37b4c5(0x15b)]??this['_mBoundsMax']*0.02)+0.1;this[_0x37b4c5(0x120)]['diffHeight']&&delete this[_0x37b4c5(0x120)]['diffHeight'];const _0x502a0f=(this['style']['splitNum'],0x64);let _0x3f68ca=Math['max'](this[_0x37b4c5(0x13e)]['height'],this['_rectangle']['width']);this['style'][_0x37b4c5(0x15d)]=_0x3f68ca/=_0x502a0f;const _0x8cbe4e=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1f5a64,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x37b4c5(0x14f))](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x5f49f6=this[_0x37b4c5(0x120)][_0x37b4c5(0x176)]||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x2d57b2,'material':_0x8cbe4e,'vertexShaderSource':getVertexShaderSource(_0x35aa74*_0x5f49f6)})}),this['_layer'][_0x37b4c5(0x172)](this['_graphic']),this['style'][_0x37b4c5(0x176)]===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x2d57b2,'material':_0x8cbe4e,'vertexShaderSource':getVertexShaderSource(-_0x35aa74)})}),this['_layer']['addGraphic'](this['_graphic2']));}['getRectangle'](_0x368262){const _0x1f970b={_0xfa02fe:0x128,_0x38746b:0x150},_0x2fed81=_0x3076df;return _0x368262!==null&&_0x368262!==void 0x0&&_0x368262[_0x2fed81(_0x1f970b._0xfa02fe)]&&this['_rectangle']?mars3d__namespace['PolyUtil'][_0x2fed81(_0x1f970b._0x38746b)](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x16efb9={_0x2a8dd5:0x121,_0xb141ab:0x167,_0x435779:0x13d,_0x6d0742:0x14c,_0x5616e3:0x13b,_0x5c27e6:0x15a,_0x4afb60:0x121,_0x3fabcd:0x169,_0x5792bf:0x174,_0xbb5033:0x171,_0x2058af:0x136,_0x3f69f7:0x166,_0x569d11:0x142},_0x50ad0e={_0x5ececb:0x16c,_0x5d3fa1:0x147,_0x5bdb5b:0x167},_0x2e788b={_0x11eefb:0x147,_0x59cef7:0x174},_0x28dac0=_0x3076df,_0xdb45f4=this['_positions'],_0x36fc78=[];let _0x2ad583,_0x267fe2,_0x40c1cc,_0x4b9a69;_0xdb45f4['forEach'](_0x1d0dea=>{const _0x112519=_0xd62a,_0x477564=mars3d__namespace['LngLatPoint'][_0x112519(0x148)](_0x1d0dea);if(!_0x477564)return;_0x477564['value']=_0x1d0dea[_0x112519(0x169)]||0x1,!this['options']['rectangle']&&(_0x2ad583===undefined?(_0x2ad583=_0x477564['lng'],_0x267fe2=_0x477564[_0x112519(_0x2e788b._0x11eefb)],_0x40c1cc=_0x477564[_0x112519(0x152)],_0x4b9a69=_0x477564['lat']):(_0x2ad583=Math['min'](_0x2ad583,_0x477564[_0x112519(_0x2e788b._0x11eefb)]),_0x267fe2=Math['max'](_0x267fe2,_0x477564['lng']),_0x40c1cc=Math[_0x112519(_0x2e788b._0x59cef7)](_0x40c1cc,_0x477564['lat']),_0x4b9a69=Math['max'](_0x4b9a69,_0x477564['lat']))),_0x36fc78['push'](_0x477564);});_0x2ad583===_0x267fe2&&(_0x2ad583-=0.000001,_0x267fe2+=0.000001);_0x40c1cc===_0x4b9a69&&(_0x40c1cc-=0.000001,_0x4b9a69+=0.000001);let _0x19cb3b=this['options']['rectangle']||{'xmin':_0x2ad583,'xmax':_0x267fe2,'ymin':_0x40c1cc,'ymax':_0x4b9a69};const _0x1cf5b3=getMercatorBounds(_0x19cb3b),_0x51d1cb=Math['abs'](_0x1cf5b3[_0x28dac0(_0x16efb9._0x2a8dd5)]-_0x1cf5b3[_0x28dac0(_0x16efb9._0xb141ab)]),_0x57e3d6=Math['abs'](_0x1cf5b3[_0x28dac0(0x177)]-_0x1cf5b3['ymin']),_0x48f0e0=Math['max'](_0x51d1cb,_0x57e3d6),_0x412bd4=Math['min'](_0x51d1cb,_0x57e3d6);this[_0x28dac0(0x14b)]=_0x48f0e0;let _0x21dedc=0x1;if(_0x48f0e0>this['options'][_0x28dac0(_0x16efb9._0x435779)])_0x21dedc=_0x48f0e0/this['options']['maxCanvasSize'],_0x412bd4/_0x21dedc<this[_0x28dac0(_0x16efb9._0x6d0742)]['minCanvasSize']&&(_0x21dedc=_0x412bd4/this[_0x28dac0(0x14c)]['minCanvasSize']);else _0x412bd4<this[_0x28dac0(0x14c)]['minCanvasSize']&&(_0x21dedc=_0x412bd4/this['options'][_0x28dac0(_0x16efb9._0x5616e3)],_0x48f0e0/_0x21dedc>this[_0x28dac0(_0x16efb9._0x6d0742)]['maxCanvasSize']&&(_0x21dedc=_0x48f0e0/this['options']['maxCanvasSize']));const _0x2a268e=this['heatStyle'][_0x28dac0(_0x16efb9._0x5c27e6)]*1.5,_0x4e139f=_0x51d1cb/_0x21dedc+_0x2a268e*0x2,_0x107e63=_0x57e3d6/_0x21dedc+_0x2a268e*0x2,_0x2dec6d=_0x2a268e*_0x21dedc;_0x1cf5b3[_0x28dac0(_0x16efb9._0xb141ab)]-=_0x2dec6d,_0x1cf5b3[_0x28dac0(0x136)]-=_0x2dec6d,_0x1cf5b3[_0x28dac0(_0x16efb9._0x4afb60)]+=_0x2dec6d,_0x1cf5b3['ymax']+=_0x2dec6d,this[_0x28dac0(0x12c)]=_0x21dedc,_0x19cb3b=geLatLngBounds(_0x1cf5b3),this[_0x28dac0(0x13e)]=Cesium['Rectangle']['fromDegrees'](_0x19cb3b[_0x28dac0(0x167)],_0x19cb3b['ymin'],_0x19cb3b[_0x28dac0(_0x16efb9._0x4afb60)],_0x19cb3b['ymax']);let _0x5bf090=_0x36fc78[0x0][_0x28dac0(_0x16efb9._0x3fabcd)]??0x1,_0x4899b6=_0x36fc78[0x0]['value']??0x0;const _0x50b23e=[];_0x36fc78['forEach'](_0x34f412=>{const _0xe6837=_0x28dac0,_0x2bf5a1=mars3d__namespace['PointTrans'][_0xe6837(_0x50ad0e._0x5ececb)]([_0x34f412[_0xe6837(_0x50ad0e._0x5d3fa1)],_0x34f412['lat']]),_0x49bc9e=_0x34f412['value']||0x1,_0x5eec56=Math['round']((_0x2bf5a1[0x0]-_0x1cf5b3[_0xe6837(_0x50ad0e._0x5bdb5b)])/_0x21dedc),_0x32d790=Math['round']((_0x1cf5b3[_0xe6837(0x177)]-_0x2bf5a1[0x1])/_0x21dedc);_0x5bf090=Math['max'](_0x5bf090,_0x49bc9e),_0x4899b6=Math['min'](_0x4899b6,_0x49bc9e),_0x50b23e['push']({'x':_0x5eec56,'y':_0x32d790,'value':_0x49bc9e});});const _0x1aa465={'min':this['options'][_0x28dac0(_0x16efb9._0x5792bf)]??_0x4899b6,'max':this['options'][_0x28dac0(0x157)]??_0x5bf090,'data':_0x50b23e};this['_last_heatData']=_0x1aa465;if(!this['_last_mBounds']||_0x1cf5b3[_0x28dac0(0x167)]!==this[_0x28dac0(_0x16efb9._0xbb5033)]['xmin']||_0x1cf5b3[_0x28dac0(_0x16efb9._0x2058af)]!==this['_last_mBounds']['ymin']||_0x1cf5b3['xmax']!==this['_last_mBounds'][_0x28dac0(0x121)]||_0x1cf5b3['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x1cf5b3,this[_0x28dac0(_0x16efb9._0x3f69f7)]['style']['cssText']='width:'+_0x4e139f+'px;height:'+_0x107e63+'px;';const _0x2b2d69={...this['heatStyle'],'container':this['_container']};!this[_0x28dac0(0x133)]?this[_0x28dac0(0x133)]=h337__namespace['create'](_0x2b2d69):this[_0x28dac0(0x133)]['configure'](_0x2b2d69);}this['_heat']['setData'](_0x1aa465);const _0x26d7c2=mars3d__namespace[_0x28dac0(_0x16efb9._0x569d11)]['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x26d7c2;}['_getArcHeatCanvas'](){const _0x5b6c98={_0x213155:0x143},_0x2bf560=_0x3076df;this[_0x2bf560(0x133)]['configure']({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x4557b4=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this['options'][_0x2bf560(_0x5b6c98._0x213155)]),_0x4557b4;}['getPointData'](_0x55b860){const _0x293c92={_0x4c5ece:0x167},_0x5ec429=_0x3076df,_0xe947f8=mars3d__namespace['LngLatPoint'][_0x5ec429(0x148)](_0x55b860);if(!_0xe947f8)return{};const _0x324199=mars3d__namespace['PointTrans'][_0x5ec429(0x16c)]([_0xe947f8['lng'],_0xe947f8['lat']]),_0x473aeb=this['_last_mBounds'],_0x3c7cca=Math['round']((_0x324199[0x0]-_0x473aeb[_0x5ec429(_0x293c92._0x4c5ece)])/this['_scale']),_0x34fc4b=Math['round']((_0x473aeb['ymax']-_0x324199[0x1])/this['_scale']),_0x236e84=this[_0x5ec429(0x133)][_0x5ec429(0x11f)]({'x':_0x3c7cca,'y':_0x34fc4b}),_0x1109fc=this['_heat']['_renderer'][_0x5ec429(0x123)]['getImageData'](_0x3c7cca-0x1,_0x34fc4b-0x1,0x1,0x1)['data'];return{'x':_0x3c7cca,'y':_0x34fc4b,'value':_0x236e84,'color':'rgba('+_0x1109fc[0x0]+','+_0x1109fc[0x1]+','+_0x1109fc[0x2]+','+_0x1109fc[0x3]+')'};}}mars3d__namespace[_0x3076df(0x161)]['register']('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function _0x1be1(){const _0x304184=['_layer','keys','push','create','minCanvasSize','setPositions','maxCanvasSize','_rectangle','_graphic','PointTrans','addPosition','DomUtil','heatStyle','fromCache','EllipsoidSurfaceAppearance','blue','lng','parse','mercator2lonlat','defineProperty','_mBoundsMax','options','KEEP','17626AyZsNQ','Color','formatRectangle','setOptions','lat','_removedHook','Util','1002632pYAQvC','115417yRVnRS','max','37524BFtpyS','coordinates','radius','diffHeight','HeatLayer','granularity','toDataURL','5mMcgQo','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','LayerUtil','_positions','Cesium','EPSG:3857','default','_container','xmin','green','value','image','body','lonlat2mercator','bumpMap','StencilOperation','yellow','BlendingState','_last_mBounds','addGraphic','layer','min','get','arcDirection','ymax','flyTo','graphic','StencilFunction','getValueAt','style','xmax','9vExQcO','ctx','getOwnPropertyDescriptor','ALWAYS','_map','308xdHJjE','isFormat','merge','956220VWnHOJ','clear','_scale','removeGraphic','positions','ALPHA_BLEND','mars3d-heatmap\x20mars3d-hideDiv','66490DxIZUz','186qhEync','_heat','__esModule','316316FMtljm','ymin'];_0x1be1=function(){return _0x304184;};return _0x1be1();}function getMercatorBounds(_0x388540){const _0x15d421={_0x42d1cf:0x140,_0x1355c3:0x16c,_0xb09699:0x167,_0x29ef15:0x136},_0x12c5f3=_0x3076df,_0x29b2d9=mars3d__namespace[_0x12c5f3(_0x15d421._0x42d1cf)][_0x12c5f3(_0x15d421._0x1355c3)]([_0x388540[_0x12c5f3(_0x15d421._0xb09699)],_0x388540[_0x12c5f3(_0x15d421._0x29ef15)]]),_0x49d24a=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x388540['xmax'],_0x388540['ymax']]);return{'xmin':_0x29b2d9[0x0],'ymin':_0x29b2d9[0x1],'xmax':_0x49d24a[0x0],'ymax':_0x49d24a[0x1]};}function geLatLngBounds(_0x1b8707){const _0x5b80db={_0x469dcc:0x136},_0x27c99f=_0x3076df,_0x38d9fa=mars3d__namespace['PointTrans'][_0x27c99f(0x149)]([_0x1b8707[_0x27c99f(0x167)],_0x1b8707[_0x27c99f(_0x5b80db._0x469dcc)]]),_0x206144=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x1b8707['xmax'],_0x1b8707['ymax']]);return{'xmin':_0x38d9fa[0x0],'ymin':_0x38d9fa[0x1],'xmax':_0x206144[0x0],'ymax':_0x206144[0x1]};}function getVertexShaderSource(_0x2d4c3b){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x2d4c3b+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports[_0x3076df(0x15c)]=HeatLayer,Object['defineProperty'](exports,_0x3076df(0x134),{'value':!![]});
}));
