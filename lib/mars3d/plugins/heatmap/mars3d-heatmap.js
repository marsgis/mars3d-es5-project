/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.4
 * 编译日期：2023-04-24 10:59:35
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';var _0x3dbca5=_0x3675;(function(_0xb6b645,_0x2a4ead){var _0x4343d3={_0x399ff1:0xc7,_0x2f94e3:0x119,_0x554069:0xfc,_0x56221f:0xf2,_0x4a26e2:0xe4,_0x22e7f2:0xf6,_0x11c4b5:0x106},_0x1f4d8a=_0x3675,_0x924f8c=_0xb6b645();while(!![]){try{var _0x1cb779=-parseInt(_0x1f4d8a(_0x4343d3._0x399ff1))/0x1+parseInt(_0x1f4d8a(_0x4343d3._0x2f94e3))/0x2*(parseInt(_0x1f4d8a(_0x4343d3._0x554069))/0x3)+parseInt(_0x1f4d8a(0x114))/0x4*(parseInt(_0x1f4d8a(0xde))/0x5)+parseInt(_0x1f4d8a(_0x4343d3._0x56221f))/0x6+parseInt(_0x1f4d8a(_0x4343d3._0x4a26e2))/0x7+-parseInt(_0x1f4d8a(_0x4343d3._0x22e7f2))/0x8*(-parseInt(_0x1f4d8a(0xb7))/0x9)+-parseInt(_0x1f4d8a(_0x4343d3._0x11c4b5))/0xa*(parseInt(_0x1f4d8a(0x110))/0xb);if(_0x1cb779===_0x2a4ead)break;else _0x924f8c['push'](_0x924f8c['shift']());}catch(_0x5010f0){_0x924f8c['push'](_0x924f8c['shift']());}}}(_0x19ee,0x2ba26));function _interopNamespace(_0x7d8987){var _0x112b70={_0x43d764:0x111,_0x3f6935:0xcf},_0x34e7da={_0x3f4251:0xf8},_0x404326=_0x3675;if(_0x7d8987&&_0x7d8987[_0x404326(_0x112b70._0x43d764)])return _0x7d8987;var _0x59743b=Object['create'](null);return _0x7d8987&&Object[_0x404326(0x126)](_0x7d8987)['forEach'](function(_0x26b2cc){var _0x29ded5=_0x404326;if(_0x26b2cc!==_0x29ded5(0xcf)){var _0xd0a888=Object['getOwnPropertyDescriptor'](_0x7d8987,_0x26b2cc);Object['defineProperty'](_0x59743b,_0x26b2cc,_0xd0a888[_0x29ded5(_0x34e7da._0x3f4251)]?_0xd0a888:{'enumerable':!![],'get':function(){return _0x7d8987[_0x26b2cc];}});}}),_0x59743b[_0x404326(_0x112b70._0x3f6935)]=_0x7d8987,_0x59743b;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337);function ownKeys(_0x3b5dce,_0x57b015){var _0x4e7dcf={_0x341bb9:0x11b,_0x4f9cd6:0x121},_0x18ce09={_0x5b071f:0xb3},_0x5a981f=_0x3675,_0x1494d1=Object['keys'](_0x3b5dce);if(Object[_0x5a981f(_0x4e7dcf._0x341bb9)]){var _0x3f2eaa=Object[_0x5a981f(_0x4e7dcf._0x341bb9)](_0x3b5dce);_0x57b015&&(_0x3f2eaa=_0x3f2eaa[_0x5a981f(_0x4e7dcf._0x4f9cd6)](function(_0x469a75){var _0x27435e=_0x5a981f;return Object[_0x27435e(_0x18ce09._0x5b071f)](_0x3b5dce,_0x469a75)['enumerable'];})),_0x1494d1['push']['apply'](_0x1494d1,_0x3f2eaa);}return _0x1494d1;}function _objectSpread2(_0x5bff64){var _0x2b337b={_0x700044:0x104,_0x2f49e3:0xe7},_0x475518=_0x3675;for(var _0x5a81f5=0x1;_0x5a81f5<arguments['length'];_0x5a81f5++){var _0x426c20=null!=arguments[_0x5a81f5]?arguments[_0x5a81f5]:{};_0x5a81f5%0x2?ownKeys(Object(_0x426c20),!0x0)[_0x475518(_0x2b337b._0x700044)](function(_0xf5c30b){_defineProperty(_0x5bff64,_0xf5c30b,_0x426c20[_0xf5c30b]);}):Object['getOwnPropertyDescriptors']?Object['defineProperties'](_0x5bff64,Object[_0x475518(_0x2b337b._0x2f49e3)](_0x426c20)):ownKeys(Object(_0x426c20))['forEach'](function(_0x182e61){var _0x3cc813=_0x475518;Object[_0x3cc813(0xd4)](_0x5bff64,_0x182e61,Object['getOwnPropertyDescriptor'](_0x426c20,_0x182e61));});}return _0x5bff64;}function _classCallCheck(_0x55d69c,_0x50b1dd){if(!(_0x55d69c instanceof _0x50b1dd))throw new TypeError('Cannot\x20call\x20a\x20class\x20as\x20a\x20function');}function _0x19ee(){var _0x1db0ef=['_map','filter','xmin','type','ymin','_last_mBounds','keys','StencilFunction','_scale','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','clientWidth','undefined','heatStyle','getOwnPropertyDescriptor','granularity','value','yellow','437652TrnehE','rgb(216,216,216)','getValueAt','width:','cssText','width','blue','blur','_graphic2','_rectangle','points','_graphic','coordinates','ImageLayer','px;height:','positions','263707hHrdUx','rectangle','setPositions','body',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','_layer','prototype','length','default','RectanglePrimitive','merge','container','uniforms','defineProperty','Rectangle','mercator2lonlat','getPrototypeOf','fromDegrees','round','lonlat2mercator','px;','REPLACE','Material','135eqwxcb','EllipsoidSurfaceAppearance','bumpMap','addLayer','copyCanvas','_heat','1428224fybvIP','concat','diffHeight','getOwnPropertyDescriptors','Util','ALPHA_BLEND','rgb(140,140,140)','function','image/png','_getArcHeatCanvas','getImageData','toArray','enumerable','object','1242276iFNsxB','flyToByAnimationEnd','xmax','StencilOperation','32Uuhbli','_createArcGraphic','get','__proto__','layer','construct','30ZlNGoM','_getHeatCanvas','abs','removeGraphic','call','maxCanvasSize','sham','_updatePositionsHook','forEach','KEEP','560CdFcUC','minCanvasSize','max','push','lng','_positions','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','lat','writable','LngLatPoint','95161aYcmIc','__esModule','graphic','options','948HfycvD','gradientArc','PointTrans','ymax','create','62980cOwlkr','addGraphic','getOwnPropertySymbols','Color','image','style','key'];_0x19ee=function(){return _0x1db0ef;};return _0x19ee();}function _defineProperties(_0x2efeb0,_0x42a303){var _0x351dd3={_0x573625:0xf0,_0x3c6874:0x10e,_0x32286a:0x11f},_0x40475d=_0x3675;for(var _0xefd680=0x0;_0xefd680<_0x42a303['length'];_0xefd680++){var _0x18533d=_0x42a303[_0xefd680];_0x18533d[_0x40475d(_0x351dd3._0x573625)]=_0x18533d['enumerable']||![],_0x18533d['configurable']=!![];if(_0x40475d(0xb5)in _0x18533d)_0x18533d[_0x40475d(_0x351dd3._0x3c6874)]=!![];Object['defineProperty'](_0x2efeb0,_0x18533d[_0x40475d(_0x351dd3._0x32286a)],_0x18533d);}}function _createClass(_0x10d338,_0x26ee2b,_0x4e0836){var _0xa3a410={_0x2872c0:0xd4},_0x450bb1=_0x3675;if(_0x26ee2b)_defineProperties(_0x10d338['prototype'],_0x26ee2b);if(_0x4e0836)_defineProperties(_0x10d338,_0x4e0836);return Object[_0x450bb1(_0xa3a410._0x2872c0)](_0x10d338,_0x450bb1(0xcd),{'writable':![]}),_0x10d338;}function _defineProperty(_0x178cc3,_0x1e8957,_0x2838e8){return _0x1e8957 in _0x178cc3?Object['defineProperty'](_0x178cc3,_0x1e8957,{'value':_0x2838e8,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x178cc3[_0x1e8957]=_0x2838e8,_0x178cc3;}function _inherits(_0x237cc0,_0x447c03){var _0x31db44={_0x1590f8:0xeb,_0x1f69f0:0xd4},_0x37535d=_0x3675;if(typeof _0x447c03!==_0x37535d(_0x31db44._0x1590f8)&&_0x447c03!==null)throw new TypeError('Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function');_0x237cc0['prototype']=Object[_0x37535d(0x118)](_0x447c03&&_0x447c03['prototype'],{'constructor':{'value':_0x237cc0,'writable':!![],'configurable':!![]}}),Object[_0x37535d(_0x31db44._0x1f69f0)](_0x237cc0,'prototype',{'writable':![]});if(_0x447c03)_setPrototypeOf(_0x237cc0,_0x447c03);}function _getPrototypeOf(_0x26f176){var _0x570bbe={_0x3b35d0:0xd7};return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf']:function _0x559401(_0x575871){var _0x16e020=_0x3675;return _0x575871[_0x16e020(0xf9)]||Object[_0x16e020(_0x570bbe._0x3b35d0)](_0x575871);},_getPrototypeOf(_0x26f176);}function _setPrototypeOf(_0x1ffc62,_0x25eb8f){return _setPrototypeOf=Object['setPrototypeOf']||function _0x37569e(_0x4b2ff2,_0x49f12c){return _0x4b2ff2['__proto__']=_0x49f12c,_0x4b2ff2;},_setPrototypeOf(_0x1ffc62,_0x25eb8f);}function _isNativeReflectConstruct(){var _0x381ff4={_0x16a8cc:0xb1,_0x1c4994:0xfb},_0xe11cac=_0x3675;if(typeof Reflect===_0xe11cac(_0x381ff4._0x16a8cc)||!Reflect[_0xe11cac(0xfb)])return![];if(Reflect['construct'][_0xe11cac(0x102)])return![];if(typeof Proxy==='function')return!![];try{return Boolean['prototype']['valueOf'][_0xe11cac(0x100)](Reflect[_0xe11cac(_0x381ff4._0x1c4994)](Boolean,[],function(){})),!![];}catch(_0x4d957e){return![];}}function _assertThisInitialized(_0x383966){if(_0x383966===void 0x0)throw new ReferenceError('this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called');return _0x383966;}function _possibleConstructorReturn(_0x4ee9ce,_0x94abf7){var _0x282b7d=_0x3675;if(_0x94abf7&&(typeof _0x94abf7===_0x282b7d(0xf1)||typeof _0x94abf7==='function'))return _0x94abf7;else{if(_0x94abf7!==void 0x0)throw new TypeError('Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined');}return _assertThisInitialized(_0x4ee9ce);}function _createSuper(_0x4e3fe1){var _0x24421b=_isNativeReflectConstruct();return function _0x32d591(){var _0x5b88df=_getPrototypeOf(_0x4e3fe1),_0x2fe518;if(_0x24421b){var _0x448814=_getPrototypeOf(this)['constructor'];_0x2fe518=Reflect['construct'](_0x5b88df,arguments,_0x448814);}else _0x2fe518=_0x5b88df['apply'](this,arguments);return _possibleConstructorReturn(this,_0x2fe518);};}var HeatMaterial=_0x3dbca5(0x129);if(!h337__namespace[_0x3dbca5(0x118)])throw new Error('请引入\x20heatmap.js\x20库\x20');var Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x3dbca5(0xbd),0.6:'green',0.8:_0x3dbca5(0xb6),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']},HeatLayer=function(_0xbf248){var _0x26bd49={_0x2ff429:0xc8,_0x4a1164:0xfd,_0x59af91:0xed},_0x2042dc={_0x333dcc:0x128,_0x180283:0xb9,_0x15a1c2:0xe3,_0x5ea494:0xee},_0x5ac8e4={_0x485a4b:0xe3,_0x37befa:0xbe,_0x180e66:0x115,_0x3bdda0:0xea,_0x506703:0xe2,_0x52a797:0xb2},_0x58f348={_0x329a7d:0xc8,_0x4cf24c:0x113,_0x3b1784:0x101,_0x519611:0x107,_0x39c2b9:0x113,_0x4553c2:0x107,_0x37f13a:0x122,_0x1d922e:0x128,_0x357dbf:0xb5,_0x33fe25:0x113,_0x2664c3:0x125,_0x570bde:0xf4,_0x3364d0:0xd2,_0x5458e0:0x11e},_0x4e35f3={_0x25696d:0x10a},_0x4f7eb7={_0x33f9e4:0xc0},_0x2682e8={_0x174734:0x127,_0x1ab554:0xf5,_0x412c48:0x105,_0x55dbed:0xe6,_0x3490e9:0x11e,_0x34f3cc:0xbc,_0x4f59f8:0xb4,_0xee1947:0xc0},_0x1a1e1e={_0x50b12c:0xc2,_0x3cf20d:0x113,_0x119de0:0xdf,_0x5d7a39:0x11a},_0x280b6={_0x56c68a:0xc6,_0x34959:0xec,_0x34c0cf:0xc2,_0x1ad0f6:0x11d,_0x39fda3:0xd3,_0x426316:0xe0},_0x2002a1={_0x77e5c4:0xbf,_0x3f5da0:0xcc},_0x4f1a74={_0x2a5535:0x10b},_0x4a1333={_0x13cbf4:0x10b,_0x5e0ae1:0x103},_0x46b935={_0x5c5c95:0xb2,_0x400da9:0xd2,_0x5af13f:0xcc},_0x5a6157={_0x177cc1:0xc6,_0x498858:0xf3},_0x4ad61a={_0x28807a:0xc4,_0x9f9e6f:0xcc},_0x1266ff={_0x509561:0xc6},_0x59a4ea={_0x17a3f8:0xc9},_0x456ce1={_0x4bf9a2:0x11e,_0x516973:0xd1},_0x27ab08={_0x99a391:0x113},_0x5776a={_0x2da10b:0x113},_0x41edf2={_0x5ee669:0x100,_0x1bc2b5:0x113,_0x1b77e2:0x108},_0x2803ed=_0x3dbca5;_inherits(_0x36e16f,_0xbf248);var _0x212cda=_createSuper(_0x36e16f);function _0x36e16f(){var _0x5c0fc3=_0x3675,_0x91eca5,_0x3abe63,_0xb9c806,_0x1c261e=arguments[_0x5c0fc3(0xce)]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x36e16f),_0xb9c806=_0x212cda[_0x5c0fc3(_0x41edf2._0x5ee669)](this,_0x1c261e),_0xb9c806[_0x5c0fc3(_0x41edf2._0x1bc2b5)]['maxCanvasSize']=(_0x91eca5=_0xb9c806['options']['maxCanvasSize'])!==null&&_0x91eca5!==void 0x0?_0x91eca5:document[_0x5c0fc3(0xca)][_0x5c0fc3(0x12a)],_0xb9c806[_0x5c0fc3(0x113)]['maxCanvasSize']=Math['min'](_0xb9c806[_0x5c0fc3(_0x41edf2._0x1bc2b5)]['maxCanvasSize'],0x1388),_0xb9c806['options'][_0x5c0fc3(0x107)]=(_0x3abe63=_0xb9c806['options']['minCanvasSize'])!==null&&_0x3abe63!==void 0x0?_0x3abe63:document['body']['clientHeight'],_0xb9c806[_0x5c0fc3(0x113)]['minCanvasSize']=Math[_0x5c0fc3(_0x41edf2._0x1b77e2)](_0xb9c806['options']['minCanvasSize'],0x2bc),_0xb9c806['options']['heatStyle']=_objectSpread2(_objectSpread2({},DEF_HEATSTYLE),_0xb9c806['options']['heatStyle']||{}),_0xb9c806[_0x5c0fc3(0x113)]['style']=_objectSpread2(_objectSpread2({},DEF_STYLE),_0xb9c806['options']['style']||{}),_0xb9c806;}return _createClass(_0x36e16f,[{'key':_0x2803ed(0xfa),'get':function _0x387d19(){var _0x433d15=_0x2803ed;return this[_0x433d15(0xcc)];}},{'key':'heatStyle','get':function _0x443de9(){return this['options']['heatStyle'];},'set':function _0x26f2c6(_0x54b779){var _0x334a77=_0x2803ed;this[_0x334a77(_0x5776a._0x2da10b)]['heatStyle']=mars3d__namespace[_0x334a77(0xe8)]['merge'](this['options']['heatStyle'],_0x54b779),this['_heat']&&(this['_heat']['configure'](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}},{'key':_0x2803ed(0x11e),'get':function _0x338019(){var _0x354cb3=_0x2803ed;return this[_0x354cb3(_0x27ab08._0x99a391)][_0x354cb3(0x11e)];},'set':function _0x2734dc(_0x27924c){var _0x5e0061=_0x2803ed;this['options'][_0x5e0061(_0x456ce1._0x4bf9a2)]=mars3d__namespace['Util'][_0x5e0061(_0x456ce1._0x516973)](this['options'][_0x5e0061(0x11e)],_0x27924c);}},{'key':'positions','get':function _0xcce76b(){return this['_positions'];},'set':function _0x285df0(_0x3687ff){var _0x2a64c2=_0x2803ed;this[_0x2a64c2(_0x59a4ea._0x17a3f8)](_0x3687ff);}},{'key':_0x2803ed(0xc3),'get':function _0x5b6578(){var _0x550fdb={_0x59cab8:0x109},_0x3cb27c=_0x2803ed,_0x11aa58=[];return this[_0x3cb27c(0xc1)][_0x3cb27c(0x104)](function(_0x2208d5){var _0x12a8bd=_0x3cb27c;_0x11aa58[_0x12a8bd(_0x550fdb._0x59cab8)](_0x2208d5[_0x12a8bd(0xef)]());}),_0x11aa58;}},{'key':_0x2803ed(_0x26bd49._0x2ff429),'get':function _0x4b2bef(){return this['_rectangle'];}},{'key':'_setOptionsHook','value':function _0x2949a6(_0x10793b,_0x2c4396){var _0x25f71a=_0x2803ed;_0x10793b[_0x25f71a(_0x1266ff._0x509561)]&&(this['positions']=_0x10793b['positions']);}},{'key':'_mountedHook','value':function _0x37186b(){var _0x6d4e0f=_0x2803ed;this['style'][_0x6d4e0f(0x123)]==='image'?this['_layer']=new mars3d__namespace['layer'][(_0x6d4e0f(_0x4ad61a._0x28807a))]({'crs':'EPSG:3857','private':!![]}):this[_0x6d4e0f(_0x4ad61a._0x9f9e6f)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}},{'key':'_addedHook','value':function _0x50c8c4(){var _0x1ca96e=_0x2803ed;this['_map'][_0x1ca96e(0xe1)](this['_layer']),this['options'][_0x1ca96e(0xc6)]&&(this[_0x1ca96e(_0x5a6157._0x177cc1)]=this['options'][_0x1ca96e(0xc6)]),this['options']['flyTo']&&this[_0x1ca96e(_0x5a6157._0x498858)]();}},{'key':'_removedHook','value':function _0x22e6bb(){var _0x2d33b9=_0x2803ed;this[_0x2d33b9(_0x46b935._0x5c5c95)]['container']&&(mars3d__namespace['DomUtil']['remove'](this[_0x2d33b9(_0x46b935._0x5c5c95)]['container']),delete this['heatStyle'][_0x2d33b9(_0x46b935._0x400da9)]),this['clear'](),this['_map']['removeLayer'](this[_0x2d33b9(_0x46b935._0x5af13f)]);}},{'key':'addPosition','value':function _0x19c1eb(_0x2aa89e,_0x11ca4b){var _0x5b246c=_0x2803ed;this[_0x5b246c(_0x4a1333._0x13cbf4)]=this['_positions']||[],this[_0x5b246c(_0x4a1333._0x13cbf4)]['push'](_0x2aa89e),this[_0x5b246c(_0x4a1333._0x5e0ae1)](_0x11ca4b);}},{'key':'setPositions','value':function _0x3a594d(_0x4e4ba8,_0x2476b5){var _0x4181d3=_0x2803ed;this[_0x4181d3(_0x4f1a74._0x2a5535)]=_0x4e4ba8,this['_updatePositionsHook'](_0x2476b5);}},{'key':'clear','value':function _0x7d4c9d(){var _0x1ef0fd=_0x2803ed;this['_graphic']&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this[_0x1ef0fd(_0x2002a1._0x77e5c4)]&&(this[_0x1ef0fd(_0x2002a1._0x3f5da0)][_0x1ef0fd(0xff)](this['_graphic2'],!![]),delete this[_0x1ef0fd(0xbf)]);}},{'key':'_updatePositionsHook','value':function _0x4f9c29(_0x128b42){var _0x139902=_0x2803ed;if(!this['show']||!this[_0x139902(0x120)]||!this[_0x139902(_0x280b6._0x56c68a)]||this[_0x139902(0xc6)][_0x139902(0xce)]===0x0)return this;var _0x4fc05f=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer']['setOptions']({'url':_0x4fc05f['toDataURL'](_0x139902(_0x280b6._0x34959)),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this['style']['arc']?this[_0x139902(_0x280b6._0x34c0cf)]&&_0x128b42?(this[_0x139902(_0x280b6._0x34c0cf)]['uniforms'][_0x139902(_0x280b6._0x1ad0f6)]=_0x4fc05f,this[_0x139902(0xc2)][_0x139902(_0x280b6._0x39fda3)][_0x139902(_0x280b6._0x426316)]=this['_getArcHeatCanvas'](),this['_graphic2']&&(this[_0x139902(0xbf)]['uniforms']['image']=_0x4fc05f,this[_0x139902(0xbf)]['uniforms'][_0x139902(_0x280b6._0x426316)]=this['_graphic'][_0x139902(_0x280b6._0x39fda3)]['bumpMap'])):this[_0x139902(0xf7)](_0x4fc05f):this['_graphic']&&_0x128b42?this['_graphic']['uniforms']['image']=_0x4fc05f:this['_createGraphic'](_0x4fc05f);return this;}},{'key':'_createGraphic','value':function _0x595453(_0x40ed4b){var _0x49afd8=_0x2803ed;this['clear'](),this[_0x49afd8(_0x1a1e1e._0x50b12c)]=new mars3d__namespace['graphic'][(_0x49afd8(0xd0))](_objectSpread2(_objectSpread2({},this[_0x49afd8(_0x1a1e1e._0x3cf20d)]),{},{'rectangle':this[_0x49afd8(0xc0)],'appearance':new Cesium[(_0x49afd8(_0x1a1e1e._0x119de0))]({'material':new Cesium[(_0x49afd8(0xdd))]({'fabric':{'uniforms':{'image':_0x40ed4b},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})})),this['_layer'][_0x49afd8(_0x1a1e1e._0x5d7a39)](this['_graphic']);}},{'key':'_createArcGraphic','value':function _0x12e2e6(_0x421bf7){var _0x153b23=_0x2803ed,_0x2216c8;this['clear']();var _0x2492dd=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x153b23(_0x2682e8._0x174734)]['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x153b23(0xdc)]},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x153b23(_0x2682e8._0x1ab554)][_0x153b23(_0x2682e8._0x412c48)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x153b23(0xe9)]}),_0x51fe05=Math['floor']((_0x2216c8=this['style']['diffHeight'])!==null&&_0x2216c8!==void 0x0?_0x2216c8:this['_mBoundsMax']*0.02)+0.1;this['style'][_0x153b23(_0x2682e8._0x55dbed)]&&delete this[_0x153b23(_0x2682e8._0x3490e9)]['diffHeight'];var _0x53ce82=(this['style']['splitNum'],0x64),_0x4d2d4e=Math['max'](this['_rectangle']['height'],this['_rectangle'][_0x153b23(_0x2682e8._0x34f3cc)]);this['style'][_0x153b23(_0x2682e8._0x4f59f8)]=_0x4d2d4e/=_0x53ce82;var _0x7ee3f7=new Cesium[(_0x153b23(0xdd))]({'fabric':{'uniforms':{'image':_0x421bf7,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x153b23(0x11c))](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x112ddb=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x153b23(0xd0))](_objectSpread2(_objectSpread2({},this['options']),{},{'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x2492dd,'material':_0x7ee3f7,'vertexShaderSource':getVertexShaderSource(_0x51fe05*_0x112ddb)})})),this['_layer']['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace[(_0x153b23(0x112))]['RectanglePrimitive'](_objectSpread2(_objectSpread2({},this['options']),{},{'rectangle':this[_0x153b23(_0x2682e8._0xee1947)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x2492dd,'material':_0x7ee3f7,'vertexShaderSource':getVertexShaderSource(-_0x51fe05)})})),this['_layer']['addGraphic'](this['_graphic2']));}},{'key':'getRectangle','value':function _0x1bd684(_0x1cf0e6){var _0x1b7ee3=_0x2803ed;return _0x1cf0e6!==null&&_0x1cf0e6!==void 0x0&&_0x1cf0e6['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this[_0x1b7ee3(_0x4f7eb7._0x33f9e4)];}},{'key':_0x2803ed(_0x26bd49._0x4a1164),'value':function _0x363a3f(){var _0x3ccd29={_0x4b4560:0xda,_0x49dcbe:0x10d,_0x40b246:0xd9},_0x1a3dae=_0x2803ed,_0x4663bf=this,_0xdec9b1,_0x447de1,_0x4d871e,_0x793619,_0x4b970d=this['_positions'],_0x1341d1=[],_0xeb90e5,_0x535de4,_0x4e8a69,_0x5db3bf;_0x4b970d['forEach'](function(_0x3d78f6){var _0x37cc02=_0x3675,_0xf46500=mars3d__namespace[_0x37cc02(0x10f)]['parse'](_0x3d78f6);if(!_0xf46500)return;_0xf46500['value']=_0x3d78f6['value']||0x1,!_0x4663bf['options']['rectangle']&&(_0xeb90e5===undefined?(_0xeb90e5=_0xf46500[_0x37cc02(_0x4e35f3._0x25696d)],_0x535de4=_0xf46500['lng'],_0x4e8a69=_0xf46500[_0x37cc02(0x10d)],_0x5db3bf=_0xf46500['lat']):(_0xeb90e5=Math['min'](_0xeb90e5,_0xf46500['lng']),_0x535de4=Math[_0x37cc02(0x108)](_0x535de4,_0xf46500['lng']),_0x4e8a69=Math['min'](_0x4e8a69,_0xf46500['lat']),_0x5db3bf=Math[_0x37cc02(0x108)](_0x5db3bf,_0xf46500[_0x37cc02(0x10d)]))),_0x1341d1['push'](_0xf46500);});var _0x45ab2e=this['options'][_0x1a3dae(_0x58f348._0x329a7d)]||{'xmin':_0xeb90e5,'xmax':_0x535de4,'ymin':_0x4e8a69,'ymax':_0x5db3bf},_0x346022=getMercatorBounds(_0x45ab2e),_0x2a445d=Math[_0x1a3dae(0xfe)](_0x346022['xmax']-_0x346022['xmin']),_0x440241=Math['abs'](_0x346022['ymax']-_0x346022['ymin']),_0x4bd42c=Math[_0x1a3dae(0x108)](_0x2a445d,_0x440241),_0x530ab9=Math['min'](_0x2a445d,_0x440241);this['_mBoundsMax']=_0x4bd42c;var _0xa3fa0b=0x1;if(_0x4bd42c>this[_0x1a3dae(_0x58f348._0x4cf24c)][_0x1a3dae(_0x58f348._0x3b1784)])_0xa3fa0b=_0x4bd42c/this[_0x1a3dae(0x113)]['maxCanvasSize'],_0x530ab9/_0xa3fa0b<this['options'][_0x1a3dae(_0x58f348._0x519611)]&&(_0xa3fa0b=_0x530ab9/this[_0x1a3dae(_0x58f348._0x39c2b9)][_0x1a3dae(0x107)]);else _0x530ab9<this[_0x1a3dae(_0x58f348._0x4cf24c)][_0x1a3dae(_0x58f348._0x4553c2)]&&(_0xa3fa0b=_0x530ab9/this[_0x1a3dae(_0x58f348._0x4cf24c)][_0x1a3dae(0x107)],_0x4bd42c/_0xa3fa0b>this[_0x1a3dae(_0x58f348._0x4cf24c)]['maxCanvasSize']&&(_0xa3fa0b=_0x4bd42c/this['options']['maxCanvasSize']));var _0x14665c=this['heatStyle']['radius']*1.5,_0x54a632=_0x2a445d/_0xa3fa0b+_0x14665c*0x2,_0x1c8e72=_0x440241/_0xa3fa0b+_0x14665c*0x2,_0x39b83d=_0x14665c*_0xa3fa0b;_0x346022[_0x1a3dae(_0x58f348._0x37f13a)]-=_0x39b83d,_0x346022['ymin']-=_0x39b83d,_0x346022['xmax']+=_0x39b83d,_0x346022['ymax']+=_0x39b83d,this[_0x1a3dae(_0x58f348._0x1d922e)]=_0xa3fa0b,_0x45ab2e=geLatLngBounds(_0x346022),this['_rectangle']=Cesium[_0x1a3dae(0xd5)][_0x1a3dae(0xd8)](_0x45ab2e[_0x1a3dae(0x122)],_0x45ab2e['ymin'],_0x45ab2e[_0x1a3dae(0xf4)],_0x45ab2e['ymax']);var _0x2c3058=(_0xdec9b1=_0x1341d1[0x0]['value'])!==null&&_0xdec9b1!==void 0x0?_0xdec9b1:0x1,_0x5cc13d=(_0x447de1=_0x1341d1[0x0][_0x1a3dae(_0x58f348._0x357dbf)])!==null&&_0x447de1!==void 0x0?_0x447de1:0x0,_0x569a9f=[];_0x1341d1['forEach'](function(_0x4eb79c){var _0x163aff=_0x1a3dae,_0x9c4da8=mars3d__namespace['PointTrans'][_0x163aff(_0x3ccd29._0x4b4560)]([_0x4eb79c['lng'],_0x4eb79c[_0x163aff(_0x3ccd29._0x49dcbe)]]),_0x1a0a50=_0x4eb79c['value']||0x1,_0x309a63=Math['round']((_0x9c4da8[0x0]-_0x346022['xmin'])/_0xa3fa0b),_0x5b9f2b=Math[_0x163aff(_0x3ccd29._0x40b246)]((_0x346022['ymax']-_0x9c4da8[0x1])/_0xa3fa0b);_0x2c3058=Math['max'](_0x2c3058,_0x1a0a50),_0x5cc13d=Math['min'](_0x5cc13d,_0x1a0a50),_0x569a9f['push']({'x':_0x309a63,'y':_0x5b9f2b,'value':_0x1a0a50});});var _0x408a82={'min':(_0x4d871e=this[_0x1a3dae(_0x58f348._0x33fe25)]['min'])!==null&&_0x4d871e!==void 0x0?_0x4d871e:_0x5cc13d,'max':(_0x793619=this[_0x1a3dae(_0x58f348._0x4cf24c)]['max'])!==null&&_0x793619!==void 0x0?_0x793619:_0x2c3058,'data':_0x569a9f};this['_last_heatData']=_0x408a82;(!this[_0x1a3dae(_0x58f348._0x2664c3)]||_0x346022['xmin']!==this['_last_mBounds']['xmin']||_0x346022['ymin']!==this['_last_mBounds'][_0x1a3dae(0x124)]||_0x346022[_0x1a3dae(0xf4)]!==this['_last_mBounds'][_0x1a3dae(_0x58f348._0x570bde)]||_0x346022['ymax']!==this['_last_mBounds']['ymax'])&&(this[_0x1a3dae(_0x58f348._0x2664c3)]=_0x346022,!this['heatStyle'][_0x1a3dae(_0x58f348._0x3364d0)]&&(this['heatStyle']['container']=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this[_0x1a3dae(0x120)]['container'])),this[_0x1a3dae(0xb2)][_0x1a3dae(0xd2)][_0x1a3dae(_0x58f348._0x5458e0)][_0x1a3dae(0xbb)]=_0x1a3dae(0xba)[_0x1a3dae(0xe5)](_0x54a632,_0x1a3dae(0xc5))[_0x1a3dae(0xe5)](_0x1c8e72,_0x1a3dae(0xdb)),!this['_heat']?this['_heat']=h337__namespace['create'](this['heatStyle']):this[_0x1a3dae(0xe3)]['configure'](this['heatStyle']));this['_heat']['setData'](_0x408a82);var _0xb50a47=mars3d__namespace['DomUtil'][_0x1a3dae(0xe2)](this['_heat']['_renderer']['canvas']);return _0xb50a47;}},{'key':_0x2803ed(_0x26bd49._0x59af91),'value':function _0x50b15d(){var _0x3e96d2=_0x2803ed;this[_0x3e96d2(_0x5ac8e4._0x485a4b)]['configure']({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle'][_0x3e96d2(_0x5ac8e4._0x37befa)]*this['style']['arcBlurScale'],'gradient':this['heatStyle'][_0x3e96d2(_0x5ac8e4._0x180e66)]||{0.25:'rgb(0,0,0)',0.55:_0x3e96d2(_0x5ac8e4._0x3bdda0),0.85:_0x3e96d2(0xb8),0x1:'rgb(255,255,255)'}});var _0x21abb4=mars3d__namespace['DomUtil'][_0x3e96d2(_0x5ac8e4._0x506703)](this['_heat']['_renderer']['canvas']);return this[_0x3e96d2(_0x5ac8e4._0x485a4b)]['configure'](this['options'][_0x3e96d2(_0x5ac8e4._0x52a797)]),_0x21abb4;}},{'key':'getPointData','value':function _0x1a40e3(_0x4e3d6d){var _0x13258f=_0x2803ed,_0x44864d=mars3d__namespace['LngLatPoint']['parse'](_0x4e3d6d);if(!_0x44864d)return{};var _0x1f6748=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x44864d['lng'],_0x44864d[_0x13258f(0x10d)]]),_0x5bf182=this[_0x13258f(0x125)],_0x5424c7=Math['round']((_0x1f6748[0x0]-_0x5bf182['xmin'])/this['_scale']),_0x37b1ff=Math[_0x13258f(0xd9)]((_0x5bf182['ymax']-_0x1f6748[0x1])/this[_0x13258f(_0x2042dc._0x333dcc)]),_0x531b1e=this['_heat'][_0x13258f(_0x2042dc._0x180283)]({'x':_0x5424c7,'y':_0x37b1ff}),_0x3d8eef=this[_0x13258f(_0x2042dc._0x15a1c2)]['_renderer']['ctx'][_0x13258f(_0x2042dc._0x5ea494)](_0x5424c7-0x1,_0x37b1ff-0x1,0x1,0x1)['data'];return{'x':_0x5424c7,'y':_0x37b1ff,'value':_0x531b1e,'color':'rgba('+_0x3d8eef[0x0]+','+_0x3d8eef[0x1]+','+_0x3d8eef[0x2]+','+_0x3d8eef[0x3]+')'};}}]),_0x36e16f;}(BaseLayer);mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['LayerUtil']['register']('heat',HeatLayer);function getMercatorBounds(_0x79f6b5){var _0xbf69b5={_0x1be550:0x116,_0x4a9991:0x122},_0x2ee1fc=_0x3dbca5,_0x444395=mars3d__namespace[_0x2ee1fc(_0xbf69b5._0x1be550)]['lonlat2mercator']([_0x79f6b5[_0x2ee1fc(_0xbf69b5._0x4a9991)],_0x79f6b5['ymin']]),_0x4046e7=mars3d__namespace[_0x2ee1fc(0x116)][_0x2ee1fc(0xda)]([_0x79f6b5['xmax'],_0x79f6b5['ymax']]);return{'xmin':_0x444395[0x0],'ymin':_0x444395[0x1],'xmax':_0x4046e7[0x0],'ymax':_0x4046e7[0x1]};}function geLatLngBounds(_0xb5befd){var _0x7c78b2={_0x4ffa77:0x116,_0x53569e:0xf4},_0x2f0bbc=_0x3dbca5,_0x189b54=mars3d__namespace[_0x2f0bbc(_0x7c78b2._0x4ffa77)]['mercator2lonlat']([_0xb5befd['xmin'],_0xb5befd['ymin']]),_0x4e951f=mars3d__namespace['PointTrans'][_0x2f0bbc(0xd6)]([_0xb5befd[_0x2f0bbc(_0x7c78b2._0x53569e)],_0xb5befd[_0x2f0bbc(0x117)]]);return{'xmin':_0x189b54[0x0],'ymin':_0x189b54[0x1],'xmax':_0x4e951f[0x0],'ymax':_0x4e951f[0x1]};}function getVertexShaderSource(_0x59b961){var _0x2f797e=_0x3dbca5;return _0x2f797e(0x10c)['concat'](_0x59b961,_0x2f797e(0xcb));}function _0x3675(_0x1b7078,_0xf0bcd9){var _0x19ee44=_0x19ee();return _0x3675=function(_0x36752e,_0x1af076){_0x36752e=_0x36752e-0xb1;var _0x118db3=_0x19ee44[_0x36752e];return _0x118db3;},_0x3675(_0x1b7078,_0xf0bcd9);}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
