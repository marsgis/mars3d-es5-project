/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.0
 * 编译日期：2023-03-16 18:58:56
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2022-10-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';var _0x322ae6=_0x56b3;(function(_0x244115,_0x1fa66b){var _0x49daff={_0x2e6348:0xdb,_0x55516a:0x10b,_0x339c9c:0x126},_0x4681cc=_0x56b3,_0x1180d8=_0x244115();while(!![]){try{var _0x1b16ec=-parseInt(_0x4681cc(0x103))/0x1*(-parseInt(_0x4681cc(0x105))/0x2)+-parseInt(_0x4681cc(0xeb))/0x3*(parseInt(_0x4681cc(0x107))/0x4)+parseInt(_0x4681cc(0x118))/0x5*(parseInt(_0x4681cc(_0x49daff._0x2e6348))/0x6)+-parseInt(_0x4681cc(0x11d))/0x7*(-parseInt(_0x4681cc(_0x49daff._0x55516a))/0x8)+-parseInt(_0x4681cc(0x130))/0x9*(-parseInt(_0x4681cc(_0x49daff._0x339c9c))/0xa)+-parseInt(_0x4681cc(0x125))/0xb+-parseInt(_0x4681cc(0x101))/0xc*(-parseInt(_0x4681cc(0xf2))/0xd);if(_0x1b16ec===_0x1fa66b)break;else _0x1180d8['push'](_0x1180d8['shift']());}catch(_0x136944){_0x1180d8['push'](_0x1180d8['shift']());}}}(_0x458d,0xcff88));function _0x458d(){var _0x1a2994=['_heat','type','522BAGAhV','setOptions','configure','getOwnPropertyDescriptor','max','options','maxCanvasSize','ymax','minCanvasSize','_mBoundsMax','writable','_rectangle','get','_positions','width:','valueOf','xmax','_scale','6MxOmPB','StencilOperation','container','create','heatStyle','undefined','PointTrans','__esModule','Color','defineProperty','diffHeight','register','_updatePositionsHook','body','mercator2lonlat','bumpMap','162636fROCuL','round','lng','Util','length','_graphic2','configurable','13eayCaL','prototype','construct','layer','_getArcHeatCanvas','style','DomUtil','请引入\x20heatmap.js\x20库\x20','EllipsoidSurfaceAppearance','KEEP','arcRadiusScale','concat','_last_mBounds','enumerable','push','2769324cTpMZs','positions','101dznjXT','lat','19038RKvoXM','rgb(216,216,216)','52RXxziT','flyToByAnimationEnd','height','granularity','64Qyagfr','GraphicLayer','rectangle','Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined','setPositions','remove','lonlat2mercator','_graphic','green','mars3d-heatmap\x20mars3d-hideDiv','clientWidth','ymin','getOwnPropertySymbols','2209765ifOLXs','constructor','xmin','EPSG:3857','min','594377VoNcnj','_getHeatCanvas','__proto__','forEach','Rectangle','isFormat','apply','div','10011397mGFoDt','26430FeWRKQ','ctx','RectanglePrimitive','key','formatRectangle','_layer','sham','data'];_0x458d=function(){return _0x1a2994;};return _0x458d();}function _interopNamespace(_0x4c357f){var _0x576244=_0x56b3;if(_0x4c357f&&_0x4c357f['__esModule'])return _0x4c357f;var _0x113ca1=Object[_0x576244(0xde)](null);return _0x4c357f&&Object['keys'](_0x4c357f)['forEach'](function(_0x43b9eb){var _0x30e317=_0x576244;if(_0x43b9eb!=='default'){var _0x4d519a=Object['getOwnPropertyDescriptor'](_0x4c357f,_0x43b9eb);Object['defineProperty'](_0x113ca1,_0x43b9eb,_0x4d519a[_0x30e317(0xd5)]?_0x4d519a:{'enumerable':!![],'get':function(){return _0x4c357f[_0x43b9eb];}});}}),_0x113ca1['default']=_0x4c357f,_0x113ca1;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337);function ownKeys(_0x2e3f23,_0x587bbd){var _0x5d2bed={_0x52e120:0x133},_0x299812=_0x56b3,_0x2c0795=Object['keys'](_0x2e3f23);if(Object[_0x299812(0x117)]){var _0xc7c26d=Object['getOwnPropertySymbols'](_0x2e3f23);_0x587bbd&&(_0xc7c26d=_0xc7c26d['filter'](function(_0x389da8){var _0x38c7a7=_0x299812;return Object[_0x38c7a7(_0x5d2bed._0x52e120)](_0x2e3f23,_0x389da8)['enumerable'];})),_0x2c0795[_0x299812(0x100)][_0x299812(0x123)](_0x2c0795,_0xc7c26d);}return _0x2c0795;}function _objectSpread2(_0x56ab11){var _0x447765={_0x3f27b0:0xe4},_0x24489d=_0x56b3;for(var _0x1613a4=0x1;_0x1613a4<arguments[_0x24489d(0xef)];_0x1613a4++){var _0x3f0076=null!=arguments[_0x1613a4]?arguments[_0x1613a4]:{};_0x1613a4%0x2?ownKeys(Object(_0x3f0076),!0x0)['forEach'](function(_0x2fdc99){_defineProperty(_0x56ab11,_0x2fdc99,_0x3f0076[_0x2fdc99]);}):Object['getOwnPropertyDescriptors']?Object['defineProperties'](_0x56ab11,Object['getOwnPropertyDescriptors'](_0x3f0076)):ownKeys(Object(_0x3f0076))['forEach'](function(_0x18bd19){var _0x57c8fe=_0x24489d;Object[_0x57c8fe(_0x447765._0x3f27b0)](_0x56ab11,_0x18bd19,Object['getOwnPropertyDescriptor'](_0x3f0076,_0x18bd19));});}return _0x56ab11;}function _classCallCheck(_0x3744da,_0x401df3){if(!(_0x3744da instanceof _0x401df3))throw new TypeError('Cannot\x20call\x20a\x20class\x20as\x20a\x20function');}function _defineProperties(_0x550a80,_0x1e4e45){var _0x46d4bb={_0x1627d2:0xf1,_0x40517d:0xe4,_0xebbce7:0x129},_0x4ffa6c=_0x56b3;for(var _0x5f97fd=0x0;_0x5f97fd<_0x1e4e45['length'];_0x5f97fd++){var _0x346cde=_0x1e4e45[_0x5f97fd];_0x346cde[_0x4ffa6c(0xff)]=_0x346cde['enumerable']||![],_0x346cde[_0x4ffa6c(_0x46d4bb._0x1627d2)]=!![];if('value'in _0x346cde)_0x346cde[_0x4ffa6c(0xd3)]=!![];Object[_0x4ffa6c(_0x46d4bb._0x40517d)](_0x550a80,_0x346cde[_0x4ffa6c(_0x46d4bb._0xebbce7)],_0x346cde);}}function _createClass(_0x3a9e9b,_0xbb1194,_0x4d82a0){var _0x389e3f={_0x36d2e2:0xf3},_0x5d8759=_0x56b3;if(_0xbb1194)_defineProperties(_0x3a9e9b[_0x5d8759(_0x389e3f._0x36d2e2)],_0xbb1194);if(_0x4d82a0)_defineProperties(_0x3a9e9b,_0x4d82a0);return Object['defineProperty'](_0x3a9e9b,'prototype',{'writable':![]}),_0x3a9e9b;}function _defineProperty(_0x3151b2,_0x1c3f39,_0x10367c){var _0x5a3902={_0x395717:0xe4},_0x655862=_0x56b3;return _0x1c3f39 in _0x3151b2?Object[_0x655862(_0x5a3902._0x395717)](_0x3151b2,_0x1c3f39,{'value':_0x10367c,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x3151b2[_0x1c3f39]=_0x10367c,_0x3151b2;}function _inherits(_0x15937b,_0x3848de){var _0x2eabe4=_0x56b3;if(typeof _0x3848de!=='function'&&_0x3848de!==null)throw new TypeError('Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function');_0x15937b[_0x2eabe4(0xf3)]=Object['create'](_0x3848de&&_0x3848de['prototype'],{'constructor':{'value':_0x15937b,'writable':!![],'configurable':!![]}}),Object['defineProperty'](_0x15937b,'prototype',{'writable':![]});if(_0x3848de)_setPrototypeOf(_0x15937b,_0x3848de);}function _getPrototypeOf(_0x32c6f7){var _0x18c099={_0x40f96e:0x11f};return _getPrototypeOf=Object['setPrototypeOf']?Object['getPrototypeOf']:function _0xa83891(_0x46b18f){var _0x1a2319=_0x56b3;return _0x46b18f[_0x1a2319(_0x18c099._0x40f96e)]||Object['getPrototypeOf'](_0x46b18f);},_getPrototypeOf(_0x32c6f7);}function _setPrototypeOf(_0x212d6f,_0x2c1aa4){var _0x7df8da={_0xb18d06:0x11f};return _setPrototypeOf=Object['setPrototypeOf']||function _0x4fd665(_0x5a792c,_0x1d195f){var _0x2be26f=_0x56b3;return _0x5a792c[_0x2be26f(_0x7df8da._0xb18d06)]=_0x1d195f,_0x5a792c;},_setPrototypeOf(_0x212d6f,_0x2c1aa4);}function _isNativeReflectConstruct(){var _0x30ce79={_0x5b6abc:0xf4,_0x5f428c:0x12c},_0x267fcc=_0x56b3;if(typeof Reflect===_0x267fcc(0xe0)||!Reflect[_0x267fcc(_0x30ce79._0x5b6abc)])return![];if(Reflect['construct'][_0x267fcc(_0x30ce79._0x5f428c)])return![];if(typeof Proxy==='function')return!![];try{return Boolean[_0x267fcc(0xf3)][_0x267fcc(0xd8)]['call'](Reflect['construct'](Boolean,[],function(){})),!![];}catch(_0x3b240c){return![];}}function _assertThisInitialized(_0x1349f5){if(_0x1349f5===void 0x0)throw new ReferenceError('this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called');return _0x1349f5;}function _possibleConstructorReturn(_0x18ca7b,_0x33eca3){var _0x36fe52={_0x36db35:0x10e},_0x25ab9c=_0x56b3;if(_0x33eca3&&(typeof _0x33eca3==='object'||typeof _0x33eca3==='function'))return _0x33eca3;else{if(_0x33eca3!==void 0x0)throw new TypeError(_0x25ab9c(_0x36fe52._0x36db35));}return _assertThisInitialized(_0x18ca7b);}function _0x56b3(_0x2834b8,_0x4b1499){var _0x458d59=_0x458d();return _0x56b3=function(_0x56b3bc,_0xc5b3a5){_0x56b3bc=_0x56b3bc-0xce;var _0x3bb32d=_0x458d59[_0x56b3bc];return _0x3bb32d;},_0x56b3(_0x2834b8,_0x4b1499);}function _createSuper(_0x284f8e){var _0x595ce6={_0x22c98e:0x119},_0x13f05a=_isNativeReflectConstruct();return function _0x59cdb0(){var _0xa8e392=_0x56b3,_0x588dea=_getPrototypeOf(_0x284f8e),_0x1db267;if(_0x13f05a){var _0x3818a8=_getPrototypeOf(this)[_0xa8e392(_0x595ce6._0x22c98e)];_0x1db267=Reflect['construct'](_0x588dea,arguments,_0x3818a8);}else _0x1db267=_0x588dea['apply'](this,arguments);return _possibleConstructorReturn(this,_0x1db267);};}var HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace[_0x322ae6(0xde)])throw new Error(_0x322ae6(0xf9));var Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x322ae6(0xf5)]['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x322ae6(0x113),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x322ae6(0xfa)]['VERTEX_FORMAT']},HeatLayer=function(_0x36a653){var _0x266464={_0x1f14ca:0x10f},_0x15793f={_0xa76d06:0xec,_0x51b117:0xd0,_0x1e7d97:0x12d},_0x12c030={_0x3465b1:0xfc,_0x11fc76:0xdf},_0x516f21={_0x54f548:0xd9,_0x32fded:0x11a,_0x279516:0x11c,_0x12f160:0xcf,_0x1dc18b:0xda,_0x3778ce:0xd9,_0x301511:0xce,_0x21f86e:0xfe,_0x56699d:0xd0,_0x21c482:0xdf,_0x59ae03:0x124,_0xea6ee9:0x114,_0xbaa4fd:0xf7,_0x28dcd2:0x12e,_0x48a756:0x132},_0x516ac2={_0x252894:0xfb,_0x1bbfcd:0x109,_0x5353b6:0x10a},_0x84819e={_0x58cf86:0x102,_0x25ecf3:0x11e,_0x47c50a:0x12f,_0x41877f:0xf7,_0x39522a:0x112},_0x2c80c7={_0x5a8103:0x112},_0x306f3f={_0x1493e1:0xd6},_0x380799={_0x6a6010:0xd6},_0x42688f={_0x33240f:0xdd,_0x292550:0xf8},_0xfa75ed={_0x286aae:0x12b,_0x152a35:0xce,_0x3cff64:0x102},_0x448db0={_0x41742f:0x10c},_0x153465={_0x17479a:0xd6},_0x4fd941={_0x4df2a5:0xce},_0x793877={_0x832f80:0xce,_0x322f8a:0x12e,_0x2b1761:0xdf},_0x1bb735={_0x26e396:0x12b},_0x1088a3={_0x562b6c:0xef,_0xe55313:0xce,_0x1c96fc:0xcf,_0x442e43:0x134,_0x55f5e7:0xdf,_0x55a88d:0xf7},_0x50920f=_0x322ae6;_inherits(_0x1c8962,_0x36a653);var _0x7d0e0e=_createSuper(_0x1c8962);function _0x1c8962(){var _0x1adbc5=_0x56b3,_0x31cfc4,_0x386738,_0x15053d,_0x27dcb7=arguments[_0x1adbc5(_0x1088a3._0x562b6c)]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};return _classCallCheck(this,_0x1c8962),_0x15053d=_0x7d0e0e['call'](this,_0x27dcb7),_0x15053d['options']['maxCanvasSize']=(_0x31cfc4=_0x15053d[_0x1adbc5(_0x1088a3._0xe55313)]['maxCanvasSize'])!==null&&_0x31cfc4!==void 0x0?_0x31cfc4:document['body'][_0x1adbc5(0x115)],_0x15053d['options'][_0x1adbc5(_0x1088a3._0x1c96fc)]=Math['min'](_0x15053d['options']['maxCanvasSize'],0x1388),_0x15053d['options']['minCanvasSize']=(_0x386738=_0x15053d['options']['minCanvasSize'])!==null&&_0x386738!==void 0x0?_0x386738:document[_0x1adbc5(0xe8)]['clientHeight'],_0x15053d['options']['minCanvasSize']=Math[_0x1adbc5(_0x1088a3._0x442e43)](_0x15053d['options'][_0x1adbc5(0xd1)],0x2bc),_0x15053d['options'][_0x1adbc5(0xdf)]=_objectSpread2(_objectSpread2({},DEF_HEATSTYLE),_0x15053d[_0x1adbc5(0xce)][_0x1adbc5(_0x1088a3._0x55f5e7)]||{}),_0x15053d['options']['style']=_objectSpread2(_objectSpread2({},DEF_STYLE),_0x15053d['options'][_0x1adbc5(_0x1088a3._0x55a88d)]||{}),_0x15053d;}return _createClass(_0x1c8962,[{'key':_0x50920f(0xf5),'get':function _0x489af7(){var _0x1deb9e=_0x50920f;return this[_0x1deb9e(_0x1bb735._0x26e396)];}},{'key':_0x50920f(0xdf),'get':function _0x2ffeea(){var _0x2270e6=_0x50920f;return this['options'][_0x2270e6(0xdf)];},'set':function _0x3be989(_0x2d6cd0){var _0x2fa1a3=_0x50920f;this[_0x2fa1a3(_0x793877._0x832f80)]['heatStyle']=mars3d__namespace[_0x2fa1a3(0xee)]['merge'](this['options']['heatStyle'],_0x2d6cd0),this[_0x2fa1a3(0x12e)]&&(this[_0x2fa1a3(_0x793877._0x322f8a)]['configure'](this['options'][_0x2fa1a3(_0x793877._0x2b1761)]),this['_updatePositionsHook'](!![]));}},{'key':_0x50920f(0xf7),'get':function _0x24c3e2(){var _0x14fcd9=_0x50920f;return this['options'][_0x14fcd9(0xf7)];},'set':function _0x27a189(_0xc1ab52){var _0x40f67f=_0x50920f;this['options']['style']=mars3d__namespace['Util']['merge'](this[_0x40f67f(_0x4fd941._0x4df2a5)]['style'],_0xc1ab52);}},{'key':_0x50920f(0x102),'get':function _0x5e177c(){var _0x2b5229=_0x50920f;return this[_0x2b5229(_0x153465._0x17479a)];},'set':function _0x283d09(_0x127f35){this['setPositions'](_0x127f35);}},{'key':'coordinates','get':function _0x3a0c02(){var _0x185c94=[];return this['points']['forEach'](function(_0x38e1cc){_0x185c94['push'](_0x38e1cc['toArray']());}),_0x185c94;}},{'key':_0x50920f(0x10d),'get':function _0x340288(){return this['_rectangle'];}},{'key':'_setOptionsHook','value':function _0x78091e(_0x3092c4,_0x33c74c){var _0x3ede61=_0x50920f;_0x3092c4[_0x3ede61(0x102)]&&(this[_0x3ede61(0x102)]=_0x3092c4[_0x3ede61(0x102)]);}},{'key':'_mountedHook','value':function _0x10f1ed(){var _0x5dccbb=_0x50920f;this['style'][_0x5dccbb(0x12f)]==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':_0x5dccbb(0x11b),'private':!![]}):this['_layer']=new mars3d__namespace[(_0x5dccbb(0xf5))][(_0x5dccbb(_0x448db0._0x41742f))]({'private':!![]});}},{'key':'_addedHook','value':function _0x1960d9(){var _0x56cd2b=_0x50920f;this['_map']['addLayer'](this[_0x56cd2b(_0xfa75ed._0x286aae)]),this[_0x56cd2b(0xce)]['positions']&&(this['positions']=this[_0x56cd2b(_0xfa75ed._0x152a35)][_0x56cd2b(_0xfa75ed._0x3cff64)]),this['options']['flyTo']&&this[_0x56cd2b(0x108)]();}},{'key':'_removedHook','value':function _0x47f1c0(){var _0x4bb8f9=_0x50920f;this['heatStyle'][_0x4bb8f9(_0x42688f._0x33240f)]&&(mars3d__namespace[_0x4bb8f9(_0x42688f._0x292550)][_0x4bb8f9(0x110)](this['heatStyle'][_0x4bb8f9(0xdd)]),delete this['heatStyle']['container']),this['clear'](),this['_map']['removeLayer'](this['_layer']);}},{'key':'addPosition','value':function _0xf1bf7f(_0x1df439,_0x141216){var _0x16cc6e=_0x50920f;this['_positions']=this[_0x16cc6e(_0x380799._0x6a6010)]||[],this['_positions']['push'](_0x1df439),this[_0x16cc6e(0xe7)](_0x141216);}},{'key':_0x50920f(_0x266464._0x1f14ca),'value':function _0xd48ee7(_0x5018ac,_0x222f96){var _0x418438=_0x50920f;this[_0x418438(_0x306f3f._0x1493e1)]=_0x5018ac,this['_updatePositionsHook'](_0x222f96);}},{'key':'clear','value':function _0x2aaccd(){var _0x4fa5f3=_0x50920f;this[_0x4fa5f3(_0x2c80c7._0x5a8103)]&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this[_0x4fa5f3(0xf0)],!![]),delete this[_0x4fa5f3(0xf0)]);}},{'key':'_updatePositionsHook','value':function _0x35813f(_0x2c85f6){var _0x32b445=_0x50920f;if(!this['show']||!this['_map']||!this[_0x32b445(_0x84819e._0x58cf86)]||this['positions']['length']===0x0)return this;var _0x192bec=this[_0x32b445(_0x84819e._0x25ecf3)]();if(this['style'][_0x32b445(_0x84819e._0x47c50a)]==='image')this['_layer'][_0x32b445(0x131)]({'url':_0x192bec['toDataURL']('image/png'),'rectangle':this[_0x32b445(0xd4)],'opacity':this[_0x32b445(0xf7)]['opacity']});else this[_0x32b445(_0x84819e._0x41877f)]['arc']?this[_0x32b445(_0x84819e._0x39522a)]&&_0x2c85f6?(this['_graphic']['uniforms']['image']=_0x192bec,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this[_0x32b445(0xf0)]&&(this[_0x32b445(0xf0)]['uniforms']['image']=_0x192bec,this['_graphic2']['uniforms'][_0x32b445(0xea)]=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x192bec):this['_graphic']&&_0x2c85f6?this['_graphic']['uniforms']['image']=_0x192bec:this['_createGraphic'](_0x192bec);return this;}},{'key':'_createGraphic','value':function _0x1922c9(_0x59650b){var _0x19d658=_0x50920f;this['clear'](),this['_graphic']=new mars3d__namespace['graphic'][(_0x19d658(0x128))](_objectSpread2(_objectSpread2({},this['options']),{},{'rectangle':this[_0x19d658(0xd4)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x59650b},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})})),this['_layer']['addGraphic'](this['_graphic']);}},{'key':'_createArcGraphic','value':function _0x23de78(_0x3bfbb2){var _0x139129=_0x50920f,_0x4f2730;this['clear']();var _0x48e5e6=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation'][_0x139129(_0x516ac2._0x252894)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x139129(0xdc)]['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0xe8d674=Math['floor']((_0x4f2730=this['style'][_0x139129(0xe5)])!==null&&_0x4f2730!==void 0x0?_0x4f2730:this[_0x139129(0xd2)]*0.02)+0.1;this[_0x139129(0xf7)]['diffHeight']&&delete this['style']['diffHeight'];var _0x46a8f5=(this[_0x139129(0xf7)]['splitNum'],0x64),_0x4adbea=Math['max'](this[_0x139129(0xd4)][_0x139129(_0x516ac2._0x1bbfcd)],this['_rectangle']['width']);this['style'][_0x139129(_0x516ac2._0x5353b6)]=_0x4adbea/=_0x46a8f5;var _0x2ced4b=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x3bfbb2,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x139129(0xe3))](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x4e0bd6=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive'](_objectSpread2(_objectSpread2({},this[_0x139129(0xce)]),{},{'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x48e5e6,'material':_0x2ced4b,'vertexShaderSource':getVertexShaderSource(_0xe8d674*_0x4e0bd6)})})),this['_layer']['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive'](_objectSpread2(_objectSpread2({},this['options']),{},{'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x48e5e6,'material':_0x2ced4b,'vertexShaderSource':getVertexShaderSource(-_0xe8d674)})})),this['_layer']['addGraphic'](this['_graphic2']));}},{'key':'getRectangle','value':function _0x4b6249(_0x7b69f8){var _0x3c7ec7=_0x50920f;return _0x7b69f8!==null&&_0x7b69f8!==void 0x0&&_0x7b69f8[_0x3c7ec7(0x122)]&&this[_0x3c7ec7(0xd4)]?mars3d__namespace['PolyUtil'][_0x3c7ec7(0x12a)](this['_rectangle']):this['_rectangle'];}},{'key':'_getHeatCanvas','value':function _0x4a9ee0(){var _0x230fc9={_0x3befc3:0x104},_0x14d357=_0x50920f,_0x308121=this,_0x1eadb2,_0x4bc784,_0x244d9e,_0x157cbf,_0x214f75=this['_positions'],_0x4e942d=[],_0x53f414,_0x3e2861,_0x2c3c72,_0x5a904a;_0x214f75['forEach'](function(_0x514965){var _0x3fe499=_0x56b3,_0x191462=mars3d__namespace['LngLatPoint']['parse'](_0x514965);if(!_0x191462)return;_0x191462['value']=_0x514965['value']||0x1,!_0x308121['options']['rectangle']&&(_0x53f414===undefined?(_0x53f414=_0x191462['lng'],_0x3e2861=_0x191462[_0x3fe499(0xed)],_0x2c3c72=_0x191462['lat'],_0x5a904a=_0x191462[_0x3fe499(0x104)]):(_0x53f414=Math['min'](_0x53f414,_0x191462['lng']),_0x3e2861=Math['max'](_0x3e2861,_0x191462['lng']),_0x2c3c72=Math['min'](_0x2c3c72,_0x191462[_0x3fe499(0x104)]),_0x5a904a=Math['max'](_0x5a904a,_0x191462['lat']))),_0x4e942d['push'](_0x191462);});var _0x3d8bec=this['options']['rectangle']||{'xmin':_0x53f414,'xmax':_0x3e2861,'ymin':_0x2c3c72,'ymax':_0x5a904a},_0x5ef413=getMercatorBounds(_0x3d8bec),_0x3e8b1b=Math['abs'](_0x5ef413[_0x14d357(_0x516f21._0x54f548)]-_0x5ef413[_0x14d357(_0x516f21._0x32fded)]),_0x2ea325=Math['abs'](_0x5ef413['ymax']-_0x5ef413['ymin']),_0x85c1ca=Math[_0x14d357(0x134)](_0x3e8b1b,_0x2ea325),_0xff0624=Math[_0x14d357(_0x516f21._0x279516)](_0x3e8b1b,_0x2ea325);this['_mBoundsMax']=_0x85c1ca;var _0x6b0631=0x1;if(_0x85c1ca>this[_0x14d357(0xce)]['maxCanvasSize'])_0x6b0631=_0x85c1ca/this['options']['maxCanvasSize'],_0xff0624/_0x6b0631<this[_0x14d357(0xce)]['minCanvasSize']&&(_0x6b0631=_0xff0624/this['options']['minCanvasSize']);else _0xff0624<this['options'][_0x14d357(0xd1)]&&(_0x6b0631=_0xff0624/this['options']['minCanvasSize'],_0x85c1ca/_0x6b0631>this['options'][_0x14d357(_0x516f21._0x12f160)]&&(_0x6b0631=_0x85c1ca/this['options']['maxCanvasSize']));var _0x2f5173=this['heatStyle']['radius']*1.5,_0x319642=_0x3e8b1b/_0x6b0631+_0x2f5173*0x2,_0x49e88e=_0x2ea325/_0x6b0631+_0x2f5173*0x2,_0x1fc1ee=_0x2f5173*_0x6b0631;_0x5ef413[_0x14d357(_0x516f21._0x32fded)]-=_0x1fc1ee,_0x5ef413[_0x14d357(0x116)]-=_0x1fc1ee,_0x5ef413['xmax']+=_0x1fc1ee,_0x5ef413['ymax']+=_0x1fc1ee,this[_0x14d357(_0x516f21._0x1dc18b)]=_0x6b0631,_0x3d8bec=geLatLngBounds(_0x5ef413),this[_0x14d357(0xd4)]=Cesium[_0x14d357(0x121)]['fromDegrees'](_0x3d8bec['xmin'],_0x3d8bec[_0x14d357(0x116)],_0x3d8bec[_0x14d357(_0x516f21._0x3778ce)],_0x3d8bec['ymax']);var _0x51a206=(_0x1eadb2=_0x4e942d[0x0]['value'])!==null&&_0x1eadb2!==void 0x0?_0x1eadb2:0x1,_0x10f28e=(_0x4bc784=_0x4e942d[0x0]['value'])!==null&&_0x4bc784!==void 0x0?_0x4bc784:0x0,_0x434167=[];_0x4e942d[_0x14d357(0x120)](function(_0x165f20){var _0x1f85a7=_0x14d357,_0x409de1=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x165f20['lng'],_0x165f20[_0x1f85a7(_0x230fc9._0x3befc3)]]),_0x25a86d=_0x165f20['value']||0x1,_0xdc5449=Math['round']((_0x409de1[0x0]-_0x5ef413['xmin'])/_0x6b0631),_0x4cda37=Math[_0x1f85a7(0xec)]((_0x5ef413['ymax']-_0x409de1[0x1])/_0x6b0631);_0x51a206=Math['max'](_0x51a206,_0x25a86d),_0x10f28e=Math[_0x1f85a7(0x11c)](_0x10f28e,_0x25a86d),_0x434167['push']({'x':_0xdc5449,'y':_0x4cda37,'value':_0x25a86d});});var _0x59c3f4={'min':(_0x244d9e=this['options']['min'])!==null&&_0x244d9e!==void 0x0?_0x244d9e:_0x10f28e,'max':(_0x157cbf=this[_0x14d357(_0x516f21._0x301511)]['max'])!==null&&_0x157cbf!==void 0x0?_0x157cbf:_0x51a206,'data':_0x434167};this['_last_heatData']=_0x59c3f4;(!this['_last_mBounds']||_0x5ef413['xmin']!==this[_0x14d357(_0x516f21._0x21f86e)]['xmin']||_0x5ef413['ymin']!==this[_0x14d357(_0x516f21._0x21f86e)][_0x14d357(0x116)]||_0x5ef413[_0x14d357(0xd9)]!==this['_last_mBounds'][_0x14d357(0xd9)]||_0x5ef413[_0x14d357(_0x516f21._0x56699d)]!==this['_last_mBounds']['ymax'])&&(this['_last_mBounds']=_0x5ef413,!this['heatStyle']['container']&&(this[_0x14d357(_0x516f21._0x21c482)]['container']=mars3d__namespace[_0x14d357(0xf8)]['create'](_0x14d357(_0x516f21._0x59ae03),_0x14d357(_0x516f21._0xea6ee9),this['_map']['container'])),this['heatStyle']['container'][_0x14d357(_0x516f21._0xbaa4fd)]['cssText']=_0x14d357(0xd7)['concat'](_0x319642,'px;height:')['concat'](_0x49e88e,'px;'),!this[_0x14d357(_0x516f21._0x28dcd2)]?this[_0x14d357(0x12e)]=h337__namespace['create'](this['heatStyle']):this[_0x14d357(0x12e)][_0x14d357(_0x516f21._0x48a756)](this['heatStyle']));this['_heat']['setData'](_0x59c3f4);var _0x4c1971=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x4c1971;}},{'key':_0x50920f(0xf6),'value':function _0x1b0d5b(){var _0x3684c9=_0x50920f;this['_heat']['configure']({'radius':this[_0x3684c9(0xdf)]['radius']*this['style'][_0x3684c9(_0x12c030._0x3465b1)],'blur':this[_0x3684c9(_0x12c030._0x11fc76)]['blur']*this[_0x3684c9(0xf7)]['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:_0x3684c9(0x106),0x1:'rgb(255,255,255)'}});var _0x6b055a=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this['options'][_0x3684c9(_0x12c030._0x11fc76)]),_0x6b055a;}},{'key':'getPointData','value':function _0x18525f(_0x22b280){var _0x26a569=_0x50920f,_0x5d751b=mars3d__namespace['LngLatPoint']['parse'](_0x22b280);if(!_0x5d751b)return{};var _0x2fbb45=mars3d__namespace['PointTrans'][_0x26a569(0x111)]([_0x5d751b['lng'],_0x5d751b['lat']]),_0x1352ac=this['_last_mBounds'],_0x49a316=Math['round']((_0x2fbb45[0x0]-_0x1352ac['xmin'])/this['_scale']),_0x331704=Math[_0x26a569(_0x15793f._0xa76d06)]((_0x1352ac[_0x26a569(_0x15793f._0x51b117)]-_0x2fbb45[0x1])/this['_scale']),_0x419f2c=this['_heat']['getValueAt']({'x':_0x49a316,'y':_0x331704}),_0x514201=this[_0x26a569(0x12e)]['_renderer'][_0x26a569(0x127)]['getImageData'](_0x49a316-0x1,_0x331704-0x1,0x1,0x1)[_0x26a569(_0x15793f._0x1e7d97)];return{'x':_0x49a316,'y':_0x331704,'value':_0x419f2c,'color':'rgba('+_0x514201[0x0]+','+_0x514201[0x1]+','+_0x514201[0x2]+','+_0x514201[0x3]+')'};}}]),_0x1c8962;}(BaseLayer);mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['LayerUtil'][_0x322ae6(0xe6)]('heat',HeatLayer);function getMercatorBounds(_0x4c6c4b){var _0x2ae77c={_0x2ed952:0x111,_0x5c79c9:0xd0},_0x182b6b=_0x322ae6,_0x23716f=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x4c6c4b[_0x182b6b(0x11a)],_0x4c6c4b['ymin']]),_0x40544e=mars3d__namespace['PointTrans'][_0x182b6b(_0x2ae77c._0x2ed952)]([_0x4c6c4b[_0x182b6b(0xd9)],_0x4c6c4b[_0x182b6b(_0x2ae77c._0x5c79c9)]]);return{'xmin':_0x23716f[0x0],'ymin':_0x23716f[0x1],'xmax':_0x40544e[0x0],'ymax':_0x40544e[0x1]};}function geLatLngBounds(_0x201219){var _0x9773c0={_0x267d7a:0xe1,_0x47dc44:0x11a,_0x4a312e:0xe9},_0x3c2cd5=_0x322ae6,_0x842bd4=mars3d__namespace[_0x3c2cd5(_0x9773c0._0x267d7a)]['mercator2lonlat']([_0x201219[_0x3c2cd5(_0x9773c0._0x47dc44)],_0x201219['ymin']]),_0x138e6d=mars3d__namespace[_0x3c2cd5(0xe1)][_0x3c2cd5(_0x9773c0._0x4a312e)]([_0x201219['xmax'],_0x201219[_0x3c2cd5(0xd0)]]);return{'xmin':_0x842bd4[0x0],'ymin':_0x842bd4[0x1],'xmax':_0x138e6d[0x0],'ymax':_0x138e6d[0x1]};}function getVertexShaderSource(_0x367480){var _0x4ab484={_0x53d8b0:0xfd},_0xf0664e=_0x322ae6;return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'[_0xf0664e(_0x4ab484._0x53d8b0)](_0x367480,';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a');}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x322ae6(0xe2),{'value':!![]});
}));
