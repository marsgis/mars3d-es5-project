/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.1
 * 编译日期：2023-08-14 21:33:27
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x3cf2e8=_0x2a3e;function _0x2cdc(){const _0x46bee5=['_addedHook','arcRadiusScale','KEEP','setData','_updatePositionsHook','_getHeatCanvas','opacity','lat','1Mglark','clear','_graphic2','parse','539dyEuea','create','canvas','_createGraphic','toArray','_rectangle','forEach','_container','clientHeight','DomUtil','_last_mBounds','minCanvasSize','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','_scale','3042778OljqHn','defineProperty','value','Util','options','_map','VERTEX_FORMAT','arcBlurScale','removeGraphic','mercator2lonlat','style','arcDirection','getImageData','_createArcGraphic','BaseLayer','min','type','5672MgsioZ','6iZeBhp','blur','_graphic','ctx','abs','600897QoErOQ','clientWidth','RectanglePrimitive','flyToByAnimationEnd','StencilOperation','max','_heat','1717070UOGAxL','lonlat2mercator','height','ymax','_layer','layer','rgb(216,216,216)','setOptions','ALWAYS','rgb(0,0,0)','merge','image','bumpMap','ImageLayer','configure','lng','diffHeight','8hxkipp','ymin','__esModule','addGraphic','5610318cKCWXU','xmin','round','35763588BBiPzL','positions','xmax','splitNum','15970tfKOzH','8082AyAquC','HeatLayer','rgb(255,255,255)','PointTrans','_mBoundsMax','_positions','green','heatStyle','width'];_0x2cdc=function(){return _0x46bee5;};return _0x2cdc();}(function(_0x4a0d02,_0x239cdc){const _0x136aa3={_0x7a3916:0x1e0,_0x5dc92c:0x1f2,_0x23bbcb:0x209,_0x5af95f:0x221,_0x5ef374:0x225,_0x3dacd9:0x1cf,_0x5065a1:0x1e4},_0x22b80e=_0x2a3e,_0x2b894f=_0x4a0d02();while(!![]){try{const _0x16c8cf=parseInt(_0x22b80e(_0x136aa3._0x7a3916))/0x1*(-parseInt(_0x22b80e(_0x136aa3._0x5dc92c))/0x2)+parseInt(_0x22b80e(_0x136aa3._0x23bbcb))/0x3+-parseInt(_0x22b80e(_0x136aa3._0x5af95f))/0x4*(-parseInt(_0x22b80e(0x210))/0x5)+-parseInt(_0x22b80e(0x204))/0x6*(parseInt(_0x22b80e(_0x136aa3._0x5ef374))/0x7)+-parseInt(_0x22b80e(0x203))/0x8*(parseInt(_0x22b80e(_0x136aa3._0x3dacd9))/0x9)+-parseInt(_0x22b80e(0x1ce))/0xa*(parseInt(_0x22b80e(_0x136aa3._0x5065a1))/0xb)+parseInt(_0x22b80e(0x228))/0xc;if(_0x16c8cf===_0x239cdc)break;else _0x2b894f['push'](_0x2b894f['shift']());}catch(_0x199fe7){_0x2b894f['push'](_0x2b894f['shift']());}}}(_0x2cdc,0xca8bc));function _interopNamespace(_0x3728d0){const _0xf81e64=_0x2a3e;if(_0x3728d0&&_0x3728d0[_0xf81e64(0x223)])return _0x3728d0;var _0x3f2a33=Object['create'](null);return _0x3728d0&&Object['keys'](_0x3728d0)['forEach'](function(_0x28894f){if(_0x28894f!=='default'){var _0x289558=Object['getOwnPropertyDescriptor'](_0x3728d0,_0x28894f);Object['defineProperty'](_0x3f2a33,_0x28894f,_0x289558['get']?_0x289558:{'enumerable':!![],'get':function(){return _0x3728d0[_0x28894f];}});}}),_0x3f2a33['default']=_0x3728d0,_0x3f2a33;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x3cf2e8(0x1f0);if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x3cf2e8(0x200)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x3cf2e8(0x1d5),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance'][_0x3cf2e8(0x1f8)]};class HeatLayer extends BaseLayer{constructor(_0x3b325d={}){const _0x24ac38={_0x2e35cf:0x20a,_0x431d69:0x1f6,_0x47af09:0x1ef,_0x221933:0x1ec},_0x55c107=_0x3cf2e8;super(_0x3b325d),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document['body'][_0x55c107(_0x24ac38._0x2e35cf)],this['options']['maxCanvasSize']=Math['min'](this[_0x55c107(_0x24ac38._0x431d69)]['maxCanvasSize'],0x1388),this['options'][_0x55c107(_0x24ac38._0x47af09)]=this[_0x55c107(0x1f6)]['minCanvasSize']??document['body'][_0x55c107(_0x24ac38._0x221933)],this[_0x55c107(0x1f6)]['minCanvasSize']=Math['max'](this[_0x55c107(0x1f6)]['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this[_0x55c107(0x1f6)]['style']={...DEF_STYLE,...this[_0x55c107(0x1f6)]['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set[_0x3cf2e8(0x1d6)](_0x1bd09b){const _0x320143={_0x5c110e:0x21a,_0x1043d6:0x1f6,_0x2c1220:0x1dc},_0x523508=_0x3cf2e8;this['options']['heatStyle']=mars3d__namespace['Util'][_0x523508(_0x320143._0x5c110e)](this[_0x523508(_0x320143._0x1043d6)]['heatStyle'],_0x1bd09b),this['_heat']&&(this['_heat']['configure'](this[_0x523508(_0x320143._0x1043d6)]['heatStyle']),this[_0x523508(_0x320143._0x2c1220)](!![]));}get[_0x3cf2e8(0x1fc)](){const _0x3b40be=_0x3cf2e8;return this[_0x3b40be(0x1f6)]['style'];}set['style'](_0x264e67){const _0x367e8d={_0x598015:0x1f5},_0x40015f=_0x3cf2e8;this['options']['style']=mars3d__namespace[_0x40015f(_0x367e8d._0x598015)][_0x40015f(0x21a)](this['options']['style'],_0x264e67);}get['positions'](){return this['_positions'];}set['positions'](_0x22d452){this['setPositions'](_0x22d452);}get['coordinates'](){const _0x2679a7={_0x36cc19:0x1e8},_0x5b4e51=_0x3cf2e8,_0x2ff7fa=[];return this['points'][_0x5b4e51(0x1ea)](_0x3557a8=>{const _0x28cc80=_0x5b4e51;_0x2ff7fa['push'](_0x3557a8[_0x28cc80(_0x2679a7._0x36cc19)]());}),_0x2ff7fa;}get['rectangle'](){const _0x312e65={_0x39eaf5:0x1e9},_0x554384=_0x3cf2e8;return this[_0x554384(_0x312e65._0x39eaf5)];}['_setOptionsHook'](_0x2419e4,_0x411621){const _0x1a104d={_0x554822:0x1cb},_0x1721c0=_0x3cf2e8;_0x2419e4['positions']&&(this[_0x1721c0(_0x1a104d._0x554822)]=_0x2419e4['positions']);}['_mountedHook'](){const _0x53a164={_0x2e8e8b:0x214},_0x474013=_0x3cf2e8;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer'][(_0x474013(0x21d))]({'crs':'EPSG:3857','private':!![]}):this[_0x474013(_0x53a164._0x2e8e8b)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}[_0x3cf2e8(0x1d8)](){const _0x1be87d={_0x2f7f87:0x20c},_0x1d3427=_0x3cf2e8;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace[_0x1d3427(0x1ed)][_0x1d3427(0x1e5)]('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this['options']['flyTo']&&this[_0x1d3427(_0x1be87d._0x2f7f87)]();}['_removedHook'](){const _0x506f6a=_0x3cf2e8;this['_container']&&(mars3d__namespace[_0x506f6a(0x1ed)]['remove'](this['_container']),delete this['_container']),this[_0x506f6a(0x1e1)](),this[_0x506f6a(0x1f7)]['removeLayer'](this['_layer']);}['addPosition'](_0x4275a4,_0x153a4e){const _0x49e07d={_0x239211:0x1d4},_0x7ddd7e=_0x3cf2e8;this['_positions']=this['_positions']||[],this[_0x7ddd7e(_0x49e07d._0x239211)]['push'](_0x4275a4),this['_updatePositionsHook'](_0x153a4e);}['setPositions'](_0x39ff2e,_0x2d1dfb){this['_positions']=_0x39ff2e,this['_updatePositionsHook'](_0x2d1dfb);}['clear'](){const _0x5dcfaa={_0x224235:0x1e2,_0x2b97ea:0x1fa},_0x48b9ac=_0x3cf2e8;this['_graphic']&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this[_0x48b9ac(_0x5dcfaa._0x224235)]&&(this['_layer'][_0x48b9ac(_0x5dcfaa._0x2b97ea)](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x37aed7){const _0x1755a8={_0x27da30:0x1f7,_0xbd5d0:0x202,_0x9f359a:0x21b,_0x2000a9:0x217,_0x1507b8:0x1fc,_0x4cfa8c:0x1e2,_0x1e0852:0x21c,_0x2575d1:0x206},_0x1669f7=_0x3cf2e8;if(!this['show']||!this[_0x1669f7(_0x1755a8._0x27da30)]||!this['positions']||this[_0x1669f7(0x1cb)]['length']===0x0)return this;const _0x542f73=this[_0x1669f7(0x1dd)]();if(this['style'][_0x1669f7(_0x1755a8._0xbd5d0)]===_0x1669f7(_0x1755a8._0x9f359a))this['_layer'][_0x1669f7(_0x1755a8._0x2000a9)]({'url':_0x542f73['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0x1669f7(0x1de)]});else this[_0x1669f7(_0x1755a8._0x1507b8)]['arc']?this[_0x1669f7(0x206)]&&_0x37aed7?(this[_0x1669f7(0x206)]['uniforms'][_0x1669f7(0x21b)]=_0x542f73,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this[_0x1669f7(_0x1755a8._0x4cfa8c)]&&(this['_graphic2']['uniforms'][_0x1669f7(_0x1755a8._0x9f359a)]=_0x542f73,this['_graphic2']['uniforms']['bumpMap']=this['_graphic']['uniforms'][_0x1669f7(_0x1755a8._0x1e0852)])):this['_createArcGraphic'](_0x542f73):this['_graphic']&&_0x37aed7?this[_0x1669f7(_0x1755a8._0x2575d1)]['uniforms']['image']=_0x542f73:this[_0x1669f7(0x1e7)](_0x542f73);return this;}[_0x3cf2e8(0x1e7)](_0x5db259){const _0x528c3c={_0x2388cd:0x20b},_0x252d70=_0x3cf2e8;this['clear'](),this['_graphic']=new mars3d__namespace['graphic'][(_0x252d70(_0x528c3c._0x2388cd))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x5db259},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0x3cf2e8(0x1ff)](_0x4bbf28){const _0x3ca22f={_0x5f2951:0x218,_0x5b9c58:0x1da,_0x405b75:0x20d,_0x129e4c:0x20d,_0xa9563c:0x1fc,_0x135cc8:0x220,_0x41b77e:0x1fc,_0x31b72a:0x1e9,_0x1579b9:0x224},_0x2790f6=_0x3cf2e8;this[_0x2790f6(0x1e1)]();const _0x15b580=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction'][_0x2790f6(_0x3ca22f._0x5f2951)],'frontOperation':{'fail':Cesium['StencilOperation'][_0x2790f6(_0x3ca22f._0x5b9c58)],'zFail':Cesium[_0x2790f6(0x20d)]['KEEP'],'zPass':Cesium[_0x2790f6(_0x3ca22f._0x405b75)]['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x2790f6(_0x3ca22f._0x129e4c)]['KEEP'],'zPass':Cesium[_0x2790f6(_0x3ca22f._0x129e4c)]['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0xa9c58e=Math['floor'](this[_0x2790f6(_0x3ca22f._0xa9563c)][_0x2790f6(_0x3ca22f._0x135cc8)]??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style'][_0x2790f6(0x220)];const _0x560c6c=(this['style'][_0x2790f6(0x1cd)],0x64);let _0x3e6dec=Math['max'](this['_rectangle'][_0x2790f6(0x212)],this['_rectangle'][_0x2790f6(0x1d7)]);this['style']['granularity']=_0x3e6dec/=_0x560c6c;const _0x27b805=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x4bbf28,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x220bab=this[_0x2790f6(_0x3ca22f._0x41b77e)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x2790f6(0x20b))]({...this[_0x2790f6(0x1f6)],'rectangle':this[_0x2790f6(_0x3ca22f._0x31b72a)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x15b580,'material':_0x27b805,'vertexShaderSource':getVertexShaderSource(_0xa9c58e*_0x220bab)})}),this['_layer'][_0x2790f6(_0x3ca22f._0x1579b9)](this['_graphic']),this['style'][_0x2790f6(0x1fd)]===0x0&&(this[_0x2790f6(0x1e2)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x15b580,'material':_0x27b805,'vertexShaderSource':getVertexShaderSource(-_0xa9c58e)})}),this['_layer']['addGraphic'](this['_graphic2']));}['getRectangle'](_0x4e49c9){return _0x4e49c9!==null&&_0x4e49c9!==void 0x0&&_0x4e49c9['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x5503f4={_0x163576:0x208,_0x274a94:0x1ef,_0x5094bf:0x1ef,_0xea2e82:0x1ef,_0x510f71:0x1f6,_0xd8c8ac:0x1f1,_0x257f42:0x1f4,_0x3c8882:0x1ea,_0x52e088:0x1ee,_0x53c3be:0x1fc,_0x5c4998:0x1d6},_0x4b36ca={_0x490a86:0x1f4,_0x5eee46:0x226},_0x2e1c0f={_0x1dbf4d:0x1f6,_0x108c29:0x1df,_0x244110:0x201},_0x21f63d=_0x3cf2e8,_0x5b2828=this['_positions'],_0x15fda1=[];let _0x5b3ba9,_0x299607,_0x532897,_0xe17b73;_0x5b2828['forEach'](_0x2a91af=>{const _0x1e52fa=_0x2a3e,_0x2de4e2=mars3d__namespace['LngLatPoint']['parse'](_0x2a91af);if(!_0x2de4e2)return;_0x2de4e2['value']=_0x2a91af['value']||0x1,!this[_0x1e52fa(_0x2e1c0f._0x1dbf4d)]['rectangle']&&(_0x5b3ba9===undefined?(_0x5b3ba9=_0x2de4e2['lng'],_0x299607=_0x2de4e2[_0x1e52fa(0x21f)],_0x532897=_0x2de4e2['lat'],_0xe17b73=_0x2de4e2[_0x1e52fa(_0x2e1c0f._0x108c29)]):(_0x5b3ba9=Math['min'](_0x5b3ba9,_0x2de4e2['lng']),_0x299607=Math['max'](_0x299607,_0x2de4e2['lng']),_0x532897=Math[_0x1e52fa(_0x2e1c0f._0x244110)](_0x532897,_0x2de4e2['lat']),_0xe17b73=Math['max'](_0xe17b73,_0x2de4e2['lat']))),_0x15fda1['push'](_0x2de4e2);});_0x5b3ba9===_0x299607&&(_0x5b3ba9-=0.000001,_0x299607+=0.000001);_0x532897===_0xe17b73&&(_0x532897-=0.000001,_0xe17b73+=0.000001);let _0x16e2da=this['options']['rectangle']||{'xmin':_0x5b3ba9,'xmax':_0x299607,'ymin':_0x532897,'ymax':_0xe17b73};const _0x38bae1=getMercatorBounds(_0x16e2da),_0x491490=Math[_0x21f63d(_0x5503f4._0x163576)](_0x38bae1['xmax']-_0x38bae1['xmin']),_0x144eb6=Math['abs'](_0x38bae1[_0x21f63d(0x213)]-_0x38bae1[_0x21f63d(0x222)]),_0x357fdf=Math['max'](_0x491490,_0x144eb6),_0x1c3426=Math[_0x21f63d(0x201)](_0x491490,_0x144eb6);this[_0x21f63d(0x1d3)]=_0x357fdf;let _0x4ed8da=0x1;if(_0x357fdf>this['options']['maxCanvasSize'])_0x4ed8da=_0x357fdf/this['options']['maxCanvasSize'],_0x1c3426/_0x4ed8da<this[_0x21f63d(0x1f6)][_0x21f63d(_0x5503f4._0x274a94)]&&(_0x4ed8da=_0x1c3426/this['options'][_0x21f63d(_0x5503f4._0x5094bf)]);else _0x1c3426<this['options'][_0x21f63d(_0x5503f4._0xea2e82)]&&(_0x4ed8da=_0x1c3426/this['options']['minCanvasSize'],_0x357fdf/_0x4ed8da>this[_0x21f63d(0x1f6)]['maxCanvasSize']&&(_0x4ed8da=_0x357fdf/this[_0x21f63d(_0x5503f4._0x510f71)]['maxCanvasSize']));const _0x3e4f94=this['heatStyle']['radius']*1.5,_0x5c6ef5=_0x491490/_0x4ed8da+_0x3e4f94*0x2,_0x43e5ae=_0x144eb6/_0x4ed8da+_0x3e4f94*0x2,_0x1dad71=_0x3e4f94*_0x4ed8da;_0x38bae1['xmin']-=_0x1dad71,_0x38bae1['ymin']-=_0x1dad71,_0x38bae1['xmax']+=_0x1dad71,_0x38bae1['ymax']+=_0x1dad71,this[_0x21f63d(_0x5503f4._0xd8c8ac)]=_0x4ed8da,_0x16e2da=geLatLngBounds(_0x38bae1),this['_rectangle']=Cesium['Rectangle']['fromDegrees'](_0x16e2da['xmin'],_0x16e2da[_0x21f63d(0x222)],_0x16e2da['xmax'],_0x16e2da['ymax']);let _0x333ea3=_0x15fda1[0x0][_0x21f63d(_0x5503f4._0x257f42)]??0x1,_0x44cb75=_0x15fda1[0x0][_0x21f63d(_0x5503f4._0x257f42)]??0x0;const _0x5f1fb2=[];_0x15fda1[_0x21f63d(_0x5503f4._0x3c8882)](_0x3f552a=>{const _0x4e4562=_0x21f63d,_0x2cd79f=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x3f552a['lng'],_0x3f552a['lat']]),_0x4ced1e=_0x3f552a[_0x4e4562(_0x4b36ca._0x490a86)]||0x1,_0x57de05=Math['round']((_0x2cd79f[0x0]-_0x38bae1[_0x4e4562(_0x4b36ca._0x5eee46)])/_0x4ed8da),_0x5c3dea=Math['round']((_0x38bae1['ymax']-_0x2cd79f[0x1])/_0x4ed8da);_0x333ea3=Math[_0x4e4562(0x20e)](_0x333ea3,_0x4ced1e),_0x44cb75=Math['min'](_0x44cb75,_0x4ced1e),_0x5f1fb2['push']({'x':_0x57de05,'y':_0x5c3dea,'value':_0x4ced1e});});const _0x2d5d3b={'min':this['options'][_0x21f63d(0x201)]??_0x44cb75,'max':this['options']['max']??_0x333ea3,'data':_0x5f1fb2};this['_last_heatData']=_0x2d5d3b;if(!this['_last_mBounds']||_0x38bae1['xmin']!==this['_last_mBounds']['xmin']||_0x38bae1[_0x21f63d(0x222)]!==this[_0x21f63d(0x1ee)]['ymin']||_0x38bae1['xmax']!==this['_last_mBounds']['xmax']||_0x38bae1['ymax']!==this['_last_mBounds'][_0x21f63d(0x213)]){this[_0x21f63d(_0x5503f4._0x52e088)]=_0x38bae1,this[_0x21f63d(0x1eb)][_0x21f63d(_0x5503f4._0x53c3be)]['cssText']='width:'+_0x5c6ef5+'px;height:'+_0x43e5ae+'px;';const _0x24cb0a={...this[_0x21f63d(_0x5503f4._0x5c4998)],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x24cb0a):this['_heat']['configure'](_0x24cb0a);}this[_0x21f63d(0x20f)][_0x21f63d(0x1db)](_0x2d5d3b);const _0xf6c538=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x21f63d(0x20f)]['_renderer']['canvas']);return _0xf6c538;}['_getArcHeatCanvas'](){const _0x3efdc9={_0x10a7ab:0x21e,_0x5ea2e2:0x205,_0x5dc509:0x1f9,_0x116f8d:0x219,_0x3e180d:0x216,_0x532ff6:0x1d1,_0x28f71a:0x21e},_0x251b61=_0x3cf2e8;this[_0x251b61(0x20f)][_0x251b61(_0x3efdc9._0x10a7ab)]({'radius':this['heatStyle']['radius']*this['style'][_0x251b61(0x1d9)],'blur':this['heatStyle'][_0x251b61(_0x3efdc9._0x5ea2e2)]*this['style'][_0x251b61(_0x3efdc9._0x5dc509)],'gradient':this['heatStyle']['gradientArc']||{0.25:_0x251b61(_0x3efdc9._0x116f8d),0.55:'rgb(140,140,140)',0.85:_0x251b61(_0x3efdc9._0x3e180d),0x1:_0x251b61(_0x3efdc9._0x532ff6)}});const _0x17e5bd=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer'][_0x251b61(0x1e6)]);return this['_heat'][_0x251b61(_0x3efdc9._0x28f71a)](this['options']['heatStyle']),_0x17e5bd;}['getPointData'](_0x309c80){const _0x2c1715={_0x1a9322:0x227,_0xca944b:0x1fe},_0x1b4fbc=_0x3cf2e8,_0x3f0080=mars3d__namespace['LngLatPoint'][_0x1b4fbc(0x1e3)](_0x309c80);if(!_0x3f0080)return{};const _0x170499=mars3d__namespace['PointTrans'][_0x1b4fbc(0x211)]([_0x3f0080['lng'],_0x3f0080['lat']]),_0x296f7b=this['_last_mBounds'],_0x39a931=Math['round']((_0x170499[0x0]-_0x296f7b['xmin'])/this[_0x1b4fbc(0x1f1)]),_0x2f2195=Math[_0x1b4fbc(_0x2c1715._0x1a9322)]((_0x296f7b['ymax']-_0x170499[0x1])/this['_scale']),_0x4509d4=this[_0x1b4fbc(0x20f)]['getValueAt']({'x':_0x39a931,'y':_0x2f2195}),_0x4c14f5=this['_heat']['_renderer'][_0x1b4fbc(0x207)][_0x1b4fbc(_0x2c1715._0xca944b)](_0x39a931-0x1,_0x2f2195-0x1,0x1,0x1)['data'];return{'x':_0x39a931,'y':_0x2f2195,'value':_0x4509d4,'color':'rgba('+_0x4c14f5[0x0]+','+_0x4c14f5[0x1]+','+_0x4c14f5[0x2]+','+_0x4c14f5[0x3]+')'};}}function _0x2a3e(_0x2f2b36,_0x46522f){const _0x2cdcc4=_0x2cdc();return _0x2a3e=function(_0x2a3e49,_0x1ad533){_0x2a3e49=_0x2a3e49-0x1cb;let _0x59c72f=_0x2cdcc4[_0x2a3e49];return _0x59c72f;},_0x2a3e(_0x2f2b36,_0x46522f);}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace[_0x3cf2e8(0x215)][_0x3cf2e8(0x1d0)]=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x42d14b){const _0x3a0fe3={_0x2dd379:0x211,_0x4f3fab:0x213},_0x37b7df=_0x3cf2e8,_0x3bc110=mars3d__namespace['PointTrans'][_0x37b7df(_0x3a0fe3._0x2dd379)]([_0x42d14b['xmin'],_0x42d14b['ymin']]),_0x599416=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x42d14b['xmax'],_0x42d14b[_0x37b7df(_0x3a0fe3._0x4f3fab)]]);return{'xmin':_0x3bc110[0x0],'ymin':_0x3bc110[0x1],'xmax':_0x599416[0x0],'ymax':_0x599416[0x1]};}function geLatLngBounds(_0xd61858){const _0x2a998f={_0x3eea9e:0x1d2,_0x3c13b9:0x1fb},_0x16313f=_0x3cf2e8,_0x3eb3ae=mars3d__namespace[_0x16313f(_0x2a998f._0x3eea9e)][_0x16313f(_0x2a998f._0x3c13b9)]([_0xd61858['xmin'],_0xd61858['ymin']]),_0x196471=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xd61858[_0x16313f(0x1cc)],_0xd61858['ymax']]);return{'xmin':_0x3eb3ae[0x0],'ymin':_0x3eb3ae[0x1],'xmax':_0x196471[0x0],'ymax':_0x196471[0x1]};}function getVertexShaderSource(_0x42aa40){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x42aa40+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object[_0x3cf2e8(0x1f3)](exports,_0x3cf2e8(0x223),{'value':!![]});
}));
