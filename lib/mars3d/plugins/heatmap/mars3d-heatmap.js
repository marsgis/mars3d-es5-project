/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.7.5
 * 编译日期：2024-03-05 20:10:38
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d'))) :
	typeof define === 'function' && define.amd ? define(['exports', 'mars3d'], factory) :
	(global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d));
})(this, (function (exports, mars3d) { 
'use strict';var _0x3e9d5b=_0x193e;(function(_0x441de2,_0x4d4f99){var _0x588f08={_0x2d1df2:0x15f,_0x24ec3b:0x16b,_0x6402a9:0x10f,_0x2453da:0x167,_0x274932:0x161,_0x15d5a1:0xeb,_0xfe8a41:0x10c},_0x48b883=_0x193e,_0x157962=_0x441de2();while(!![]){try{var _0x1c5b80=-parseInt(_0x48b883(_0x588f08._0x2d1df2))/0x1+-parseInt(_0x48b883(_0x588f08._0x24ec3b))/0x2*(-parseInt(_0x48b883(_0x588f08._0x6402a9))/0x3)+parseInt(_0x48b883(_0x588f08._0x2453da))/0x4*(-parseInt(_0x48b883(0xff))/0x5)+parseInt(_0x48b883(_0x588f08._0x274932))/0x6+-parseInt(_0x48b883(0x152))/0x7+-parseInt(_0x48b883(_0x588f08._0x15d5a1))/0x8*(parseInt(_0x48b883(0xea))/0x9)+parseInt(_0x48b883(_0x588f08._0xfe8a41))/0xa;if(_0x1c5b80===_0x4d4f99)break;else _0x157962['push'](_0x157962['shift']());}catch(_0x415951){_0x157962['push'](_0x157962['shift']());}}}(_0x112d,0xb9797));function _0x112d(){var _0x5ea6a4=['lat','body','_height','heat','_palette','__esModule','create','clearRect','createElement','_updateGradient','toDataURL','max','_max','removeGraphic','options','_last_mBounds','getValueAt','uniforms','_store','_min','rectangle','graphic','addGraphic','xmin','appendChild','fromCache','_updatePositionsHook','shadowCtx','_mountedHook','formatRectangle','_getArcHeatCanvas','defaultMinOpacity','_organiseData','GraphicLayer','copyCanvas','shadowCanvas','getOwnPropertyDescriptor','EllipsoidSurfaceAppearance','cStore','style','StencilOperation','_unOrganizeData','_renderBoundaries','LayerUtil','setCoordinator','configure','maxCanvasSize','_width','plugins','setDataMax','extremachange','setData','_container','9788492SeckoB','Util','length','getImageData','abs','rgba(','apply','minOpacity','_last_heatData','px;','string','_scale','defineProperty','520604ukCEcQ','createMaterial','2599512BFlxtF','_templates','rgba(0,0,0,1)','PointTrans','ymin','forEach','6004qglRvd','keys','renderAll','height','230MRJwmR','BaseLayer','undefined','round','_setStyles','_positions','_valueField','_maxOpacity','RenderState','parse','_heat','arcDirection','xField','min','coordinates','_graphic','546849gvXHds','64PBnWMG','_config','_map','clear','lonlat2mercator','valueField','xmax','emit','image','defaultRenderer','width','ymax','merge','_coordinator','heatStyle','REPLACE','value','rgb(140,140,140)','_layer','lng','495PrMpXF','addData','_opacity','_renderer','cssText','data','default','_drawAlpha','updateConfig','_rectangle','StencilFunction','canvas','removeData','23723730wZkUaj','prototype','call','13245VHhiAw','_graphic2','_getInternalData','_removedHook','push','bumpMap','minCanvasSize','addColorStop','DomUtil','positions','setDataMin','ctx','RectanglePrimitive','_createArcGraphic'];_0x112d=function(){return _0x5ea6a4;};return _0x112d();}function _interopNamespace(_0x4f8930){var _0x5e9653={_0x49f1bf:0x122},_0x59ce30=_0x193e;if(_0x4f8930&&_0x4f8930[_0x59ce30(_0x5e9653._0x49f1bf)])return _0x4f8930;var _0x5debd9=Object['create'](null);return _0x4f8930&&Object['keys'](_0x4f8930)['forEach'](function(_0x51abcb){var _0x56cdc9=_0x59ce30;if(_0x51abcb!==_0x56cdc9(0x105)){var _0x348bf4=Object['getOwnPropertyDescriptor'](_0x4f8930,_0x51abcb);Object['defineProperty'](_0x5debd9,_0x51abcb,_0x348bf4['get']?_0x348bf4:{'enumerable':!![],'get':function(){return _0x4f8930[_0x51abcb];}});}}),_0x5debd9[_0x59ce30(0x105)]=_0x4f8930,_0x5debd9;}function _mergeNamespaces(_0x311753,_0x477ef9){return _0x477ef9['forEach'](function(_0x2d55f1){var _0x42142e={_0x128de9:0x141},_0x50b0c8=_0x193e;_0x2d55f1&&typeof _0x2d55f1!==_0x50b0c8(0x15c)&&!Array['isArray'](_0x2d55f1)&&Object['keys'](_0x2d55f1)['forEach'](function(_0xa97de3){var _0x35485b=_0x50b0c8;if(_0xa97de3!==_0x35485b(0x105)&&!(_0xa97de3 in _0x311753)){var _0x327267=Object[_0x35485b(_0x42142e._0x128de9)](_0x2d55f1,_0xa97de3);Object[_0x35485b(0x15e)](_0x311753,_0xa97de3,_0x327267['get']?_0x327267:{'enumerable':!![],'get':function(){return _0x2d55f1[_0xa97de3];}});}});}),_0x311753;}var mars3d__namespace=_interopNamespace(mars3d),commonjsGlobal=typeof globalThis!==_0x3e9d5b(0x16d)?globalThis:typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{},heatmap$1={'exports':{}};(function(_0xeda3d4){var _0x306db5={_0x506cbd:0x10d};(function(_0x4e2eab,_0x64da07,_0x69f40e){_0xeda3d4['exports']?_0xeda3d4['exports']=_0x69f40e():_0x64da07[_0x4e2eab]=_0x69f40e();}('h337',commonjsGlobal,function(){var _0x34441d={_0xeebbb0:0x119},_0x59199e={_0x31c1c2:0x150,_0x115870:0x158},_0x3cc381={_0x462655:0x100,_0x35885f:0x158},_0x161e2a={_0x1d1674:0x14d},_0x5a5f87={_0x4d6488:0x12f},_0x562906={_0x7c586f:0xf4},_0x3d9957={_0x2588c7:0x147},_0x372bff={_0x41dcfa:0x121},_0x1f3f43={_0x1345df:0x16a,_0x22bd32:0x116},_0x2dd0cc={_0x4b9746:0xf2},_0x1cbeb3={_0x5a11db:0x129},_0x117825={_0x404f9b:0xfb,_0x4ced7c:0xf8,_0x1e2797:0x129},_0x34f8d8={_0x4c1fd8:0x14f},_0x3da09e={_0x5c9d82:0x113},_0x5aae4={_0x34bdbf:0x171},_0x43ce43=_0x193e,_0x22395c={'defaultRadius':0x28,'defaultRenderer':'canvas2d','defaultGradient':{0.25:'rgb(0,0,255)',0.55:'rgb(0,255,0)',0.85:'yellow',0x1:'rgb(255,0,0)'},'defaultMaxOpacity':0x1,'defaultMinOpacity':0x0,'defaultBlur':0.85,'defaultXField':'x','defaultYField':'y','defaultValueField':_0x43ce43(0xfb),'plugins':{}},_0xcdbec9=function _0x8acb44(){var _0x106293={_0x18fa8a:0xf0},_0x1e9d7b=_0x43ce43,_0x49bd7b=function _0x57dadf(_0x4bfbc7){var _0x3e937a=_0x193e;this['_coordinator']={},this['_data']=[],this['_radi']=[],this['_min']=0xa,this['_max']=0x1,this['_xField']=_0x4bfbc7[_0x3e937a(0x177)]||_0x4bfbc7['defaultXField'],this['_yField']=_0x4bfbc7['yField']||_0x4bfbc7['defaultYField'],this['_valueField']=_0x4bfbc7[_0x3e937a(_0x106293._0x18fa8a)]||_0x4bfbc7['defaultValueField'],_0x4bfbc7['radius']&&(this['_cfgRadius']=_0x4bfbc7['radius']);},_0x49736b=_0x22395c['defaultRadius'];return _0x49bd7b[_0x1e9d7b(0x10d)]={'_organiseData':function(_0x4ad30b,_0x4d859a){var _0x5637b8=_0x1e9d7b,_0x34e25f=_0x4ad30b[this['_xField']],_0x7a2eff=_0x4ad30b[this['_yField']],_0x6991b6=this['_radi'],_0x2020a2=this['_data'],_0x3692b2=this['_max'],_0x1249b4=this['_min'],_0x45240b=_0x4ad30b[this[_0x5637b8(_0x5aae4._0x34bdbf)]]||0x1,_0x498777=_0x4ad30b['radius']||this['_cfgRadius']||_0x49736b;!_0x2020a2[_0x34e25f]&&(_0x2020a2[_0x34e25f]=[],_0x6991b6[_0x34e25f]=[]);!_0x2020a2[_0x34e25f][_0x7a2eff]?(_0x2020a2[_0x34e25f][_0x7a2eff]=_0x45240b,_0x6991b6[_0x34e25f][_0x7a2eff]=_0x498777):_0x2020a2[_0x34e25f][_0x7a2eff]+=_0x45240b;var _0x3368f3=_0x2020a2[_0x34e25f][_0x7a2eff];if(_0x3368f3>_0x3692b2)return!_0x4d859a?this['_max']=_0x3368f3:this[_0x5637b8(0x14e)](_0x3368f3),![];else return _0x3368f3<_0x1249b4?(!_0x4d859a?this['_min']=_0x3368f3:this['setDataMin'](_0x3368f3),![]):{'x':_0x34e25f,'y':_0x7a2eff,'value':_0x45240b,'radius':_0x498777,'min':_0x1249b4,'max':_0x3692b2};},'_unOrganizeData':function(){var _0x9c664e=_0x1e9d7b,_0x39998d=[],_0x2418f5=this['_data'],_0x3c29db=this['_radi'];for(var _0x3d9e71 in _0x2418f5){for(var _0x42fc57 in _0x2418f5[_0x3d9e71]){_0x39998d[_0x9c664e(_0x3da09e._0x5c9d82)]({'x':_0x3d9e71,'y':_0x42fc57,'radius':_0x3c29db[_0x3d9e71][_0x42fc57],'value':_0x2418f5[_0x3d9e71][_0x42fc57]});}}return{'min':this['_min'],'max':this[_0x9c664e(0x129)],'data':_0x39998d};},'_onExtremaChange':function(){var _0x2ef025=_0x1e9d7b;this['_coordinator'][_0x2ef025(0xf2)](_0x2ef025(_0x34f8d8._0x4c1fd8),{'min':this['_min'],'max':this['_max']});},'addData':function(){var _0x2195c2=_0x1e9d7b;if(arguments[0x0]['length']>0x0){var _0x42ccec=arguments[0x0],_0x53b3f0=_0x42ccec['length'];while(_0x53b3f0--){this[_0x2195c2(0x100)]['call'](this,_0x42ccec[_0x53b3f0]);}}else{var _0x47aa1e=this[_0x2195c2(0x13d)](arguments[0x0],!![]);_0x47aa1e&&(this['_data']['length']===0x0&&(this['_min']=this['_max']=_0x47aa1e[_0x2195c2(_0x117825._0x404f9b)]),this[_0x2195c2(_0x117825._0x4ced7c)]['emit']('renderpartial',{'min':this['_min'],'max':this[_0x2195c2(_0x117825._0x1e2797)],'data':[_0x47aa1e]}));}return this;},'setData':function(_0x2132b8){var _0x478af4=_0x1e9d7b,_0x219b93=_0x2132b8['data'],_0x1a74f5=_0x219b93['length'];this['_data']=[],this['_radi']=[];for(var _0x5b5f86=0x0;_0x5b5f86<_0x1a74f5;_0x5b5f86++){this[_0x478af4(0x13d)](_0x219b93[_0x5b5f86],![]);}return this[_0x478af4(_0x1cbeb3._0x5a11db)]=_0x2132b8['max'],this['_min']=_0x2132b8['min']||0x0,this['_onExtremaChange'](),this[_0x478af4(0xf8)][_0x478af4(0xf2)]('renderall',this['_getInternalData']()),this;},'removeData':function(){},'setDataMax':function(_0x436a66){var _0x1f53b7=_0x1e9d7b;return this['_max']=_0x436a66,this['_onExtremaChange'](),this['_coordinator'][_0x1f53b7(_0x2dd0cc._0x4b9746)]('renderall',this['_getInternalData']()),this;},'setDataMin':function(_0x1eaadb){var _0x780b48=_0x1e9d7b;return this['_min']=_0x1eaadb,this['_onExtremaChange'](),this[_0x780b48(0xf8)]['emit']('renderall',this['_getInternalData']()),this;},'setCoordinator':function(_0x4a3c0b){this['_coordinator']=_0x4a3c0b;},'_getInternalData':function(){return{'max':this['_max'],'min':this['_min'],'data':this['_data'],'radi':this['_radi']};},'getData':function(){var _0x40e293=_0x1e9d7b;return this[_0x40e293(0x146)]();}},_0x49bd7b;}(),_0x346272=function _0x5661e3(){var _0x5d5d9b={_0x54caea:0x155,_0x3320c7:0x104,_0x56ce7b:0x130},_0x4bfd3d={_0x38c78d:0x147,_0x16c3de:0x101,_0x310a8b:0x138,_0x4c379b:0x121},_0x544d10={_0x25897a:0x14c,_0x144682:0x159},_0x5dd767={_0x25f85b:0x124},_0x1836fc={_0x554fc0:0xf5,_0x27b810:0xf5},_0x3840f6={_0x34caf7:0x106},_0xb87ad7={_0x4704e2:0x10a,_0x316a02:0x16a,_0x52b85c:0x103,_0x314bb0:0x144,_0x4c0b98:0x162},_0x17621a={_0x4a5c40:0x168,_0x4504df:0x154},_0x5c811f={_0x1f0a98:0x125,_0x20b6c2:0x16a},_0x375a51=function(_0x10d8f5){var _0x4c647b=_0x193e,_0x4212d9=_0x10d8f5['gradient']||_0x10d8f5['defaultGradient'],_0x44e932=document[_0x4c647b(_0x5c811f._0x1f0a98)]('canvas'),_0x5aaed5=_0x44e932['getContext']('2d',{'willReadFrequently':!![]});_0x44e932['width']=0x100,_0x44e932[_0x4c647b(_0x5c811f._0x20b6c2)]=0x1;var _0x3f8855=_0x5aaed5['createLinearGradient'](0x0,0x0,0x100,0x1);for(var _0x33e04b in _0x4212d9){_0x3f8855['addColorStop'](_0x33e04b,_0x4212d9[_0x33e04b]);}return _0x5aaed5['fillStyle']=_0x3f8855,_0x5aaed5['fillRect'](0x0,0x0,0x100,0x1),_0x5aaed5['getImageData'](0x0,0x0,0x100,0x1)['data'];},_0x5967f9=function(_0x1bff7b,_0xcccf28){var _0x5064eb=_0x193e,_0x39d320=document['createElement']('canvas'),_0x215912=_0x39d320['getContext']('2d',{'willReadFrequently':!![]}),_0x4260cd=_0x1bff7b,_0x338890=_0x1bff7b;_0x39d320['width']=_0x39d320[_0x5064eb(_0x1f3f43._0x1345df)]=_0x1bff7b*0x2;if(_0xcccf28==0x1)_0x215912['beginPath'](),_0x215912['arc'](_0x4260cd,_0x338890,_0x1bff7b,0x0,0x2*Math['PI'],![]),_0x215912['fillStyle']=_0x5064eb(0x163),_0x215912['fill']();else{var _0x8479b8=_0x215912['createRadialGradient'](_0x4260cd,_0x338890,_0x1bff7b*_0xcccf28,_0x4260cd,_0x338890,_0x1bff7b);_0x8479b8[_0x5064eb(_0x1f3f43._0x22bd32)](0x0,'rgba(0,0,0,1)'),_0x8479b8[_0x5064eb(0x116)](0x1,'rgba(0,0,0,0)'),_0x215912['fillStyle']=_0x8479b8,_0x215912['fillRect'](0x0,0x0,0x2*_0x1bff7b,0x2*_0x1bff7b);}return _0x39d320;},_0x1e4af2=function(_0x1b3194){var _0x6339b8=_0x193e,_0x1d998d=[],_0x44f63d=_0x1b3194[_0x6339b8(0xe7)],_0xecb89f=_0x1b3194['max'],_0x4c0933=_0x1b3194['radi'],_0x1b3194=_0x1b3194['data'],_0x10ce38=Object[_0x6339b8(0x168)](_0x1b3194),_0x6e8d8c=_0x10ce38['length'];while(_0x6e8d8c--){var _0x8fc6c5=_0x10ce38[_0x6e8d8c],_0x3a9624=Object[_0x6339b8(_0x17621a._0x4a5c40)](_0x1b3194[_0x8fc6c5]),_0x37d412=_0x3a9624[_0x6339b8(_0x17621a._0x4504df)];while(_0x37d412--){var _0x464553=_0x3a9624[_0x37d412],_0x4e0c9d=_0x1b3194[_0x8fc6c5][_0x464553],_0x356315=_0x4c0933[_0x8fc6c5][_0x464553];_0x1d998d['push']({'x':_0x8fc6c5,'y':_0x464553,'value':_0x4e0c9d,'radius':_0x356315});}}return{'min':_0x44f63d,'max':_0xecb89f,'data':_0x1d998d};};function _0x4c21dd(_0x518e8c){var _0x543efe=_0x193e,_0x5542ad=_0x518e8c['container'],_0x240e4a=this['shadowCanvas']=document['createElement']('canvas'),_0x3afb93=this['canvas']=_0x518e8c['canvas']||document[_0x543efe(0x125)](_0x543efe(_0xb87ad7._0x4704e2));this['_renderBoundaries']=[0x2710,0x2710,0x0,0x0];var _0x4a5f85=getComputedStyle(_0x518e8c['container'])||{};_0x3afb93['className']='heatmap-canvas',this['_width']=_0x3afb93['width']=_0x240e4a['width']=_0x518e8c['width']||+_0x4a5f85[_0x543efe(0xf5)]['replace'](/px/,''),this[_0x543efe(0x11f)]=_0x3afb93[_0x543efe(_0xb87ad7._0x316a02)]=_0x240e4a['height']=_0x518e8c['height']||+_0x4a5f85['height']['replace'](/px/,''),this['shadowCtx']=_0x240e4a['getContext']('2d',{'willReadFrequently':!![]}),this['ctx']=_0x3afb93['getContext']('2d',{'willReadFrequently':!![]}),_0x3afb93['style'][_0x543efe(_0xb87ad7._0x52b85c)]=_0x240e4a['style']['cssText']='position:absolute;left:0;top:0;',_0x5542ad[_0x543efe(_0xb87ad7._0x314bb0)]['position']='relative',_0x5542ad[_0x543efe(0x135)](_0x3afb93),this['_palette']=_0x375a51(_0x518e8c),this[_0x543efe(_0xb87ad7._0x4c0b98)]={},this[_0x543efe(0x16f)](_0x518e8c);}return _0x4c21dd['prototype']={'renderPartial':function(_0x137e7d){var _0x30cea4=_0x193e;_0x137e7d['data']['length']>0x0&&(this[_0x30cea4(_0x3840f6._0x34caf7)](_0x137e7d),this['_colorize']());},'renderAll':function(_0x3d059a){var _0x239b53=_0x193e;this['_clear'](),_0x3d059a['data']['length']>0x0&&(this[_0x239b53(0x106)](_0x1e4af2(_0x3d059a)),this['_colorize']());},'_updateGradient':function(_0x316214){var _0x563258=_0x193e;this[_0x563258(_0x372bff._0x41dcfa)]=_0x375a51(_0x316214);},'updateConfig':function(_0x18920b){var _0x5a8698=_0x193e;_0x18920b['gradient']&&this[_0x5a8698(0x126)](_0x18920b),this[_0x5a8698(0x16f)](_0x18920b);},'setDimensions':function(_0x153311,_0x98ed43){var _0x3e7ae9=_0x193e;this['_width']=_0x153311,this[_0x3e7ae9(0x11f)]=_0x98ed43,this['canvas'][_0x3e7ae9(_0x1836fc._0x554fc0)]=this['shadowCanvas'][_0x3e7ae9(_0x1836fc._0x27b810)]=_0x153311,this['canvas']['height']=this['shadowCanvas'][_0x3e7ae9(0x16a)]=_0x98ed43;},'_clear':function(){var _0x2b47ec=_0x193e;this['shadowCtx']['clearRect'](0x0,0x0,this[_0x2b47ec(0x14c)],this[_0x2b47ec(0x11f)]),this['ctx'][_0x2b47ec(_0x5dd767._0x25f85b)](0x0,0x0,this['_width'],this[_0x2b47ec(0x11f)]);},'_setStyles':function(_0x242a3f){var _0x4f85ef=_0x193e;this['_blur']=_0x242a3f['blur']==0x0?0x0:_0x242a3f['blur']||_0x242a3f['defaultBlur'],_0x242a3f['backgroundColor']&&(this['canvas']['style']['backgroundColor']=_0x242a3f['backgroundColor']),this[_0x4f85ef(_0x544d10._0x25897a)]=this['canvas']['width']=this[_0x4f85ef(0x140)]['width']=_0x242a3f[_0x4f85ef(0xf5)]||this['_width'],this[_0x4f85ef(0x11f)]=this[_0x4f85ef(0x10a)]['height']=this['shadowCanvas']['height']=_0x242a3f[_0x4f85ef(0x16a)]||this['_height'],this['_opacity']=(_0x242a3f['opacity']||0x0)*0xff,this['_maxOpacity']=(_0x242a3f['maxOpacity']||_0x242a3f['defaultMaxOpacity'])*0xff,this['_minOpacity']=(_0x242a3f[_0x4f85ef(_0x544d10._0x144682)]||_0x242a3f[_0x4f85ef(0x13c)])*0xff,this['_useGradientOpacity']=!!_0x242a3f['useGradientOpacity'];},'_drawAlpha':function(_0x18d22e){var _0xcd403d=_0x193e,_0x370feb=this['_min']=_0x18d22e['min'],_0x52896d=this['_max']=_0x18d22e['max'],_0x18d22e=_0x18d22e['data']||[],_0x1a439b=_0x18d22e['length'],_0x152f94=0x1-this['_blur'];while(_0x1a439b--){var _0x294db5=_0x18d22e[_0x1a439b],_0x28f36b=_0x294db5['x'],_0x2c6c22=_0x294db5['y'],_0x2c8c2b=_0x294db5['radius'],_0x3a456b=Math['min'](_0x294db5['value'],_0x52896d),_0x310510=_0x28f36b-_0x2c8c2b,_0xb5aa4=_0x2c6c22-_0x2c8c2b,_0x5c6e73=this['shadowCtx'],_0x4ec714;!this['_templates'][_0x2c8c2b]?this['_templates'][_0x2c8c2b]=_0x4ec714=_0x5967f9(_0x2c8c2b,_0x152f94):_0x4ec714=this['_templates'][_0x2c8c2b];var _0x135e06=(_0x3a456b-_0x370feb)/(_0x52896d-_0x370feb);_0x5c6e73['globalAlpha']=_0x135e06<0.01?0.01:_0x135e06,_0x5c6e73['drawImage'](_0x4ec714,_0x310510,_0xb5aa4),_0x310510<this['_renderBoundaries'][0x0]&&(this['_renderBoundaries'][0x0]=_0x310510),_0xb5aa4<this['_renderBoundaries'][0x1]&&(this['_renderBoundaries'][0x1]=_0xb5aa4),_0x310510+0x2*_0x2c8c2b>this[_0xcd403d(_0x3d9957._0x2588c7)][0x2]&&(this[_0xcd403d(_0x3d9957._0x2588c7)][0x2]=_0x310510+0x2*_0x2c8c2b),_0xb5aa4+0x2*_0x2c8c2b>this['_renderBoundaries'][0x3]&&(this['_renderBoundaries'][0x3]=_0xb5aa4+0x2*_0x2c8c2b);}},'_colorize':function(){var _0x2c63d3=_0x193e,_0x3f1e38=this[_0x2c63d3(_0x4bfd3d._0x38c78d)][0x0],_0x28fa6a=this['_renderBoundaries'][0x1],_0x27dac6=this['_renderBoundaries'][0x2]-_0x3f1e38,_0x57bf26=this[_0x2c63d3(0x147)][0x3]-_0x28fa6a,_0x3df50b=this['_width'],_0x510c8d=this[_0x2c63d3(0x11f)],_0xfbe174=this[_0x2c63d3(_0x4bfd3d._0x16c3de)],_0x38e333=this[_0x2c63d3(0x172)],_0x18fdf6=this['_minOpacity'],_0x11bc3b=this['_useGradientOpacity'];_0x3f1e38<0x0&&(_0x3f1e38=0x0);_0x28fa6a<0x0&&(_0x28fa6a=0x0);_0x3f1e38+_0x27dac6>_0x3df50b&&(_0x27dac6=_0x3df50b-_0x3f1e38);_0x28fa6a+_0x57bf26>_0x510c8d&&(_0x57bf26=_0x510c8d-_0x28fa6a);var _0x4e9f69=this[_0x2c63d3(_0x4bfd3d._0x310a8b)]['getImageData'](_0x3f1e38,_0x28fa6a,_0x27dac6,_0x57bf26),_0x1d9bd3=_0x4e9f69['data'],_0x5762f6=_0x1d9bd3[_0x2c63d3(0x154)],_0x56af57=this[_0x2c63d3(_0x4bfd3d._0x4c379b)];for(var _0x4418bc=0x3;_0x4418bc<_0x5762f6;_0x4418bc+=0x4){var _0x26729a=_0x1d9bd3[_0x4418bc],_0x3a2d0b=_0x26729a*0x4;if(!_0x3a2d0b)continue;var _0x2e0321;_0xfbe174>0x0?_0x2e0321=_0xfbe174:_0x26729a<_0x38e333?_0x26729a<_0x18fdf6?_0x2e0321=_0x18fdf6:_0x2e0321=_0x26729a:_0x2e0321=_0x38e333,_0x1d9bd3[_0x4418bc-0x3]=_0x56af57[_0x3a2d0b],_0x1d9bd3[_0x4418bc-0x2]=_0x56af57[_0x3a2d0b+0x1],_0x1d9bd3[_0x4418bc-0x1]=_0x56af57[_0x3a2d0b+0x2],_0x1d9bd3[_0x4418bc]=_0x11bc3b?_0x56af57[_0x3a2d0b+0x3]:_0x2e0321;}this[_0x2c63d3(0x11a)]['putImageData'](_0x4e9f69,_0x3f1e38,_0x28fa6a),this['_renderBoundaries']=[0x3e8,0x3e8,0x0,0x0];},'getValueAt':function(_0x444533){var _0x41f007=_0x193e,_0x4748f6,_0x4cad74=this['shadowCtx'],_0x218c37=_0x4cad74[_0x41f007(_0x5d5d9b._0x54caea)](_0x444533['x'],_0x444533['y'],0x1,0x1),_0x4b662e=_0x218c37[_0x41f007(_0x5d5d9b._0x3320c7)][0x3],_0x4c3556=this['_max'],_0x412b73=this[_0x41f007(_0x5d5d9b._0x56ce7b)];return _0x4748f6=Math['abs'](_0x4c3556-_0x412b73)*(_0x4b662e/0xff)>>0x0,_0x4748f6;},'getDataURL':function(){return this['canvas']['toDataURL']();}},_0x4c21dd;}(),_0x5e8493=function _0x12454a(){var _0x125966=_0x43ce43,_0x480a3f=![];return _0x22395c[_0x125966(_0x562906._0x7c586f)]==='canvas2d'&&(_0x480a3f=_0x346272),_0x480a3f;}(),_0xf8dbf6={'merge':function(){var _0x3bd11f={},_0x2d99ab=arguments['length'];for(var _0x5c0814=0x0;_0x5c0814<_0x2d99ab;_0x5c0814++){var _0x268511=arguments[_0x5c0814];for(var _0x523419 in _0x268511){_0x3bd11f[_0x523419]=_0x268511[_0x523419];}}return _0x3bd11f;}},_0x1ab77d=function _0x24c412(){var _0x39ce66={_0x567462:0x102},_0x2eaaac={_0xd4bd64:0x102,_0x88344b:0x107},_0x31e337={_0x533e80:0x14e,_0x2d75fb:0x158,_0x21f368:0x12f},_0x53e56c=_0x43ce43,_0x455e08=function _0x312fee(){var _0x1ddc4b={_0x5b99b4:0x154},_0x47cb3e={_0x5909f2:0x143};function _0x4eadfb(){var _0x436338=_0x193e;this[_0x436338(0x143)]={};}return _0x4eadfb['prototype']={'on':function(_0xbe2270,_0x1285f8,_0x500ae9){var _0xd2070b={_0x296426:0x10e},_0x381895=_0x193e,_0x3531d6=this[_0x381895(_0x47cb3e._0x5909f2)];!_0x3531d6[_0xbe2270]&&(_0x3531d6[_0xbe2270]=[]),_0x3531d6[_0xbe2270]['push'](function(_0x4b5142){var _0x47572e=_0x381895;return _0x1285f8[_0x47572e(_0xd2070b._0x296426)](_0x500ae9,_0x4b5142);});},'emit':function(_0x1ba336,_0x72dc87){var _0x2ccd42=_0x193e,_0x278669=this['cStore'];if(_0x278669[_0x1ba336]){var _0x5bc2e9=_0x278669[_0x1ba336][_0x2ccd42(_0x1ddc4b._0x5b99b4)];for(var _0x3a028a=0x0;_0x3a028a<_0x5bc2e9;_0x3a028a++){var _0x125c2d=_0x278669[_0x1ba336][_0x3a028a];_0x125c2d(_0x72dc87);}}}},_0x4eadfb;}(),_0x1827fa=function(_0x2e8cc0){var _0x3a7853=_0x193e,_0x516f9b=_0x2e8cc0['_renderer'],_0x5bf9cb=_0x2e8cc0['_coordinator'],_0x45487e=_0x2e8cc0[_0x3a7853(_0x5a5f87._0x4d6488)];_0x5bf9cb['on']('renderpartial',_0x516f9b['renderPartial'],_0x516f9b),_0x5bf9cb['on']('renderall',_0x516f9b[_0x3a7853(0x169)],_0x516f9b),_0x5bf9cb['on']('extremachange',function(_0x272912){var _0x3d1fe9=_0x3a7853;_0x2e8cc0['_config']['onExtremaChange']&&_0x2e8cc0[_0x3d1fe9(0xec)]['onExtremaChange']({'min':_0x272912['min'],'max':_0x272912['max'],'gradient':_0x2e8cc0['_config']['gradient']||_0x2e8cc0['_config']['defaultGradient']});}),_0x45487e[_0x3a7853(0x149)](_0x5bf9cb);};function _0x404773(){var _0x3917d0=_0x193e,_0x381c69=this['_config']=_0xf8dbf6['merge'](_0x22395c,arguments[0x0]||{});this[_0x3917d0(0xf8)]=new _0x455e08();if(_0x381c69['plugin']){var _0x1a0920=_0x381c69['plugin'];if(!_0x22395c[_0x3917d0(_0x161e2a._0x1d1674)][_0x1a0920])throw new Error('Plugin\x20\x27'+_0x1a0920+'\x27\x20not\x20found.\x20Maybe\x20it\x20was\x20not\x20registered.');else{var _0x22b966=_0x22395c['plugins'][_0x1a0920];this['_renderer']=new _0x22b966['renderer'](_0x381c69),this[_0x3917d0(0x12f)]=new _0x22b966['store'](_0x381c69);}}else this['_renderer']=new _0x5e8493(_0x381c69),this['_store']=new _0xcdbec9(_0x381c69);_0x1827fa(this);}return _0x404773[_0x53e56c(_0x306db5._0x506cbd)]={'addData':function(){var _0x21d01b=_0x53e56c;return this['_store'][_0x21d01b(_0x3cc381._0x462655)][_0x21d01b(_0x3cc381._0x35885f)](this['_store'],arguments),this;},'removeData':function(){var _0x333e27=_0x53e56c;return this['_store'][_0x333e27(0x10b)]&&this['_store']['removeData']['apply'](this[_0x333e27(0x12f)],arguments),this;},'setData':function(){var _0x5a59bf=_0x53e56c;return this['_store'][_0x5a59bf(_0x59199e._0x31c1c2)][_0x5a59bf(_0x59199e._0x115870)](this['_store'],arguments),this;},'setDataMax':function(){var _0x260d1f=_0x53e56c;return this['_store'][_0x260d1f(_0x31e337._0x533e80)][_0x260d1f(_0x31e337._0x2d75fb)](this[_0x260d1f(_0x31e337._0x21f368)],arguments),this;},'setDataMin':function(){var _0x137938=_0x53e56c;return this['_store'][_0x137938(_0x34441d._0xeebbb0)]['apply'](this['_store'],arguments),this;},'configure':function(_0x8013fd){var _0x53e749=_0x53e56c;return this['_config']=_0xf8dbf6[_0x53e749(0xf7)](this['_config'],_0x8013fd),this[_0x53e749(_0x2eaaac._0xd4bd64)][_0x53e749(_0x2eaaac._0x88344b)](this['_config']),this['_coordinator'][_0x53e749(0xf2)]('renderall',this['_store']['_getInternalData']()),this;},'repaint':function(){var _0x108fbc=_0x53e56c;return this[_0x108fbc(0xf8)]['emit']('renderall',this['_store'][_0x108fbc(0x111)]()),this;},'getData':function(){return this['_store']['getData']();},'getDataURL':function(){var _0x8c5655=_0x53e56c;return this[_0x8c5655(_0x39ce66._0x567462)]['getDataURL']();},'getValueAt':function(_0x48abf4){var _0x32c6e7=_0x53e56c;if(this['_store'][_0x32c6e7(0x12d)])return this['_store']['getValueAt'](_0x48abf4);else return this['_renderer']['getValueAt']?this['_renderer']['getValueAt'](_0x48abf4):null;}},_0x404773;}(),_0x50b9b1={'create':function(_0x178696){return new _0x1ab77d(_0x178696);},'register':function(_0x1bec59,_0x3a2763){_0x22395c['plugins'][_0x1bec59]=_0x3a2763;}};return _0x50b9b1;}));}(heatmap$1));var heatmap=heatmap$1['exports'],h337=_mergeNamespaces({'__proto__':null,'default':heatmap},[heatmap$1['exports']]),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!heatmap$1['exports']['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x3e9d5b(0x16c)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x3d503f={}){var _0x36f3a7={_0x238a00:0x14b,_0x48c129:0x11e},_0x1314a5=_0x3e9d5b;super(_0x3d503f),this[_0x1314a5(0x12b)]['maxCanvasSize']=this['options']['maxCanvasSize']??document['body']['clientWidth'],this['options'][_0x1314a5(_0x36f3a7._0x238a00)]=Math['min'](this['options']['maxCanvasSize'],0x1388),this[_0x1314a5(0x12b)]['minCanvasSize']=this['options']['minCanvasSize']??document[_0x1314a5(_0x36f3a7._0x48c129)]['clientHeight'],this[_0x1314a5(0x12b)][_0x1314a5(0x115)]=Math[_0x1314a5(0x128)](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options']['style']={...DEF_STYLE,...this[_0x1314a5(0x12b)]['style']};}get['layer'](){var _0x13e9bf={_0x511985:0xfd},_0xc0d606=_0x3e9d5b;return this[_0xc0d606(_0x13e9bf._0x511985)];}get[_0x3e9d5b(0xf9)](){var _0x53d734=_0x3e9d5b;return this[_0x53d734(0x12b)]['heatStyle'];}set['heatStyle'](_0x2dc15f){var _0x468eee={_0x553826:0x12b,_0x454131:0xf7,_0x1277aa:0x12b,_0x3e6566:0xf9},_0x19f161=_0x3e9d5b;this[_0x19f161(_0x468eee._0x553826)]['heatStyle']=mars3d__namespace['Util'][_0x19f161(_0x468eee._0x454131)](this[_0x19f161(_0x468eee._0x1277aa)][_0x19f161(_0x468eee._0x3e6566)],_0x2dc15f),this['_heat']&&(this['_heat']['configure'](this[_0x19f161(0x12b)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set[_0x3e9d5b(0x144)](_0x7ebc3b){var _0x107ce0={_0x366174:0x153},_0x4f0cc6=_0x3e9d5b;this['options'][_0x4f0cc6(0x144)]=mars3d__namespace[_0x4f0cc6(_0x107ce0._0x366174)]['merge'](this['options']['style'],_0x7ebc3b);}get['positions'](){return this['_positions'];}set['positions'](_0x544ca6){this['setPositions'](_0x544ca6);}get[_0x3e9d5b(0xe8)](){const _0x30a70f=[];return this['points']['forEach'](_0xeb4897=>{_0x30a70f['push'](_0xeb4897['toArray']());}),_0x30a70f;}get[_0x3e9d5b(0x131)](){return this['_rectangle'];}['_setOptionsHook'](_0x2d4be7,_0xdc4f8){_0x2d4be7['positions']&&(this['positions']=_0x2d4be7['positions']);}[_0x3e9d5b(0x139)](){var _0x5cbaae=_0x3e9d5b;this['style']['type']==='image'?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer'][(_0x5cbaae(0x13e))]({'private':!![]});}['_addedHook'](){var _0x3bf9c9=_0x3e9d5b;this[_0x3bf9c9(0xed)]['addLayer'](this[_0x3bf9c9(0xfd)]),this['_container']=mars3d__namespace[_0x3bf9c9(0x117)][_0x3bf9c9(0x123)]('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this[_0x3bf9c9(0x12b)]['flyTo']&&this['flyToByAnimationEnd']();}[_0x3e9d5b(0x112)](){var _0x185db4={_0x5f1246:0x151},_0x24309b=_0x3e9d5b;this[_0x24309b(_0x185db4._0x5f1246)]&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this['_layer']);}['addPosition'](_0x1a0d47,_0x4467cc){var _0x2de4d5={_0x1c632b:0x170},_0x4cee76=_0x3e9d5b;this['_positions']=this[_0x4cee76(_0x2de4d5._0x1c632b)]||[],this['_positions']['push'](_0x1a0d47),this['_updatePositionsHook'](_0x4467cc);}['setPositions'](_0x141cfc,_0x7d3a1a){var _0x2b536a={_0x15d38e:0x137},_0x1dd3d5=_0x3e9d5b;this['_positions']=_0x141cfc,this[_0x1dd3d5(_0x2b536a._0x15d38e)](_0x7d3a1a);}['clear'](){var _0x2e813e={_0x896d3e:0xe9},_0x5eeac8=_0x3e9d5b;this['_graphic']&&(this['_layer'][_0x5eeac8(0x12a)](this['_graphic'],!![]),delete this[_0x5eeac8(_0x2e813e._0x896d3e)]),this['_graphic2']&&(this['_layer'][_0x5eeac8(0x12a)](this[_0x5eeac8(0x110)],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x493dca){var _0x955b33={_0x4744c5:0xf3,_0x593f26:0x108,_0x1c56a3:0x144,_0x5676fa:0x12e,_0x23b895:0xf3,_0x25d5df:0xf3,_0x26809e:0xe9},_0x48aa11=_0x3e9d5b;if(!this['show']||!this['_map']||!this[_0x48aa11(0x118)]||this[_0x48aa11(0x118)]['length']===0x0)return this;const _0x3a8819=this['_getHeatCanvas']();if(this['style']['type']===_0x48aa11(_0x955b33._0x4744c5))this['_layer']['setOptions']({'url':_0x3a8819[_0x48aa11(0x127)]('image/png',0x1),'rectangle':this[_0x48aa11(_0x955b33._0x593f26)],'opacity':this[_0x48aa11(0x144)]['opacity']});else this[_0x48aa11(_0x955b33._0x1c56a3)]['arc']?this['_graphic']&&_0x493dca?(this['_graphic'][_0x48aa11(_0x955b33._0x5676fa)][_0x48aa11(_0x955b33._0x23b895)]=_0x3a8819,this[_0x48aa11(0xe9)]['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms'][_0x48aa11(_0x955b33._0x25d5df)]=_0x3a8819,this['_graphic2']['uniforms']['bumpMap']=this['_graphic'][_0x48aa11(0x12e)][_0x48aa11(0x114)])):this['_createArcGraphic'](_0x3a8819):this['_graphic']&&_0x493dca?this[_0x48aa11(_0x955b33._0x26809e)]['uniforms']['image']=_0x3a8819:this['_createGraphic'](_0x3a8819);return this;}['_createGraphic'](_0x237543){var _0x375cdf={_0x2065cd:0xee,_0x5bbbcc:0x11b,_0xeda18b:0xe9},_0x42584d=_0x3e9d5b;this[_0x42584d(_0x375cdf._0x2065cd)](),this['_graphic']=new mars3d__namespace['graphic'][(_0x42584d(_0x375cdf._0x5bbbcc))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':mars3d__namespace['MaterialUtil'][_0x42584d(0x160)](mars3d__namespace['MaterialType']['Image2'],{'image':_0x237543}),'flat':!![]})}),this['_layer']['addGraphic'](this[_0x42584d(_0x375cdf._0xeda18b)]);}[_0x3e9d5b(0x11c)](_0x3969f5){var _0xa62201={_0x21831e:0x136,_0x863752:0x109,_0x4eac02:0x145,_0x3f19d5:0xfa,_0x4a9712:0x144,_0x1607df:0x108,_0x28370d:0x176,_0x11fcdb:0x132,_0x4334a0:0x133,_0x3ab3ef:0x176,_0x58a17b:0x11b,_0xb76242:0x133},_0x1435ed=_0x3e9d5b;this['clear']();const _0x1b4b88=Cesium[_0x1435ed(0x173)][_0x1435ed(_0xa62201._0x21831e)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x1435ed(_0xa62201._0x863752)]['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x1435ed(_0xa62201._0x4eac02)]['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x1435ed(_0xa62201._0x3f19d5)]},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x412ed3=Math['floor'](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style']['diffHeight'];const _0x36e95f=(this[_0x1435ed(_0xa62201._0x4a9712)]['splitNum'],0x64);let _0x4569cd=Math['max'](this[_0x1435ed(_0xa62201._0x1607df)]['height'],this['_rectangle']['width']);this['style']['granularity']=_0x4569cd/=_0x36e95f;const _0x176e44=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x3969f5,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x1435ed(0x13b)]()},'source':HeatMaterial},'translucent':!![]}),_0xaabb97=this['style'][_0x1435ed(_0xa62201._0x28370d)]||0x1;this['_graphic']=new mars3d__namespace[(_0x1435ed(_0xa62201._0x11fcdb))]['RectanglePrimitive']({...this[_0x1435ed(0x12b)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x1b4b88,'material':_0x176e44,'vertexShaderSource':getVertexShaderSource(_0x412ed3*_0xaabb97)})}),this['_layer'][_0x1435ed(_0xa62201._0x4334a0)](this['_graphic']),this[_0x1435ed(_0xa62201._0x4a9712)][_0x1435ed(_0xa62201._0x3ab3ef)]===0x0&&(this['_graphic2']=new mars3d__namespace['graphic'][(_0x1435ed(_0xa62201._0x58a17b))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x1435ed(0x142))]({'flat':!![],'aboveGround':!![],'renderState':_0x1b4b88,'material':_0x176e44,'vertexShaderSource':getVertexShaderSource(-_0x412ed3)})}),this['_layer'][_0x1435ed(_0xa62201._0xb76242)](this['_graphic2']));}['getRectangle'](_0x19473e){var _0x50d36e={_0x53dbe3:0x108,_0x48d41b:0x13a,_0x3a86ef:0x108},_0x4db092=_0x3e9d5b;return _0x19473e!==null&&_0x19473e!==void 0x0&&_0x19473e['isFormat']&&this[_0x4db092(_0x50d36e._0x53dbe3)]?mars3d__namespace['PolyUtil'][_0x4db092(_0x50d36e._0x48d41b)](this[_0x4db092(_0x50d36e._0x3a86ef)]):this[_0x4db092(0x108)];}['_getHeatCanvas'](){var _0x44116b={_0x4ca848:0x131,_0x50ff78:0x134,_0x40457b:0x12b,_0xdd05c2:0x115,_0x3b9cb6:0x12b,_0xbd374a:0xf9,_0xf919b6:0x165,_0x262a0d:0x165,_0x14274b:0xf1,_0x7dd3b2:0x15b,_0x110ab4:0x175,_0x36179b:0x123},_0x52f840={_0x194383:0x134,_0x4d0ce1:0xf6},_0x58ac27={_0x4d083b:0x131,_0x54c8f7:0xfe},_0x54ffdb=_0x3e9d5b;const _0x2d9543=this['_positions'],_0x3faa48=[];let _0x2fd8fa,_0x567ab5,_0x1c044a,_0x2a7339;_0x2d9543[_0x54ffdb(0x166)](_0x4e8ed3=>{var _0x29686d=_0x54ffdb;const _0x46a139=mars3d__namespace['LngLatPoint'][_0x29686d(0x174)](_0x4e8ed3);if(!_0x46a139)return;_0x46a139['value']=_0x4e8ed3[_0x29686d(0xfb)]||0x1,!this['options'][_0x29686d(_0x58ac27._0x4d083b)]&&(_0x2fd8fa===undefined?(_0x2fd8fa=_0x46a139[_0x29686d(_0x58ac27._0x54c8f7)],_0x567ab5=_0x46a139['lng'],_0x1c044a=_0x46a139['lat'],_0x2a7339=_0x46a139[_0x29686d(0x11d)]):(_0x2fd8fa=Math[_0x29686d(0xe7)](_0x2fd8fa,_0x46a139['lng']),_0x567ab5=Math['max'](_0x567ab5,_0x46a139['lng']),_0x1c044a=Math['min'](_0x1c044a,_0x46a139['lat']),_0x2a7339=Math['max'](_0x2a7339,_0x46a139['lat']))),_0x3faa48[_0x29686d(0x113)](_0x46a139);});_0x2fd8fa===_0x567ab5&&(_0x2fd8fa-=0.000001,_0x567ab5+=0.000001);_0x1c044a===_0x2a7339&&(_0x1c044a-=0.000001,_0x2a7339+=0.000001);let _0x56cab2=this['options'][_0x54ffdb(_0x44116b._0x4ca848)]||{'xmin':_0x2fd8fa,'xmax':_0x567ab5,'ymin':_0x1c044a,'ymax':_0x2a7339};const _0x1da8dc=getMercatorBounds(_0x56cab2),_0xfd14d=Math[_0x54ffdb(0x156)](_0x1da8dc[_0x54ffdb(0xf1)]-_0x1da8dc[_0x54ffdb(_0x44116b._0x50ff78)]),_0x164bdb=Math['abs'](_0x1da8dc['ymax']-_0x1da8dc[_0x54ffdb(0x165)]),_0x48d06=Math[_0x54ffdb(0x128)](_0xfd14d,_0x164bdb),_0x44dc00=Math['min'](_0xfd14d,_0x164bdb);this['_mBoundsMax']=_0x48d06;let _0x119717=0x1;if(_0x48d06>this['options']['maxCanvasSize'])_0x119717=_0x48d06/this['options']['maxCanvasSize'],_0x44dc00/_0x119717<this[_0x54ffdb(0x12b)]['minCanvasSize']&&(_0x119717=_0x44dc00/this[_0x54ffdb(0x12b)]['minCanvasSize']);else _0x44dc00<this[_0x54ffdb(_0x44116b._0x40457b)][_0x54ffdb(_0x44116b._0xdd05c2)]&&(_0x119717=_0x44dc00/this['options'][_0x54ffdb(0x115)],_0x48d06/_0x119717>this['options']['maxCanvasSize']&&(_0x119717=_0x48d06/this[_0x54ffdb(_0x44116b._0x3b9cb6)]['maxCanvasSize']));const _0x371a9=this[_0x54ffdb(_0x44116b._0xbd374a)]['radius']*1.5,_0x300e9c=_0xfd14d/_0x119717+_0x371a9*0x2,_0x30797e=_0x164bdb/_0x119717+_0x371a9*0x2,_0x2638ee=_0x371a9*_0x119717;_0x1da8dc['xmin']-=_0x2638ee,_0x1da8dc['ymin']-=_0x2638ee,_0x1da8dc['xmax']+=_0x2638ee,_0x1da8dc['ymax']+=_0x2638ee,_0x1da8dc['xmin']=Math['max'](_0x1da8dc[_0x54ffdb(_0x44116b._0x50ff78)],-20037508.34),_0x1da8dc['xmax']=Math['min'](_0x1da8dc['xmax'],20037508.34),_0x1da8dc['ymin']=Math[_0x54ffdb(0x128)](_0x1da8dc['ymin'],-20037508.34),_0x1da8dc['ymax']=Math[_0x54ffdb(0xe7)](_0x1da8dc['ymax'],20037508.34),this['_scale']=_0x119717,_0x56cab2=geLatLngBounds(_0x1da8dc),this['_rectangle']=Cesium['Rectangle']['fromDegrees'](_0x56cab2[_0x54ffdb(0x134)],_0x56cab2[_0x54ffdb(_0x44116b._0xf919b6)],_0x56cab2[_0x54ffdb(0xf1)],_0x56cab2['ymax']);let _0x8dcf9b=_0x3faa48[0x0]['value']??0x1,_0x4b09b9=_0x3faa48[0x0]['value']??0x0;const _0x3dcaa5=[];_0x3faa48['forEach'](_0x132c4e=>{var _0x5c9b86=_0x54ffdb;const _0x3f504b=mars3d__namespace[_0x5c9b86(0x164)]['lonlat2mercator']([_0x132c4e[_0x5c9b86(0xfe)],_0x132c4e['lat']]),_0x2a820e=_0x132c4e[_0x5c9b86(0xfb)]||0x1,_0x2953f0=Math['round']((_0x3f504b[0x0]-_0x1da8dc[_0x5c9b86(_0x52f840._0x194383)])/_0x119717),_0x4f2978=Math['round']((_0x1da8dc[_0x5c9b86(_0x52f840._0x4d0ce1)]-_0x3f504b[0x1])/_0x119717);_0x8dcf9b=Math['max'](_0x8dcf9b,_0x2a820e),_0x4b09b9=Math[_0x5c9b86(0xe7)](_0x4b09b9,_0x2a820e),_0x3dcaa5['push']({'x':_0x2953f0,'y':_0x4f2978,'value':_0x2a820e});});const _0x350eee={'min':this[_0x54ffdb(0x12b)]['min']??_0x4b09b9,'max':this['options']['max']??_0x8dcf9b,'data':_0x3dcaa5};this[_0x54ffdb(0x15a)]=_0x350eee;if(!this[_0x54ffdb(0x12c)]||_0x1da8dc['xmin']!==this['_last_mBounds']['xmin']||_0x1da8dc['ymin']!==this['_last_mBounds'][_0x54ffdb(_0x44116b._0x262a0d)]||_0x1da8dc['xmax']!==this['_last_mBounds'][_0x54ffdb(_0x44116b._0x14274b)]||_0x1da8dc['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x1da8dc,this['_container'][_0x54ffdb(0x144)]['cssText']='width:'+_0x300e9c+'px;height:'+_0x30797e+_0x54ffdb(_0x44116b._0x7dd3b2);const _0x126a2d={...this[_0x54ffdb(_0x44116b._0xbd374a)],'container':this['_container']};!this['_heat']?this[_0x54ffdb(_0x44116b._0x110ab4)]=heatmap$1['exports'][_0x54ffdb(_0x44116b._0x36179b)](_0x126a2d):this[_0x54ffdb(_0x44116b._0x110ab4)]['configure'](_0x126a2d);}this['_heat']['setData'](_0x350eee);const _0x170407=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x170407;}['_getArcHeatCanvas'](){var _0x1fe02d={_0x3beddc:0x175,_0x5acda7:0xf9,_0x1c43ce:0xfc,_0x227b9e:0x13f,_0x4da007:0x10a,_0x42b60c:0x12b},_0x12428b=_0x3e9d5b;this[_0x12428b(_0x1fe02d._0x3beddc)]['configure']({'radius':this[_0x12428b(_0x1fe02d._0x5acda7)]['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:_0x12428b(_0x1fe02d._0x1c43ce),0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x8f114a=mars3d__namespace['DomUtil'][_0x12428b(_0x1fe02d._0x227b9e)](this[_0x12428b(0x175)]['_renderer'][_0x12428b(_0x1fe02d._0x4da007)]);return this[_0x12428b(0x175)][_0x12428b(0x14a)](this[_0x12428b(_0x1fe02d._0x42b60c)]['heatStyle']),_0x8f114a;}['getPointData'](_0x5482ad){var _0x13add3={_0x48e6b2:0x15d,_0x2c70ff:0x175,_0x30afad:0x11a,_0x294296:0x157},_0xfcd072=_0x3e9d5b;const _0x21c489=mars3d__namespace['LngLatPoint']['parse'](_0x5482ad);if(!_0x21c489)return{};const _0xfe4369=mars3d__namespace[_0xfcd072(0x164)]['lonlat2mercator']([_0x21c489['lng'],_0x21c489['lat']]),_0x20b08a=this[_0xfcd072(0x12c)],_0x2ca016=Math['round']((_0xfe4369[0x0]-_0x20b08a[_0xfcd072(0x134)])/this['_scale']),_0x2ca7e0=Math[_0xfcd072(0x16e)]((_0x20b08a['ymax']-_0xfe4369[0x1])/this[_0xfcd072(_0x13add3._0x48e6b2)]),_0x1dacdb=this[_0xfcd072(0x175)]['getValueAt']({'x':_0x2ca016,'y':_0x2ca7e0}),_0x1ed71d=this[_0xfcd072(_0x13add3._0x2c70ff)]['_renderer'][_0xfcd072(_0x13add3._0x30afad)]['getImageData'](_0x2ca016-0x1,_0x2ca7e0-0x1,0x1,0x1)['data'];return{'x':_0x2ca016,'y':_0x2ca7e0,'value':_0x1dacdb,'color':_0xfcd072(_0x13add3._0x294296)+_0x1ed71d[0x0]+','+_0x1ed71d[0x1]+','+_0x1ed71d[0x2]+','+_0x1ed71d[0x3]+')'};}}mars3d__namespace[_0x3e9d5b(0x148)]['register'](_0x3e9d5b(0x120),HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337;function getMercatorBounds(_0x5ca8ac){var _0x402a48=_0x3e9d5b;const _0x580995=mars3d__namespace[_0x402a48(0x164)]['lonlat2mercator']([_0x5ca8ac['xmin'],_0x5ca8ac['ymin']]),_0x1a34e0=mars3d__namespace['PointTrans'][_0x402a48(0xef)]([_0x5ca8ac['xmax'],_0x5ca8ac['ymax']]);return{'xmin':_0x580995[0x0],'ymin':_0x580995[0x1],'xmax':_0x1a34e0[0x0],'ymax':_0x1a34e0[0x1]};}function _0x193e(_0x22b976,_0x2bd664){var _0x112d4d=_0x112d();return _0x193e=function(_0x193e81,_0x1d722b){_0x193e81=_0x193e81-0xe7;var _0xf54015=_0x112d4d[_0x193e81];return _0xf54015;},_0x193e(_0x22b976,_0x2bd664);}function geLatLngBounds(_0x49b4f1){var _0x1a0400={_0x4b2c29:0x164,_0x4177cd:0xf6},_0x1eeeb2=_0x3e9d5b;const _0x297084=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x49b4f1['xmin'],_0x49b4f1['ymin']]),_0x42328a=mars3d__namespace[_0x1eeeb2(_0x1a0400._0x4b2c29)]['mercator2lonlat']([_0x49b4f1['xmax'],_0x49b4f1[_0x1eeeb2(_0x1a0400._0x4177cd)]]);return{'xmin':_0x297084[0x0],'ymin':_0x297084[0x1],'xmax':_0x42328a[0x0],'ymax':_0x42328a[0x1]};}function getVertexShaderSource(_0x47e26c){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x47e26c+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
