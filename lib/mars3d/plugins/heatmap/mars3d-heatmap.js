/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.13
 * 编译日期：2023-06-26 22:27:12
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x3937f0=_0xe958;(function(_0x4589f9,_0x29144b){const _0x38e659={_0x5f5c44:0x112,_0x30f8d9:0xef,_0x29500d:0xfa,_0xa4c664:0x109,_0xa7aa08:0x119,_0x192330:0xfc,_0x411f16:0x115},_0x90be2=_0xe958,_0x59b537=_0x4589f9();while(!![]){try{const _0x3ce8f1=-parseInt(_0x90be2(_0x38e659._0x5f5c44))/0x1+parseInt(_0x90be2(_0x38e659._0x30f8d9))/0x2+parseInt(_0x90be2(0xee))/0x3+parseInt(_0x90be2(_0x38e659._0x29500d))/0x4*(-parseInt(_0x90be2(_0x38e659._0xa4c664))/0x5)+-parseInt(_0x90be2(0x118))/0x6+-parseInt(_0x90be2(_0x38e659._0xa7aa08))/0x7+parseInt(_0x90be2(_0x38e659._0x192330))/0x8*(parseInt(_0x90be2(_0x38e659._0x411f16))/0x9);if(_0x3ce8f1===_0x29144b)break;else _0x59b537['push'](_0x59b537['shift']());}catch(_0x1d494a){_0x59b537['push'](_0x59b537['shift']());}}}(_0x548f,0xdfafd));function _interopNamespace(_0xb41251){if(_0xb41251&&_0xb41251['__esModule'])return _0xb41251;var _0x3425d9=Object['create'](null);return _0xb41251&&Object['keys'](_0xb41251)['forEach'](function(_0x264e4a){const _0x328eec=_0xe958;if(_0x264e4a!=='default'){var _0x4909c7=Object['getOwnPropertyDescriptor'](_0xb41251,_0x264e4a);Object[_0x328eec(0x11d)](_0x3425d9,_0x264e4a,_0x4909c7['get']?_0x4909c7:{'enumerable':!![],'get':function(){return _0xb41251[_0x264e4a];}});}}),_0x3425d9['default']=_0xb41251,_0x3425d9;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x3937f0(0x136)]['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x517e33={}){const _0xcf8cd2={_0xbfcd98:0x116,_0x329a82:0x138,_0x40a153:0x138,_0x6871cc:0xf4,_0x4bd7a9:0x12d,_0x3b378c:0x122,_0xb6c86b:0xf4},_0x21d049=_0x3937f0;super(_0x517e33),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document['body']['clientWidth'],this['options']['maxCanvasSize']=Math['min'](this[_0x21d049(0xf4)][_0x21d049(_0xcf8cd2._0xbfcd98)],0x1388),this['options']['minCanvasSize']=this['options']['minCanvasSize']??document['body']['clientHeight'],this['options'][_0x21d049(_0xcf8cd2._0x329a82)]=Math['max'](this['options'][_0x21d049(_0xcf8cd2._0x40a153)],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this[_0x21d049(_0xcf8cd2._0x6871cc)][_0x21d049(_0xcf8cd2._0x4bd7a9)]||{}},this[_0x21d049(0xf4)][_0x21d049(_0xcf8cd2._0x3b378c)]={...DEF_STYLE,...this[_0x21d049(_0xcf8cd2._0xb6c86b)][_0x21d049(0x122)]||{}};}get['layer'](){return this['_layer'];}get[_0x3937f0(0x12d)](){const _0x2b89e8=_0x3937f0;return this[_0x2b89e8(0xf4)]['heatStyle'];}set[_0x3937f0(0x12d)](_0x17d8ba){const _0x14f391=_0x3937f0;this[_0x14f391(0xf4)]['heatStyle']=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x17d8ba),this['_heat']&&(this['_heat']['configure'](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get[_0x3937f0(0x122)](){const _0x4bb3c7=_0x3937f0;return this[_0x4bb3c7(0xf4)]['style'];}set[_0x3937f0(0x122)](_0x910d89){this['options']['style']=mars3d__namespace['Util']['merge'](this['options']['style'],_0x910d89);}get[_0x3937f0(0x117)](){const _0x52f98f={_0x3badd2:0x113},_0x2dff3f=_0x3937f0;return this[_0x2dff3f(_0x52f98f._0x3badd2)];}set['positions'](_0x4d543a){const _0x3ce4d5={_0x3a8856:0x106},_0x39a7d9=_0x3937f0;this[_0x39a7d9(_0x3ce4d5._0x3a8856)](_0x4d543a);}get['coordinates'](){const _0x19a55a=_0x3937f0,_0x559abe=[];return this[_0x19a55a(0x120)]['forEach'](_0x44f7b7=>{_0x559abe['push'](_0x44f7b7['toArray']());}),_0x559abe;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x431acb,_0x7f2974){const _0x4854f7=_0x3937f0;_0x431acb[_0x4854f7(0x117)]&&(this['positions']=_0x431acb[_0x4854f7(0x117)]);}['_mountedHook'](){const _0xa8a165={_0x3cf626:0x111,_0x3ed8ac:0x107},_0x1ff60c=_0x3937f0;this['style'][_0x1ff60c(_0xa8a165._0x3cf626)]==='image'?this['_layer']=new mars3d__namespace[(_0x1ff60c(0x136))]['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this[_0x1ff60c(_0xa8a165._0x3ed8ac)]=new mars3d__namespace['layer'][(_0x1ff60c(0xf3))]({'private':!![]});}['_addedHook'](){const _0x56030b={_0x51a8fb:0xf4},_0x5345c7=_0x3937f0;this['_map']['addLayer'](this['_layer']),this[_0x5345c7(0xf7)]=mars3d__namespace[_0x5345c7(0x133)]['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options'][_0x5345c7(0x117)]&&(this['positions']=this[_0x5345c7(0xf4)]['positions']),this[_0x5345c7(_0x56030b._0x51a8fb)]['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x5a1fde=_0x3937f0;this[_0x5a1fde(0xf7)]&&(mars3d__namespace['DomUtil']['remove'](this[_0x5a1fde(0xf7)]),delete this['_container']),this['clear'](),this[_0x5a1fde(0xfe)]['removeLayer'](this['_layer']);}['addPosition'](_0x4b270c,_0x3a18c2){const _0x3729ab={_0x54782f:0x113},_0x58d8ae=_0x3937f0;this[_0x58d8ae(_0x3729ab._0x54782f)]=this[_0x58d8ae(_0x3729ab._0x54782f)]||[],this[_0x58d8ae(0x113)][_0x58d8ae(0xf8)](_0x4b270c),this['_updatePositionsHook'](_0x3a18c2);}[_0x3937f0(0x106)](_0x2cf01b,_0x78f422){const _0x2226fc=_0x3937f0;this[_0x2226fc(0x113)]=_0x2cf01b,this['_updatePositionsHook'](_0x78f422);}['clear'](){const _0x363f85={_0x3ed1a1:0x107,_0x40b724:0xf1},_0x55b995=_0x3937f0;this['_graphic']&&(this[_0x55b995(_0x363f85._0x3ed1a1)]['removeGraphic'](this[_0x55b995(0x124)],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer'][_0x55b995(_0x363f85._0x40b724)](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x3937f0(0x125)](_0x5a5369){const _0x5dd43a={_0x433b31:0x137,_0x3a592f:0x121,_0x30f945:0x122,_0x3f288f:0x124,_0x276755:0x130,_0x4d963e:0x130,_0x33b586:0x11e},_0x28fe95=_0x3937f0;if(!this['show']||!this['_map']||!this['positions']||this[_0x28fe95(0x117)]['length']===0x0)return this;const _0x31a3f2=this[_0x28fe95(0xf2)]();if(this['style']['type']==='image')this['_layer'][_0x28fe95(_0x5dd43a._0x433b31)]({'url':_0x31a3f2['toDataURL'](_0x28fe95(0x10a)),'rectangle':this[_0x28fe95(_0x5dd43a._0x3a592f)],'opacity':this[_0x28fe95(_0x5dd43a._0x30f945)]['opacity']});else this['style']['arc']?this[_0x28fe95(0x124)]&&_0x5a5369?(this[_0x28fe95(_0x5dd43a._0x3f288f)]['uniforms']['image']=_0x31a3f2,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2'][_0x28fe95(0x130)]['image']=_0x31a3f2,this['_graphic2'][_0x28fe95(_0x5dd43a._0x276755)]['bumpMap']=this['_graphic'][_0x28fe95(_0x5dd43a._0x4d963e)]['bumpMap'])):this[_0x28fe95(0x128)](_0x31a3f2):this[_0x28fe95(0x124)]&&_0x5a5369?this['_graphic']['uniforms'][_0x28fe95(_0x5dd43a._0x33b586)]=_0x31a3f2:this['_createGraphic'](_0x31a3f2);return this;}[_0x3937f0(0x10b)](_0x3b7b6d){const _0x5e14a5={_0x8541a1:0x11f,_0x24a119:0xf4},_0x50d379=_0x3937f0;this['clear'](),this['_graphic']=new mars3d__namespace[(_0x50d379(_0x5e14a5._0x8541a1))][(_0x50d379(0x123))]({...this[_0x50d379(_0x5e14a5._0x24a119)],'rectangle':this[_0x50d379(0x121)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x3b7b6d},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0x3937f0(0x128)](_0x234657){const _0x4081d0={_0x264d3b:0x12b,_0x4009e7:0x11c,_0x18051c:0x122,_0x2d18f8:0x11b,_0x516a30:0x134,_0x33e2bb:0x11f},_0x161822=_0x3937f0;this['clear']();const _0x1218f7=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x161822(_0x4081d0._0x264d3b)]['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation'][_0x161822(0x10d)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x45595d=Math[_0x161822(_0x4081d0._0x4009e7)](this[_0x161822(_0x4081d0._0x18051c)]['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this[_0x161822(_0x4081d0._0x18051c)][_0x161822(_0x4081d0._0x2d18f8)]&&delete this[_0x161822(_0x4081d0._0x18051c)][_0x161822(0x11b)];const _0x30bacd=(this['style']['splitNum'],0x64);let _0x58d364=Math['max'](this['_rectangle']['height'],this['_rectangle'][_0x161822(0xfb)]);this['style']['granularity']=_0x58d364/=_0x30bacd;const _0x17eac5=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x234657,'repeat':new Cesium[(_0x161822(0x100))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x4a58e4=this[_0x161822(0x122)]['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x161822(0xf4)],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x161822(_0x4081d0._0x516a30))]({'flat':!![],'aboveGround':!![],'renderState':_0x1218f7,'material':_0x17eac5,'vertexShaderSource':getVertexShaderSource(_0x45595d*_0x4a58e4)})}),this[_0x161822(0x107)]['addGraphic'](this['_graphic']),this['style'][_0x161822(0xf0)]===0x0&&(this[_0x161822(0x11a)]=new mars3d__namespace[(_0x161822(_0x4081d0._0x33e2bb))]['RectanglePrimitive']({...this[_0x161822(0xf4)],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x161822(0x134))]({'flat':!![],'aboveGround':!![],'renderState':_0x1218f7,'material':_0x17eac5,'vertexShaderSource':getVertexShaderSource(-_0x45595d)})}),this['_layer']['addGraphic'](this['_graphic2']));}['getRectangle'](_0x1ef792){const _0x2cc01b={_0x15cbc0:0x12a,_0x19fa2b:0x121,_0x5c9380:0x114,_0xef4eb6:0x121},_0x39df5a=_0x3937f0;return _0x1ef792!==null&&_0x1ef792!==void 0x0&&_0x1ef792[_0x39df5a(_0x2cc01b._0x15cbc0)]&&this[_0x39df5a(_0x2cc01b._0x19fa2b)]?mars3d__namespace['PolyUtil'][_0x39df5a(_0x2cc01b._0x5c9380)](this[_0x39df5a(_0x2cc01b._0xef4eb6)]):this[_0x39df5a(0x121)];}['_getHeatCanvas'](){const _0x4d665a={_0x203d12:0xf6,_0x1df416:0x13a,_0xfd39f4:0x132,_0x45e969:0x138,_0x3fa0ab:0xf4,_0xd17963:0xf9,_0x138ee8:0xff,_0x15750f:0x110,_0x3105f:0xf5,_0x5255e7:0x10e},_0x1ddd5c={_0x234507:0x101,_0xf9bf80:0x139,_0x398989:0x104,_0x34b1b6:0xfd},_0x2d5ce8={_0x125f2a:0x129,_0x2ad349:0x104},_0x5ccda6=_0x3937f0,_0x26ebe5=this['_positions'],_0xaf00d=[];let _0x52e6f6,_0x1053e7,_0x63fecb,_0xdf91a0;_0x26ebe5['forEach'](_0xd10c4c=>{const _0x4ca3fc=_0xe958,_0x316b39=mars3d__namespace['LngLatPoint'][_0x4ca3fc(_0x2d5ce8._0x125f2a)](_0xd10c4c);if(!_0x316b39)return;_0x316b39[_0x4ca3fc(0x139)]=_0xd10c4c['value']||0x1,!this[_0x4ca3fc(0xf4)][_0x4ca3fc(0xf6)]&&(_0x52e6f6===undefined?(_0x52e6f6=_0x316b39['lng'],_0x1053e7=_0x316b39[_0x4ca3fc(0x101)],_0x63fecb=_0x316b39['lat'],_0xdf91a0=_0x316b39['lat']):(_0x52e6f6=Math['min'](_0x52e6f6,_0x316b39['lng']),_0x1053e7=Math['max'](_0x1053e7,_0x316b39['lng']),_0x63fecb=Math[_0x4ca3fc(0xfd)](_0x63fecb,_0x316b39['lat']),_0xdf91a0=Math[_0x4ca3fc(_0x2d5ce8._0x2ad349)](_0xdf91a0,_0x316b39[_0x4ca3fc(0x103)]))),_0xaf00d['push'](_0x316b39);});_0x52e6f6===_0x1053e7&&(_0x52e6f6-=0.000001,_0x1053e7+=0.000001);_0x63fecb===_0xdf91a0&&(_0x63fecb-=0.000001,_0xdf91a0+=0.000001);let _0xebec0=this['options'][_0x5ccda6(_0x4d665a._0x203d12)]||{'xmin':_0x52e6f6,'xmax':_0x1053e7,'ymin':_0x63fecb,'ymax':_0xdf91a0};const _0x573686=getMercatorBounds(_0xebec0),_0x38838c=Math['abs'](_0x573686[_0x5ccda6(_0x4d665a._0x1df416)]-_0x573686['xmin']),_0x25f3f1=Math['abs'](_0x573686[_0x5ccda6(_0x4d665a._0xfd39f4)]-_0x573686[_0x5ccda6(0x135)]),_0x39b6e5=Math['max'](_0x38838c,_0x25f3f1),_0x39bc62=Math['min'](_0x38838c,_0x25f3f1);this['_mBoundsMax']=_0x39b6e5;let _0x4f13f5=0x1;if(_0x39b6e5>this['options']['maxCanvasSize'])_0x4f13f5=_0x39b6e5/this['options'][_0x5ccda6(0x116)],_0x39bc62/_0x4f13f5<this['options']['minCanvasSize']&&(_0x4f13f5=_0x39bc62/this['options'][_0x5ccda6(_0x4d665a._0x45e969)]);else _0x39bc62<this[_0x5ccda6(0xf4)][_0x5ccda6(0x138)]&&(_0x4f13f5=_0x39bc62/this['options']['minCanvasSize'],_0x39b6e5/_0x4f13f5>this['options']['maxCanvasSize']&&(_0x4f13f5=_0x39b6e5/this['options'][_0x5ccda6(0x116)]));const _0xfebff5=this['heatStyle']['radius']*1.5,_0x585370=_0x38838c/_0x4f13f5+_0xfebff5*0x2,_0x14d4bb=_0x25f3f1/_0x4f13f5+_0xfebff5*0x2,_0x475658=_0xfebff5*_0x4f13f5;_0x573686[_0x5ccda6(0xf9)]-=_0x475658,_0x573686['ymin']-=_0x475658,_0x573686[_0x5ccda6(0x13a)]+=_0x475658,_0x573686['ymax']+=_0x475658,this['_scale']=_0x4f13f5,_0xebec0=geLatLngBounds(_0x573686),this['_rectangle']=Cesium['Rectangle'][_0x5ccda6(0x12e)](_0xebec0['xmin'],_0xebec0[_0x5ccda6(0x135)],_0xebec0['xmax'],_0xebec0['ymax']);let _0x14df7f=_0xaf00d[0x0]['value']??0x1,_0x3895ce=_0xaf00d[0x0]['value']??0x0;const _0x1dcf8e=[];_0xaf00d['forEach'](_0x51d363=>{const _0x404db1=_0x5ccda6,_0x4d0851=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x51d363[_0x404db1(_0x1ddd5c._0x234507)],_0x51d363['lat']]),_0x2678ae=_0x51d363[_0x404db1(_0x1ddd5c._0xf9bf80)]||0x1,_0x328723=Math['round']((_0x4d0851[0x0]-_0x573686['xmin'])/_0x4f13f5),_0x4f5c0b=Math[_0x404db1(0x102)]((_0x573686['ymax']-_0x4d0851[0x1])/_0x4f13f5);_0x14df7f=Math[_0x404db1(_0x1ddd5c._0x398989)](_0x14df7f,_0x2678ae),_0x3895ce=Math[_0x404db1(_0x1ddd5c._0x34b1b6)](_0x3895ce,_0x2678ae),_0x1dcf8e[_0x404db1(0xf8)]({'x':_0x328723,'y':_0x4f5c0b,'value':_0x2678ae});});const _0x29fff1={'min':this[_0x5ccda6(_0x4d665a._0x3fa0ab)][_0x5ccda6(0xfd)]??_0x3895ce,'max':this['options'][_0x5ccda6(0x104)]??_0x14df7f,'data':_0x1dcf8e};this['_last_heatData']=_0x29fff1;if(!this['_last_mBounds']||_0x573686[_0x5ccda6(_0x4d665a._0xd17963)]!==this['_last_mBounds']['xmin']||_0x573686[_0x5ccda6(0x135)]!==this['_last_mBounds']['ymin']||_0x573686['xmax']!==this[_0x5ccda6(0x12f)]['xmax']||_0x573686[_0x5ccda6(0x132)]!==this['_last_mBounds']['ymax']){this[_0x5ccda6(0x12f)]=_0x573686,this['_container']['style']['cssText']='width:'+_0x585370+'px;height:'+_0x14d4bb+_0x5ccda6(_0x4d665a._0x138ee8);const _0x3ec8f2={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x3ec8f2):this['_heat'][_0x5ccda6(_0x4d665a._0x15750f)](_0x3ec8f2);}this[_0x5ccda6(_0x4d665a._0x3105f)]['setData'](_0x29fff1);const _0x4bc4b6=mars3d__namespace['DomUtil'][_0x5ccda6(_0x4d665a._0x5255e7)](this[_0x5ccda6(0xf5)]['_renderer']['canvas']);return _0x4bc4b6;}[_0x3937f0(0x131)](){const _0x580260={_0x5ef6a6:0x110,_0x1abf92:0x12d},_0x315bdb=_0x3937f0;this['_heat'][_0x315bdb(_0x580260._0x5ef6a6)]({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this[_0x315bdb(_0x580260._0x1abf92)]['gradientArc']||{0.25:_0x315bdb(0x127),0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:_0x315bdb(0x12c)}});const _0x5a1c52=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x315bdb(0xf5)][_0x315bdb(0x10f)]['canvas']);return this['_heat']['configure'](this['options'][_0x315bdb(0x12d)]),_0x5a1c52;}['getPointData'](_0xdd0530){const _0x461cd7={_0x2b95b0:0xf9,_0x2567b9:0x132},_0x597324=_0x3937f0,_0x3ff663=mars3d__namespace['LngLatPoint']['parse'](_0xdd0530);if(!_0x3ff663)return{};const _0x146e86=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x3ff663['lng'],_0x3ff663['lat']]),_0xe81a94=this['_last_mBounds'],_0x25070a=Math['round']((_0x146e86[0x0]-_0xe81a94[_0x597324(_0x461cd7._0x2b95b0)])/this['_scale']),_0x4af3d4=Math['round']((_0xe81a94[_0x597324(_0x461cd7._0x2567b9)]-_0x146e86[0x1])/this['_scale']),_0x180600=this['_heat']['getValueAt']({'x':_0x25070a,'y':_0x4af3d4}),_0xfaac3=this['_heat']['_renderer'][_0x597324(0x105)]['getImageData'](_0x25070a-0x1,_0x4af3d4-0x1,0x1,0x1)['data'];return{'x':_0x25070a,'y':_0x4af3d4,'value':_0x180600,'color':'rgba('+_0xfaac3[0x0]+','+_0xfaac3[0x1]+','+_0xfaac3[0x2]+','+_0xfaac3[0x3]+')'};}}function _0xe958(_0x3fd8d7,_0x561924){const _0x548fa4=_0x548f();return _0xe958=function(_0xe95815,_0x5de3da){_0xe95815=_0xe95815-0xee;let _0x22f0fb=_0x548fa4[_0xe95815];return _0x22f0fb;},_0xe958(_0x3fd8d7,_0x561924);}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace['layer'][_0x3937f0(0x108)]=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x181681){const _0x297f26=_0x3937f0,_0x500fee=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x181681['xmin'],_0x181681['ymin']]),_0x546238=mars3d__namespace[_0x297f26(0x10c)]['lonlat2mercator']([_0x181681['xmax'],_0x181681['ymax']]);return{'xmin':_0x500fee[0x0],'ymin':_0x500fee[0x1],'xmax':_0x546238[0x0],'ymax':_0x546238[0x1]};}function geLatLngBounds(_0x2d8c89){const _0x3bc782={_0x18fad2:0x132},_0x5c2c12=_0x3937f0,_0xa604a=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x2d8c89['xmin'],_0x2d8c89['ymin']]),_0x249a82=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x2d8c89['xmax'],_0x2d8c89[_0x5c2c12(_0x3bc782._0x18fad2)]]);return{'xmin':_0xa604a[0x0],'ymin':_0xa604a[0x1],'xmax':_0x249a82[0x0],'ymax':_0x249a82[0x1]};}function _0x548f(){const _0x488532=['948287ZiCzDL','_positions','formatRectangle','27tiziHx','maxCanvasSize','positions','10622100WAloMZ','2899512Jvzhov','_graphic2','diffHeight','floor','defineProperty','image','graphic','points','_rectangle','style','RectanglePrimitive','_graphic','_updatePositionsHook','__esModule','rgb(0,0,0)','_createArcGraphic','parse','isFormat','StencilOperation','rgb(255,255,255)','heatStyle','fromDegrees','_last_mBounds','uniforms','_getArcHeatCanvas','ymax','DomUtil','EllipsoidSurfaceAppearance','ymin','layer','setOptions','minCanvasSize','value','xmax','4300179rRllce','3561710nlsFDk','arcDirection','removeGraphic','_getHeatCanvas','GraphicLayer','options','_heat','rectangle','_container','push','xmin','16LuBAEo','width','4767536PcdpeY','min','_map','px;','Cartesian2','lng','round','lat','max','ctx','setPositions','_layer','HeatLayer','1191250gDVKsO','image/png','_createGraphic','PointTrans','KEEP','copyCanvas','_renderer','configure','type'];_0x548f=function(){return _0x488532;};return _0x548f();}function getVertexShaderSource(_0xd7fcf4){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0xd7fcf4+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x3937f0(0x126),{'value':!![]});
}));
