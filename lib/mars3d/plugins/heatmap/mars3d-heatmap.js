/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.8
 * 编译日期：2023-05-23 19:43:59
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x162715=_0x5f34;(function(_0x1205cc,_0x51f028){const _0x1ccbde={_0x30cb0a:0x19b,_0x2cee19:0x1c5,_0x5e59e2:0x1c4,_0x51ff76:0x1df,_0x1bad60:0x1b3,_0x562a9c:0x1e4,_0x37201a:0x1e6},_0x8f5a30=_0x5f34,_0x31ad28=_0x1205cc();while(!![]){try{const _0x4d8d72=parseInt(_0x8f5a30(_0x1ccbde._0x30cb0a))/0x1*(parseInt(_0x8f5a30(0x1f2))/0x2)+-parseInt(_0x8f5a30(_0x1ccbde._0x2cee19))/0x3*(parseInt(_0x8f5a30(_0x1ccbde._0x5e59e2))/0x4)+parseInt(_0x8f5a30(0x1d9))/0x5+-parseInt(_0x8f5a30(_0x1ccbde._0x51ff76))/0x6*(parseInt(_0x8f5a30(_0x1ccbde._0x1bad60))/0x7)+parseInt(_0x8f5a30(0x1d8))/0x8+parseInt(_0x8f5a30(0x1f5))/0x9*(-parseInt(_0x8f5a30(_0x1ccbde._0x562a9c))/0xa)+parseInt(_0x8f5a30(_0x1ccbde._0x37201a))/0xb;if(_0x4d8d72===_0x51f028)break;else _0x31ad28['push'](_0x31ad28['shift']());}catch(_0x42027f){_0x31ad28['push'](_0x31ad28['shift']());}}}(_0x5abf,0xd7509));function _0x5abf(){const _0x48045=['ymax','fromDegrees','ctx','LngLatPoint','div','lat','arcDirection','PointTrans','width','4PWIyKj','5058048LogPPM','PolyUtil','EPSG:3857','value','copyCanvas','Cartesian2','_renderer','KEEP','HeatLayer','_graphic2','setPositions','gradientArc','rgba(','setOptions','blur','RectanglePrimitive','_updatePositionsHook','_map','rgb(140,140,140)','2446864qQgbLO','2379665cReBYy','_last_mBounds','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','isFormat','_createArcGraphic','_container','4829418raxfiY','coordinates','minCanvasSize','DomUtil','_rectangle','1766390ziwEtt','_getArcHeatCanvas','34939190LYBTwp','getOwnPropertyDescriptor','min','layer','_layer','type','positions','StencilFunction','options','maxCanvasSize','image','Material','1499174ruRkYI','addGraphic','body','27FtFrpw','heatStyle','xmin','ALPHA_BLEND','1PLSQyh','lonlat2mercator','clientHeight','ymin','_scale','_mBoundsMax','__esModule','ALWAYS','Rectangle','register','merge','opacity','_createGraphic','configure','_graphic','uniforms','show','_getHeatCanvas','max','_positions','StencilOperation','graphic','round','_heat','14cNduTa','push','REPLACE','lng','xmax','style','flyTo','_removedHook'];_0x5abf=function(){return _0x48045;};return _0x5abf();}function _interopNamespace(_0x5b3096){const _0x4e33f2={_0x5be366:0x1a1},_0x2c0002={_0x5b8b8c:0x1e7},_0x2ed05e=_0x5f34;if(_0x5b3096&&_0x5b3096[_0x2ed05e(_0x4e33f2._0x5be366)])return _0x5b3096;var _0x10b688=Object['create'](null);return _0x5b3096&&Object['keys'](_0x5b3096)['forEach'](function(_0x279889){const _0x24d003=_0x2ed05e;if(_0x279889!=='default'){var _0x36f93f=Object[_0x24d003(_0x2c0002._0x5b8b8c)](_0x5b3096,_0x279889);Object['defineProperty'](_0x10b688,_0x279889,_0x36f93f['get']?_0x36f93f:{'enumerable':!![],'get':function(){return _0x5b3096[_0x279889];}});}}),_0x10b688['default']=_0x5b3096,_0x10b688;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x2936f4={}){const _0x55f665={_0x24885a:0x1f4,_0x26bf34:0x1ee,_0x523eaa:0x1ee,_0xd381cf:0x1e1,_0x44ddb2:0x1e1,_0x18ab7a:0x1ee,_0x3ed02d:0x1b8},_0x5f5668=_0x5f34;super(_0x2936f4),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document[_0x5f5668(_0x55f665._0x24885a)]['clientWidth'],this[_0x5f5668(_0x55f665._0x26bf34)]['maxCanvasSize']=Math['min'](this[_0x5f5668(_0x55f665._0x523eaa)]['maxCanvasSize'],0x1388),this['options'][_0x5f5668(_0x55f665._0xd381cf)]=this['options']['minCanvasSize']??document['body'][_0x5f5668(0x19d)],this[_0x5f5668(0x1ee)]['minCanvasSize']=Math['max'](this['options'][_0x5f5668(_0x55f665._0x44ddb2)],0x2bc),this[_0x5f5668(_0x55f665._0x18ab7a)]['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']||{}},this['options']['style']={...DEF_STYLE,...this['options'][_0x5f5668(_0x55f665._0x3ed02d)]||{}};}get['layer'](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x5770e5){const _0xc7a681=_0x5f34;this['options']['heatStyle']=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x5770e5),this['_heat']&&(this['_heat'][_0xc7a681(0x1a8)](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get[_0x162715(0x1b8)](){return this['options']['style'];}set[_0x162715(0x1b8)](_0x9540ef){const _0x393bed={_0x1a73ed:0x1a5},_0x17d280=_0x162715;this['options']['style']=mars3d__namespace['Util'][_0x17d280(_0x393bed._0x1a73ed)](this['options']['style'],_0x9540ef);}get['positions'](){return this['_positions'];}set['positions'](_0x243647){this['setPositions'](_0x243647);}get[_0x162715(0x1e0)](){const _0x287884=[];return this['points']['forEach'](_0x51e3db=>{_0x287884['push'](_0x51e3db['toArray']());}),_0x287884;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x11efaf,_0x2ed3b7){const _0xc621ca=_0x162715;_0x11efaf['positions']&&(this['positions']=_0x11efaf[_0xc621ca(0x1ec)]);}['_mountedHook'](){const _0x139bd1={_0x1fab41:0x1b8,_0x37e1ba:0x1eb,_0x217fb9:0x1e9,_0x261c74:0x1c7},_0x2698d3=_0x162715;this[_0x2698d3(_0x139bd1._0x1fab41)][_0x2698d3(_0x139bd1._0x37e1ba)]==='image'?this['_layer']=new mars3d__namespace[(_0x2698d3(_0x139bd1._0x217fb9))]['ImageLayer']({'crs':_0x2698d3(_0x139bd1._0x261c74),'private':!![]}):this['_layer']=new mars3d__namespace[(_0x2698d3(0x1e9))]['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x3db230={_0x4cd5fa:0x1ee,_0xbaf026:0x1ec},_0x57429a=_0x162715;this['_map']['addLayer'](this['_layer']),this[_0x57429a(0x1de)]=mars3d__namespace['DomUtil']['create'](_0x57429a(0x1bf),'mars3d-heatmap\x20mars3d-hideDiv',this[_0x57429a(0x1d6)]['container']),this[_0x57429a(_0x3db230._0x4cd5fa)]['positions']&&(this[_0x57429a(_0x3db230._0xbaf026)]=this['options'][_0x57429a(0x1ec)]),this[_0x57429a(0x1ee)][_0x57429a(0x1b9)]&&this['flyToByAnimationEnd']();}[_0x162715(0x1ba)](){const _0x233668=_0x162715;this['_container']&&(mars3d__namespace['DomUtil']['remove'](this[_0x233668(0x1de)]),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this['_layer']);}['addPosition'](_0x58868a,_0x1d7934){const _0x38ed48={_0x3e1325:0x1d5},_0x3d43ee=_0x162715;this['_positions']=this['_positions']||[],this['_positions']['push'](_0x58868a),this[_0x3d43ee(_0x38ed48._0x3e1325)](_0x1d7934);}[_0x162715(0x1cf)](_0x5f55f8,_0x109590){const _0x485d9d=_0x162715;this[_0x485d9d(0x1ae)]=_0x5f55f8,this[_0x485d9d(0x1d5)](_0x109590);}['clear'](){const _0x7ee50f=_0x162715;this['_graphic']&&(this['_layer']['removeGraphic'](this[_0x7ee50f(0x1a9)],!![]),delete this['_graphic']),this['_graphic2']&&(this[_0x7ee50f(0x1ea)]['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x304c3d){const _0x5dd01d={_0x49c730:0x1ab,_0x5b89e1:0x1dd},_0x371bb6=_0x162715;if(!this[_0x371bb6(_0x5dd01d._0x49c730)]||!this[_0x371bb6(0x1d6)]||!this['positions']||this['positions']['length']===0x0)return this;const _0x55d065=this[_0x371bb6(0x1ac)]();if(this[_0x371bb6(0x1b8)]['type']===_0x371bb6(0x1f0))this['_layer'][_0x371bb6(0x1d2)]({'url':_0x55d065['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0x371bb6(0x1a6)]});else this['style']['arc']?this['_graphic']&&_0x304c3d?(this['_graphic'][_0x371bb6(0x1aa)]['image']=_0x55d065,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2'][_0x371bb6(0x1aa)]['image']=_0x55d065,this[_0x371bb6(0x1ce)]['uniforms']['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this[_0x371bb6(_0x5dd01d._0x5b89e1)](_0x55d065):this['_graphic']&&_0x304c3d?this['_graphic']['uniforms'][_0x371bb6(0x1f0)]=_0x55d065:this['_createGraphic'](_0x55d065);return this;}[_0x162715(0x1a7)](_0x31bab4){const _0xf0df92={_0x388399:0x1b0,_0xd1ece5:0x1f1,_0x484bc5:0x1f3},_0x2198db=_0x162715;this['clear'](),this['_graphic']=new mars3d__namespace[(_0x2198db(_0xf0df92._0x388399))]['RectanglePrimitive']({...this['options'],'rectangle':this[_0x2198db(0x1e3)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium[(_0x2198db(_0xf0df92._0xd1ece5))]({'fabric':{'uniforms':{'image':_0x31bab4},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer'][_0x2198db(_0xf0df92._0x484bc5)](this['_graphic']);}['_createArcGraphic'](_0x33c4c7){const _0x583ae4={_0x38bc55:0x1cc,_0x37a9c3:0x1af,_0x437b3c:0x1ed,_0x3c541e:0x1a0,_0x5f0183:0x1ad,_0x59f665:0x1e3,_0x262d5c:0x1b8,_0x1f27aa:0x1f1,_0xdfcf4c:0x1e5,_0xaa9200:0x1ea,_0x4e66a4:0x1ee,_0x4dfb0d:0x1ea},_0x15bbf5=_0x162715;this['clear']();const _0x439f8e=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x15bbf5(_0x583ae4._0x38bc55)],'zFail':Cesium[_0x15bbf5(_0x583ae4._0x37a9c3)][_0x15bbf5(0x1cc)],'zPass':Cesium[_0x15bbf5(_0x583ae4._0x37a9c3)]['REPLACE']},'backFunction':Cesium[_0x15bbf5(_0x583ae4._0x437b3c)][_0x15bbf5(0x1a2)],'backOperation':{'fail':Cesium[_0x15bbf5(0x1af)][_0x15bbf5(0x1cc)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x15bbf5(0x1b5)]},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x15bbf5(0x19a)]}),_0x1085e1=Math['floor'](this['style']['diffHeight']??this[_0x15bbf5(_0x583ae4._0x3c541e)]*0.02)+0.1;this['style']['diffHeight']&&delete this['style']['diffHeight'];const _0x3b5012=(this['style']['splitNum'],0x64);let _0x869989=Math[_0x15bbf5(_0x583ae4._0x5f0183)](this[_0x15bbf5(_0x583ae4._0x59f665)]['height'],this['_rectangle'][_0x15bbf5(0x1c3)]);this[_0x15bbf5(_0x583ae4._0x262d5c)]['granularity']=_0x869989/=_0x3b5012;const _0x58038e=new Cesium[(_0x15bbf5(_0x583ae4._0x1f27aa))]({'fabric':{'uniforms':{'image':_0x33c4c7,'repeat':new Cesium[(_0x15bbf5(0x1ca))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x15bbf5(_0x583ae4._0xdfcf4c)]()},'source':HeatMaterial},'translucent':!![]}),_0x3289ef=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x15bbf5(0x1d4))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x439f8e,'material':_0x58038e,'vertexShaderSource':getVertexShaderSource(_0x1085e1*_0x3289ef)})}),this[_0x15bbf5(_0x583ae4._0xaa9200)]['addGraphic'](this['_graphic']),this['style'][_0x15bbf5(0x1c1)]===0x0&&(this['_graphic2']=new mars3d__namespace['graphic'][(_0x15bbf5(0x1d4))]({...this[_0x15bbf5(_0x583ae4._0x4e66a4)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x439f8e,'material':_0x58038e,'vertexShaderSource':getVertexShaderSource(-_0x1085e1)})}),this[_0x15bbf5(_0x583ae4._0x4dfb0d)]['addGraphic'](this['_graphic2']));}['getRectangle'](_0x2e5df7){const _0x1928a7={_0xb6f727:0x1c6},_0x494e1c=_0x162715;return _0x2e5df7!==null&&_0x2e5df7!==void 0x0&&_0x2e5df7[_0x494e1c(0x1dc)]&&this['_rectangle']?mars3d__namespace[_0x494e1c(_0x1928a7._0xb6f727)]['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x204104={_0x323309:0x1ee,_0x397cec:0x1ef,_0x1ab0ac:0x1ef,_0x46268e:0x1e1,_0x1ca4e4:0x1a3,_0x5280c0:0x1bb,_0x4cbea4:0x1da,_0x358f6b:0x19e,_0x2054a6:0x1b7,_0x3f06d3:0x1a8,_0x576d8a:0x1b2,_0x4f4139:0x1e2,_0x1d07e9:0x1cb},_0x2d9800={_0x9e9093:0x1c2,_0x231d17:0x1c0},_0x10a031={_0x203d16:0x1c8,_0x15a249:0x1c0,_0x807643:0x1e8,_0x439a98:0x1c0},_0x41891a=_0x162715,_0x21a997=this['_positions'],_0x44496c=[];let _0x1dcd1d,_0x2ac209,_0x43560d,_0x31f7a0;_0x21a997['forEach'](_0x222dd3=>{const _0x14f698=_0x5f34,_0x3f559e=mars3d__namespace['LngLatPoint']['parse'](_0x222dd3);if(!_0x3f559e)return;_0x3f559e[_0x14f698(_0x10a031._0x203d16)]=_0x222dd3[_0x14f698(0x1c8)]||0x1,!this['options']['rectangle']&&(_0x1dcd1d===undefined?(_0x1dcd1d=_0x3f559e['lng'],_0x2ac209=_0x3f559e['lng'],_0x43560d=_0x3f559e['lat'],_0x31f7a0=_0x3f559e[_0x14f698(_0x10a031._0x15a249)]):(_0x1dcd1d=Math['min'](_0x1dcd1d,_0x3f559e['lng']),_0x2ac209=Math['max'](_0x2ac209,_0x3f559e[_0x14f698(0x1b6)]),_0x43560d=Math[_0x14f698(_0x10a031._0x807643)](_0x43560d,_0x3f559e['lat']),_0x31f7a0=Math['max'](_0x31f7a0,_0x3f559e[_0x14f698(_0x10a031._0x439a98)]))),_0x44496c['push'](_0x3f559e);});let _0x22bdb1=this['options']['rectangle']||{'xmin':_0x1dcd1d,'xmax':_0x2ac209,'ymin':_0x43560d,'ymax':_0x31f7a0};const _0x18a91a=getMercatorBounds(_0x22bdb1),_0x4ecd16=Math['abs'](_0x18a91a['xmax']-_0x18a91a['xmin']),_0x2b24a4=Math['abs'](_0x18a91a['ymax']-_0x18a91a['ymin']),_0x39084f=Math['max'](_0x4ecd16,_0x2b24a4),_0x367822=Math['min'](_0x4ecd16,_0x2b24a4);this['_mBoundsMax']=_0x39084f;let _0x2c364c=0x1;if(_0x39084f>this[_0x41891a(_0x204104._0x323309)][_0x41891a(_0x204104._0x397cec)])_0x2c364c=_0x39084f/this['options'][_0x41891a(_0x204104._0x1ab0ac)],_0x367822/_0x2c364c<this['options'][_0x41891a(_0x204104._0x46268e)]&&(_0x2c364c=_0x367822/this['options']['minCanvasSize']);else _0x367822<this['options']['minCanvasSize']&&(_0x2c364c=_0x367822/this['options']['minCanvasSize'],_0x39084f/_0x2c364c>this['options']['maxCanvasSize']&&(_0x2c364c=_0x39084f/this['options']['maxCanvasSize']));const _0x2744bb=this['heatStyle']['radius']*1.5,_0x8faf16=_0x4ecd16/_0x2c364c+_0x2744bb*0x2,_0x240ad1=_0x2b24a4/_0x2c364c+_0x2744bb*0x2,_0x2353da=_0x2744bb*_0x2c364c;_0x18a91a['xmin']-=_0x2353da,_0x18a91a['ymin']-=_0x2353da,_0x18a91a['xmax']+=_0x2353da,_0x18a91a['ymax']+=_0x2353da,this['_scale']=_0x2c364c,_0x22bdb1=geLatLngBounds(_0x18a91a),this['_rectangle']=Cesium[_0x41891a(_0x204104._0x1ca4e4)][_0x41891a(0x1bc)](_0x22bdb1['xmin'],_0x22bdb1['ymin'],_0x22bdb1['xmax'],_0x22bdb1[_0x41891a(_0x204104._0x5280c0)]);let _0x1c1cc5=_0x44496c[0x0]['value']??0x1,_0x2bd941=_0x44496c[0x0]['value']??0x0;const _0x4d7091=[];_0x44496c['forEach'](_0x46c76e=>{const _0x3731df=_0x41891a,_0x344374=mars3d__namespace[_0x3731df(_0x2d9800._0x9e9093)]['lonlat2mercator']([_0x46c76e['lng'],_0x46c76e[_0x3731df(_0x2d9800._0x231d17)]]),_0x2f0baf=_0x46c76e['value']||0x1,_0x59509d=Math['round']((_0x344374[0x0]-_0x18a91a['xmin'])/_0x2c364c),_0x1c1c9a=Math[_0x3731df(0x1b1)]((_0x18a91a['ymax']-_0x344374[0x1])/_0x2c364c);_0x1c1cc5=Math['max'](_0x1c1cc5,_0x2f0baf),_0x2bd941=Math['min'](_0x2bd941,_0x2f0baf),_0x4d7091[_0x3731df(0x1b4)]({'x':_0x59509d,'y':_0x1c1c9a,'value':_0x2f0baf});});const _0x2f3c29={'min':this['options']['min']??_0x2bd941,'max':this[_0x41891a(_0x204104._0x323309)][_0x41891a(0x1ad)]??_0x1c1cc5,'data':_0x4d7091};this['_last_heatData']=_0x2f3c29;if(!this[_0x41891a(_0x204104._0x4cbea4)]||_0x18a91a[_0x41891a(0x1f7)]!==this['_last_mBounds']['xmin']||_0x18a91a['ymin']!==this['_last_mBounds'][_0x41891a(_0x204104._0x358f6b)]||_0x18a91a['xmax']!==this[_0x41891a(0x1da)][_0x41891a(_0x204104._0x2054a6)]||_0x18a91a['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x18a91a,this[_0x41891a(0x1de)]['style']['cssText']='width:'+_0x8faf16+'px;height:'+_0x240ad1+'px;';const _0x4f739c={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x4f739c):this['_heat'][_0x41891a(_0x204104._0x3f06d3)](_0x4f739c);}this[_0x41891a(_0x204104._0x576d8a)]['setData'](_0x2f3c29);const _0x4395ea=mars3d__namespace[_0x41891a(_0x204104._0x4f4139)]['copyCanvas'](this['_heat'][_0x41891a(_0x204104._0x1d07e9)]['canvas']);return _0x4395ea;}['_getArcHeatCanvas'](){const _0x282587={_0x56c4a5:0x1f6,_0x2836ff:0x1d3,_0x586786:0x1d0,_0x52cc11:0x1d7,_0x1cca99:0x1c9,_0x5a746c:0x1cb,_0xe1abf:0x1ee},_0x2ff5fc=_0x162715;this['_heat']['configure']({'radius':this[_0x2ff5fc(_0x282587._0x56c4a5)]['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle'][_0x2ff5fc(_0x282587._0x2836ff)]*this[_0x2ff5fc(0x1b8)]['arcBlurScale'],'gradient':this['heatStyle'][_0x2ff5fc(_0x282587._0x586786)]||{0.25:'rgb(0,0,0)',0.55:_0x2ff5fc(_0x282587._0x52cc11),0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x2e17ab=mars3d__namespace['DomUtil'][_0x2ff5fc(_0x282587._0x1cca99)](this['_heat'][_0x2ff5fc(_0x282587._0x5a746c)]['canvas']);return this['_heat']['configure'](this[_0x2ff5fc(_0x282587._0xe1abf)]['heatStyle']),_0x2e17ab;}['getPointData'](_0x78a7ae){const _0x1ec5b8={_0x4993fe:0x1be,_0x26e616:0x1da,_0x53379f:0x1f7,_0x1a5610:0x19f,_0x442ddd:0x1bd,_0x52fa40:0x1d1},_0x330d8e=_0x162715,_0x473fc3=mars3d__namespace[_0x330d8e(_0x1ec5b8._0x4993fe)]['parse'](_0x78a7ae);if(!_0x473fc3)return{};const _0x570861=mars3d__namespace[_0x330d8e(0x1c2)][_0x330d8e(0x19c)]([_0x473fc3[_0x330d8e(0x1b6)],_0x473fc3['lat']]),_0x2b72bd=this[_0x330d8e(_0x1ec5b8._0x26e616)],_0x5d6023=Math['round']((_0x570861[0x0]-_0x2b72bd[_0x330d8e(_0x1ec5b8._0x53379f)])/this['_scale']),_0x2cd448=Math[_0x330d8e(0x1b1)]((_0x2b72bd['ymax']-_0x570861[0x1])/this[_0x330d8e(_0x1ec5b8._0x1a5610)]),_0x538365=this['_heat']['getValueAt']({'x':_0x5d6023,'y':_0x2cd448}),_0x567dd8=this['_heat']['_renderer'][_0x330d8e(_0x1ec5b8._0x442ddd)]['getImageData'](_0x5d6023-0x1,_0x2cd448-0x1,0x1,0x1)['data'];return{'x':_0x5d6023,'y':_0x2cd448,'value':_0x538365,'color':_0x330d8e(_0x1ec5b8._0x52fa40)+_0x567dd8[0x0]+','+_0x567dd8[0x1]+','+_0x567dd8[0x2]+','+_0x567dd8[0x3]+')'};}}mars3d__namespace[_0x162715(0x1e9)]['HeatLayer']=HeatLayer,mars3d__namespace['LayerUtil'][_0x162715(0x1a4)]('heat',HeatLayer);function _0x5f34(_0x2d2c14,_0x13bb31){const _0x5abf62=_0x5abf();return _0x5f34=function(_0x5f341a,_0x4239c2){_0x5f341a=_0x5f341a-0x19a;let _0x226537=_0x5abf62[_0x5f341a];return _0x226537;},_0x5f34(_0x2d2c14,_0x13bb31);}function getMercatorBounds(_0x534f87){const _0x7bd36d={_0x3ae417:0x19c,_0x260576:0x1f7,_0x4607c5:0x1c2,_0x5a02ee:0x19c,_0x39f13b:0x1bb},_0x3f2780=_0x162715,_0x1c6192=mars3d__namespace['PointTrans'][_0x3f2780(_0x7bd36d._0x3ae417)]([_0x534f87[_0x3f2780(_0x7bd36d._0x260576)],_0x534f87['ymin']]),_0x3aee5f=mars3d__namespace[_0x3f2780(_0x7bd36d._0x4607c5)][_0x3f2780(_0x7bd36d._0x5a02ee)]([_0x534f87['xmax'],_0x534f87[_0x3f2780(_0x7bd36d._0x39f13b)]]);return{'xmin':_0x1c6192[0x0],'ymin':_0x1c6192[0x1],'xmax':_0x3aee5f[0x0],'ymax':_0x3aee5f[0x1]};}function geLatLngBounds(_0x494f65){const _0x9df6e2=_0x162715,_0x223055=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x494f65['xmin'],_0x494f65['ymin']]),_0x3525d3=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x494f65[_0x9df6e2(0x1b7)],_0x494f65[_0x9df6e2(0x1bb)]]);return{'xmin':_0x223055[0x0],'ymin':_0x223055[0x1],'xmax':_0x3525d3[0x0],'ymax':_0x3525d3[0x1]};}function getVertexShaderSource(_0x5c2b42){const _0x1e6c6f=_0x162715;return _0x1e6c6f(0x1db)+_0x5c2b42+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports[_0x162715(0x1cd)]=HeatLayer,Object['defineProperty'](exports,_0x162715(0x1a1),{'value':!![]});
}));
