/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.7
 * 编译日期：2023-05-16 21:12:02
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x39c7fc=_0x5165;(function(_0x23e0eb,_0x27b439){const _0x13f8a2={_0x702d:0xe9,_0x418ca0:0xd2},_0x194e22=_0x5165,_0x3ea6d3=_0x23e0eb();while(!![]){try{const _0x13a862=-parseInt(_0x194e22(0xda))/0x1+-parseInt(_0x194e22(_0x13f8a2._0x702d))/0x2*(-parseInt(_0x194e22(_0x13f8a2._0x418ca0))/0x3)+parseInt(_0x194e22(0xef))/0x4+-parseInt(_0x194e22(0xd5))/0x5+-parseInt(_0x194e22(0xf7))/0x6+parseInt(_0x194e22(0xc1))/0x7*(parseInt(_0x194e22(0xca))/0x8)+-parseInt(_0x194e22(0xbc))/0x9;if(_0x13a862===_0x27b439)break;else _0x3ea6d3['push'](_0x3ea6d3['shift']());}catch(_0x1e7415){_0x3ea6d3['push'](_0x3ea6d3['shift']());}}}(_0x5299,0x37321));function _0x5165(_0x21bd4d,_0x5e8aec){const _0x529958=_0x5299();return _0x5165=function(_0x516500,_0x1c378a){_0x516500=_0x516500-0xb1;let _0x36b4ab=_0x529958[_0x516500];return _0x36b4ab;},_0x5165(_0x21bd4d,_0x5e8aec);}function _interopNamespace(_0x47166d){const _0x3bca19=_0x5165;if(_0x47166d&&_0x47166d['__esModule'])return _0x47166d;var _0x37697b=Object['create'](null);return _0x47166d&&Object['keys'](_0x47166d)[_0x3bca19(0xfb)](function(_0x759789){if(_0x759789!=='default'){var _0x54a2cf=Object['getOwnPropertyDescriptor'](_0x47166d,_0x759789);Object['defineProperty'](_0x37697b,_0x759789,_0x54a2cf['get']?_0x54a2cf:{'enumerable':!![],'get':function(){return _0x47166d[_0x759789];}});}}),_0x37697b['default']=_0x47166d,_0x37697b;}function _0x5299(){const _0x3b3e22=['lat','setPositions','2080GgtpsJ','type','value','bumpMap','lng','StencilOperation','diffHeight','_positions','393147QUHCnw','_updatePositionsHook','push','814740blciEh','ALWAYS','_removedHook','positions','DomUtil','107300XiFiMp','layer','xmin','canvas','granularity','minCanvasSize','_rectangle','configure','_getHeatCanvas','_last_mBounds','maxCanvasSize','addLayer','_setOptionsHook','uniforms','graphic','4oAqyxI','coordinates','splitNum','_graphic2','style','fromCache','1092944mUVWOF','_graphic','heatStyle','clientWidth','PointTrans','LayerUtil','heat','ImageLayer','1604886yHUDmL','merge','_layer','getValueAt','forEach','ALPHA_BLEND','_getArcHeatCanvas','div','parse','xmax','round','min','clear','ymax','options','_heat','lonlat2mercator','LngLatPoint','arcDirection','_mBoundsMax','RenderState','container','addGraphic','green','image/png','12276SdCNDI','cssText','rgba(','_renderer','EllipsoidSurfaceAppearance','6188slbOGv','body','width:','Color','max','px;height:','Material'];_0x5299=function(){return _0x3b3e22;};return _0x5299();}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x39c7fc(0xba),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x5f4792={}){const _0xefca9b={_0x764ffc:0xf2,_0x36b5a9:0xc2,_0x58b897:0xdf,_0x44cbcd:0xed},_0x2a2e5b=_0x39c7fc;super(_0x5f4792),this['options']['maxCanvasSize']=this[_0x2a2e5b(0xb1)]['maxCanvasSize']??document[_0x2a2e5b(0xc2)][_0x2a2e5b(_0xefca9b._0x764ffc)],this['options'][_0x2a2e5b(0xe4)]=Math['min'](this[_0x2a2e5b(0xb1)]['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this[_0x2a2e5b(0xb1)]['minCanvasSize']??document[_0x2a2e5b(_0xefca9b._0x36b5a9)]['clientHeight'],this['options'][_0x2a2e5b(_0xefca9b._0x58b897)]=Math[_0x2a2e5b(0xc5)](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']||{}},this['options']['style']={...DEF_STYLE,...this['options'][_0x2a2e5b(_0xefca9b._0x44cbcd)]||{}};}get['layer'](){return this['_layer'];}get[_0x39c7fc(0xf1)](){const _0x3dc3c7=_0x39c7fc;return this[_0x3dc3c7(0xb1)]['heatStyle'];}set['heatStyle'](_0x2d2ac2){const _0x48db8c={_0x213978:0xd3},_0x5d037d=_0x39c7fc;this['options']['heatStyle']=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x2d2ac2),this['_heat']&&(this['_heat']['configure'](this['options'][_0x5d037d(0xf1)]),this[_0x5d037d(_0x48db8c._0x213978)](!![]));}get[_0x39c7fc(0xed)](){return this['options']['style'];}set['style'](_0x53a67f){const _0x487992=_0x39c7fc;this['options']['style']=mars3d__namespace['Util'][_0x487992(0xf8)](this['options']['style'],_0x53a67f);}get['positions'](){return this['_positions'];}set['positions'](_0xe05821){this['setPositions'](_0xe05821);}get[_0x39c7fc(0xea)](){const _0x35f119=[];return this['points']['forEach'](_0x2800cd=>{const _0x4145b3=_0x5165;_0x35f119[_0x4145b3(0xd4)](_0x2800cd['toArray']());}),_0x35f119;}get['rectangle'](){return this['_rectangle'];}[_0x39c7fc(0xe6)](_0x1174c1,_0x17fc6a){const _0x23c350={_0x527b44:0xd8},_0xe3d1ac=_0x39c7fc;_0x1174c1[_0xe3d1ac(_0x23c350._0x527b44)]&&(this['positions']=_0x1174c1['positions']);}['_mountedHook'](){const _0x3a2bde={_0xa7e482:0xf6},_0x28b997=_0x39c7fc;this['style'][_0x28b997(0xcb)]==='image'?this['_layer']=new mars3d__namespace['layer'][(_0x28b997(_0x3a2bde._0xa7e482))]({'crs':'EPSG:3857','private':!![]}):this[_0x28b997(0xf9)]=new mars3d__namespace[(_0x28b997(0xdb))]['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x76d0f3={_0xfd73dc:0xf9},_0x12fde1=_0x39c7fc;this['_map'][_0x12fde1(0xe5)](this[_0x12fde1(_0x76d0f3._0xfd73dc)]),this['options']['positions']&&(this['positions']=this[_0x12fde1(0xb1)]['positions']),this['options']['flyTo']&&this['flyToByAnimationEnd']();}[_0x39c7fc(0xd7)](){const _0x2715cd={_0xf9aef0:0xb8,_0x30e298:0x103,_0x582dd7:0xf9},_0x3a9472=_0x39c7fc;this['heatStyle']['container']&&(mars3d__namespace['DomUtil']['remove'](this['heatStyle']['container']),delete this['heatStyle'][_0x3a9472(_0x2715cd._0xf9aef0)]),this[_0x3a9472(_0x2715cd._0x30e298)](),this['_map']['removeLayer'](this[_0x3a9472(_0x2715cd._0x582dd7)]);}['addPosition'](_0x1b851a,_0x428c97){const _0x18a1dc={_0x440de6:0xd1},_0x4e5df1=_0x39c7fc;this[_0x4e5df1(_0x18a1dc._0x440de6)]=this['_positions']||[],this['_positions']['push'](_0x1b851a),this['_updatePositionsHook'](_0x428c97);}[_0x39c7fc(0xc9)](_0x17ce7d,_0x4b695d){this['_positions']=_0x17ce7d,this['_updatePositionsHook'](_0x4b695d);}['clear'](){const _0x359556=_0x39c7fc;this['_graphic']&&(this[_0x359556(0xf9)]['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this[_0x359556(0xec)]);}[_0x39c7fc(0xd3)](_0x338f43){const _0x39f877={_0x8e6c9:0xe2,_0x32095b:0xbb,_0x585902:0xf0,_0x3864e4:0xcd,_0x475d20:0xec,_0x1a0dc6:0xec},_0x1dcfd2=_0x39c7fc;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x2ed8c7=this[_0x1dcfd2(_0x39f877._0x8e6c9)]();if(this['style']['type']==='image')this[_0x1dcfd2(0xf9)]['setOptions']({'url':_0x2ed8c7['toDataURL'](_0x1dcfd2(_0x39f877._0x32095b)),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this['style']['arc']?this['_graphic']&&_0x338f43?(this['_graphic'][_0x1dcfd2(0xe7)]['image']=_0x2ed8c7,this[_0x1dcfd2(_0x39f877._0x585902)]['uniforms'][_0x1dcfd2(_0x39f877._0x3864e4)]=this['_getArcHeatCanvas'](),this[_0x1dcfd2(_0x39f877._0x475d20)]&&(this[_0x1dcfd2(_0x39f877._0x1a0dc6)][_0x1dcfd2(0xe7)]['image']=_0x2ed8c7,this['_graphic2']['uniforms'][_0x1dcfd2(0xcd)]=this['_graphic'][_0x1dcfd2(0xe7)]['bumpMap'])):this['_createArcGraphic'](_0x2ed8c7):this[_0x1dcfd2(0xf0)]&&_0x338f43?this['_graphic']['uniforms']['image']=_0x2ed8c7:this['_createGraphic'](_0x2ed8c7);return this;}['_createGraphic'](_0x1f18ab){const _0x17950d={_0x4b8a89:0xf0,_0x2f3129:0xc0,_0x5c3447:0xf0},_0x3575a0=_0x39c7fc;this[_0x3575a0(0x103)](),this[_0x3575a0(_0x17950d._0x4b8a89)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x3575a0(_0x17950d._0x2f3129))]({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1f18ab},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x3575a0(0xf9)]['addGraphic'](this[_0x3575a0(_0x17950d._0x5c3447)]);}['_createArcGraphic'](_0x33306d){const _0x580adf={_0x30faed:0xb7,_0x4f3259:0xee,_0x58c351:0xd6,_0x598433:0xcf,_0xcf0977:0xd0,_0x345217:0xb5,_0x31b15b:0xb1,_0x40eeea:0xf9,_0x138239:0xe8},_0x2b94d5=_0x39c7fc;this[_0x2b94d5(0x103)]();const _0x2aa995=Cesium[_0x2b94d5(_0x580adf._0x30faed)][_0x2b94d5(_0x580adf._0x4f3259)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction'][_0x2b94d5(_0x580adf._0x58c351)],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x2b94d5(0xcf)]['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium[_0x2b94d5(_0x580adf._0x598433)]['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState'][_0x2b94d5(0xfc)]}),_0xb13a1f=Math['floor'](this['style'][_0x2b94d5(0xd0)]??this['_mBoundsMax']*0.02)+0.1;this['style'][_0x2b94d5(_0x580adf._0xcf0977)]&&delete this['style'][_0x2b94d5(_0x580adf._0xcf0977)];const _0x13f7ed=(this['style'][_0x2b94d5(0xeb)],0x64);let _0x148cc3=Math[_0x2b94d5(0xc5)](this[_0x2b94d5(0xe0)]['height'],this['_rectangle']['width']);this[_0x2b94d5(0xed)][_0x2b94d5(0xde)]=_0x148cc3/=_0x13f7ed;const _0x2e09d9=new Cesium[(_0x2b94d5(0xc7))]({'fabric':{'uniforms':{'image':_0x33306d,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x2b94d5(0xc4))](0x1,0x1,0x1,0x0),'bumpMap':this[_0x2b94d5(0xfd)]()},'source':HeatMaterial},'translucent':!![]}),_0x1684f0=this['style'][_0x2b94d5(_0x580adf._0x345217)]||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x2b94d5(_0x580adf._0x31b15b)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x2aa995,'material':_0x2e09d9,'vertexShaderSource':getVertexShaderSource(_0xb13a1f*_0x1684f0)})}),this[_0x2b94d5(_0x580adf._0x40eeea)]['addGraphic'](this[_0x2b94d5(0xf0)]),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace[(_0x2b94d5(_0x580adf._0x138239))]['RectanglePrimitive']({...this[_0x2b94d5(0xb1)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x2aa995,'material':_0x2e09d9,'vertexShaderSource':getVertexShaderSource(-_0xb13a1f)})}),this['_layer'][_0x2b94d5(0xb9)](this['_graphic2']));}['getRectangle'](_0x2d1c2e){const _0x4924c7={_0x3b3853:0xe0},_0x4798d5=_0x39c7fc;return _0x2d1c2e!==null&&_0x2d1c2e!==void 0x0&&_0x2d1c2e['isFormat']&&this[_0x4798d5(_0x4924c7._0x3b3853)]?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}[_0x39c7fc(0xe2)](){const _0x528567={_0x484020:0xb6,_0x38a948:0xdf,_0xcb243f:0xe4,_0x460564:0xfb,_0x437ebd:0xb1,_0x5d7d27:0x102,_0x596a85:0xe3,_0x1b8013:0xb8,_0x36f578:0xbd,_0x5275a1:0xc3,_0x4b61e0:0xc6,_0x415c32:0xe1},_0x2055b9={_0x916459:0xce,_0x4af3cb:0xc8,_0x441031:0xcc,_0x364c79:0x104,_0x10d22c:0xc5},_0x558cfd={_0x4eae2d:0xb1,_0x104c6f:0x102},_0x1feb49=_0x39c7fc,_0x366851=this['_positions'],_0xa50efe=[];let _0x56ff0b,_0x4b390d,_0x7cfce3,_0x4ba3c2;_0x366851['forEach'](_0xd3c0a5=>{const _0x39c95c=_0x5165,_0x287f24=mars3d__namespace[_0x39c95c(0xb4)]['parse'](_0xd3c0a5);if(!_0x287f24)return;_0x287f24[_0x39c95c(0xcc)]=_0xd3c0a5['value']||0x1,!this[_0x39c95c(_0x558cfd._0x4eae2d)]['rectangle']&&(_0x56ff0b===undefined?(_0x56ff0b=_0x287f24['lng'],_0x4b390d=_0x287f24[_0x39c95c(0xce)],_0x7cfce3=_0x287f24['lat'],_0x4ba3c2=_0x287f24[_0x39c95c(0xc8)]):(_0x56ff0b=Math['min'](_0x56ff0b,_0x287f24['lng']),_0x4b390d=Math['max'](_0x4b390d,_0x287f24['lng']),_0x7cfce3=Math[_0x39c95c(_0x558cfd._0x104c6f)](_0x7cfce3,_0x287f24['lat']),_0x4ba3c2=Math['max'](_0x4ba3c2,_0x287f24[_0x39c95c(0xc8)]))),_0xa50efe[_0x39c95c(0xd4)](_0x287f24);});let _0x52f7ea=this['options']['rectangle']||{'xmin':_0x56ff0b,'xmax':_0x4b390d,'ymin':_0x7cfce3,'ymax':_0x4ba3c2};const _0x54c041=getMercatorBounds(_0x52f7ea),_0x140149=Math['abs'](_0x54c041['xmax']-_0x54c041['xmin']),_0x41969d=Math['abs'](_0x54c041['ymax']-_0x54c041['ymin']),_0x1a7027=Math['max'](_0x140149,_0x41969d),_0x2c63f5=Math['min'](_0x140149,_0x41969d);this[_0x1feb49(_0x528567._0x484020)]=_0x1a7027;let _0x21dc16=0x1;if(_0x1a7027>this['options'][_0x1feb49(0xe4)])_0x21dc16=_0x1a7027/this['options'][_0x1feb49(0xe4)],_0x2c63f5/_0x21dc16<this['options'][_0x1feb49(_0x528567._0x38a948)]&&(_0x21dc16=_0x2c63f5/this['options']['minCanvasSize']);else _0x2c63f5<this['options']['minCanvasSize']&&(_0x21dc16=_0x2c63f5/this['options'][_0x1feb49(0xdf)],_0x1a7027/_0x21dc16>this['options'][_0x1feb49(0xe4)]&&(_0x21dc16=_0x1a7027/this['options'][_0x1feb49(_0x528567._0xcb243f)]));const _0x31d4c0=this['heatStyle']['radius']*1.5,_0xcef6ea=_0x140149/_0x21dc16+_0x31d4c0*0x2,_0x1198eb=_0x41969d/_0x21dc16+_0x31d4c0*0x2,_0x2d4ae5=_0x31d4c0*_0x21dc16;_0x54c041[_0x1feb49(0xdc)]-=_0x2d4ae5,_0x54c041['ymin']-=_0x2d4ae5,_0x54c041['xmax']+=_0x2d4ae5,_0x54c041['ymax']+=_0x2d4ae5,this['_scale']=_0x21dc16,_0x52f7ea=geLatLngBounds(_0x54c041),this[_0x1feb49(0xe0)]=Cesium['Rectangle']['fromDegrees'](_0x52f7ea['xmin'],_0x52f7ea['ymin'],_0x52f7ea['xmax'],_0x52f7ea['ymax']);let _0x31343c=_0xa50efe[0x0]['value']??0x1,_0x23ab5f=_0xa50efe[0x0]['value']??0x0;const _0x5e3b7f=[];_0xa50efe[_0x1feb49(_0x528567._0x460564)](_0x20dbc6=>{const _0x3b7411=_0x1feb49,_0x2fa8af=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x20dbc6[_0x3b7411(_0x2055b9._0x916459)],_0x20dbc6[_0x3b7411(_0x2055b9._0x4af3cb)]]),_0x252c9a=_0x20dbc6[_0x3b7411(_0x2055b9._0x441031)]||0x1,_0x3a3ce4=Math['round']((_0x2fa8af[0x0]-_0x54c041['xmin'])/_0x21dc16),_0x21f664=Math['round']((_0x54c041[_0x3b7411(_0x2055b9._0x364c79)]-_0x2fa8af[0x1])/_0x21dc16);_0x31343c=Math[_0x3b7411(_0x2055b9._0x10d22c)](_0x31343c,_0x252c9a),_0x23ab5f=Math['min'](_0x23ab5f,_0x252c9a),_0x5e3b7f['push']({'x':_0x3a3ce4,'y':_0x21f664,'value':_0x252c9a});});const _0x313fbb={'min':this[_0x1feb49(_0x528567._0x437ebd)][_0x1feb49(_0x528567._0x5d7d27)]??_0x23ab5f,'max':this[_0x1feb49(_0x528567._0x437ebd)]['max']??_0x31343c,'data':_0x5e3b7f};this['_last_heatData']=_0x313fbb;(!this['_last_mBounds']||_0x54c041['xmin']!==this['_last_mBounds'][_0x1feb49(0xdc)]||_0x54c041['ymin']!==this[_0x1feb49(0xe3)]['ymin']||_0x54c041['xmax']!==this['_last_mBounds']['xmax']||_0x54c041['ymax']!==this[_0x1feb49(_0x528567._0x596a85)]['ymax'])&&(this['_last_mBounds']=_0x54c041,!this[_0x1feb49(0xf1)][_0x1feb49(_0x528567._0x1b8013)]&&(this['heatStyle']['container']=mars3d__namespace[_0x1feb49(0xd9)]['create'](_0x1feb49(0xfe),'mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container'])),this[_0x1feb49(0xf1)]['container']['style'][_0x1feb49(_0x528567._0x36f578)]=_0x1feb49(_0x528567._0x5275a1)+_0xcef6ea+_0x1feb49(_0x528567._0x4b61e0)+_0x1198eb+'px;',!this['_heat']?this[_0x1feb49(0xb2)]=h337__namespace['create'](this['heatStyle']):this[_0x1feb49(0xb2)][_0x1feb49(_0x528567._0x415c32)](this['heatStyle']));this['_heat']['setData'](_0x313fbb);const _0x512493=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x1feb49(0xb2)][_0x1feb49(0xbf)][_0x1feb49(0xdd)]);return _0x512493;}['_getArcHeatCanvas'](){const _0x470acb={_0x543835:0xe1},_0x1dbe1c=_0x39c7fc;this['_heat'][_0x1dbe1c(_0x470acb._0x543835)]({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this[_0x1dbe1c(0xf1)]['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x57afdb=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this['options']['heatStyle']),_0x57afdb;}['getPointData'](_0x563254){const _0x5d40c7={_0xd0bf82:0xff,_0x4fbf76:0xf3,_0x41f64e:0x101},_0x3f0d5c=_0x39c7fc,_0x5deed0=mars3d__namespace['LngLatPoint'][_0x3f0d5c(_0x5d40c7._0xd0bf82)](_0x563254);if(!_0x5deed0)return{};const _0x27db0e=mars3d__namespace[_0x3f0d5c(_0x5d40c7._0x4fbf76)][_0x3f0d5c(0xb3)]([_0x5deed0[_0x3f0d5c(0xce)],_0x5deed0['lat']]),_0x28807b=this[_0x3f0d5c(0xe3)],_0x185ae2=Math[_0x3f0d5c(_0x5d40c7._0x41f64e)]((_0x27db0e[0x0]-_0x28807b['xmin'])/this['_scale']),_0x219471=Math['round']((_0x28807b['ymax']-_0x27db0e[0x1])/this['_scale']),_0x21ec56=this[_0x3f0d5c(0xb2)][_0x3f0d5c(0xfa)]({'x':_0x185ae2,'y':_0x219471}),_0x308fbe=this['_heat']['_renderer']['ctx']['getImageData'](_0x185ae2-0x1,_0x219471-0x1,0x1,0x1)['data'];return{'x':_0x185ae2,'y':_0x219471,'value':_0x21ec56,'color':_0x3f0d5c(0xbe)+_0x308fbe[0x0]+','+_0x308fbe[0x1]+','+_0x308fbe[0x2]+','+_0x308fbe[0x3]+')'};}}mars3d__namespace[_0x39c7fc(0xdb)]['HeatLayer']=HeatLayer,mars3d__namespace[_0x39c7fc(0xf4)]['register'](_0x39c7fc(0xf5),HeatLayer);function getMercatorBounds(_0x4a9c4b){const _0x519c6f=_0x39c7fc,_0x4a01aa=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x4a9c4b['xmin'],_0x4a9c4b['ymin']]),_0x4ed021=mars3d__namespace[_0x519c6f(0xf3)]['lonlat2mercator']([_0x4a9c4b['xmax'],_0x4a9c4b['ymax']]);return{'xmin':_0x4a01aa[0x0],'ymin':_0x4a01aa[0x1],'xmax':_0x4ed021[0x0],'ymax':_0x4ed021[0x1]};}function geLatLngBounds(_0xca435c){const _0x2029fd={_0x1a189c:0x104},_0x2c4b05=_0x39c7fc,_0x41f9c5=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xca435c['xmin'],_0xca435c['ymin']]),_0x51898a=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xca435c[_0x2c4b05(0x100)],_0xca435c[_0x2c4b05(_0x2029fd._0x1a189c)]]);return{'xmin':_0x41f9c5[0x0],'ymin':_0x41f9c5[0x1],'xmax':_0x51898a[0x0],'ymax':_0x51898a[0x1]};}function getVertexShaderSource(_0xc1e3d0){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0xc1e3d0+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
