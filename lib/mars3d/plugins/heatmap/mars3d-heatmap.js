/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.4.10
 * 编译日期：2022-10-17 17:29:40
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2022-06-01
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x449843=_0x31a7;(function(_0xd20c0c,_0x16f338){const _0x27d0fc=_0x31a7,_0xc3d24c=_0xd20c0c();while(!![]){try{const _0xa38027=-parseInt(_0x27d0fc(0x221))/0x1+-parseInt(_0x27d0fc(0x1b1))/0x2+-parseInt(_0x27d0fc(0x1c9))/0x3+parseInt(_0x27d0fc(0x204))/0x4*(parseInt(_0x27d0fc(0x1ed))/0x5)+-parseInt(_0x27d0fc(0x1e5))/0x6*(parseInt(_0x27d0fc(0x1ae))/0x7)+parseInt(_0x27d0fc(0x1fb))/0x8+parseInt(_0x27d0fc(0x1f4))/0x9*(parseInt(_0x27d0fc(0x1c7))/0xa);if(_0xa38027===_0x16f338)break;else _0xc3d24c['push'](_0xc3d24c['shift']());}catch(_0x22e5e5){_0xc3d24c['push'](_0xc3d24c['shift']());}}}(_0x47a2,0x8cbfe));function _interopNamespace(_0x3d936e){const _0x425ddc=_0x31a7;if(_0x3d936e&&_0x3d936e['__esModule'])return _0x3d936e;var _0x41c88e=Object[_0x425ddc(0x1b5)](null);return _0x3d936e&&Object['keys'](_0x3d936e)['forEach'](function(_0x490720){const _0x371fa9=_0x425ddc;if(_0x490720!=='default'){var _0x1ec32a=Object['getOwnPropertyDescriptor'](_0x3d936e,_0x490720);Object[_0x371fa9(0x210)](_0x41c88e,_0x490720,_0x1ec32a[_0x371fa9(0x1f2)]?_0x1ec32a:{'enumerable':!![],'get':function(){return _0x3d936e[_0x490720];}});}}),_0x41c88e[_0x425ddc(0x1a3)]=_0x3d936e,_0x41c88e;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x449843(0x211);if(!h337__namespace[_0x449843(0x1b5)])throw new Error(_0x449843(0x1d9));function _0x47a2(){const _0x36f599=['x2DYyxbOAwm','B3b0Aw9UCW','Bg5N','CMDIkde0mcWXndaSmtqWkq','zMX5vg8','yxjJ','y29WEunHBNzHCW','x3nJywXL','x3jLBw92zwriB29R','twf0zxjPywW','ndiZotKWtMDct3fQ','y3nZvgv4Da','y29UzMLNDxjL','ody5mJqWtwjYEhvU','CgfYC2u','ug9SEvv0AwW','q2fYDgvZAwfUmG','y3jLyxrL','x2nYzwf0zufYy0DYyxbOAwm','y3r4','x3jLy3rHBMDSzq','y29UDgfPBMvY','zgf0yq','yMX1CG','Bgf5zxi','vKvsvevyx0zpuK1bva','zgL2','x2fKzgvKsg9VAW','q2vZAxvT','x2XHC3rFBujVDw5KCW','D2LKDgG','z2v0uMvJDgfUz2XL','Ew1PBG','C2v0ug9ZAxrPB25Z','Eg1HEa','mJC3mg51u2TbBa','CMfKAxvZ','mJa2otm4nu9ds3fhDq','uMvJDgfUz2XLuhjPBwL0AxzL','tgf5zxjvDgLS','ywrKr3jHCgHPyW','Dw5PzM9YBxm','x3bVC2L0Aw9UCW','qMXLBMrPBMDtDgf0zq','x3jLBMrLCMvY','x3nLDe9WDgLVBNniB29R','rwXSAxbZB2LKu3vYzMfJzufWCgvHCMfUy2u','ywrKug9ZAxrPB24','u3rLBMnPBe9WzxjHDgLVBG','uMvUzgvYu3rHDgu','ywjZ','x2HLyxq','CMDIkdiXnIWYmtySmJe2kq','6k+35BYv5ywLigHLyxrTyxaUANmG5BQtia','Ew1HEa','uKvqtefdrq','DMfSDwu','CMvK','z3jHCgHPyW','zM9YrwfJAa','x2XHC3rFAgvHDerHDge','qMfZzuXHEwvY','z3jLzw4','CM91BMq','yxjJuMfKAxvZu2nHBgu','mtaYA0XYCg54','CMDIkdi1nsWYntuSmJu1kq','z2v0vMfSDwvbDa','x2DLDefYy0HLyxrdyw52yxm','quXxqvLt','yNvTCe1HCa','C3r5Bgu','CMvNAxn0zxi','mZG1otq1rLzuv1bM','x2DLDeHLyxrdyw52yxm','CMvTB3zLr3jHCgHPyW','C3bSAxroDw0','vxrPBa','z2v0','x2XHEwvY','ntq5odfNrwLwAem','ug9PBNruCMfUCW','x21HCa','tg5Ntgf0ug9PBNq','Bg9UBgf0mM1LCMnHDg9Y','ChvZAa','u3rLBMnPBez1BMn0Aw9U','ndC2mdu1mNjmvKP3BG','BgvUz3rO','rg9TvxrPBa','C2v0rgf0yq','zNjVBunHy2HL','BwfYCZnKlwHLyxrTyxaGBwfYCZnKlwHPzgveAxy','quXqsefFqKXftKq','x21cB3vUzhnnyxG','uMvJDgfUz2XL','ndr1qw9Ht1y','Eg1PBG','Cg9PBNrZ','zNjVBurLz3jLzxm','z2v0ug9PBNreyxrH','Bwf4q2fUDMfZu2L6zq','Bgf0','BwvYz2u','zgLMzKHLAwDODa','yM9KEq','AgvPz2H0','D2LKDgG6','zgvMAw5LuhjVCgvYDhK','Dw5PzM9YBsbZyw1WBgvYmKqGAw1Hz2u7cGPJEM1FBwf0zxjPywWGy3PTx2DLDe1HDgvYAwfSkgn6Bv9TyxrLCMLHBeLUChv0ig1HDgvYAwfSsw5WDxqPihSkicbJEM1FBwf0zxjPywWGBwf0zxjPywWGpsbJEM1Fz2v0rgvMyxvSDe1HDgvYAwfSkg1HDgvYAwfSsw5WDxqPoWOGihzLyZiGC3qGpsbTyxrLCMLHBeLUChv0lNn0oWOGihzLyZqGy29SB3jjBwfNzsa9ihrLEhr1CMuYrcHPBwfNzsWGC3qPoWOGigLMkgnVBg9Ysw1Hz2uUCMDIid09ihzLyZmOms4Wksb8FcbJB2XVCKLTywDLlNjNyIa9psb2zwmZkdaUmcKPihSkicaGigrPC2nHCMq7cIaGFqOGig1HDgvYAwfSlMrPzMz1C2uGpsbJB2XVCKLTywDLlNjNyJSkicbTyxrLCMLHBc5HBhbOysa9ignVBg9Ysw1Hz2uUytSkicbYzxr1CM4GBwf0zxjPywW7cN0k','r3jHCgHPy0XHEwvY','sgvHDeXHEwvY','yxjJqMX1CLnJywXL','Bwf4','zMXVB3i','AxngB3jTyxq','x3vWzgf0zvbVC2L0Aw9UC0HVB2S','y29VCMrPBMf0zxm','zM9YBwf0uMvJDgfUz2XL','CMvJDgfUz2XL','BwvYy2f0B3iYBg9UBgf0','AgvHDfn0EwXL','s0vfua','Aw1Hz2u','ywrKtgf5zxi','nda1nZi2AvHLEMjM','y2XPzw50v2LKDgG','z3jHzgLLBNrbCMm','AgvHDa','BwLU','ChG7AgvPz2H0oG','Cg9ZAxrPB25Z','BwLUq2fUDMfZu2L6zq','Dg9bCNjHEq','y2XLyxi','zgvMyxvSDa'];_0x47a2=function(){return _0x36f599;};return _0x47a2();}function _0x31a7(_0x49401f,_0x4e3759){const _0x47a2b9=_0x47a2();return _0x31a7=function(_0x31a73a,_0x25bad0){_0x31a73a=_0x31a73a-0x1a3;let _0x36f0a0=_0x47a2b9[_0x31a73a];if(_0x31a7['qFwLHM']===undefined){var _0x4c6c42=function(_0x3d936e){const _0x41c88e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x490720='',_0x1ec32a='';for(let _0x35b20b=0x0,_0x332f13,_0x4a82eb,_0x286ef7=0x0;_0x4a82eb=_0x3d936e['charAt'](_0x286ef7++);~_0x4a82eb&&(_0x332f13=_0x35b20b%0x4?_0x332f13*0x40+_0x4a82eb:_0x4a82eb,_0x35b20b++%0x4)?_0x490720+=String['fromCharCode'](0xff&_0x332f13>>(-0x2*_0x35b20b&0x6)):0x0){_0x4a82eb=_0x41c88e['indexOf'](_0x4a82eb);}for(let _0x455fca=0x0,_0x479cb4=_0x490720['length'];_0x455fca<_0x479cb4;_0x455fca++){_0x1ec32a+='%'+('00'+_0x490720['charCodeAt'](_0x455fca)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1ec32a);};_0x31a7['iJXbku']=_0x4c6c42,_0x49401f=arguments,_0x31a7['qFwLHM']=!![];}const _0x302567=_0x47a2b9[0x0],_0x354c13=_0x31a73a+_0x302567,_0x28ff9d=_0x49401f[_0x354c13];return!_0x28ff9d?(_0x36f0a0=_0x31a7['iJXbku'](_0x36f0a0),_0x49401f[_0x354c13]=_0x36f0a0):_0x36f0a0=_0x28ff9d,_0x36f0a0;},_0x31a7(_0x49401f,_0x4e3759);}const Cesium=mars3d__namespace[_0x449843(0x1c0)],BaseLayer=mars3d__namespace[_0x449843(0x1bc)][_0x449843(0x1e1)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x449843(0x1e2),0.8:'yellow',0.9:_0x449843(0x1dd)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x449843(0x1d2)][_0x449843(0x1bd)]};class HeatLayer extends BaseLayer{constructor(){const _0x1f6787=_0x449843;let _0x35b20b=arguments[_0x1f6787(0x1fc)]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:{};super(_0x35b20b),this[_0x1f6787(0x1a5)][_0x1f6787(0x209)]=this['options'][_0x1f6787(0x209)]??document['body'][_0x1f6787(0x222)],this[_0x1f6787(0x1a5)][_0x1f6787(0x209)]=Math[_0x1f6787(0x225)](this['options']['maxCanvasSize'],0x1388),this[_0x1f6787(0x1a5)][_0x1f6787(0x228)]=this[_0x1f6787(0x1a5)][_0x1f6787(0x228)]??document[_0x1f6787(0x20d)]['clientHeight'],this[_0x1f6787(0x1a5)]['minCanvasSize']=Math[_0x1f6787(0x215)](this[_0x1f6787(0x1a5)][_0x1f6787(0x228)],0x2bc),this[_0x1f6787(0x1a5)][_0x1f6787(0x21d)]={...DEF_HEATSTYLE,...this[_0x1f6787(0x1a5)]['heatStyle']||{}},this[_0x1f6787(0x1a5)][_0x1f6787(0x1eb)]={...DEF_STYLE,...this[_0x1f6787(0x1a5)][_0x1f6787(0x1eb)]||{}};}get[_0x449843(0x1bc)](){const _0x5153d6=_0x449843;return this[_0x5153d6(0x1f3)];}get[_0x449843(0x21d)](){const _0x4bd163=_0x449843;return this[_0x4bd163(0x1a5)][_0x4bd163(0x21d)];}set[_0x449843(0x21d)](_0x332f13){const _0x48a9a=_0x449843;this['options'][_0x48a9a(0x21d)]=mars3d__namespace[_0x48a9a(0x1f1)][_0x48a9a(0x20b)](this[_0x48a9a(0x1a5)][_0x48a9a(0x21d)],_0x332f13),this[_0x48a9a(0x1d7)]&&(this['_heat']['configure'](this[_0x48a9a(0x1a5)][_0x48a9a(0x21d)]),this[_0x48a9a(0x218)](!![]));}get[_0x449843(0x1eb)](){const _0x23224b=_0x449843;return this['options'][_0x23224b(0x1eb)];}set[_0x449843(0x1eb)](_0x4a82eb){const _0x48a89e=_0x449843;this[_0x48a89e(0x1a5)][_0x48a89e(0x1eb)]=mars3d__namespace['Util'][_0x48a89e(0x20b)](this[_0x48a89e(0x1a5)][_0x48a89e(0x1eb)],_0x4a82eb);}get['positions'](){return this['_positions'];}set[_0x449843(0x227)](_0x286ef7){const _0x20a0ad=_0x449843;this[_0x20a0ad(0x1c5)](_0x286ef7);}get[_0x449843(0x219)](){const _0x12646c=_0x449843,_0x455fca=[];return this[_0x12646c(0x206)][_0x12646c(0x1df)](_0x479cb4=>{const _0x2369f7=_0x12646c;_0x455fca[_0x2369f7(0x1f9)](_0x479cb4[_0x2369f7(0x229)]());}),_0x455fca;}get[_0x449843(0x21b)](){const _0x3d27e2=_0x449843;return this[_0x3d27e2(0x1b8)];}[_0x449843(0x1d1)](_0x583463,_0x46ef8d){const _0x55d352=_0x449843;_0x583463[_0x55d352(0x227)]&&(this[_0x55d352(0x227)]=_0x583463[_0x55d352(0x227)]);}['_mountedHook'](){const _0x4bb0f9=_0x449843;this['_layer']=new mars3d__namespace[(_0x4bb0f9(0x1bc))][(_0x4bb0f9(0x212))]({'private':!![]});}[_0x449843(0x1bf)](){const _0x40264b=_0x449843;this[_0x40264b(0x1f6)][_0x40264b(0x220)](this[_0x40264b(0x1f3)]),this['options']['positions']&&(this[_0x40264b(0x227)]=this['options'][_0x40264b(0x227)]),this[_0x40264b(0x1a5)][_0x40264b(0x1a8)]&&this['flyToByAnimationEnd']();}[_0x449843(0x1ac)](){const _0x23d6b8=_0x449843;this['heatStyle'][_0x23d6b8(0x1b9)]&&(mars3d__namespace['DomUtil']['remove'](this[_0x23d6b8(0x21d)]['container']),delete this[_0x23d6b8(0x21d)][_0x23d6b8(0x1b9)]),this[_0x23d6b8(0x22a)](),this[_0x23d6b8(0x1f6)]['removeLayer'](this[_0x23d6b8(0x1f3)]);}[_0x449843(0x1d3)](_0x361f66,_0x511fcb){const _0x2f74c8=_0x449843;this[_0x2f74c8(0x1ce)]=this[_0x2f74c8(0x1ce)]||[],this['_positions'][_0x2f74c8(0x1f9)](_0x361f66),this[_0x2f74c8(0x218)](_0x511fcb);}[_0x449843(0x1c5)](_0x4ae34d,_0x1005ec){const _0x56d5f6=_0x449843;this[_0x56d5f6(0x1ce)]=_0x4ae34d,this['_updatePositionsHook'](_0x1005ec);}[_0x449843(0x22a)](){const _0x41cf39=_0x449843;this[_0x41cf39(0x1a4)]&&(this[_0x41cf39(0x1f3)][_0x41cf39(0x1ef)](this[_0x41cf39(0x1a4)],!![]),delete this[_0x41cf39(0x1a4)]);}['_updatePositionsHook'](_0xa355ff){const _0x264b07=_0x449843;if(!this['show']||!this[_0x264b07(0x1f6)]||!this[_0x264b07(0x227)]||this[_0x264b07(0x227)][_0x264b07(0x1fc)]===0x0)return this;const _0xa95c39=this[_0x264b07(0x1ee)]();return this[_0x264b07(0x1eb)][_0x264b07(0x1a9)]?this[_0x264b07(0x1a4)]&&_0xa355ff?(this[_0x264b07(0x1a4)][_0x264b07(0x1cd)]['image']=_0xa95c39,this[_0x264b07(0x1a4)]['uniforms'][_0x264b07(0x1ea)]=this[_0x264b07(0x1e8)]()):this[_0x264b07(0x1b6)](_0xa95c39):this[_0x264b07(0x1a4)]&&_0xa355ff?this['_graphic'][_0x264b07(0x1cd)][_0x264b07(0x21f)]=_0xa95c39:this['_createGraphic'](_0xa95c39),this;}['_createGraphic'](_0x4bee71){const _0x48e7c2=_0x449843;this['clear'](),this[_0x48e7c2(0x1a4)]=new mars3d__namespace[(_0x48e7c2(0x1de))][(_0x48e7c2(0x1ca))]({...this[_0x48e7c2(0x1a5)],'rectangle':this[_0x48e7c2(0x1b8)],'appearance':new Cesium[(_0x48e7c2(0x1d2))]({'material':new Cesium[(_0x48e7c2(0x1ad))]({'fabric':{'uniforms':{'image':_0x4bee71},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this[_0x48e7c2(0x1f3)][_0x48e7c2(0x1cc)](this[_0x48e7c2(0x1a4)]);}[_0x449843(0x1b6)](_0x3c4283){const _0x49ac00=_0x449843;this[_0x49ac00(0x22a)]();const _0x181ccf=Cesium[_0x49ac00(0x1d5)][_0x49ac00(0x1ff)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x49ac00(0x1fa)][_0x49ac00(0x1e9)],'frontOperation':{'fail':Cesium['StencilOperation'][_0x49ac00(0x21e)],'zFail':Cesium[_0x49ac00(0x1d4)]['KEEP'],'zPass':Cesium[_0x49ac00(0x1d4)][_0x49ac00(0x1db)]},'backFunction':Cesium[_0x49ac00(0x1fa)][_0x49ac00(0x1e9)],'backOperation':{'fail':Cesium[_0x49ac00(0x1d4)][_0x49ac00(0x21e)],'zFail':Cesium[_0x49ac00(0x1d4)][_0x49ac00(0x21e)],'zPass':Cesium[_0x49ac00(0x1d4)][_0x49ac00(0x1db)]},'reference':0x2,'mask':0x2},'blending':Cesium[_0x49ac00(0x1cf)][_0x49ac00(0x201)]}),_0x45d7de=Math[_0x49ac00(0x216)](this[_0x49ac00(0x1eb)][_0x49ac00(0x20c)]??this[_0x49ac00(0x202)]*0.02)+0.1;this[_0x49ac00(0x1eb)]['diffHeight']&&delete this[_0x49ac00(0x1eb)][_0x49ac00(0x20c)];const _0xa17a99=(this[_0x49ac00(0x1eb)][_0x49ac00(0x1f0)],0x64);let _0xd6b22d=Math['max'](this[_0x49ac00(0x1b8)][_0x49ac00(0x20e)],this[_0x49ac00(0x1b8)][_0x49ac00(0x1c2)]);this[_0x49ac00(0x1eb)]['granularity']=_0xd6b22d/=_0xa17a99,this['_graphic']=new mars3d__namespace[(_0x49ac00(0x1de))][(_0x49ac00(0x1ca))]({...this[_0x49ac00(0x1a5)],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x49ac00(0x1d2))]({'aboveGround':!![],'renderState':_0x181ccf,'material':new Cesium[(_0x49ac00(0x1ad))]({'fabric':{'uniforms':{'image':_0x3c4283,'repeat':new Cesium[(_0x49ac00(0x1b4))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0.01),'bumpMap':this[_0x49ac00(0x1e8)]()},'source':HeatMaterial},'translucent':!![]}),'vertexShaderSource':'attribute\x20vec3\x20position3DHigh;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20attribute\x20vec3\x20position3DLow;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20attribute\x20vec2\x20st;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20attribute\x20float\x20batchId;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20varying\x20vec3\x20v_positionMC;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20varying\x20vec3\x20v_positionEC;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20varying\x20vec2\x20v_st;\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20void\x20main()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vec4\x20color\x20=\x20texture2D(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x45d7de+';\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','flat':!![]})}),this[_0x49ac00(0x1f3)][_0x49ac00(0x1cc)](this[_0x49ac00(0x1a4)]);}[_0x449843(0x1c3)](_0x15368e){const _0x22e7a1=_0x449843;return _0x15368e!==null&&_0x15368e!==void 0x0&&_0x15368e[_0x22e7a1(0x217)]&&this[_0x22e7a1(0x1b8)]?mars3d__namespace[_0x22e7a1(0x1b3)][_0x22e7a1(0x21a)](this['_rectangle']):this[_0x22e7a1(0x1b8)];}[_0x449843(0x1ee)](){const _0xb9d2c1=_0x449843,_0xdb8954=this[_0xb9d2c1(0x1ce)],_0x9e13ad=[];let _0x49ca6d,_0x4722f8,_0x4d4a80,_0x1ba98c;_0xdb8954['forEach'](_0x141d84=>{const _0x53d1c2=_0xb9d2c1,_0x532bd7=mars3d__namespace[_0x53d1c2(0x1f7)][_0x53d1c2(0x1b2)](_0x141d84);if(!_0x532bd7)return;_0x532bd7['value']=_0x141d84[_0x53d1c2(0x1dc)]||0x1,!this[_0x53d1c2(0x1a5)]['rectangle']&&(_0x49ca6d===undefined?(_0x49ca6d=_0x532bd7[_0x53d1c2(0x1a6)],_0x4722f8=_0x532bd7['lng'],_0x4d4a80=_0x532bd7[_0x53d1c2(0x20a)],_0x1ba98c=_0x532bd7[_0x53d1c2(0x20a)]):(_0x49ca6d=Math[_0x53d1c2(0x225)](_0x49ca6d,_0x532bd7[_0x53d1c2(0x1a6)]),_0x4722f8=Math[_0x53d1c2(0x215)](_0x4722f8,_0x532bd7['lng']),_0x4d4a80=Math[_0x53d1c2(0x225)](_0x4d4a80,_0x532bd7[_0x53d1c2(0x20a)]),_0x1ba98c=Math['max'](_0x1ba98c,_0x532bd7[_0x53d1c2(0x20a)]))),_0x9e13ad[_0x53d1c2(0x1f9)](_0x532bd7);});let _0x20bbf8=this[_0xb9d2c1(0x1a5)][_0xb9d2c1(0x21b)]||{'xmin':_0x49ca6d,'xmax':_0x4722f8,'ymin':_0x4d4a80,'ymax':_0x1ba98c};const _0x2cf226=getMercatorBounds(_0x20bbf8),_0x223d07=Math[_0xb9d2c1(0x1d6)](_0x2cf226['xmax']-_0x2cf226[_0xb9d2c1(0x205)]),_0x2e33cc=Math[_0xb9d2c1(0x1d6)](_0x2cf226[_0xb9d2c1(0x1da)]-_0x2cf226[_0xb9d2c1(0x1c4)]),_0x5c7926=Math[_0xb9d2c1(0x215)](_0x223d07,_0x2e33cc),_0x28948f=Math[_0xb9d2c1(0x225)](_0x223d07,_0x2e33cc);this[_0xb9d2c1(0x202)]=_0x5c7926;let _0x30e2dd=0x1;if(_0x5c7926>this[_0xb9d2c1(0x1a5)][_0xb9d2c1(0x209)])_0x30e2dd=_0x5c7926/this[_0xb9d2c1(0x1a5)][_0xb9d2c1(0x209)],_0x28948f/_0x30e2dd<this[_0xb9d2c1(0x1a5)][_0xb9d2c1(0x228)]&&(_0x30e2dd=_0x28948f/this['options'][_0xb9d2c1(0x228)]);else _0x28948f<this[_0xb9d2c1(0x1a5)]['minCanvasSize']&&(_0x30e2dd=_0x28948f/this[_0xb9d2c1(0x1a5)]['minCanvasSize'],_0x5c7926/_0x30e2dd>this[_0xb9d2c1(0x1a5)][_0xb9d2c1(0x209)]&&(_0x30e2dd=_0x5c7926/this[_0xb9d2c1(0x1a5)]['maxCanvasSize']));const _0x15dbe2=this[_0xb9d2c1(0x21d)][_0xb9d2c1(0x1c8)]*1.5,_0x370162=_0x223d07/_0x30e2dd+_0x15dbe2*0x2,_0x192e8b=_0x2e33cc/_0x30e2dd+_0x15dbe2*0x2,_0x190219=_0x15dbe2*_0x30e2dd;_0x2cf226['xmin']-=_0x190219,_0x2cf226[_0xb9d2c1(0x1c4)]-=_0x190219,_0x2cf226[_0xb9d2c1(0x1c6)]+=_0x190219,_0x2cf226[_0xb9d2c1(0x1da)]+=_0x190219,this[_0xb9d2c1(0x1ab)]=_0x30e2dd,_0x20bbf8=geLatLngBounds(_0x2cf226),this[_0xb9d2c1(0x1b8)]=Cesium[_0xb9d2c1(0x203)][_0xb9d2c1(0x207)](_0x20bbf8['xmin'],_0x20bbf8[_0xb9d2c1(0x1c4)],_0x20bbf8[_0xb9d2c1(0x1c6)],_0x20bbf8[_0xb9d2c1(0x1da)]);let _0x1bcb9b=_0x9e13ad[0x0]['value']??0x1,_0x19c339=_0x9e13ad[0x0][_0xb9d2c1(0x1dc)]??0x0;const _0xf1dcdb=[];_0x9e13ad[_0xb9d2c1(0x1df)](_0xc06aac=>{const _0x524176=_0xb9d2c1,_0x1200ec=mars3d__namespace[_0x524176(0x1f5)][_0x524176(0x1f8)]([_0xc06aac[_0x524176(0x1a6)],_0xc06aac[_0x524176(0x20a)]]),_0x57378c=_0xc06aac[_0x524176(0x1dc)]||0x1,_0x1c6811=Math[_0x524176(0x1e3)]((_0x1200ec[0x0]-_0x2cf226[_0x524176(0x205)])/_0x30e2dd),_0x2e4f5d=Math[_0x524176(0x1e3)]((_0x2cf226[_0x524176(0x1da)]-_0x1200ec[0x1])/_0x30e2dd);_0x1bcb9b=Math[_0x524176(0x215)](_0x1bcb9b,_0x57378c),_0x19c339=Math[_0x524176(0x225)](_0x19c339,_0x57378c),_0xf1dcdb[_0x524176(0x1f9)]({'x':_0x1c6811,'y':_0x2e4f5d,'value':_0x57378c});});const _0x18db72={'min':this['options'][_0xb9d2c1(0x225)]??_0x19c339,'max':this[_0xb9d2c1(0x1a5)]['max']??_0x1bcb9b,'data':_0xf1dcdb};this[_0xb9d2c1(0x1e0)]=_0x18db72;(!this[_0xb9d2c1(0x1c1)]||_0x2cf226[_0xb9d2c1(0x205)]!==this[_0xb9d2c1(0x1c1)][_0xb9d2c1(0x205)]||_0x2cf226['ymin']!==this['_last_mBounds'][_0xb9d2c1(0x1c4)]||_0x2cf226[_0xb9d2c1(0x1c6)]!==this[_0xb9d2c1(0x1c1)][_0xb9d2c1(0x1c6)]||_0x2cf226[_0xb9d2c1(0x1da)]!==this[_0xb9d2c1(0x1c1)][_0xb9d2c1(0x1da)])&&(this[_0xb9d2c1(0x1c1)]=_0x2cf226,!this[_0xb9d2c1(0x21d)]['container']&&(this[_0xb9d2c1(0x21d)]['container']=mars3d__namespace[_0xb9d2c1(0x1fd)][_0xb9d2c1(0x1b5)](_0xb9d2c1(0x1be),_0xb9d2c1(0x200),this[_0xb9d2c1(0x1f6)][_0xb9d2c1(0x1b9)])),this[_0xb9d2c1(0x21d)][_0xb9d2c1(0x1b9)][_0xb9d2c1(0x1eb)][_0xb9d2c1(0x1af)]=_0xb9d2c1(0x20f)+_0x370162+_0xb9d2c1(0x226)+_0x192e8b+'px;',!this[_0xb9d2c1(0x1d7)]?this[_0xb9d2c1(0x1d7)]=h337__namespace[_0xb9d2c1(0x1b5)](this[_0xb9d2c1(0x21d)]):this['_heat'][_0xb9d2c1(0x1b0)](this[_0xb9d2c1(0x21d)]));this[_0xb9d2c1(0x1d7)][_0xb9d2c1(0x1fe)](_0x18db72);const _0x5b9777=mars3d__namespace['DomUtil'][_0xb9d2c1(0x1aa)](this['_heat'][_0xb9d2c1(0x1d0)]['canvas']);return _0x5b9777;}[_0x449843(0x1e8)](){const _0x5dde7a=_0x449843;this[_0x5dde7a(0x1d7)][_0x5dde7a(0x1b0)]({'radius':this['heatStyle'][_0x5dde7a(0x1c8)]*this[_0x5dde7a(0x1eb)][_0x5dde7a(0x1e4)],'blur':this['heatStyle'][_0x5dde7a(0x1bb)]*this[_0x5dde7a(0x1eb)][_0x5dde7a(0x214)],'gradient':this[_0x5dde7a(0x21d)][_0x5dde7a(0x223)]||{0.25:'rgb(0,0,0)',0.55:_0x5dde7a(0x1a7),0.85:_0x5dde7a(0x1d8),0x1:_0x5dde7a(0x1e6)}});const _0x4a0354=mars3d__namespace[_0x5dde7a(0x1fd)][_0x5dde7a(0x1aa)](this[_0x5dde7a(0x1d7)][_0x5dde7a(0x1d0)]['canvas']);return this[_0x5dde7a(0x1d7)][_0x5dde7a(0x1b0)](this['options']['heatStyle']),_0x4a0354;}[_0x449843(0x208)](_0x3678c6){const _0x476139=_0x449843,_0x408ecc=mars3d__namespace[_0x476139(0x1f7)][_0x476139(0x1b2)](_0x3678c6);if(!_0x408ecc)return{};const _0x5b05d4=mars3d__namespace[_0x476139(0x1f5)][_0x476139(0x1f8)]([_0x408ecc[_0x476139(0x1a6)],_0x408ecc[_0x476139(0x20a)]]),_0x381c3e=this['_last_mBounds'],_0x1bc745=Math[_0x476139(0x1e3)]((_0x5b05d4[0x0]-_0x381c3e[_0x476139(0x205)])/this[_0x476139(0x1ab)]),_0x1db003=Math[_0x476139(0x1e3)]((_0x381c3e[_0x476139(0x1da)]-_0x5b05d4[0x1])/this['_scale']),_0x2205ec=this['_heat'][_0x476139(0x1e7)]({'x':_0x1bc745,'y':_0x1db003}),_0x22bb21=this[_0x476139(0x1d7)]['_renderer'][_0x476139(0x1b7)]['getImageData'](_0x1bc745-0x1,_0x1db003-0x1,0x1,0x1)[_0x476139(0x1ba)];return{'x':_0x1bc745,'y':_0x1db003,'value':_0x2205ec,'color':'rgba('+_0x22bb21[0x0]+','+_0x22bb21[0x1]+','+_0x22bb21[0x2]+','+_0x22bb21[0x3]+')'};}}mars3d__namespace[_0x449843(0x1bc)][_0x449843(0x213)]=HeatLayer,mars3d__namespace[_0x449843(0x1cb)][_0x449843(0x1ec)](_0x449843(0x224),HeatLayer);function getMercatorBounds(_0x140e19){const _0x5348a5=_0x449843,_0x17052e=mars3d__namespace['PointTrans'][_0x5348a5(0x1f8)]([_0x140e19['xmin'],_0x140e19['ymin']]),_0x5f0e1a=mars3d__namespace[_0x5348a5(0x1f5)][_0x5348a5(0x1f8)]([_0x140e19[_0x5348a5(0x1c6)],_0x140e19[_0x5348a5(0x1da)]]);return{'xmin':_0x17052e[0x0],'ymin':_0x17052e[0x1],'xmax':_0x5f0e1a[0x0],'ymax':_0x5f0e1a[0x1]};}function geLatLngBounds(_0x362240){const _0x33ee05=_0x449843,_0x500c43=mars3d__namespace[_0x33ee05(0x1f5)][_0x33ee05(0x21c)]([_0x362240[_0x33ee05(0x205)],_0x362240['ymin']]),_0x4d5b4a=mars3d__namespace[_0x33ee05(0x1f5)]['mercator2lonlat']([_0x362240[_0x33ee05(0x1c6)],_0x362240[_0x33ee05(0x1da)]]);return{'xmin':_0x500c43[0x0],'ymin':_0x500c43[0x1],'xmax':_0x4d5b4a[0x0],'ymax':_0x4d5b4a[0x1]};}exports[_0x449843(0x213)]=HeatLayer,Object[_0x449843(0x210)](exports,'__esModule',{'value':!![]});
}));
