/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.9
 * 编译日期：2023-05-29 18:08:10
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x4393ea=_0x36ca;(function(_0x159c67,_0x196435){const _0x313836={_0x23fde7:0x119,_0x13f349:0x162,_0x15a98d:0x11d,_0x425339:0x137,_0x175a54:0x120},_0x290246=_0x36ca,_0x384e9a=_0x159c67();while(!![]){try{const _0x45f49a=parseInt(_0x290246(0x13b))/0x1*(parseInt(_0x290246(0x159))/0x2)+parseInt(_0x290246(_0x313836._0x23fde7))/0x3+parseInt(_0x290246(0x16a))/0x4*(parseInt(_0x290246(_0x313836._0x13f349))/0x5)+parseInt(_0x290246(_0x313836._0x15a98d))/0x6+parseInt(_0x290246(0x141))/0x7*(-parseInt(_0x290246(_0x313836._0x425339))/0x8)+parseInt(_0x290246(0x127))/0x9+parseInt(_0x290246(_0x313836._0x175a54))/0xa*(parseInt(_0x290246(0x11c))/0xb);if(_0x45f49a===_0x196435)break;else _0x384e9a['push'](_0x384e9a['shift']());}catch(_0x152ce9){_0x384e9a['push'](_0x384e9a['shift']());}}}(_0x3ec3,0xd2969));function _interopNamespace(_0xecb0a4){const _0x4741f5={_0x1610f7:0x164,_0x18ed25:0x153};if(_0xecb0a4&&_0xecb0a4['__esModule'])return _0xecb0a4;var _0x2a7bc4=Object['create'](null);return _0xecb0a4&&Object['keys'](_0xecb0a4)['forEach'](function(_0x41f29f){const _0x2857a9=_0x36ca;if(_0x41f29f!=='default'){var _0x327137=Object[_0x2857a9(_0x4741f5._0x1610f7)](_0xecb0a4,_0x41f29f);Object['defineProperty'](_0x2a7bc4,_0x41f29f,_0x327137[_0x2857a9(_0x4741f5._0x18ed25)]?_0x327137:{'enumerable':!![],'get':function(){return _0xecb0a4[_0x41f29f];}});}}),_0x2a7bc4['default']=_0xecb0a4,_0x2a7bc4;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x4393ea(0x158),0.6:_0x4393ea(0x167),0.8:'yellow',0.9:_0x4393ea(0x13a)}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x57ab27={}){const _0x3b674d={_0x2e546a:0x154,_0x4a59f8:0x12a,_0x3c44af:0x118,_0x2921e0:0x154,_0x3961a9:0x166},_0x33db4a=_0x4393ea;super(_0x57ab27),this['options'][_0x33db4a(0x151)]=this[_0x33db4a(0x154)]['maxCanvasSize']??document['body']['clientWidth'],this[_0x33db4a(_0x3b674d._0x2e546a)][_0x33db4a(0x151)]=Math[_0x33db4a(_0x3b674d._0x4a59f8)](this[_0x33db4a(_0x3b674d._0x2e546a)][_0x33db4a(0x151)],0x1388),this[_0x33db4a(_0x3b674d._0x2e546a)][_0x33db4a(_0x3b674d._0x3c44af)]=this['options'][_0x33db4a(0x118)]??document['body']['clientHeight'],this[_0x33db4a(_0x3b674d._0x2e546a)][_0x33db4a(0x118)]=Math['max'](this[_0x33db4a(_0x3b674d._0x2921e0)][_0x33db4a(_0x3b674d._0x3c44af)],0x2bc),this[_0x33db4a(_0x3b674d._0x2e546a)]['heatStyle']={...DEF_HEATSTYLE,...this[_0x33db4a(_0x3b674d._0x2921e0)][_0x33db4a(_0x3b674d._0x3961a9)]||{}},this['options']['style']={...DEF_STYLE,...this['options']['style']||{}};}get['layer'](){return this['_layer'];}get[_0x4393ea(0x166)](){return this['options']['heatStyle'];}set['heatStyle'](_0x49bae5){const _0x32ff18={_0x5851a2:0x14e},_0x598a49=_0x4393ea;this[_0x598a49(0x154)]['heatStyle']=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x49bae5),this['_heat']&&(this[_0x598a49(0x12b)][_0x598a49(_0x32ff18._0x5851a2)](this['options'][_0x598a49(0x166)]),this[_0x598a49(0x165)](!![]));}get['style'](){return this['options']['style'];}set[_0x4393ea(0x147)](_0x4ed0d4){const _0x42f417=_0x4393ea;this[_0x42f417(0x154)]['style']=mars3d__namespace['Util']['merge'](this['options'][_0x42f417(0x147)],_0x4ed0d4);}get[_0x4393ea(0x114)](){return this['_positions'];}set[_0x4393ea(0x114)](_0x4dae99){this['setPositions'](_0x4dae99);}get[_0x4393ea(0x168)](){const _0x1c3232=[];return this['points']['forEach'](_0x51f0bc=>{_0x1c3232['push'](_0x51f0bc['toArray']());}),_0x1c3232;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x2547d0,_0x1a4970){const _0xd7fdbe=_0x4393ea;_0x2547d0[_0xd7fdbe(0x114)]&&(this['positions']=_0x2547d0['positions']);}[_0x4393ea(0x16b)](){const _0x23a89d={_0x1f852d:0x15f},_0x36f2b5=_0x4393ea;this['style']['type']==='image'?this['_layer']=new mars3d__namespace[(_0x36f2b5(0x163))][(_0x36f2b5(0x16d))]({'crs':'EPSG:3857','private':!![]}):this[_0x36f2b5(0x132)]=new mars3d__namespace['layer'][(_0x36f2b5(_0x23a89d._0x1f852d))]({'private':!![]});}[_0x4393ea(0x144)](){const _0x17c166={_0x432277:0x13e,_0x1be505:0x114},_0x340513=_0x4393ea;this[_0x340513(_0x17c166._0x432277)][_0x340513(0x11e)](this['_layer']),this['_container']=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this[_0x340513(_0x17c166._0x1be505)]=this['options']['positions']),this['options'][_0x340513(0x15d)]&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x397d08={_0x3ebe56:0x138},_0x548252=_0x4393ea;this['_container']&&(mars3d__namespace['DomUtil'][_0x548252(_0x397d08._0x3ebe56)](this['_container']),delete this['_container']),this[_0x548252(0x16c)](),this['_map'][_0x548252(0x124)](this['_layer']);}['addPosition'](_0x1a1fbf,_0x1803f6){const _0x26e7a5={_0x32ba35:0x12e},_0x556385=_0x4393ea;this[_0x556385(_0x26e7a5._0x32ba35)]=this['_positions']||[],this[_0x556385(_0x26e7a5._0x32ba35)]['push'](_0x1a1fbf),this['_updatePositionsHook'](_0x1803f6);}[_0x4393ea(0x117)](_0x2a8987,_0x3fc718){const _0x51f737={_0x667d16:0x12e},_0x32f6c5=_0x4393ea;this[_0x32f6c5(_0x51f737._0x667d16)]=_0x2a8987,this['_updatePositionsHook'](_0x3fc718);}[_0x4393ea(0x16c)](){const _0x4ea0f2={_0x33c215:0x130},_0x6f5323=_0x4393ea;this['_graphic']&&(this['_layer'][_0x6f5323(_0x4ea0f2._0x33c215)](this[_0x6f5323(0x136)],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this[_0x6f5323(0x150)],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x231dbc){const _0x2e59e8={_0x38e916:0x114,_0x315279:0x14d,_0x1b8fd5:0x15b,_0xbca30e:0x136,_0x50a055:0x14a},_0xbaca94=_0x4393ea;if(!this['show']||!this['_map']||!this[_0xbaca94(_0x2e59e8._0x38e916)]||this['positions'][_0xbaca94(_0x2e59e8._0x315279)]===0x0)return this;const _0x4a2042=this['_getHeatCanvas']();if(this[_0xbaca94(0x147)]['type']===_0xbaca94(_0x2e59e8._0x1b8fd5))this['_layer']['setOptions']({'url':_0x4a2042['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0xbaca94(0x152)]});else this['style']['arc']?this[_0xbaca94(_0x2e59e8._0xbca30e)]&&_0x231dbc?(this['_graphic']['uniforms']['image']=_0x4a2042,this[_0xbaca94(0x136)]['uniforms'][_0xbaca94(0x112)]=this['_getArcHeatCanvas'](),this[_0xbaca94(0x150)]&&(this['_graphic2']['uniforms']['image']=_0x4a2042,this['_graphic2']['uniforms'][_0xbaca94(0x112)]=this['_graphic'][_0xbaca94(0x13d)]['bumpMap'])):this[_0xbaca94(_0x2e59e8._0x50a055)](_0x4a2042):this['_graphic']&&_0x231dbc?this['_graphic']['uniforms']['image']=_0x4a2042:this['_createGraphic'](_0x4a2042);return this;}['_createGraphic'](_0x3ce3d6){const _0x57703f=_0x4393ea;this['clear'](),this[_0x57703f(0x136)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x3ce3d6},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0x4393ea(0x14a)](_0x56adf2){const _0x4ddc14={_0x309ba:0x16c,_0x16c44a:0x129,_0x5d7b3e:0x15a,_0x1bd4ca:0x13c,_0x3dab5e:0x128,_0x1dc010:0x146,_0x541881:0x14c,_0x5f4238:0x147,_0x1105b7:0x113,_0xdba1f0:0x145,_0x10d946:0x136,_0xc70442:0x14f,_0x44c04c:0x154,_0x594b54:0x161},_0x1b4db8=_0x4393ea;this[_0x1b4db8(_0x4ddc14._0x309ba)]();const _0x3ca0c9=Cesium[_0x1b4db8(_0x4ddc14._0x16c44a)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x1b4db8(_0x4ddc14._0x5d7b3e)]},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium[_0x1b4db8(_0x4ddc14._0x1bd4ca)]['KEEP'],'zFail':Cesium[_0x1b4db8(_0x4ddc14._0x1bd4ca)][_0x1b4db8(_0x4ddc14._0x3dab5e)],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x1b4db8(0x13f)]['ALPHA_BLEND']}),_0x1442ca=Math[_0x1b4db8(_0x4ddc14._0x1dc010)](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style'][_0x1b4db8(_0x4ddc14._0x541881)];const _0x59336b=(this[_0x1b4db8(_0x4ddc14._0x5f4238)][_0x1b4db8(0x156)],0x64);let _0x40c733=Math[_0x1b4db8(_0x4ddc14._0x1105b7)](this['_rectangle']['height'],this['_rectangle']['width']);this[_0x1b4db8(0x147)]['granularity']=_0x40c733/=_0x59336b;const _0x77c926=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x56adf2,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this[_0x1b4db8(_0x4ddc14._0xdba1f0)]()},'source':HeatMaterial},'translucent':!![]}),_0x178822=this['style']['arcDirection']||0x1;this[_0x1b4db8(0x136)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x3ca0c9,'material':_0x77c926,'vertexShaderSource':getVertexShaderSource(_0x1442ca*_0x178822)})}),this['_layer'][_0x1b4db8(0x161)](this[_0x1b4db8(_0x4ddc14._0x10d946)]),this['style']['arcDirection']===0x0&&(this[_0x1b4db8(0x150)]=new mars3d__namespace['graphic'][(_0x1b4db8(_0x4ddc14._0xc70442))]({...this[_0x1b4db8(_0x4ddc14._0x44c04c)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x3ca0c9,'material':_0x77c926,'vertexShaderSource':getVertexShaderSource(-_0x1442ca)})}),this['_layer'][_0x1b4db8(_0x4ddc14._0x594b54)](this['_graphic2']));}[_0x4393ea(0x15e)](_0x109590){const _0x1b9d3e={_0x3eb307:0x125},_0x2414f4=_0x4393ea;return _0x109590!==null&&_0x109590!==void 0x0&&_0x109590['isFormat']&&this[_0x2414f4(0x133)]?mars3d__namespace[_0x2414f4(_0x1b9d3e._0x3eb307)]['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x283c26={_0x100809:0x131,_0x2d1edd:0x160,_0x3bcf33:0x118,_0x2bfb5b:0x166,_0x435db8:0x149,_0xe00e94:0x115,_0x19f582:0x139,_0x278faa:0x139,_0x27e34c:0x14b,_0x22035d:0x134,_0x462969:0x122,_0x297c39:0x12b},_0x165d15={_0xbe43c9:0x169,_0x5d1fbe:0x121,_0x52a0b0:0x160},_0x3132ef={_0x1e30bc:0x113,_0x583728:0x11a},_0x59e9c5=_0x4393ea,_0x37fce7=this['_positions'],_0x1c6df6=[];let _0x1b2886,_0x1419d9,_0x5e8c1e,_0x599a33;_0x37fce7['forEach'](_0x5e1391=>{const _0x5d86a6=_0x36ca,_0x21f98c=mars3d__namespace['LngLatPoint']['parse'](_0x5e1391);if(!_0x21f98c)return;_0x21f98c['value']=_0x5e1391['value']||0x1,!this['options']['rectangle']&&(_0x1b2886===undefined?(_0x1b2886=_0x21f98c['lng'],_0x1419d9=_0x21f98c[_0x5d86a6(0x11f)],_0x5e8c1e=_0x21f98c[_0x5d86a6(0x11a)],_0x599a33=_0x21f98c[_0x5d86a6(0x11a)]):(_0x1b2886=Math['min'](_0x1b2886,_0x21f98c['lng']),_0x1419d9=Math[_0x5d86a6(_0x3132ef._0x1e30bc)](_0x1419d9,_0x21f98c['lng']),_0x5e8c1e=Math['min'](_0x5e8c1e,_0x21f98c[_0x5d86a6(_0x3132ef._0x583728)]),_0x599a33=Math['max'](_0x599a33,_0x21f98c['lat']))),_0x1c6df6['push'](_0x21f98c);});let _0x2f3e42=this['options'][_0x59e9c5(_0x283c26._0x100809)]||{'xmin':_0x1b2886,'xmax':_0x1419d9,'ymin':_0x5e8c1e,'ymax':_0x599a33};const _0x3286bb=getMercatorBounds(_0x2f3e42),_0x2e21a3=Math['abs'](_0x3286bb['xmax']-_0x3286bb['xmin']),_0x536812=Math[_0x59e9c5(0x157)](_0x3286bb[_0x59e9c5(_0x283c26._0x2d1edd)]-_0x3286bb['ymin']),_0x3810b6=Math['max'](_0x2e21a3,_0x536812),_0x13f05a=Math[_0x59e9c5(0x12a)](_0x2e21a3,_0x536812);this['_mBoundsMax']=_0x3810b6;let _0x5de94e=0x1;if(_0x3810b6>this['options']['maxCanvasSize'])_0x5de94e=_0x3810b6/this['options']['maxCanvasSize'],_0x13f05a/_0x5de94e<this['options'][_0x59e9c5(_0x283c26._0x3bcf33)]&&(_0x5de94e=_0x13f05a/this['options']['minCanvasSize']);else _0x13f05a<this[_0x59e9c5(0x154)][_0x59e9c5(_0x283c26._0x3bcf33)]&&(_0x5de94e=_0x13f05a/this['options']['minCanvasSize'],_0x3810b6/_0x5de94e>this[_0x59e9c5(0x154)][_0x59e9c5(0x151)]&&(_0x5de94e=_0x3810b6/this['options']['maxCanvasSize']));const _0x3a6c36=this[_0x59e9c5(_0x283c26._0x2bfb5b)]['radius']*1.5,_0x49f5ac=_0x2e21a3/_0x5de94e+_0x3a6c36*0x2,_0x53e610=_0x536812/_0x5de94e+_0x3a6c36*0x2,_0x35af1d=_0x3a6c36*_0x5de94e;_0x3286bb['xmin']-=_0x35af1d,_0x3286bb['ymin']-=_0x35af1d,_0x3286bb['xmax']+=_0x35af1d,_0x3286bb['ymax']+=_0x35af1d,this['_scale']=_0x5de94e,_0x2f3e42=geLatLngBounds(_0x3286bb),this[_0x59e9c5(0x133)]=Cesium[_0x59e9c5(0x148)][_0x59e9c5(_0x283c26._0x435db8)](_0x2f3e42['xmin'],_0x2f3e42[_0x59e9c5(_0x283c26._0xe00e94)],_0x2f3e42['xmax'],_0x2f3e42['ymax']);let _0x4cfab1=_0x1c6df6[0x0]['value']??0x1,_0x1bb629=_0x1c6df6[0x0]['value']??0x0;const _0x21e725=[];_0x1c6df6['forEach'](_0x3012dd=>{const _0x533c22=_0x59e9c5,_0x4fdeb9=mars3d__namespace[_0x533c22(_0x165d15._0xbe43c9)]['lonlat2mercator']([_0x3012dd['lng'],_0x3012dd['lat']]),_0x3c8e25=_0x3012dd['value']||0x1,_0x31f5e8=Math['round']((_0x4fdeb9[0x0]-_0x3286bb['xmin'])/_0x5de94e),_0x4f418d=Math[_0x533c22(_0x165d15._0x5d1fbe)]((_0x3286bb[_0x533c22(_0x165d15._0x52a0b0)]-_0x4fdeb9[0x1])/_0x5de94e);_0x4cfab1=Math[_0x533c22(0x113)](_0x4cfab1,_0x3c8e25),_0x1bb629=Math['min'](_0x1bb629,_0x3c8e25),_0x21e725['push']({'x':_0x31f5e8,'y':_0x4f418d,'value':_0x3c8e25});});const _0x444bbd={'min':this['options']['min']??_0x1bb629,'max':this['options']['max']??_0x4cfab1,'data':_0x21e725};this['_last_heatData']=_0x444bbd;if(!this[_0x59e9c5(0x139)]||_0x3286bb['xmin']!==this['_last_mBounds']['xmin']||_0x3286bb['ymin']!==this[_0x59e9c5(0x139)][_0x59e9c5(0x115)]||_0x3286bb['xmax']!==this['_last_mBounds']['xmax']||_0x3286bb[_0x59e9c5(0x160)]!==this[_0x59e9c5(_0x283c26._0x19f582)]['ymax']){this[_0x59e9c5(_0x283c26._0x278faa)]=_0x3286bb,this[_0x59e9c5(_0x283c26._0x27e34c)]['style'][_0x59e9c5(_0x283c26._0x22035d)]='width:'+_0x49f5ac+_0x59e9c5(0x155)+_0x53e610+_0x59e9c5(_0x283c26._0x462969);const _0x1ab5e6={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace['create'](_0x1ab5e6):this['_heat']['configure'](_0x1ab5e6);}this['_heat']['setData'](_0x444bbd);const _0x429dc0=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x59e9c5(_0x283c26._0x297c39)]['_renderer']['canvas']);return _0x429dc0;}['_getArcHeatCanvas'](){const _0x1040ca={_0x227e2c:0x15c,_0x275ed1:0x126,_0x12bd59:0x135,_0x56f683:0x11b},_0x409068=_0x4393ea;this['_heat']['configure']({'radius':this['heatStyle'][_0x409068(_0x1040ca._0x227e2c)]*this['style']['arcRadiusScale'],'blur':this['heatStyle']['blur']*this['style'][_0x409068(_0x1040ca._0x275ed1)],'gradient':this['heatStyle'][_0x409068(_0x1040ca._0x12bd59)]||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:_0x409068(0x116),0x1:'rgb(255,255,255)'}});const _0x5c87ec=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x409068(0x12b)]['_renderer'][_0x409068(_0x1040ca._0x56f683)]);return this['_heat']['configure'](this['options']['heatStyle']),_0x5c87ec;}[_0x4393ea(0x140)](_0x3ca001){const _0x542956={_0x24113d:0x11f,_0x23380a:0x121,_0x5c9dd9:0x143},_0xa44282=_0x4393ea,_0x32459a=mars3d__namespace[_0xa44282(0x12c)]['parse'](_0x3ca001);if(!_0x32459a)return{};const _0x5a7108=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x32459a[_0xa44282(_0x542956._0x24113d)],_0x32459a[_0xa44282(0x11a)]]),_0x2f9601=this['_last_mBounds'],_0x39abee=Math[_0xa44282(_0x542956._0x23380a)]((_0x5a7108[0x0]-_0x2f9601['xmin'])/this['_scale']),_0x2ab9a7=Math['round']((_0x2f9601['ymax']-_0x5a7108[0x1])/this[_0xa44282(_0x542956._0x5c9dd9)]),_0x544996=this['_heat']['getValueAt']({'x':_0x39abee,'y':_0x2ab9a7}),_0x39f89d=this[_0xa44282(0x12b)]['_renderer']['ctx']['getImageData'](_0x39abee-0x1,_0x2ab9a7-0x1,0x1,0x1)['data'];return{'x':_0x39abee,'y':_0x2ab9a7,'value':_0x544996,'color':'rgba('+_0x39f89d[0x0]+','+_0x39f89d[0x1]+','+_0x39f89d[0x2]+','+_0x39f89d[0x3]+')'};}}function _0x3ec3(){const _0x15ef44=['lat','canvas','979715SQwpaY','2615376zhxndI','addLayer','lng','20VWWHND','round','px;','heat','removeLayer','PolyUtil','arcBlurScale','543285fszuGH','KEEP','RenderState','min','_heat','LngLatPoint','xmax','_positions','lonlat2mercator','removeGraphic','rectangle','_layer','_rectangle','cssText','gradientArc','_graphic','3222424JdIfSh','remove','_last_mBounds','red','8qJuarQ','StencilOperation','uniforms','_map','BlendingState','getPointData','21PSuDRD','HeatLayer','_scale','_addedHook','_getArcHeatCanvas','floor','style','Rectangle','fromDegrees','_createArcGraphic','_container','diffHeight','length','configure','RectanglePrimitive','_graphic2','maxCanvasSize','opacity','get','options','px;height:','splitNum','abs','blue','108266LbaMUD','REPLACE','image','radius','flyTo','getRectangle','GraphicLayer','ymax','addGraphic','2479845rJUUdh','layer','getOwnPropertyDescriptor','_updatePositionsHook','heatStyle','green','coordinates','PointTrans','4DztxOB','_mountedHook','clear','ImageLayer','bumpMap','max','positions','ymin','rgb(216,216,216)','setPositions','minCanvasSize','1402662NGPATn'];_0x3ec3=function(){return _0x15ef44;};return _0x3ec3();}function _0x36ca(_0x1b6956,_0x53dc04){const _0x3ec324=_0x3ec3();return _0x36ca=function(_0x36cabc,_0x2bc44b){_0x36cabc=_0x36cabc-0x112;let _0x9c5424=_0x3ec324[_0x36cabc];return _0x9c5424;},_0x36ca(_0x1b6956,_0x53dc04);}mars3d__namespace[_0x4393ea(0x163)][_0x4393ea(0x142)]=HeatLayer,mars3d__namespace['LayerUtil']['register'](_0x4393ea(0x123),HeatLayer);function getMercatorBounds(_0x4639bd){const _0x303bad=_0x4393ea,_0x2c74b7=mars3d__namespace[_0x303bad(0x169)]['lonlat2mercator']([_0x4639bd['xmin'],_0x4639bd['ymin']]),_0x3a06d0=mars3d__namespace['PointTrans'][_0x303bad(0x12f)]([_0x4639bd['xmax'],_0x4639bd['ymax']]);return{'xmin':_0x2c74b7[0x0],'ymin':_0x2c74b7[0x1],'xmax':_0x3a06d0[0x0],'ymax':_0x3a06d0[0x1]};}function geLatLngBounds(_0xeb1107){const _0x1b3838={_0x2f7bd2:0x115,_0x3c8ab1:0x12d},_0x38fa83=_0x4393ea,_0x13e9dd=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xeb1107['xmin'],_0xeb1107[_0x38fa83(_0x1b3838._0x2f7bd2)]]),_0x1f688f=mars3d__namespace['PointTrans']['mercator2lonlat']([_0xeb1107[_0x38fa83(_0x1b3838._0x3c8ab1)],_0xeb1107['ymax']]);return{'xmin':_0x13e9dd[0x0],'ymin':_0x13e9dd[0x1],'xmax':_0x1f688f[0x0],'ymax':_0x1f688f[0x1]};}function getVertexShaderSource(_0x4feeda){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x4feeda+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
