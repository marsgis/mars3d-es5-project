/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.5.10
 * 编译日期：2023-06-05 18:31:10
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x2aa105=_0x346a;(function(_0x1a3477,_0x104d67){const _0x2efced={_0x5354ed:0xe4,_0x3c8e11:0xf3,_0x2c9cc7:0x128},_0x31c3df=_0x346a,_0x3c6a79=_0x1a3477();while(!![]){try{const _0x1b1407=parseInt(_0x31c3df(0x104))/0x1+-parseInt(_0x31c3df(0xfa))/0x2*(parseInt(_0x31c3df(0xe7))/0x3)+-parseInt(_0x31c3df(0x112))/0x4+parseInt(_0x31c3df(0x113))/0x5*(parseInt(_0x31c3df(0x121))/0x6)+parseInt(_0x31c3df(_0x2efced._0x5354ed))/0x7+-parseInt(_0x31c3df(_0x2efced._0x3c8e11))/0x8+-parseInt(_0x31c3df(_0x2efced._0x2c9cc7))/0x9*(-parseInt(_0x31c3df(0x10d))/0xa);if(_0x1b1407===_0x104d67)break;else _0x3c6a79['push'](_0x3c6a79['shift']());}catch(_0x2a4161){_0x3c6a79['push'](_0x3c6a79['shift']());}}}(_0x11c5,0xe81ca));function _interopNamespace(_0x55a2cb){const _0x106d8a={_0x128b05:0x117},_0x5c34b5={_0x7e22ce:0xd8},_0x9d1a19=_0x346a;if(_0x55a2cb&&_0x55a2cb['__esModule'])return _0x55a2cb;var _0x303b74=Object[_0x9d1a19(_0x106d8a._0x128b05)](null);return _0x55a2cb&&Object['keys'](_0x55a2cb)['forEach'](function(_0x56ea61){const _0x29c8d5=_0x9d1a19;if(_0x56ea61!=='default'){var _0x3b5bbd=Object[_0x29c8d5(0xfe)](_0x55a2cb,_0x56ea61);Object[_0x29c8d5(_0x5c34b5._0x7e22ce)](_0x303b74,_0x56ea61,_0x3b5bbd[_0x29c8d5(0x119)]?_0x3b5bbd:{'enumerable':!![],'get':function(){return _0x55a2cb[_0x56ea61];}});}}),_0x303b74['default']=_0x55a2cb,_0x303b74;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x2aa105(0x10e)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x2a9389={}){const _0xce9155={_0x21a091:0x10c,_0x2b150f:0x10c,_0x25f8bf:0x127,_0x4eef30:0xd2,_0x568e05:0xed},_0x3e7735=_0x2aa105;super(_0x2a9389),this[_0x3e7735(_0xce9155._0x21a091)]['maxCanvasSize']=this[_0x3e7735(_0xce9155._0x2b150f)][_0x3e7735(_0xce9155._0x25f8bf)]??document['body']['clientWidth'],this['options']['maxCanvasSize']=Math['min'](this['options'][_0x3e7735(_0xce9155._0x25f8bf)],0x1388),this['options']['minCanvasSize']=this['options']['minCanvasSize']??document['body'][_0x3e7735(0x116)],this['options']['minCanvasSize']=Math[_0x3e7735(0xef)](this['options'][_0x3e7735(_0xce9155._0x4eef30)],0x2bc),this['options'][_0x3e7735(_0xce9155._0x568e05)]={...DEF_HEATSTYLE,...this[_0x3e7735(0x10c)]['heatStyle']||{}},this['options']['style']={...DEF_STYLE,...this['options'][_0x3e7735(0xf0)]||{}};}get[_0x2aa105(0xff)](){const _0x50af22=_0x2aa105;return this[_0x50af22(0x110)];}get['heatStyle'](){const _0x164d90=_0x2aa105;return this['options'][_0x164d90(0xed)];}set['heatStyle'](_0x2e11d4){const _0x5e533c={_0x307da7:0x10c,_0x553700:0x12c},_0x10cdc8=_0x2aa105;this['options'][_0x10cdc8(0xed)]=mars3d__namespace[_0x10cdc8(0xec)]['merge'](this[_0x10cdc8(_0x5e533c._0x307da7)]['heatStyle'],_0x2e11d4),this['_heat']&&(this[_0x10cdc8(0x129)]['configure'](this['options']['heatStyle']),this[_0x10cdc8(_0x5e533c._0x553700)](!![]));}get[_0x2aa105(0xf0)](){return this['options']['style'];}set['style'](_0x1f231f){const _0x1e0edc={_0x66fb3b:0xfc},_0x47f2e3=_0x2aa105;this['options']['style']=mars3d__namespace['Util'][_0x47f2e3(_0x1e0edc._0x66fb3b)](this['options']['style'],_0x1f231f);}get['positions'](){const _0x4cc222=_0x2aa105;return this[_0x4cc222(0xf6)];}set['positions'](_0x470403){this['setPositions'](_0x470403);}get['coordinates'](){const _0x7ea0a4=_0x2aa105,_0x5dbeec=[];return this[_0x7ea0a4(0xf9)]['forEach'](_0x3ab0c7=>{_0x5dbeec['push'](_0x3ab0c7['toArray']());}),_0x5dbeec;}get['rectangle'](){const _0x29e18a={_0xb4f4ec:0x120},_0x1559e0=_0x2aa105;return this[_0x1559e0(_0x29e18a._0xb4f4ec)];}['_setOptionsHook'](_0x52c625,_0x45befd){_0x52c625['positions']&&(this['positions']=_0x52c625['positions']);}['_mountedHook'](){const _0x37c740={_0x29d789:0xff,_0x9aef69:0x110},_0x111f8b=_0x2aa105;this['style'][_0x111f8b(0x11c)]==='image'?this[_0x111f8b(0x110)]=new mars3d__namespace[(_0x111f8b(_0x37c740._0x29d789))][(_0x111f8b(0xdc))]({'crs':_0x111f8b(0xdd),'private':!![]}):this[_0x111f8b(_0x37c740._0x9aef69)]=new mars3d__namespace['layer'][(_0x111f8b(0xe3))]({'private':!![]});}[_0x2aa105(0xd9)](){const _0x4a09e3={_0xeeec26:0xcf},_0x5e5a14=_0x2aa105;this['_map'][_0x5e5a14(_0x4a09e3._0xeeec26)](this['_layer']),this['_container']=mars3d__namespace['DomUtil']['create']('div',_0x5e5a14(0x11f),this['_map']['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this['options']['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x2ca87c={_0x4aac76:0xe0,_0xa9524:0x110},_0x19c1ba=_0x2aa105;this[_0x19c1ba(_0x2ca87c._0x4aac76)]&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this[_0x19c1ba(_0x2ca87c._0xa9524)]);}[_0x2aa105(0x106)](_0x224293,_0x673fab){const _0x550a05=_0x2aa105;this['_positions']=this['_positions']||[],this[_0x550a05(0xf6)]['push'](_0x224293),this[_0x550a05(0x12c)](_0x673fab);}[_0x2aa105(0x122)](_0x4b04c2,_0x249d76){const _0x561af5={_0x295d2c:0x12c},_0x228118=_0x2aa105;this['_positions']=_0x4b04c2,this[_0x228118(_0x561af5._0x295d2c)](_0x249d76);}['clear'](){this['_graphic']&&(this['_layer']['removeGraphic'](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x38aaf7){const _0x516d76={_0x42fbf3:0x110,_0x43f0f7:0xd3,_0x177ad6:0xeb,_0x3a0ec8:0xd3,_0x12e132:0x12e,_0x11bb26:0xd3,_0x4cdb55:0x12d,_0xe8a26f:0xdf},_0x2d8ffe=_0x2aa105;if(!this['show']||!this['_map']||!this['positions']||this['positions'][_0x2d8ffe(0xda)]===0x0)return this;const _0x4577be=this[_0x2d8ffe(0xd0)]();if(this['style']['type']==='image')this[_0x2d8ffe(_0x516d76._0x42fbf3)]['setOptions']({'url':_0x4577be['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this['style']['arc']?this[_0x2d8ffe(_0x516d76._0x43f0f7)]&&_0x38aaf7?(this[_0x2d8ffe(_0x516d76._0x43f0f7)][_0x2d8ffe(0x12d)][_0x2d8ffe(_0x516d76._0x177ad6)]=_0x4577be,this[_0x2d8ffe(_0x516d76._0x3a0ec8)]['uniforms']['bumpMap']=this[_0x2d8ffe(_0x516d76._0x12e132)](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x4577be,this[_0x2d8ffe(0xfd)]['uniforms']['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x4577be):this[_0x2d8ffe(0xd3)]&&_0x38aaf7?this[_0x2d8ffe(_0x516d76._0x11bb26)][_0x2d8ffe(_0x516d76._0x4cdb55)][_0x2d8ffe(0xeb)]=_0x4577be:this[_0x2d8ffe(_0x516d76._0xe8a26f)](_0x4577be);return this;}['_createGraphic'](_0x44284b){const _0x23645a={_0x14d375:0x120},_0x5338ab=_0x2aa105;this['clear'](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x5338ab(_0x23645a._0x14d375)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x44284b},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x635ee4){const _0x242e62={_0x354798:0x11b,_0x1d0ebb:0x11d,_0x512618:0x115,_0x573e91:0x103,_0x2b6d0f:0xee,_0x31556f:0xe6,_0x5e6f33:0x10a,_0x346186:0xf5,_0x10a3a5:0x120,_0x46481a:0x120,_0x4d17e7:0xf0,_0x3ea722:0xd3,_0x1ce7fe:0x108,_0x1d2499:0x110},_0x56ee5a=_0x2aa105;this['clear']();const _0x6e9a98=Cesium[_0x56ee5a(_0x242e62._0x354798)]['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction'][_0x56ee5a(_0x242e62._0x1d0ebb)],'frontOperation':{'fail':Cesium[_0x56ee5a(_0x242e62._0x512618)]['KEEP'],'zFail':Cesium[_0x56ee5a(_0x242e62._0x512618)][_0x56ee5a(_0x242e62._0x573e91)],'zPass':Cesium['StencilOperation'][_0x56ee5a(_0x242e62._0x2b6d0f)]},'backFunction':Cesium[_0x56ee5a(0xe2)][_0x56ee5a(_0x242e62._0x1d0ebb)],'backOperation':{'fail':Cesium[_0x56ee5a(0x115)]['KEEP'],'zFail':Cesium['StencilOperation'][_0x56ee5a(0x103)],'zPass':Cesium[_0x56ee5a(_0x242e62._0x512618)]['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x56ee5a(_0x242e62._0x31556f)]['ALPHA_BLEND']}),_0x3bb48f=Math['floor'](this['style']['diffHeight']??this[_0x56ee5a(_0x242e62._0x5e6f33)]*0.02)+0.1;this['style']['diffHeight']&&delete this['style'][_0x56ee5a(_0x242e62._0x346186)];const _0x18ab30=(this['style']['splitNum'],0x64);let _0x940355=Math['max'](this[_0x56ee5a(_0x242e62._0x10a3a5)]['height'],this[_0x56ee5a(_0x242e62._0x46481a)]['width']);this[_0x56ee5a(_0x242e62._0x4d17e7)][_0x56ee5a(0xfb)]=_0x940355/=_0x18ab30;const _0x26d272=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x635ee4,'repeat':new Cesium[(_0x56ee5a(0xf7))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x4035ea=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic'][(_0x56ee5a(0xea))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x6e9a98,'material':_0x26d272,'vertexShaderSource':getVertexShaderSource(_0x3bb48f*_0x4035ea)})}),this['_layer'][_0x56ee5a(0x126)](this[_0x56ee5a(_0x242e62._0x3ea722)]),this['style'][_0x56ee5a(_0x242e62._0x1ce7fe)]===0x0&&(this['_graphic2']=new mars3d__namespace['graphic'][(_0x56ee5a(0xea))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x6e9a98,'material':_0x26d272,'vertexShaderSource':getVertexShaderSource(-_0x3bb48f)})}),this[_0x56ee5a(_0x242e62._0x1d2499)]['addGraphic'](this['_graphic2']));}[_0x2aa105(0xf4)](_0x2b15a2){const _0x3647c3={_0x52b78f:0x120},_0x5883ac=_0x2aa105;return _0x2b15a2!==null&&_0x2b15a2!==void 0x0&&_0x2b15a2['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this[_0x5883ac(_0x3647c3._0x52b78f)];}['_getHeatCanvas'](){const _0x47c524={_0x1a0de8:0x10a,_0xc0f448:0x10c,_0x11645e:0xed,_0x214d91:0x111,_0x1f6c7a:0x11a,_0x5539c0:0x124,_0x3a9c70:0xf1,_0x5a731b:0x12f,_0x597ce6:0xdb,_0x1c127c:0x12a,_0x5043a3:0x109},_0xca4626={_0x6d988f:0x125},_0x477a9c={_0x9d3811:0x10b,_0x1961b6:0xd6},_0x2100ff=_0x2aa105,_0x28a714=this['_positions'],_0x499f05=[];let _0x138904,_0x380186,_0x79c97d,_0x46f65c;_0x28a714[_0x2100ff(0x11a)](_0x21abe3=>{const _0x4e86a4=_0x2100ff,_0x192fd1=mars3d__namespace['LngLatPoint']['parse'](_0x21abe3);if(!_0x192fd1)return;_0x192fd1[_0x4e86a4(_0x477a9c._0x9d3811)]=_0x21abe3[_0x4e86a4(0x10b)]||0x1,!this['options']['rectangle']&&(_0x138904===undefined?(_0x138904=_0x192fd1['lng'],_0x380186=_0x192fd1['lng'],_0x79c97d=_0x192fd1['lat'],_0x46f65c=_0x192fd1['lat']):(_0x138904=Math[_0x4e86a4(_0x477a9c._0x1961b6)](_0x138904,_0x192fd1[_0x4e86a4(0x101)]),_0x380186=Math['max'](_0x380186,_0x192fd1['lng']),_0x79c97d=Math[_0x4e86a4(0xd6)](_0x79c97d,_0x192fd1['lat']),_0x46f65c=Math['max'](_0x46f65c,_0x192fd1['lat']))),_0x499f05['push'](_0x192fd1);});let _0x31276e=this['options']['rectangle']||{'xmin':_0x138904,'xmax':_0x380186,'ymin':_0x79c97d,'ymax':_0x46f65c};const _0xb2fb3c=getMercatorBounds(_0x31276e),_0x54abb8=Math['abs'](_0xb2fb3c['xmax']-_0xb2fb3c['xmin']),_0x49e387=Math['abs'](_0xb2fb3c['ymax']-_0xb2fb3c['ymin']),_0x16c86b=Math['max'](_0x54abb8,_0x49e387),_0x100917=Math['min'](_0x54abb8,_0x49e387);this[_0x2100ff(_0x47c524._0x1a0de8)]=_0x16c86b;let _0x27bfb7=0x1;if(_0x16c86b>this[_0x2100ff(0x10c)]['maxCanvasSize'])_0x27bfb7=_0x16c86b/this[_0x2100ff(_0x47c524._0xc0f448)]['maxCanvasSize'],_0x100917/_0x27bfb7<this['options']['minCanvasSize']&&(_0x27bfb7=_0x100917/this['options']['minCanvasSize']);else _0x100917<this['options']['minCanvasSize']&&(_0x27bfb7=_0x100917/this['options']['minCanvasSize'],_0x16c86b/_0x27bfb7>this[_0x2100ff(_0x47c524._0xc0f448)]['maxCanvasSize']&&(_0x27bfb7=_0x16c86b/this['options']['maxCanvasSize']));const _0x176ef2=this[_0x2100ff(_0x47c524._0x11645e)][_0x2100ff(_0x47c524._0x214d91)]*1.5,_0x1e2167=_0x54abb8/_0x27bfb7+_0x176ef2*0x2,_0x32ddda=_0x49e387/_0x27bfb7+_0x176ef2*0x2,_0xf3784d=_0x176ef2*_0x27bfb7;_0xb2fb3c['xmin']-=_0xf3784d,_0xb2fb3c[_0x2100ff(0xf1)]-=_0xf3784d,_0xb2fb3c['xmax']+=_0xf3784d,_0xb2fb3c['ymax']+=_0xf3784d,this['_scale']=_0x27bfb7,_0x31276e=geLatLngBounds(_0xb2fb3c),this[_0x2100ff(0x120)]=Cesium[_0x2100ff(0xd5)][_0x2100ff(0x118)](_0x31276e['xmin'],_0x31276e[_0x2100ff(0xf1)],_0x31276e[_0x2100ff(0xf8)],_0x31276e['ymax']);let _0x5f2226=_0x499f05[0x0]['value']??0x1,_0x19ee77=_0x499f05[0x0]['value']??0x0;const _0x455796=[];_0x499f05[_0x2100ff(_0x47c524._0x1f6c7a)](_0x9408a8=>{const _0x146fbf=_0x2100ff,_0x355335=mars3d__namespace['PointTrans'][_0x146fbf(_0xca4626._0x6d988f)]([_0x9408a8['lng'],_0x9408a8['lat']]),_0x380325=_0x9408a8['value']||0x1,_0x5d582c=Math['round']((_0x355335[0x0]-_0xb2fb3c['xmin'])/_0x27bfb7),_0x770d84=Math['round']((_0xb2fb3c['ymax']-_0x355335[0x1])/_0x27bfb7);_0x5f2226=Math['max'](_0x5f2226,_0x380325),_0x19ee77=Math['min'](_0x19ee77,_0x380325),_0x455796[_0x146fbf(0x102)]({'x':_0x5d582c,'y':_0x770d84,'value':_0x380325});});const _0x18e59c={'min':this['options'][_0x2100ff(0xd6)]??_0x19ee77,'max':this['options'][_0x2100ff(0xef)]??_0x5f2226,'data':_0x455796};this[_0x2100ff(0x105)]=_0x18e59c;if(!this[_0x2100ff(_0x47c524._0x5539c0)]||_0xb2fb3c['xmin']!==this[_0x2100ff(_0x47c524._0x5539c0)]['xmin']||_0xb2fb3c[_0x2100ff(_0x47c524._0x3a9c70)]!==this['_last_mBounds']['ymin']||_0xb2fb3c[_0x2100ff(0xf8)]!==this[_0x2100ff(0x124)]['xmax']||_0xb2fb3c['ymax']!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0xb2fb3c,this['_container']['style'][_0x2100ff(_0x47c524._0x5a731b)]=_0x2100ff(_0x47c524._0x597ce6)+_0x1e2167+'px;height:'+_0x32ddda+'px;';const _0x6d5f29={...this[_0x2100ff(0xed)],'container':this['_container']};!this[_0x2100ff(0x129)]?this['_heat']=h337__namespace['create'](_0x6d5f29):this['_heat']['configure'](_0x6d5f29);}this['_heat'][_0x2100ff(_0x47c524._0x1c127c)](_0x18e59c);const _0x55a83d=mars3d__namespace[_0x2100ff(_0x47c524._0x5043a3)]['copyCanvas'](this[_0x2100ff(0x129)]['_renderer']['canvas']);return _0x55a83d;}[_0x2aa105(0x12e)](){const _0x15d02c={_0x35c545:0xf0,_0x318a7d:0x11e,_0x2a8eeb:0xe9,_0x4712d3:0x10c},_0x4838df=_0x2aa105;this['_heat'][_0x4838df(0x114)]({'radius':this['heatStyle'][_0x4838df(0x111)]*this[_0x4838df(_0x15d02c._0x35c545)]['arcRadiusScale'],'blur':this['heatStyle'][_0x4838df(_0x15d02c._0x318a7d)]*this[_0x4838df(0xf0)]['arcBlurScale'],'gradient':this[_0x4838df(0xed)][_0x4838df(_0x15d02c._0x2a8eeb)]||{0.25:_0x4838df(0x10f),0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x42e6ee=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x4838df(0x129)][_0x4838df(0xf2)]['canvas']);return this['_heat']['configure'](this[_0x4838df(_0x15d02c._0x4712d3)]['heatStyle']),_0x42e6ee;}['getPointData'](_0x12fc47){const _0x71eb68={_0x2fc1cd:0x123,_0x2185b7:0xe8,_0x5f4343:0x107,_0x2d2104:0x100},_0x115b9d=_0x2aa105,_0x83e5ee=mars3d__namespace['LngLatPoint'][_0x115b9d(0xd7)](_0x12fc47);if(!_0x83e5ee)return{};const _0x5161d4=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x83e5ee['lng'],_0x83e5ee['lat']]),_0x594278=this['_last_mBounds'],_0x3d8059=Math['round']((_0x5161d4[0x0]-_0x594278['xmin'])/this[_0x115b9d(_0x71eb68._0x2fc1cd)]),_0x42cd4e=Math[_0x115b9d(_0x71eb68._0x2185b7)]((_0x594278[_0x115b9d(_0x71eb68._0x5f4343)]-_0x5161d4[0x1])/this['_scale']),_0x24b407=this['_heat'][_0x115b9d(0xde)]({'x':_0x3d8059,'y':_0x42cd4e}),_0x40ba3c=this['_heat']['_renderer'][_0x115b9d(_0x71eb68._0x2d2104)]['getImageData'](_0x3d8059-0x1,_0x42cd4e-0x1,0x1,0x1)['data'];return{'x':_0x3d8059,'y':_0x42cd4e,'value':_0x24b407,'color':_0x115b9d(0xe5)+_0x40ba3c[0x0]+','+_0x40ba3c[0x1]+','+_0x40ba3c[0x2]+','+_0x40ba3c[0x3]+')'};}}function _0x11c5(){const _0x44acdd=['addPosition','ymax','arcDirection','DomUtil','_mBoundsMax','value','options','70FdRoSf','BaseLayer','rgb(0,0,0)','_layer','radius','3987308UKlgml','10CUsUbK','configure','StencilOperation','clientHeight','create','fromDegrees','get','forEach','RenderState','type','ALWAYS','blur','mars3d-heatmap\x20mars3d-hideDiv','_rectangle','3752556AolNGd','setPositions','_scale','_last_mBounds','lonlat2mercator','addGraphic','maxCanvasSize','2176110AyFyUD','_heat','setData','PointTrans','_updatePositionsHook','uniforms','_getArcHeatCanvas','cssText','addLayer','_getHeatCanvas','mercator2lonlat','minCanvasSize','_graphic','HeatLayer','Rectangle','min','parse','defineProperty','_addedHook','length','width:','ImageLayer','EPSG:3857','getValueAt','_createGraphic','_container','xmin','StencilFunction','GraphicLayer','4669833KXYhdW','rgba(','BlendingState','1104cqDeSn','round','gradientArc','RectanglePrimitive','image','Util','heatStyle','REPLACE','max','style','ymin','_renderer','10774600nftmvM','getRectangle','diffHeight','_positions','Cartesian2','xmax','points','6128JXvPeG','granularity','merge','_graphic2','getOwnPropertyDescriptor','layer','ctx','lng','push','KEEP','811433sWXgoA','_last_heatData'];_0x11c5=function(){return _0x44acdd;};return _0x11c5();}mars3d__namespace[_0x2aa105(0xff)]['HeatLayer']=HeatLayer,mars3d__namespace['LayerUtil']['register']('heat',HeatLayer);function getMercatorBounds(_0x35e0df){const _0x5e8d44=_0x2aa105,_0x524b3a=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x35e0df['xmin'],_0x35e0df['ymin']]),_0x1e7845=mars3d__namespace['PointTrans'][_0x5e8d44(0x125)]([_0x35e0df['xmax'],_0x35e0df['ymax']]);return{'xmin':_0x524b3a[0x0],'ymin':_0x524b3a[0x1],'xmax':_0x1e7845[0x0],'ymax':_0x1e7845[0x1]};}function geLatLngBounds(_0x5befcc){const _0x387338={_0x111ddc:0xd1,_0x181ef5:0xf1},_0x153f6f=_0x2aa105,_0x5f23bc=mars3d__namespace['PointTrans'][_0x153f6f(_0x387338._0x111ddc)]([_0x5befcc[_0x153f6f(0xe1)],_0x5befcc[_0x153f6f(_0x387338._0x181ef5)]]),_0x20914d=mars3d__namespace[_0x153f6f(0x12b)]['mercator2lonlat']([_0x5befcc['xmax'],_0x5befcc['ymax']]);return{'xmin':_0x5f23bc[0x0],'ymin':_0x5f23bc[0x1],'xmax':_0x20914d[0x0],'ymax':_0x20914d[0x1]};}function getVertexShaderSource(_0x257011){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x257011+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}function _0x346a(_0x3e4e31,_0x32e15e){const _0x11c555=_0x11c5();return _0x346a=function(_0x346a7d,_0x22ff41){_0x346a7d=_0x346a7d-0xcf;let _0x169a2d=_0x11c555[_0x346a7d];return _0x169a2d;},_0x346a(_0x3e4e31,_0x32e15e);}exports[_0x2aa105(0xd4)]=HeatLayer,Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
