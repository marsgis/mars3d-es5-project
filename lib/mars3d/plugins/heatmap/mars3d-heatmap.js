/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.4
 * 编译日期：2023-08-30 23:18:18
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';function _0x53bc(){const _0x273ae3=['getPointData','gradientArc','1104483mjVaDg','remove','lat','clear','bumpMap','width','value','24oEZwjJ','uniforms','28120HolJSz','radius','ymax','configure','_updatePositionsHook','merge','data','1296DEjQup','rectangle','min','Color','minCanvasSize','cssText','layer','_heat','heatStyle','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','_last_mBounds','7840820KfMFTS','ImageLayer','xmin','round','_getHeatCanvas','rgb(0,0,0)','2peNbov','options','ymin','xmax','19989jCMonm','_renderer','lonlat2mercator','max','__esModule','_layer','_mountedHook','yellow','getImageData','canvas','29617vlnuml','style','green','positions','KEEP','abs','create','_container','EllipsoidSurfaceAppearance','maxCanvasSize','arcRadiusScale','image/png','lng','266726pPQsQk','body','forEach','image','removeLayer','_graphic','PointTrans','RectanglePrimitive','StencilFunction','5891347CZBPOl','360XYLIlX','StencilOperation','addGraphic','arcDirection','register','Util','addPosition','8UloEnD','graphic','_positions','_rectangle','DomUtil','_setOptionsHook','Rectangle','diffHeight','addLayer','removeGraphic'];_0x53bc=function(){return _0x273ae3;};return _0x53bc();}const _0x1a20a5=_0x2dab;function _0x2dab(_0x1cc563,_0x4a1c9c){const _0x53bc35=_0x53bc();return _0x2dab=function(_0x2dab51,_0x22265e){_0x2dab51=_0x2dab51-0x15b;let _0xd60be8=_0x53bc35[_0x2dab51];return _0xd60be8;},_0x2dab(_0x1cc563,_0x4a1c9c);}(function(_0x17d084,_0xb4ad2e){const _0x4bebdf={_0x3e040e:0x1a1,_0x55764b:0x174,_0x3d1671:0x190,_0x4ad67c:0x16d,_0x3ca952:0x1a5,_0x3a067c:0x19b,_0x4a6a4a:0x187},_0x30cddd=_0x2dab,_0x43f7a4=_0x17d084();while(!![]){try{const _0x209c86=parseInt(_0x30cddd(0x163))/0x1*(parseInt(_0x30cddd(_0x4bebdf._0x3e040e))/0x2)+parseInt(_0x30cddd(0x180))/0x3*(parseInt(_0x30cddd(_0x4bebdf._0x55764b))/0x4)+parseInt(_0x30cddd(0x189))/0x5+-parseInt(_0x30cddd(_0x4bebdf._0x3d1671))/0x6*(parseInt(_0x30cddd(0x1af))/0x7)+-parseInt(_0x30cddd(_0x4bebdf._0x4ad67c))/0x8*(-parseInt(_0x30cddd(_0x4bebdf._0x3ca952))/0x9)+-parseInt(_0x30cddd(_0x4bebdf._0x3a067c))/0xa+-parseInt(_0x30cddd(0x16c))/0xb*(-parseInt(_0x30cddd(_0x4bebdf._0x4a6a4a))/0xc);if(_0x209c86===_0xb4ad2e)break;else _0x43f7a4['push'](_0x43f7a4['shift']());}catch(_0x514ed5){_0x43f7a4['push'](_0x43f7a4['shift']());}}}(_0x53bc,0x75a01));function _interopNamespace(_0x5e1be6){const _0x2ca6eb={_0x13c3cd:0x1a9},_0x3a7d73=_0x2dab;if(_0x5e1be6&&_0x5e1be6[_0x3a7d73(_0x2ca6eb._0x13c3cd)])return _0x5e1be6;var _0x204bdf=Object['create'](null);return _0x5e1be6&&Object['keys'](_0x5e1be6)['forEach'](function(_0x4aad91){if(_0x4aad91!=='default'){var _0x7e2077=Object['getOwnPropertyDescriptor'](_0x5e1be6,_0x4aad91);Object['defineProperty'](_0x204bdf,_0x4aad91,_0x7e2077['get']?_0x7e2077:{'enumerable':!![],'get':function(){return _0x5e1be6[_0x4aad91];}});}}),_0x204bdf['default']=_0x5e1be6,_0x204bdf;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace[_0x1a20a5(0x15c)])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x1a20a5(0x196)]['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x1a20a5(0x1b1),0.8:_0x1a20a5(0x1ac),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x122944={}){const _0x46586e={_0x5327e4:0x15f,_0x3df6e4:0x164,_0x2ca347:0x164,_0x128bc2:0x194,_0x32d869:0x1a2},_0x9c1034=_0x1a20a5;super(_0x122944),this['options']['maxCanvasSize']=this['options'][_0x9c1034(_0x46586e._0x5327e4)]??document[_0x9c1034(_0x46586e._0x3df6e4)]['clientWidth'],this['options']['maxCanvasSize']=Math[_0x9c1034(0x192)](this[_0x9c1034(0x1a2)]['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this['options']['minCanvasSize']??document[_0x9c1034(_0x46586e._0x2ca347)]['clientHeight'],this['options'][_0x9c1034(_0x46586e._0x128bc2)]=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this[_0x9c1034(_0x46586e._0x32d869)]['style']={...DEF_STYLE,...this[_0x9c1034(0x1a2)]['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){const _0x436528={_0x49d487:0x1a2},_0x34f549=_0x1a20a5;return this[_0x34f549(_0x436528._0x49d487)]['heatStyle'];}set['heatStyle'](_0x393d2c){const _0x3d583a={_0x739ea0:0x198,_0x339e78:0x197,_0x392250:0x1a2},_0x1f9754=_0x1a20a5;this['options'][_0x1f9754(_0x3d583a._0x739ea0)]=mars3d__namespace[_0x1f9754(0x172)]['merge'](this['options']['heatStyle'],_0x393d2c),this['_heat']&&(this[_0x1f9754(_0x3d583a._0x339e78)]['configure'](this[_0x1f9754(_0x3d583a._0x392250)]['heatStyle']),this['_updatePositionsHook'](!![]));}get['style'](){const _0x1fb550=_0x1a20a5;return this[_0x1fb550(0x1a2)]['style'];}set['style'](_0x30c779){const _0x5f0181={_0x5215c5:0x1b0},_0x5d16f0=_0x1a20a5;this['options'][_0x5d16f0(_0x5f0181._0x5215c5)]=mars3d__namespace['Util'][_0x5d16f0(0x18e)](this['options']['style'],_0x30c779);}get['positions'](){return this['_positions'];}set['positions'](_0x1df97c){this['setPositions'](_0x1df97c);}get['coordinates'](){const _0x2e6023=[];return this['points']['forEach'](_0x54ad4b=>{_0x2e6023['push'](_0x54ad4b['toArray']());}),_0x2e6023;}get[_0x1a20a5(0x191)](){return this['_rectangle'];}[_0x1a20a5(0x179)](_0x489a19,_0x3b726b){const _0x50fa5d={_0x12d7a2:0x1b2},_0x1b17af=_0x1a20a5;_0x489a19['positions']&&(this[_0x1b17af(0x1b2)]=_0x489a19[_0x1b17af(_0x50fa5d._0x12d7a2)]);}[_0x1a20a5(0x1ab)](){const _0xb00dbe=_0x1a20a5;this['style']['type']==='image'?this['_layer']=new mars3d__namespace[(_0xb00dbe(0x196))][(_0xb00dbe(0x19c))]({'crs':'EPSG:3857','private':!![]}):this[_0xb00dbe(0x1aa)]=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0x475070={_0x3d437b:0x178,_0x413037:0x1a2,_0x151ae9:0x1b2},_0x352843=_0x1a20a5;this['_map'][_0x352843(0x17c)](this['_layer']),this[_0x352843(0x15d)]=mars3d__namespace[_0x352843(_0x475070._0x3d437b)]['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this[_0x352843(_0x475070._0x413037)][_0x352843(_0x475070._0x151ae9)]&&(this['positions']=this[_0x352843(_0x475070._0x413037)][_0x352843(_0x475070._0x151ae9)]),this['options']['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x24099f={_0xdd8a5a:0x181,_0x53e273:0x183},_0x5cc051=_0x1a20a5;this['_container']&&(mars3d__namespace['DomUtil'][_0x5cc051(_0x24099f._0xdd8a5a)](this['_container']),delete this['_container']),this[_0x5cc051(_0x24099f._0x53e273)](),this['_map'][_0x5cc051(0x167)](this['_layer']);}[_0x1a20a5(0x173)](_0x4fed5a,_0x9fa8fb){const _0x42f809={_0x5b3b33:0x176,_0x3ff08f:0x18d},_0x2ace8f=_0x1a20a5;this['_positions']=this[_0x2ace8f(_0x42f809._0x5b3b33)]||[],this['_positions']['push'](_0x4fed5a),this[_0x2ace8f(_0x42f809._0x3ff08f)](_0x9fa8fb);}['setPositions'](_0x41c052,_0x5142e2){const _0x4873f0=_0x1a20a5;this[_0x4873f0(0x176)]=_0x41c052,this['_updatePositionsHook'](_0x5142e2);}[_0x1a20a5(0x183)](){const _0x17dade=_0x1a20a5;this['_graphic']&&(this['_layer'][_0x17dade(0x17d)](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x202577){const _0x478daf={_0x5a5f8d:0x1b2,_0x4c3953:0x1b0,_0x2f8b47:0x1b0,_0x3ff1f7:0x188,_0x4f771a:0x184},_0x36904e=_0x1a20a5;if(!this['show']||!this['_map']||!this[_0x36904e(_0x478daf._0x5a5f8d)]||this['positions']['length']===0x0)return this;const _0x16f08b=this['_getHeatCanvas']();if(this[_0x36904e(_0x478daf._0x4c3953)]['type']===_0x36904e(0x166))this['_layer']['setOptions']({'url':_0x16f08b['toDataURL'](_0x36904e(0x161)),'rectangle':this['_rectangle'],'opacity':this[_0x36904e(_0x478daf._0x2f8b47)]['opacity']});else this['style']['arc']?this['_graphic']&&_0x202577?(this['_graphic'][_0x36904e(_0x478daf._0x3ff1f7)]['image']=_0x16f08b,this['_graphic']['uniforms'][_0x36904e(0x184)]=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms'][_0x36904e(0x166)]=_0x16f08b,this['_graphic2']['uniforms'][_0x36904e(_0x478daf._0x4f771a)]=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x16f08b):this['_graphic']&&_0x202577?this['_graphic']['uniforms']['image']=_0x16f08b:this['_createGraphic'](_0x16f08b);return this;}['_createGraphic'](_0x1009b1){const _0x59b5ae=_0x1a20a5;this['clear'](),this['_graphic']=new mars3d__namespace['graphic'][(_0x59b5ae(0x16a))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1009b1},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer'][_0x59b5ae(0x16f)](this['_graphic']);}['_createArcGraphic'](_0x7d4d7f){const _0x42dc37={_0x1eab01:0x16e,_0x41e6f0:0x16e,_0x17e4ce:0x1b0,_0xee5a7a:0x17b,_0x5712e3:0x168,_0x35fb90:0x1aa,_0x2f98f7:0x175,_0xc36d7a:0x177,_0x3cab4c:0x15e,_0x20512c:0x16f},_0x13214c=_0x1a20a5;this['clear']();const _0x234c5e=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x13214c(0x16b)]['ALWAYS'],'frontOperation':{'fail':Cesium[_0x13214c(_0x42dc37._0x1eab01)]['KEEP'],'zFail':Cesium['StencilOperation'][_0x13214c(0x1b3)],'zPass':Cesium[_0x13214c(0x16e)]['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium[_0x13214c(_0x42dc37._0x41e6f0)][_0x13214c(0x1b3)],'zFail':Cesium[_0x13214c(0x16e)]['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x188690=Math['floor'](this[_0x13214c(_0x42dc37._0x17e4ce)]['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style'][_0x13214c(_0x42dc37._0xee5a7a)];const _0x594395=(this['style']['splitNum'],0x64);let _0x189097=Math[_0x13214c(0x1a8)](this['_rectangle']['height'],this['_rectangle'][_0x13214c(0x185)]);this[_0x13214c(0x1b0)]['granularity']=_0x189097/=_0x594395;const _0x4207df=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x7d4d7f,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0x13214c(0x193))](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x4d807d=this['style']['arcDirection']||0x1;this[_0x13214c(_0x42dc37._0x5712e3)]=new mars3d__namespace[(_0x13214c(0x175))]['RectanglePrimitive']({...this['options'],'rectangle':this[_0x13214c(0x177)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x234c5e,'material':_0x4207df,'vertexShaderSource':getVertexShaderSource(_0x188690*_0x4d807d)})}),this[_0x13214c(_0x42dc37._0x35fb90)]['addGraphic'](this['_graphic']),this[_0x13214c(0x1b0)][_0x13214c(0x170)]===0x0&&(this['_graphic2']=new mars3d__namespace[(_0x13214c(_0x42dc37._0x2f98f7))]['RectanglePrimitive']({...this[_0x13214c(0x1a2)],'rectangle':this[_0x13214c(_0x42dc37._0xc36d7a)],'appearance':new Cesium[(_0x13214c(_0x42dc37._0x3cab4c))]({'flat':!![],'aboveGround':!![],'renderState':_0x234c5e,'material':_0x4207df,'vertexShaderSource':getVertexShaderSource(-_0x188690)})}),this['_layer'][_0x13214c(_0x42dc37._0x20512c)](this['_graphic2']));}['getRectangle'](_0x3d0a96){return _0x3d0a96!==null&&_0x3d0a96!==void 0x0&&_0x3d0a96['isFormat']&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}[_0x1a20a5(0x19f)](){const _0x29b2f6={_0x2d1d6d:0x191,_0x437d33:0x1a3,_0x5760b4:0x1a8,_0x5f3ade:0x194,_0x4d7af5:0x15f,_0x192e31:0x19d,_0x4bcddc:0x1a4,_0x46b6eb:0x19a,_0x3c872b:0x197},_0x17db48={_0x432c58:0x182,_0x277746:0x186,_0x17c97a:0x19e},_0x19c025={_0x249dcd:0x191},_0x40290b=_0x1a20a5,_0x510283=this['_positions'],_0x5986ff=[];let _0x2be996,_0x3db48c,_0x1d0ccc,_0x4d328e;_0x510283[_0x40290b(0x165)](_0x33d139=>{const _0x13dce9=_0x40290b,_0x4889a4=mars3d__namespace['LngLatPoint']['parse'](_0x33d139);if(!_0x4889a4)return;_0x4889a4['value']=_0x33d139['value']||0x1,!this['options'][_0x13dce9(_0x19c025._0x249dcd)]&&(_0x2be996===undefined?(_0x2be996=_0x4889a4['lng'],_0x3db48c=_0x4889a4['lng'],_0x1d0ccc=_0x4889a4['lat'],_0x4d328e=_0x4889a4[_0x13dce9(0x182)]):(_0x2be996=Math['min'](_0x2be996,_0x4889a4['lng']),_0x3db48c=Math['max'](_0x3db48c,_0x4889a4['lng']),_0x1d0ccc=Math['min'](_0x1d0ccc,_0x4889a4['lat']),_0x4d328e=Math['max'](_0x4d328e,_0x4889a4['lat']))),_0x5986ff['push'](_0x4889a4);});_0x2be996===_0x3db48c&&(_0x2be996-=0.000001,_0x3db48c+=0.000001);_0x1d0ccc===_0x4d328e&&(_0x1d0ccc-=0.000001,_0x4d328e+=0.000001);let _0x253b55=this['options'][_0x40290b(_0x29b2f6._0x2d1d6d)]||{'xmin':_0x2be996,'xmax':_0x3db48c,'ymin':_0x1d0ccc,'ymax':_0x4d328e};const _0x3693a5=getMercatorBounds(_0x253b55),_0x4f7b44=Math['abs'](_0x3693a5[_0x40290b(0x1a4)]-_0x3693a5['xmin']),_0x530984=Math[_0x40290b(0x15b)](_0x3693a5[_0x40290b(0x18b)]-_0x3693a5[_0x40290b(_0x29b2f6._0x437d33)]),_0x17e807=Math[_0x40290b(_0x29b2f6._0x5760b4)](_0x4f7b44,_0x530984),_0x1a6d13=Math['min'](_0x4f7b44,_0x530984);this['_mBoundsMax']=_0x17e807;let _0x52a450=0x1;if(_0x17e807>this['options'][_0x40290b(0x15f)])_0x52a450=_0x17e807/this['options']['maxCanvasSize'],_0x1a6d13/_0x52a450<this['options']['minCanvasSize']&&(_0x52a450=_0x1a6d13/this['options'][_0x40290b(_0x29b2f6._0x5f3ade)]);else _0x1a6d13<this['options']['minCanvasSize']&&(_0x52a450=_0x1a6d13/this['options']['minCanvasSize'],_0x17e807/_0x52a450>this['options'][_0x40290b(_0x29b2f6._0x4d7af5)]&&(_0x52a450=_0x17e807/this['options']['maxCanvasSize']));const _0x266469=this[_0x40290b(0x198)]['radius']*1.5,_0x218e14=_0x4f7b44/_0x52a450+_0x266469*0x2,_0x52c5f3=_0x530984/_0x52a450+_0x266469*0x2,_0x473d7d=_0x266469*_0x52a450;_0x3693a5[_0x40290b(_0x29b2f6._0x192e31)]-=_0x473d7d,_0x3693a5['ymin']-=_0x473d7d,_0x3693a5['xmax']+=_0x473d7d,_0x3693a5['ymax']+=_0x473d7d,this['_scale']=_0x52a450,_0x253b55=geLatLngBounds(_0x3693a5),this['_rectangle']=Cesium[_0x40290b(0x17a)]['fromDegrees'](_0x253b55['xmin'],_0x253b55[_0x40290b(0x1a3)],_0x253b55[_0x40290b(_0x29b2f6._0x4bcddc)],_0x253b55['ymax']);let _0xeb4ab=_0x5986ff[0x0]['value']??0x1,_0x42773d=_0x5986ff[0x0]['value']??0x0;const _0x2f1451=[];_0x5986ff['forEach'](_0x44bf5c=>{const _0x133a17=_0x40290b,_0x5c4b9b=mars3d__namespace['PointTrans'][_0x133a17(0x1a7)]([_0x44bf5c['lng'],_0x44bf5c[_0x133a17(_0x17db48._0x432c58)]]),_0x4d1570=_0x44bf5c[_0x133a17(_0x17db48._0x277746)]||0x1,_0x5ac7ed=Math['round']((_0x5c4b9b[0x0]-_0x3693a5['xmin'])/_0x52a450),_0x36151f=Math[_0x133a17(_0x17db48._0x17c97a)]((_0x3693a5['ymax']-_0x5c4b9b[0x1])/_0x52a450);_0xeb4ab=Math['max'](_0xeb4ab,_0x4d1570),_0x42773d=Math['min'](_0x42773d,_0x4d1570),_0x2f1451['push']({'x':_0x5ac7ed,'y':_0x36151f,'value':_0x4d1570});});const _0x522e6b={'min':this['options'][_0x40290b(0x192)]??_0x42773d,'max':this['options']['max']??_0xeb4ab,'data':_0x2f1451};this['_last_heatData']=_0x522e6b;if(!this['_last_mBounds']||_0x3693a5['xmin']!==this['_last_mBounds']['xmin']||_0x3693a5['ymin']!==this['_last_mBounds']['ymin']||_0x3693a5['xmax']!==this['_last_mBounds']['xmax']||_0x3693a5['ymax']!==this[_0x40290b(_0x29b2f6._0x46b6eb)]['ymax']){this['_last_mBounds']=_0x3693a5,this['_container'][_0x40290b(0x1b0)][_0x40290b(0x195)]='width:'+_0x218e14+'px;height:'+_0x52c5f3+'px;';const _0x5045c0={...this['heatStyle'],'container':this['_container']};!this['_heat']?this[_0x40290b(_0x29b2f6._0x3c872b)]=h337__namespace['create'](_0x5045c0):this['_heat']['configure'](_0x5045c0);}this['_heat']['setData'](_0x522e6b);const _0x3b0e3d=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer'][_0x40290b(0x1ae)]);return _0x3b0e3d;}['_getArcHeatCanvas'](){const _0x29e0ef={_0x3a7c0f:0x197,_0x3757e:0x198,_0x1399e8:0x18a,_0x83cba6:0x160,_0x13e4f0:0x17f,_0x744dce:0x1a6},_0x1fa423=_0x1a20a5;this[_0x1fa423(_0x29e0ef._0x3a7c0f)]['configure']({'radius':this[_0x1fa423(_0x29e0ef._0x3757e)][_0x1fa423(_0x29e0ef._0x1399e8)]*this['style'][_0x1fa423(_0x29e0ef._0x83cba6)],'blur':this[_0x1fa423(_0x29e0ef._0x3757e)]['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle'][_0x1fa423(_0x29e0ef._0x13e4f0)]||{0.25:_0x1fa423(0x1a0),0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x32fc64=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat'][_0x1fa423(_0x29e0ef._0x744dce)]['canvas']);return this['_heat'][_0x1fa423(0x18c)](this['options']['heatStyle']),_0x32fc64;}[_0x1a20a5(0x17e)](_0x21fffe){const _0x359f46=_0x1a20a5,_0x4228e6=mars3d__namespace['LngLatPoint']['parse'](_0x21fffe);if(!_0x4228e6)return{};const _0x45f8f1=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x4228e6[_0x359f46(0x162)],_0x4228e6['lat']]),_0x41c124=this['_last_mBounds'],_0x31419e=Math['round']((_0x45f8f1[0x0]-_0x41c124['xmin'])/this['_scale']),_0x4b2048=Math['round']((_0x41c124['ymax']-_0x45f8f1[0x1])/this['_scale']),_0x16c94d=this['_heat']['getValueAt']({'x':_0x31419e,'y':_0x4b2048}),_0x4ea722=this['_heat']['_renderer']['ctx'][_0x359f46(0x1ad)](_0x31419e-0x1,_0x4b2048-0x1,0x1,0x1)[_0x359f46(0x18f)];return{'x':_0x31419e,'y':_0x4b2048,'value':_0x16c94d,'color':'rgba('+_0x4ea722[0x0]+','+_0x4ea722[0x1]+','+_0x4ea722[0x2]+','+_0x4ea722[0x3]+')'};}}mars3d__namespace['LayerUtil'][_0x1a20a5(0x171)]('heat',HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace['h337']=h337__namespace;function getMercatorBounds(_0x579bf2){const _0x583475={_0x179b0f:0x1a7},_0x6283de=_0x1a20a5,_0x57e677=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x579bf2['xmin'],_0x579bf2['ymin']]),_0x1a34a1=mars3d__namespace['PointTrans'][_0x6283de(_0x583475._0x179b0f)]([_0x579bf2[_0x6283de(0x1a4)],_0x579bf2[_0x6283de(0x18b)]]);return{'xmin':_0x57e677[0x0],'ymin':_0x57e677[0x1],'xmax':_0x1a34a1[0x0],'ymax':_0x1a34a1[0x1]};}function geLatLngBounds(_0x4bd829){const _0x3830d3=_0x1a20a5,_0x1a2ae0=mars3d__namespace[_0x3830d3(0x169)]['mercator2lonlat']([_0x4bd829[_0x3830d3(0x19d)],_0x4bd829['ymin']]),_0x10eb4c=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x4bd829['xmax'],_0x4bd829['ymax']]);return{'xmin':_0x1a2ae0[0x0],'ymin':_0x1a2ae0[0x1],'xmax':_0x10eb4c[0x0],'ymax':_0x10eb4c[0x1]};}function getVertexShaderSource(_0x5e3d19){const _0x27cbab=_0x1a20a5;return _0x27cbab(0x199)+_0x5e3d19+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x1a20a5(0x1a9),{'value':!![]});
}));
