/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.5
 * 编译日期：2023-09-08 17:10:07
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x38add4=_0x1ded;function _0x1ded(_0x18b6b6,_0x4f2661){const _0x4ef6a3=_0x4ef6();return _0x1ded=function(_0x1ded24,_0x512266){_0x1ded24=_0x1ded24-0x1e8;let _0x392f1c=_0x4ef6a3[_0x1ded24];return _0x392f1c;},_0x1ded(_0x18b6b6,_0x4f2661);}(function(_0x2a3c03,_0x16c611){const _0x3395ff={_0x32899f:0x20a,_0x52c13f:0x213,_0x122f3b:0x217,_0x321972:0x214,_0x8ad08a:0x23c},_0x4cf366=_0x1ded,_0x5a5635=_0x2a3c03();while(!![]){try{const _0xa32f44=-parseInt(_0x4cf366(0x22f))/0x1+-parseInt(_0x4cf366(_0x3395ff._0x32899f))/0x2+-parseInt(_0x4cf366(0x20f))/0x3+parseInt(_0x4cf366(_0x3395ff._0x52c13f))/0x4+parseInt(_0x4cf366(0x238))/0x5*(-parseInt(_0x4cf366(_0x3395ff._0x122f3b))/0x6)+parseInt(_0x4cf366(_0x3395ff._0x321972))/0x7*(parseInt(_0x4cf366(_0x3395ff._0x8ad08a))/0x8)+parseInt(_0x4cf366(0x1ff))/0x9*(parseInt(_0x4cf366(0x1eb))/0xa);if(_0xa32f44===_0x16c611)break;else _0x5a5635['push'](_0x5a5635['shift']());}catch(_0x4477f7){_0x5a5635['push'](_0x5a5635['shift']());}}}(_0x4ef6,0xa2c30));function _interopNamespace(_0x512695){const _0x5efaaf={_0x56ce81:0x204};if(_0x512695&&_0x512695['__esModule'])return _0x512695;var _0x535dff=Object['create'](null);return _0x512695&&Object['keys'](_0x512695)['forEach'](function(_0x197f07){const _0x515cd9=_0x1ded;if(_0x197f07!=='default'){var _0x5bcc84=Object[_0x515cd9(_0x5efaaf._0x56ce81)](_0x512695,_0x197f07);Object['defineProperty'](_0x535dff,_0x197f07,_0x5bcc84['get']?_0x5bcc84:{'enumerable':!![],'get':function(){return _0x512695[_0x197f07];}});}}),_0x535dff['default']=_0x512695,_0x535dff;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace[_0x38add4(0x21c)])throw new Error('请引入\x20heatmap.js\x20库\x20');function _0x4ef6(){const _0x5b3a0a=['value','_positions','1322869Zhwkix','px;','type','_setOptionsHook','lat','_createArcGraphic','layer','graphic','maxCanvasSize','182670lgawvy','_scale','_layer','max','11128YlccPQ','style','uniforms','green','_container','10lAYCZO','_last_heatData','HeatLayer','RectanglePrimitive','_heat','REPLACE','configure','push','EllipsoidSurfaceAppearance','VERTEX_FORMAT','image/png','_rectangle','LngLatPoint','_graphic','show','canvas','cssText','_addedHook','blur','_updatePositionsHook','5642739oEgEFs','_graphic2','PointTrans','StencilOperation','xmax','getOwnPropertyDescriptor','_mountedHook','diffHeight','floor','rgb(216,216,216)','heatStyle','254902UppKlG','clientHeight','positions','defineProperty','rectangle','974976deGSIv','KEEP','flyToByAnimationEnd','min','4430920HqYZLp','3927OQdbzO','_map','toDataURL','12kjyTzP','clear','StencilFunction','setOptions','xmin','create','Util','round','options','arc','parse','flyTo','ymin','h337','_last_mBounds','ymax','remove','Rectangle','arcBlurScale','abs','lonlat2mercator','DomUtil'];_0x4ef6=function(){return _0x5b3a0a;};return _0x4ef6();}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:_0x38add4(0x1e9),0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance'][_0x38add4(0x1f4)]};class HeatLayer extends BaseLayer{constructor(_0x31afb5={}){const _0xc87b6f={_0x363298:0x237,_0x1cf333:0x237,_0x1efaa4:0x237,_0x2ade77:0x23b,_0x278505:0x21f,_0x2d42b2:0x21f},_0x3a9b34=_0x38add4;super(_0x31afb5),this[_0x3a9b34(0x21f)][_0x3a9b34(_0xc87b6f._0x363298)]=this['options'][_0x3a9b34(0x237)]??document['body']['clientWidth'],this['options'][_0x3a9b34(_0xc87b6f._0x1cf333)]=Math['min'](this['options'][_0x3a9b34(_0xc87b6f._0x1efaa4)],0x1388),this['options']['minCanvasSize']=this['options']['minCanvasSize']??document['body'][_0x3a9b34(0x20b)],this['options']['minCanvasSize']=Math[_0x3a9b34(_0xc87b6f._0x2ade77)](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this[_0x3a9b34(0x21f)]['heatStyle']},this[_0x3a9b34(_0xc87b6f._0x278505)][_0x3a9b34(0x23d)]={...DEF_STYLE,...this[_0x3a9b34(_0xc87b6f._0x2d42b2)][_0x3a9b34(0x23d)]};}get[_0x38add4(0x235)](){return this['_layer'];}get['heatStyle'](){const _0xd74829={_0x2d96a1:0x21f},_0x551f44=_0x38add4;return this[_0x551f44(_0xd74829._0x2d96a1)]['heatStyle'];}set['heatStyle'](_0x27635a){const _0x4727d5={_0x2414cf:0x209},_0x257445=_0x38add4;this['options'][_0x257445(_0x4727d5._0x2414cf)]=mars3d__namespace[_0x257445(0x21d)]['merge'](this['options']['heatStyle'],_0x27635a),this[_0x257445(0x1ef)]&&(this[_0x257445(0x1ef)]['configure'](this['options'][_0x257445(_0x4727d5._0x2414cf)]),this['_updatePositionsHook'](!![]));}get[_0x38add4(0x23d)](){const _0x5ec50a=_0x38add4;return this['options'][_0x5ec50a(0x23d)];}set['style'](_0x2946b8){const _0x3a1df4={_0x4f4b1b:0x23d},_0x127202=_0x38add4;this['options']['style']=mars3d__namespace['Util']['merge'](this['options'][_0x127202(_0x3a1df4._0x4f4b1b)],_0x2946b8);}get['positions'](){const _0xed9a7d={_0x58b075:0x22e},_0x31f657=_0x38add4;return this[_0x31f657(_0xed9a7d._0x58b075)];}set[_0x38add4(0x20c)](_0x73eda3){this['setPositions'](_0x73eda3);}get['coordinates'](){const _0x2614cf={_0x34dd82:0x1f2},_0x19591c=[];return this['points']['forEach'](_0x32061f=>{const _0x2b90ae=_0x1ded;_0x19591c[_0x2b90ae(_0x2614cf._0x34dd82)](_0x32061f['toArray']());}),_0x19591c;}get[_0x38add4(0x20e)](){return this['_rectangle'];}[_0x38add4(0x232)](_0x4bf980,_0x339e32){const _0x49f764=_0x38add4;_0x4bf980['positions']&&(this['positions']=_0x4bf980[_0x49f764(0x20c)]);}[_0x38add4(0x205)](){const _0x288a00=_0x38add4;this['style']['type']==='image'?this[_0x288a00(0x23a)]=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}[_0x38add4(0x1fc)](){const _0x5dd36c={_0x4915e2:0x215,_0x4b0d53:0x23a,_0x56f8a5:0x21f,_0x4e72d7:0x222},_0x59c61f=_0x38add4;this[_0x59c61f(_0x5dd36c._0x4915e2)]['addLayer'](this[_0x59c61f(_0x5dd36c._0x4b0d53)]),this['_container']=mars3d__namespace['DomUtil']['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this[_0x59c61f(0x215)]['container']),this['options']['positions']&&(this['positions']=this[_0x59c61f(_0x5dd36c._0x56f8a5)]['positions']),this['options'][_0x59c61f(_0x5dd36c._0x4e72d7)]&&this[_0x59c61f(0x211)]();}['_removedHook'](){const _0x37e5ef=_0x38add4;this[_0x37e5ef(0x1ea)]&&(mars3d__namespace['DomUtil'][_0x37e5ef(0x227)](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this['_layer']);}['addPosition'](_0x4ff49a,_0x1507df){const _0x134d7b=_0x38add4;this['_positions']=this['_positions']||[],this['_positions'][_0x134d7b(0x1f2)](_0x4ff49a),this['_updatePositionsHook'](_0x1507df);}['setPositions'](_0x3650d6,_0x3634c0){const _0x14c4c8=_0x38add4;this['_positions']=_0x3650d6,this[_0x14c4c8(0x1fe)](_0x3634c0);}[_0x38add4(0x218)](){const _0x3310bf={_0x56edd9:0x1f8},_0x30a0ca=_0x38add4;this[_0x30a0ca(_0x3310bf._0x56edd9)]&&(this[_0x30a0ca(0x23a)]['removeGraphic'](this['_graphic'],!![]),delete this[_0x30a0ca(0x1f8)]),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x38add4(0x1fe)](_0x3fa5d6){const _0x228e62={_0x2accd2:0x215,_0x47c500:0x231,_0x36b3e6:0x21a,_0x1660a0:0x1f6,_0x22a091:0x200,_0x25284c:0x1e8},_0x53c120=_0x38add4;if(!this[_0x53c120(0x1f9)]||!this[_0x53c120(_0x228e62._0x2accd2)]||!this['positions']||this['positions']['length']===0x0)return this;const _0x33fe88=this['_getHeatCanvas']();if(this['style'][_0x53c120(_0x228e62._0x47c500)]==='image')this['_layer'][_0x53c120(_0x228e62._0x36b3e6)]({'url':_0x33fe88[_0x53c120(0x216)](_0x53c120(0x1f5)),'rectangle':this[_0x53c120(_0x228e62._0x1660a0)],'opacity':this['style']['opacity']});else this[_0x53c120(0x23d)][_0x53c120(0x220)]?this['_graphic']&&_0x3fa5d6?(this['_graphic'][_0x53c120(0x1e8)]['image']=_0x33fe88,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this[_0x53c120(_0x228e62._0x22a091)]&&(this['_graphic2'][_0x53c120(_0x228e62._0x25284c)]['image']=_0x33fe88,this['_graphic2']['uniforms']['bumpMap']=this[_0x53c120(0x1f8)]['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x33fe88):this['_graphic']&&_0x3fa5d6?this['_graphic']['uniforms']['image']=_0x33fe88:this['_createGraphic'](_0x33fe88);return this;}['_createGraphic'](_0x66ee84){const _0x1e89cc={_0x481902:0x1ee,_0x3e34fd:0x1f6,_0x3271c0:0x1f3},_0x48736d=_0x38add4;this['clear'](),this['_graphic']=new mars3d__namespace[(_0x48736d(0x236))][(_0x48736d(_0x1e89cc._0x481902))]({...this['options'],'rectangle':this[_0x48736d(_0x1e89cc._0x3e34fd)],'appearance':new Cesium[(_0x48736d(_0x1e89cc._0x3271c0))]({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x66ee84},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0x38add4(0x234)](_0x1a60e3){const _0x72a963={_0x106368:0x210,_0x15435c:0x1f0,_0x5a3cd5:0x202,_0x576236:0x202,_0x204841:0x1f0,_0x125e75:0x206,_0x134e3a:0x1f6,_0xdc41de:0x23d,_0x4f5dbc:0x1f3},_0x47f9d7=_0x38add4;this['clear']();const _0x1e831e=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium[_0x47f9d7(0x219)]['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation'][_0x47f9d7(_0x72a963._0x106368)],'zFail':Cesium['StencilOperation'][_0x47f9d7(_0x72a963._0x106368)],'zPass':Cesium[_0x47f9d7(0x202)][_0x47f9d7(_0x72a963._0x15435c)]},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium[_0x47f9d7(_0x72a963._0x5a3cd5)]['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x47f9d7(_0x72a963._0x576236)][_0x47f9d7(_0x72a963._0x204841)]},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x4a7ed7=Math[_0x47f9d7(0x207)](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style'][_0x47f9d7(_0x72a963._0x125e75)];const _0x8c2309=(this[_0x47f9d7(0x23d)]['splitNum'],0x64);let _0x3b0495=Math['max'](this['_rectangle']['height'],this[_0x47f9d7(_0x72a963._0x134e3a)]['width']);this['style']['granularity']=_0x3b0495/=_0x8c2309;const _0x3edcc7=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x1a60e3,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x4cb3dc=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x1e831e,'material':_0x3edcc7,'vertexShaderSource':getVertexShaderSource(_0x4a7ed7*_0x4cb3dc)})}),this[_0x47f9d7(0x23a)]['addGraphic'](this['_graphic']),this[_0x47f9d7(_0x72a963._0xdc41de)]['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x47f9d7(0x21f)],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x47f9d7(_0x72a963._0x4f5dbc))]({'flat':!![],'aboveGround':!![],'renderState':_0x1e831e,'material':_0x3edcc7,'vertexShaderSource':getVertexShaderSource(-_0x4a7ed7)})}),this['_layer']['addGraphic'](this['_graphic2']));}['getRectangle'](_0x321a11){const _0x27dc65={_0x1886a5:0x1f6},_0x136a73=_0x38add4;return _0x321a11!==null&&_0x321a11!==void 0x0&&_0x321a11['isFormat']&&this[_0x136a73(_0x27dc65._0x1886a5)]?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0xdf27d9={_0x298a46:0x203,_0x1bc6b7:0x226,_0x4838cc:0x212,_0xf5b51b:0x237,_0x52d66c:0x21f,_0x143115:0x1f6,_0x119784:0x21b,_0x488d50:0x21b,_0x3302a8:0x1ea,_0x1e9b0a:0x230,_0x4dd19f:0x1ef},_0x1eff75={_0x215527:0x22b},_0xb185f7={_0x180c43:0x221,_0x265d03:0x233,_0x410453:0x23b},_0x3c60d9=_0x38add4,_0x5f38b4=this['_positions'],_0x59a850=[];let _0x31d520,_0x66b62e,_0x4abf92,_0x521bb9;_0x5f38b4['forEach'](_0x11a0f3=>{const _0x25af95=_0x1ded,_0x1d54f9=mars3d__namespace['LngLatPoint'][_0x25af95(_0xb185f7._0x180c43)](_0x11a0f3);if(!_0x1d54f9)return;_0x1d54f9[_0x25af95(0x22d)]=_0x11a0f3[_0x25af95(0x22d)]||0x1,!this[_0x25af95(0x21f)]['rectangle']&&(_0x31d520===undefined?(_0x31d520=_0x1d54f9['lng'],_0x66b62e=_0x1d54f9['lng'],_0x4abf92=_0x1d54f9['lat'],_0x521bb9=_0x1d54f9[_0x25af95(_0xb185f7._0x265d03)]):(_0x31d520=Math['min'](_0x31d520,_0x1d54f9['lng']),_0x66b62e=Math[_0x25af95(0x23b)](_0x66b62e,_0x1d54f9['lng']),_0x4abf92=Math['min'](_0x4abf92,_0x1d54f9['lat']),_0x521bb9=Math[_0x25af95(_0xb185f7._0x410453)](_0x521bb9,_0x1d54f9[_0x25af95(0x233)]))),_0x59a850['push'](_0x1d54f9);});_0x31d520===_0x66b62e&&(_0x31d520-=0.000001,_0x66b62e+=0.000001);_0x4abf92===_0x521bb9&&(_0x4abf92-=0.000001,_0x521bb9+=0.000001);let _0x399e62=this['options']['rectangle']||{'xmin':_0x31d520,'xmax':_0x66b62e,'ymin':_0x4abf92,'ymax':_0x521bb9};const _0x162c22=getMercatorBounds(_0x399e62),_0x2b7fae=Math[_0x3c60d9(0x22a)](_0x162c22[_0x3c60d9(_0xdf27d9._0x298a46)]-_0x162c22['xmin']),_0x58efc6=Math['abs'](_0x162c22[_0x3c60d9(_0xdf27d9._0x1bc6b7)]-_0x162c22[_0x3c60d9(0x223)]),_0x2fa0b8=Math['max'](_0x2b7fae,_0x58efc6),_0xc54e7e=Math[_0x3c60d9(_0xdf27d9._0x4838cc)](_0x2b7fae,_0x58efc6);this['_mBoundsMax']=_0x2fa0b8;let _0x10624f=0x1;if(_0x2fa0b8>this['options']['maxCanvasSize'])_0x10624f=_0x2fa0b8/this['options'][_0x3c60d9(_0xdf27d9._0xf5b51b)],_0xc54e7e/_0x10624f<this[_0x3c60d9(_0xdf27d9._0x52d66c)]['minCanvasSize']&&(_0x10624f=_0xc54e7e/this['options']['minCanvasSize']);else _0xc54e7e<this['options']['minCanvasSize']&&(_0x10624f=_0xc54e7e/this['options']['minCanvasSize'],_0x2fa0b8/_0x10624f>this[_0x3c60d9(_0xdf27d9._0x52d66c)]['maxCanvasSize']&&(_0x10624f=_0x2fa0b8/this[_0x3c60d9(0x21f)]['maxCanvasSize']));const _0x54b819=this['heatStyle']['radius']*1.5,_0x290f6f=_0x2b7fae/_0x10624f+_0x54b819*0x2,_0x4ec696=_0x58efc6/_0x10624f+_0x54b819*0x2,_0x5101c6=_0x54b819*_0x10624f;_0x162c22['xmin']-=_0x5101c6,_0x162c22[_0x3c60d9(0x223)]-=_0x5101c6,_0x162c22['xmax']+=_0x5101c6,_0x162c22['ymax']+=_0x5101c6,this['_scale']=_0x10624f,_0x399e62=geLatLngBounds(_0x162c22),this[_0x3c60d9(_0xdf27d9._0x143115)]=Cesium[_0x3c60d9(0x228)]['fromDegrees'](_0x399e62['xmin'],_0x399e62['ymin'],_0x399e62['xmax'],_0x399e62['ymax']);let _0x5b0fc0=_0x59a850[0x0]['value']??0x1,_0x2ee292=_0x59a850[0x0][_0x3c60d9(0x22d)]??0x0;const _0x2a6f00=[];_0x59a850['forEach'](_0x4c92bc=>{const _0xb38260=_0x3c60d9,_0x4fc63f=mars3d__namespace['PointTrans'][_0xb38260(_0x1eff75._0x215527)]([_0x4c92bc['lng'],_0x4c92bc['lat']]),_0x4caee5=_0x4c92bc['value']||0x1,_0x1832be=Math['round']((_0x4fc63f[0x0]-_0x162c22['xmin'])/_0x10624f),_0x76f3e7=Math['round']((_0x162c22['ymax']-_0x4fc63f[0x1])/_0x10624f);_0x5b0fc0=Math['max'](_0x5b0fc0,_0x4caee5),_0x2ee292=Math['min'](_0x2ee292,_0x4caee5),_0x2a6f00['push']({'x':_0x1832be,'y':_0x76f3e7,'value':_0x4caee5});});const _0x5d2b7f={'min':this['options'][_0x3c60d9(0x212)]??_0x2ee292,'max':this['options']['max']??_0x5b0fc0,'data':_0x2a6f00};this[_0x3c60d9(0x1ec)]=_0x5d2b7f;if(!this['_last_mBounds']||_0x162c22[_0x3c60d9(_0xdf27d9._0x119784)]!==this['_last_mBounds'][_0x3c60d9(_0xdf27d9._0x488d50)]||_0x162c22['ymin']!==this['_last_mBounds'][_0x3c60d9(0x223)]||_0x162c22['xmax']!==this['_last_mBounds']['xmax']||_0x162c22['ymax']!==this['_last_mBounds']['ymax']){this[_0x3c60d9(0x225)]=_0x162c22,this[_0x3c60d9(_0xdf27d9._0x3302a8)]['style'][_0x3c60d9(0x1fb)]='width:'+_0x290f6f+'px;height:'+_0x4ec696+_0x3c60d9(_0xdf27d9._0x1e9b0a);const _0x3018fc={...this['heatStyle'],'container':this['_container']};!this['_heat']?this[_0x3c60d9(_0xdf27d9._0x4dd19f)]=h337__namespace['create'](_0x3018fc):this['_heat']['configure'](_0x3018fc);}this['_heat']['setData'](_0x5d2b7f);const _0x436aa5=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer'][_0x3c60d9(0x1fa)]);return _0x436aa5;}['_getArcHeatCanvas'](){const _0x1bba99={_0x2fc597:0x1fd,_0xd78512:0x229,_0x918169:0x209,_0x3fd000:0x22c,_0x1b22d0:0x1ef,_0x428585:0x209},_0x46d89a=_0x38add4;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this['heatStyle'][_0x46d89a(_0x1bba99._0x2fc597)]*this['style'][_0x46d89a(_0x1bba99._0xd78512)],'gradient':this[_0x46d89a(_0x1bba99._0x918169)]['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:_0x46d89a(0x208),0x1:'rgb(255,255,255)'}});const _0x2ee724=mars3d__namespace[_0x46d89a(_0x1bba99._0x3fd000)]['copyCanvas'](this['_heat']['_renderer']['canvas']);return this[_0x46d89a(_0x1bba99._0x1b22d0)][_0x46d89a(0x1f1)](this['options'][_0x46d89a(_0x1bba99._0x428585)]),_0x2ee724;}['getPointData'](_0x20b7b1){const _0x374e0a={_0x5b2fa8:0x1f7,_0xe072a3:0x21e},_0x131f91=_0x38add4,_0x2a8828=mars3d__namespace[_0x131f91(_0x374e0a._0x5b2fa8)]['parse'](_0x20b7b1);if(!_0x2a8828)return{};const _0x2c4bb8=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x2a8828['lng'],_0x2a8828['lat']]),_0x5489c8=this['_last_mBounds'],_0x35b42f=Math['round']((_0x2c4bb8[0x0]-_0x5489c8['xmin'])/this['_scale']),_0x325cec=Math[_0x131f91(_0x374e0a._0xe072a3)]((_0x5489c8['ymax']-_0x2c4bb8[0x1])/this[_0x131f91(0x239)]),_0x1132ab=this['_heat']['getValueAt']({'x':_0x35b42f,'y':_0x325cec}),_0x3632ff=this['_heat']['_renderer']['ctx']['getImageData'](_0x35b42f-0x1,_0x325cec-0x1,0x1,0x1)['data'];return{'x':_0x35b42f,'y':_0x325cec,'value':_0x1132ab,'color':'rgba('+_0x3632ff[0x0]+','+_0x3632ff[0x1]+','+_0x3632ff[0x2]+','+_0x3632ff[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace[_0x38add4(0x235)]['HeatLayer']=HeatLayer,mars3d__namespace[_0x38add4(0x224)]=h337__namespace;function getMercatorBounds(_0x182ff8){const _0x59184d=_0x38add4,_0xcfe535=mars3d__namespace[_0x59184d(0x201)]['lonlat2mercator']([_0x182ff8['xmin'],_0x182ff8['ymin']]),_0x305913=mars3d__namespace[_0x59184d(0x201)]['lonlat2mercator']([_0x182ff8[_0x59184d(0x203)],_0x182ff8['ymax']]);return{'xmin':_0xcfe535[0x0],'ymin':_0xcfe535[0x1],'xmax':_0x305913[0x0],'ymax':_0x305913[0x1]};}function geLatLngBounds(_0x5760d1){const _0x396b16={_0x5df7b1:0x21b},_0x42fbec=_0x38add4,_0x155fef=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x5760d1[_0x42fbec(_0x396b16._0x5df7b1)],_0x5760d1['ymin']]),_0xb54bc4=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x5760d1['xmax'],_0x5760d1[_0x42fbec(0x226)]]);return{'xmin':_0x155fef[0x0],'ymin':_0x155fef[0x1],'xmax':_0xb54bc4[0x0],'ymax':_0xb54bc4[0x1]};}function getVertexShaderSource(_0x2758c8){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x2758c8+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports[_0x38add4(0x1ed)]=HeatLayer,Object[_0x38add4(0x20d)](exports,'__esModule',{'value':!![]});
}));
