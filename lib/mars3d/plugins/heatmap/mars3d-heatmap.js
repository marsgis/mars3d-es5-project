/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.17
 * 编译日期：2023-12-14 20:38:51
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x8d4470=_0x3041;(function(_0x5ed039,_0x248161){const _0x3058d6={_0x4e7c49:0x1a6,_0x1a3ac9:0x161,_0x11dac5:0x19c},_0x2fcc25=_0x3041,_0x21b55a=_0x5ed039();while(!![]){try{const _0x1e7692=parseInt(_0x2fcc25(_0x3058d6._0x4e7c49))/0x1*(parseInt(_0x2fcc25(0x187))/0x2)+parseInt(_0x2fcc25(_0x3058d6._0x1a3ac9))/0x3+-parseInt(_0x2fcc25(0x199))/0x4+parseInt(_0x2fcc25(0x175))/0x5+parseInt(_0x2fcc25(0x162))/0x6+-parseInt(_0x2fcc25(0x180))/0x7+parseInt(_0x2fcc25(_0x3058d6._0x11dac5))/0x8*(-parseInt(_0x2fcc25(0x178))/0x9);if(_0x1e7692===_0x248161)break;else _0x21b55a['push'](_0x21b55a['shift']());}catch(_0x384470){_0x21b55a['push'](_0x21b55a['shift']());}}}(_0x2dac,0xf13fb));function _0x3041(_0x3a179a,_0x270e64){const _0x2dac76=_0x2dac();return _0x3041=function(_0x3041f6,_0xc68de7){_0x3041f6=_0x3041f6-0x15f;let _0x3c05d1=_0x2dac76[_0x3041f6];return _0x3c05d1;},_0x3041(_0x3a179a,_0x270e64);}function _interopNamespace(_0x35b4e1){const _0x437770={_0x420c92:0x1af},_0x2f9a1d=_0x3041;if(_0x35b4e1&&_0x35b4e1['__esModule'])return _0x35b4e1;var _0x5239a5=Object['create'](null);return _0x35b4e1&&Object['keys'](_0x35b4e1)[_0x2f9a1d(0x1ac)](function(_0xaf8af3){if(_0xaf8af3!=='default'){var _0x2f3cad=Object['getOwnPropertyDescriptor'](_0x35b4e1,_0xaf8af3);Object['defineProperty'](_0x5239a5,_0xaf8af3,_0x2f3cad['get']?_0x2f3cad:{'enumerable':!![],'get':function(){return _0x35b4e1[_0xaf8af3];}});}}),_0x5239a5[_0x2f9a1d(_0x437770._0x420c92)]=_0x35b4e1,_0x5239a5;}function _0x2dac(){const _0x450354=['Material','PointTrans','5630685GWtxzs','11557968UkRZuk','diffHeight','lonlat2mercator','_graphic','graphic','_last_mBounds','_container','round','请引入\x20heatmap.js\x20库\x20','clear','xmax','create','setPositions','_scale','granularity','ymin','_updatePositionsHook','copyCanvas','div','5970130EMDLKj','floor','LayerUtil','81207EukfWa','configure','min','mercator2lonlat','width','Cartesian2','opacity','heat','13239534CorCiF','fromCache','_graphic2','Util','coordinates','uniforms','ImageLayer','1254FUCdfd','BlendingState','toArray','EllipsoidSurfaceAppearance','value','minCanvasSize','getValueAt','arcDirection','image','layer','rectangle','maxCanvasSize','rgb(255,255,255)','removeGraphic','_layer','ymax','merge','DomUtil','4139912TELYdC','_createArcGraphic','body','2352rcYFXR','positions','h337','defineProperty','xmin','points','flyTo','lat','addGraphic','REPLACE','2504TEPUgu','KEEP','heatStyle','StencilOperation','isFormat','_map','forEach','push','RenderState','default','options','_getArcHeatCanvas','_heat','abs','_rectangle','lng','style'];_0x2dac=function(){return _0x450354;};return _0x2dac();}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error(_0x8d4470(0x16a));const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium[_0x8d4470(0x18a)]['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x251efa={}){const _0x2ed09a={_0x466961:0x1b0,_0x143b27:0x1b0,_0x23255a:0x18c,_0x18078d:0x1b6},_0x105540=_0x8d4470;super(_0x251efa),this[_0x105540(_0x2ed09a._0x466961)][_0x105540(0x192)]=this[_0x105540(_0x2ed09a._0x143b27)][_0x105540(0x192)]??document['body']['clientWidth'],this['options']['maxCanvasSize']=Math[_0x105540(0x17a)](this['options']['maxCanvasSize'],0x1388),this['options']['minCanvasSize']=this[_0x105540(0x1b0)][_0x105540(_0x2ed09a._0x23255a)]??document[_0x105540(0x19b)]['clientHeight'],this['options']['minCanvasSize']=Math['max'](this['options']['minCanvasSize'],0x2bc),this['options']['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options']['style']={...DEF_STYLE,...this['options'][_0x105540(_0x2ed09a._0x18078d)]};}get['layer'](){return this['_layer'];}get[_0x8d4470(0x1a8)](){return this['options']['heatStyle'];}set['heatStyle'](_0x5b8cdd){const _0x52ebf0={_0x38afb3:0x1b0,_0x48e07e:0x1b2,_0x3c09ce:0x1a8},_0x226064=_0x8d4470;this[_0x226064(0x1b0)]['heatStyle']=mars3d__namespace[_0x226064(0x183)]['merge'](this[_0x226064(_0x52ebf0._0x38afb3)]['heatStyle'],_0x5b8cdd),this['_heat']&&(this[_0x226064(_0x52ebf0._0x48e07e)][_0x226064(0x179)](this['options'][_0x226064(_0x52ebf0._0x3c09ce)]),this[_0x226064(0x172)](!![]));}get[_0x8d4470(0x1b6)](){return this['options']['style'];}set['style'](_0x261506){const _0x2c10={_0x2d8bf4:0x1b6},_0x3659ce=_0x8d4470;this['options']['style']=mars3d__namespace['Util'][_0x3659ce(0x197)](this['options'][_0x3659ce(_0x2c10._0x2d8bf4)],_0x261506);}get['positions'](){return this['_positions'];}set[_0x8d4470(0x19d)](_0x53c462){const _0x12d2f4={_0x33bd17:0x16e},_0x4752b0=_0x8d4470;this[_0x4752b0(_0x12d2f4._0x33bd17)](_0x53c462);}get[_0x8d4470(0x184)](){const _0x3eaf74={_0x173929:0x1a1},_0x1fb639={_0x1e812a:0x189},_0x5792c5=_0x8d4470,_0x5a1857=[];return this[_0x5792c5(_0x3eaf74._0x173929)]['forEach'](_0x7a21ce=>{const _0x32f1cd=_0x5792c5;_0x5a1857[_0x32f1cd(0x1ad)](_0x7a21ce[_0x32f1cd(_0x1fb639._0x1e812a)]());}),_0x5a1857;}get['rectangle'](){const _0x347e29={_0x2112a0:0x1b4},_0x4da866=_0x8d4470;return this[_0x4da866(_0x347e29._0x2112a0)];}['_setOptionsHook'](_0x355642,_0x44699a){_0x355642['positions']&&(this['positions']=_0x355642['positions']);}['_mountedHook'](){const _0x2a3008={_0x56e6aa:0x190,_0x5c745a:0x186},_0x5e0c18=_0x8d4470;this['style']['type']===_0x5e0c18(0x18f)?this['_layer']=new mars3d__namespace[(_0x5e0c18(_0x2a3008._0x56e6aa))][(_0x5e0c18(_0x2a3008._0x5c745a))]({'crs':'EPSG:3857','private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0xea450d={_0x305881:0x198,_0x216a40:0x174,_0x31dc95:0x1a2},_0x59fd71=_0x8d4470;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace[_0x59fd71(_0xea450d._0x305881)]['create'](_0x59fd71(_0xea450d._0x216a40),'mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options'][_0x59fd71(0x19d)]&&(this['positions']=this['options']['positions']),this['options'][_0x59fd71(_0xea450d._0x31dc95)]&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x2fe60e=_0x8d4470;this['_container']&&(mars3d__namespace[_0x2fe60e(0x198)]['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this['_layer']);}['addPosition'](_0x51baf9,_0x68f5f4){this['_positions']=this['_positions']||[],this['_positions']['push'](_0x51baf9),this['_updatePositionsHook'](_0x68f5f4);}['setPositions'](_0x414948,_0x22d975){this['_positions']=_0x414948,this['_updatePositionsHook'](_0x22d975);}['clear'](){const _0x1d968d={_0x3ce358:0x165,_0x4da243:0x194,_0x2db536:0x182},_0x309e1d=_0x8d4470;this[_0x309e1d(_0x1d968d._0x3ce358)]&&(this['_layer'][_0x309e1d(_0x1d968d._0x4da243)](this['_graphic'],!![]),delete this[_0x309e1d(0x165)]),this[_0x309e1d(_0x1d968d._0x2db536)]&&(this[_0x309e1d(0x195)][_0x309e1d(_0x1d968d._0x4da243)](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x5d3824){const _0x4fe3a1={_0x2c4576:0x1ab},_0x1b979b=_0x8d4470;if(!this['show']||!this[_0x1b979b(_0x4fe3a1._0x2c4576)]||!this[_0x1b979b(0x19d)]||this['positions']['length']===0x0)return this;const _0x53a8f7=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer']['setOptions']({'url':_0x53a8f7['toDataURL']('image/png'),'rectangle':this['_rectangle'],'opacity':this['style'][_0x1b979b(0x17e)]});else this['style']['arc']?this['_graphic']&&_0x5d3824?(this['_graphic']['uniforms'][_0x1b979b(0x18f)]=_0x53a8f7,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2'][_0x1b979b(0x185)]['image']=_0x53a8f7,this['_graphic2']['uniforms']['bumpMap']=this['_graphic']['uniforms']['bumpMap'])):this['_createArcGraphic'](_0x53a8f7):this['_graphic']&&_0x5d3824?this['_graphic']['uniforms']['image']=_0x53a8f7:this['_createGraphic'](_0x53a8f7);return this;}['_createGraphic'](_0x104491){const _0xe8b9b2=_0x8d4470;this[_0xe8b9b2(0x16b)](),this['_graphic']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x104491},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this[_0xe8b9b2(0x165)]);}[_0x8d4470(0x19a)](_0x540a00){const _0x16269b={_0x3445a6:0x181,_0x3e701b:0x1a9,_0x5c036c:0x176,_0xecd645:0x1b4,_0x9b2cad:0x17c,_0x535fcb:0x166,_0x468c59:0x1b0,_0x9f0c21:0x182,_0x5707f2:0x18a,_0x576eff:0x182},_0x252242=_0x8d4470;this['clear']();const _0xdf899d=Cesium[_0x252242(0x1ae)][_0x252242(_0x16269b._0x3445a6)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x252242(0x1a5)]},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium['StencilOperation'][_0x252242(0x1a7)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium[_0x252242(_0x16269b._0x3e701b)]['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium[_0x252242(0x188)]['ALPHA_BLEND']}),_0xc1e473=Math[_0x252242(_0x16269b._0x5c036c)](this['style'][_0x252242(0x163)]??this['_mBoundsMax']*0.02)+0.1;this['style']['diffHeight']&&delete this['style']['diffHeight'];const _0x578f17=(this['style']['splitNum'],0x64);let _0x9b57c7=Math['max'](this[_0x252242(_0x16269b._0xecd645)]['height'],this['_rectangle'][_0x252242(_0x16269b._0x9b2cad)]);this['style'][_0x252242(0x170)]=_0x9b57c7/=_0x578f17;const _0x153c1a=new Cesium[(_0x252242(0x15f))]({'fabric':{'uniforms':{'image':_0x540a00,'repeat':new Cesium[(_0x252242(0x17d))](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x12d728=this[_0x252242(0x1b6)][_0x252242(0x18e)]||0x1;this['_graphic']=new mars3d__namespace[(_0x252242(_0x16269b._0x535fcb))]['RectanglePrimitive']({...this[_0x252242(_0x16269b._0x468c59)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0xdf899d,'material':_0x153c1a,'vertexShaderSource':getVertexShaderSource(_0xc1e473*_0x12d728)})}),this['_layer'][_0x252242(0x1a4)](this[_0x252242(0x165)]),this['style']['arcDirection']===0x0&&(this[_0x252242(_0x16269b._0x9f0c21)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x252242(_0x16269b._0x5707f2))]({'flat':!![],'aboveGround':!![],'renderState':_0xdf899d,'material':_0x153c1a,'vertexShaderSource':getVertexShaderSource(-_0xc1e473)})}),this['_layer']['addGraphic'](this[_0x252242(_0x16269b._0x576eff)]));}['getRectangle'](_0x44082e){const _0x5c866d=_0x8d4470;return _0x44082e!==null&&_0x44082e!==void 0x0&&_0x44082e[_0x5c866d(0x1aa)]&&this['_rectangle']?mars3d__namespace['PolyUtil']['formatRectangle'](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x1d5479={_0x4abf36:0x1b0,_0x3dabea:0x1b0,_0x1911cf:0x167,_0x41f018:0x1a0,_0x432807:0x16c,_0x54d2f1:0x16d},_0x110e7f={_0x38ee5c:0x1a3,_0x4120aa:0x18b,_0x3bd514:0x169,_0x14f974:0x196},_0x1a5a3e={_0x3df692:0x191,_0x3fb612:0x1b5,_0x39536f:0x17a,_0x2d6b2f:0x1a3},_0x45e5ea=_0x8d4470,_0x352d25=this['_positions'],_0x3be143=[];let _0x5ac15f,_0x447478,_0x28c1a6,_0x408d27;_0x352d25[_0x45e5ea(0x1ac)](_0x3c40ea=>{const _0xb60f2a=_0x45e5ea,_0x130283=mars3d__namespace['LngLatPoint']['parse'](_0x3c40ea);if(!_0x130283)return;_0x130283['value']=_0x3c40ea['value']||0x1,!this[_0xb60f2a(0x1b0)][_0xb60f2a(_0x1a5a3e._0x3df692)]&&(_0x5ac15f===undefined?(_0x5ac15f=_0x130283[_0xb60f2a(_0x1a5a3e._0x3fb612)],_0x447478=_0x130283['lng'],_0x28c1a6=_0x130283['lat'],_0x408d27=_0x130283['lat']):(_0x5ac15f=Math[_0xb60f2a(0x17a)](_0x5ac15f,_0x130283['lng']),_0x447478=Math['max'](_0x447478,_0x130283['lng']),_0x28c1a6=Math[_0xb60f2a(_0x1a5a3e._0x39536f)](_0x28c1a6,_0x130283[_0xb60f2a(_0x1a5a3e._0x2d6b2f)]),_0x408d27=Math['max'](_0x408d27,_0x130283['lat']))),_0x3be143['push'](_0x130283);});_0x5ac15f===_0x447478&&(_0x5ac15f-=0.000001,_0x447478+=0.000001);_0x28c1a6===_0x408d27&&(_0x28c1a6-=0.000001,_0x408d27+=0.000001);let _0x247a13=this[_0x45e5ea(0x1b0)]['rectangle']||{'xmin':_0x5ac15f,'xmax':_0x447478,'ymin':_0x28c1a6,'ymax':_0x408d27};const _0x2e3a18=getMercatorBounds(_0x247a13),_0x4481f6=Math['abs'](_0x2e3a18['xmax']-_0x2e3a18['xmin']),_0x2e02b3=Math[_0x45e5ea(0x1b3)](_0x2e3a18['ymax']-_0x2e3a18['ymin']),_0x162a65=Math['max'](_0x4481f6,_0x2e02b3),_0x4695ba=Math['min'](_0x4481f6,_0x2e02b3);this['_mBoundsMax']=_0x162a65;let _0x31f2ce=0x1;if(_0x162a65>this[_0x45e5ea(0x1b0)]['maxCanvasSize'])_0x31f2ce=_0x162a65/this['options']['maxCanvasSize'],_0x4695ba/_0x31f2ce<this[_0x45e5ea(_0x1d5479._0x4abf36)][_0x45e5ea(0x18c)]&&(_0x31f2ce=_0x4695ba/this[_0x45e5ea(_0x1d5479._0x3dabea)][_0x45e5ea(0x18c)]);else _0x4695ba<this['options']['minCanvasSize']&&(_0x31f2ce=_0x4695ba/this['options']['minCanvasSize'],_0x162a65/_0x31f2ce>this['options']['maxCanvasSize']&&(_0x31f2ce=_0x162a65/this['options'][_0x45e5ea(0x192)]));const _0x377548=this['heatStyle']['radius']*1.5,_0x2dd30e=_0x4481f6/_0x31f2ce+_0x377548*0x2,_0x5a7048=_0x2e02b3/_0x31f2ce+_0x377548*0x2,_0x12a774=_0x377548*_0x31f2ce;_0x2e3a18['xmin']-=_0x12a774,_0x2e3a18['ymin']-=_0x12a774,_0x2e3a18[_0x45e5ea(0x16c)]+=_0x12a774,_0x2e3a18[_0x45e5ea(0x196)]+=_0x12a774,this['_scale']=_0x31f2ce,_0x247a13=geLatLngBounds(_0x2e3a18),this['_rectangle']=Cesium['Rectangle']['fromDegrees'](_0x247a13['xmin'],_0x247a13['ymin'],_0x247a13['xmax'],_0x247a13['ymax']);let _0x151d0f=_0x3be143[0x0]['value']??0x1,_0x3beece=_0x3be143[0x0][_0x45e5ea(0x18b)]??0x0;const _0x4c480d=[];_0x3be143['forEach'](_0x409979=>{const _0x303fdd=_0x45e5ea,_0x4b124d=mars3d__namespace[_0x303fdd(0x160)][_0x303fdd(0x164)]([_0x409979['lng'],_0x409979[_0x303fdd(_0x110e7f._0x38ee5c)]]),_0x4c964d=_0x409979[_0x303fdd(_0x110e7f._0x4120aa)]||0x1,_0x5446b6=Math['round']((_0x4b124d[0x0]-_0x2e3a18['xmin'])/_0x31f2ce),_0xa01f2e=Math[_0x303fdd(_0x110e7f._0x3bd514)]((_0x2e3a18[_0x303fdd(_0x110e7f._0x14f974)]-_0x4b124d[0x1])/_0x31f2ce);_0x151d0f=Math['max'](_0x151d0f,_0x4c964d),_0x3beece=Math[_0x303fdd(0x17a)](_0x3beece,_0x4c964d),_0x4c480d['push']({'x':_0x5446b6,'y':_0xa01f2e,'value':_0x4c964d});});const _0x5bb707={'min':this['options']['min']??_0x3beece,'max':this['options']['max']??_0x151d0f,'data':_0x4c480d};this['_last_heatData']=_0x5bb707;if(!this[_0x45e5ea(_0x1d5479._0x1911cf)]||_0x2e3a18[_0x45e5ea(_0x1d5479._0x41f018)]!==this['_last_mBounds']['xmin']||_0x2e3a18[_0x45e5ea(0x171)]!==this['_last_mBounds']['ymin']||_0x2e3a18[_0x45e5ea(0x16c)]!==this['_last_mBounds'][_0x45e5ea(_0x1d5479._0x432807)]||_0x2e3a18[_0x45e5ea(0x196)]!==this['_last_mBounds']['ymax']){this['_last_mBounds']=_0x2e3a18,this[_0x45e5ea(0x168)]['style']['cssText']='width:'+_0x2dd30e+'px;height:'+_0x5a7048+'px;';const _0x186eec={...this['heatStyle'],'container':this['_container']};!this['_heat']?this['_heat']=h337__namespace[_0x45e5ea(_0x1d5479._0x54d2f1)](_0x186eec):this['_heat']['configure'](_0x186eec);}this[_0x45e5ea(0x1b2)]['setData'](_0x5bb707);const _0xa2978=mars3d__namespace['DomUtil'][_0x45e5ea(0x173)](this[_0x45e5ea(0x1b2)]['_renderer']['canvas']);return _0xa2978;}[_0x8d4470(0x1b1)](){const _0x5edac6={_0x8b4a2a:0x1b6,_0x5baa76:0x193,_0x1f035e:0x1b2},_0x1d443a=_0x8d4470;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this[_0x1d443a(_0x5edac6._0x8b4a2a)]['arcRadiusScale'],'blur':this['heatStyle']['blur']*this['style']['arcBlurScale'],'gradient':this['heatStyle']['gradientArc']||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:'rgb(216,216,216)',0x1:_0x1d443a(_0x5edac6._0x5baa76)}});const _0x437630=mars3d__namespace['DomUtil']['copyCanvas'](this[_0x1d443a(_0x5edac6._0x1f035e)]['_renderer']['canvas']);return this['_heat']['configure'](this['options']['heatStyle']),_0x437630;}['getPointData'](_0x21823a){const _0x3617fc={_0x1ea22e:0x16f,_0x390e05:0x169,_0x31143c:0x196,_0x35fe97:0x18d},_0x5b3bd4=_0x8d4470,_0x3f1c1e=mars3d__namespace['LngLatPoint']['parse'](_0x21823a);if(!_0x3f1c1e)return{};const _0x51bef3=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x3f1c1e['lng'],_0x3f1c1e['lat']]),_0x5a3a9c=this['_last_mBounds'],_0xbc2f37=Math['round']((_0x51bef3[0x0]-_0x5a3a9c[_0x5b3bd4(0x1a0)])/this[_0x5b3bd4(_0x3617fc._0x1ea22e)]),_0x3a9f2c=Math[_0x5b3bd4(_0x3617fc._0x390e05)]((_0x5a3a9c[_0x5b3bd4(_0x3617fc._0x31143c)]-_0x51bef3[0x1])/this['_scale']),_0x53ed55=this['_heat'][_0x5b3bd4(_0x3617fc._0x35fe97)]({'x':_0xbc2f37,'y':_0x3a9f2c}),_0x326c17=this['_heat']['_renderer']['ctx']['getImageData'](_0xbc2f37-0x1,_0x3a9f2c-0x1,0x1,0x1)['data'];return{'x':_0xbc2f37,'y':_0x3a9f2c,'value':_0x53ed55,'color':'rgba('+_0x326c17[0x0]+','+_0x326c17[0x1]+','+_0x326c17[0x2]+','+_0x326c17[0x3]+')'};}}mars3d__namespace[_0x8d4470(0x177)]['register'](_0x8d4470(0x17f),HeatLayer),mars3d__namespace['layer']['HeatLayer']=HeatLayer,mars3d__namespace[_0x8d4470(0x19e)]=h337__namespace;function getMercatorBounds(_0x18e55a){const _0x53930f=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x18e55a['xmin'],_0x18e55a['ymin']]),_0x168724=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x18e55a['xmax'],_0x18e55a['ymax']]);return{'xmin':_0x53930f[0x0],'ymin':_0x53930f[0x1],'xmax':_0x168724[0x0],'ymax':_0x168724[0x1]};}function geLatLngBounds(_0x52ae0e){const _0x1239f2={_0x138d85:0x16c},_0x1927b6=_0x8d4470,_0x532d99=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x52ae0e['xmin'],_0x52ae0e['ymin']]),_0x10065c=mars3d__namespace['PointTrans'][_0x1927b6(0x17b)]([_0x52ae0e[_0x1927b6(_0x1239f2._0x138d85)],_0x52ae0e['ymax']]);return{'xmin':_0x532d99[0x0],'ymin':_0x532d99[0x1],'xmax':_0x10065c[0x0],'ymax':_0x10065c[0x1]};}function getVertexShaderSource(_0x355fa4){return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x355fa4+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object[_0x8d4470(0x19f)](exports,'__esModule',{'value':!![]});
}));
