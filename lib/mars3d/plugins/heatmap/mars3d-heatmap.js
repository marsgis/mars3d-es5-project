/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.5
 * 编译日期：2023-09-08 17:15:56
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x2f84fa=_0x1547;(function(_0x193067,_0x193498){const _0x1f0564={_0x4fc18e:0x1d2,_0x1864e7:0x1c5,_0x5463e0:0x205,_0x16b49b:0x1df,_0x3ac5aa:0x1d9,_0x194a91:0x1e8,_0x5c9691:0x1cb},_0x5588ee=_0x1547,_0x34f244=_0x193067();while(!![]){try{const _0x3e6c7a=parseInt(_0x5588ee(_0x1f0564._0x4fc18e))/0x1+parseInt(_0x5588ee(0x1bf))/0x2+-parseInt(_0x5588ee(0x1fe))/0x3*(parseInt(_0x5588ee(_0x1f0564._0x1864e7))/0x4)+-parseInt(_0x5588ee(0x1b5))/0x5+-parseInt(_0x5588ee(_0x1f0564._0x5463e0))/0x6*(-parseInt(_0x5588ee(_0x1f0564._0x16b49b))/0x7)+-parseInt(_0x5588ee(_0x1f0564._0x3ac5aa))/0x8*(-parseInt(_0x5588ee(0x1ed))/0x9)+parseInt(_0x5588ee(_0x1f0564._0x194a91))/0xa*(parseInt(_0x5588ee(_0x1f0564._0x5c9691))/0xb);if(_0x3e6c7a===_0x193498)break;else _0x34f244['push'](_0x34f244['shift']());}catch(_0x1fcd86){_0x34f244['push'](_0x34f244['shift']());}}}(_0x47ee,0x25070));function _interopNamespace(_0x2907bf){const _0x5ada12={_0xbaff63:0x1d0,_0x3396bd:0x1e9,_0x31ef8f:0x1b8},_0x36f7f0=_0x1547;if(_0x2907bf&&_0x2907bf['__esModule'])return _0x2907bf;var _0x3441b5=Object['create'](null);return _0x2907bf&&Object['keys'](_0x2907bf)['forEach'](function(_0x3cea78){const _0x6f4a09=_0x1547;if(_0x3cea78!=='default'){var _0x5a5280=Object[_0x6f4a09(_0x5ada12._0xbaff63)](_0x2907bf,_0x3cea78);Object[_0x6f4a09(_0x5ada12._0x3396bd)](_0x3441b5,_0x3cea78,_0x5a5280[_0x6f4a09(_0x5ada12._0x31ef8f)]?_0x5a5280:{'enumerable':!![],'get':function(){return _0x2907bf[_0x3cea78];}});}}),_0x3441b5[_0x36f7f0(0x1ef)]=_0x2907bf,_0x3441b5;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial=_0x2f84fa(0x1ba);if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');function _0x1547(_0x5e931b,_0x3db162){const _0x47ee49=_0x47ee();return _0x1547=function(_0x1547ff,_0x371ad3){_0x1547ff=_0x1547ff-0x1b2;let _0xa105a=_0x47ee49[_0x1547ff];return _0xa105a;},_0x1547(_0x5e931b,_0x3db162);}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0x2f84fa(0x20e)],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:'blue',0.6:'green',0.8:'yellow',0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance']['VERTEX_FORMAT']};class HeatLayer extends BaseLayer{constructor(_0x569b8a={}){const _0x39d576={_0x2c628d:0x212,_0xc8af3e:0x1de,_0x1b0310:0x1fb,_0x4f9d65:0x1f7,_0x2a1500:0x1bb,_0x5dd0bf:0x1fb,_0x1db684:0x1d8},_0x5dc48e=_0x2f84fa;super(_0x569b8a),this['options']['maxCanvasSize']=this['options']['maxCanvasSize']??document[_0x5dc48e(_0x39d576._0x2c628d)]['clientWidth'],this['options']['maxCanvasSize']=Math['min'](this[_0x5dc48e(0x1fb)][_0x5dc48e(_0x39d576._0xc8af3e)],0x1388),this['options']['minCanvasSize']=this[_0x5dc48e(_0x39d576._0x1b0310)]['minCanvasSize']??document['body'][_0x5dc48e(_0x39d576._0x4f9d65)],this['options'][_0x5dc48e(_0x39d576._0x2a1500)]=Math['max'](this['options']['minCanvasSize'],0x2bc),this[_0x5dc48e(_0x39d576._0x5dd0bf)]['heatStyle']={...DEF_HEATSTYLE,...this[_0x5dc48e(_0x39d576._0x5dd0bf)][_0x5dc48e(_0x39d576._0x1db684)]},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){const _0x1b6b9f={_0x4fdef0:0x1d8},_0x230e37=_0x2f84fa;return this['options'][_0x230e37(_0x1b6b9f._0x4fdef0)];}set[_0x2f84fa(0x1d8)](_0x3f7eb3){const _0x596a49={_0x32a004:0x1b6},_0x39553a=_0x2f84fa;this['options'][_0x39553a(0x1d8)]=mars3d__namespace[_0x39553a(_0x596a49._0x32a004)]['merge'](this['options']['heatStyle'],_0x3f7eb3),this[_0x39553a(0x202)]&&(this['_heat']['configure'](this['options']['heatStyle']),this['_updatePositionsHook'](!![]));}get[_0x2f84fa(0x20d)](){return this['options']['style'];}set['style'](_0x3e4119){const _0x3f977b={_0x55c07e:0x1fb},_0x48b409=_0x2f84fa;this[_0x48b409(_0x3f977b._0x55c07e)]['style']=mars3d__namespace['Util']['merge'](this['options']['style'],_0x3e4119);}get['positions'](){return this['_positions'];}set['positions'](_0x322bc5){const _0xed9c4d=_0x2f84fa;this[_0xed9c4d(0x1eb)](_0x322bc5);}get[_0x2f84fa(0x1ce)](){const _0x5db81b=[];return this['points']['forEach'](_0xe90b62=>{_0x5db81b['push'](_0xe90b62['toArray']());}),_0x5db81b;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x877f6a,_0x3706ae){const _0x36bd9e={_0x5ddead:0x1c2},_0x453428=_0x2f84fa;_0x877f6a['positions']&&(this['positions']=_0x877f6a[_0x453428(_0x36bd9e._0x5ddead)]);}[_0x2f84fa(0x1c6)](){const _0x2fd163={_0x5214a5:0x1e1,_0x400826:0x1d7},_0x58dc6b=_0x2f84fa;this['style']['type']===_0x58dc6b(_0x2fd163._0x5214a5)?this['_layer']=new mars3d__namespace['layer']['ImageLayer']({'crs':'EPSG:3857','private':!![]}):this[_0x58dc6b(0x1b7)]=new mars3d__namespace['layer'][(_0x58dc6b(_0x2fd163._0x400826))]({'private':!![]});}['_addedHook'](){const _0x1353aa={_0x2311f1:0x1e2},_0x5ecc06=_0x2f84fa;this['_map'][_0x5ecc06(0x211)](this['_layer']),this['_container']=mars3d__namespace[_0x5ecc06(_0x1353aa._0x2311f1)][_0x5ecc06(0x20b)]('div','mars3d-heatmap\x20mars3d-hideDiv',this['_map']['container']),this['options']['positions']&&(this['positions']=this['options']['positions']),this['options']['flyTo']&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x5b290a={_0x55bee6:0x1b7},_0x2858c4=_0x2f84fa;this['_container']&&(mars3d__namespace['DomUtil'][_0x2858c4(0x20a)](this['_container']),delete this[_0x2858c4(0x1ee)]),this['clear'](),this['_map']['removeLayer'](this[_0x2858c4(_0x5b290a._0x55bee6)]);}['addPosition'](_0x179560,_0x4e8646){const _0x1945c4={_0x144bb7:0x1f5},_0x213ab9=_0x2f84fa;this['_positions']=this[_0x213ab9(_0x1945c4._0x144bb7)]||[],this[_0x213ab9(0x1f5)]['push'](_0x179560),this['_updatePositionsHook'](_0x4e8646);}['setPositions'](_0x58976d,_0x577922){const _0x36eef2={_0x3da2ef:0x1db},_0x22d1e4=_0x2f84fa;this['_positions']=_0x58976d,this[_0x22d1e4(_0x36eef2._0x3da2ef)](_0x577922);}['clear'](){const _0x2fa1d6={_0x36b631:0x1d4,_0xc0168b:0x1fc},_0x1cc441=_0x2f84fa;this[_0x1cc441(0x1fc)]&&(this['_layer'][_0x1cc441(_0x2fa1d6._0x36b631)](this[_0x1cc441(_0x2fa1d6._0xc0168b)],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}['_updatePositionsHook'](_0x33b948){const _0x14f1e1={_0x3a9bae:0x1c2,_0xbe19a8:0x20d,_0x45fa94:0x1c8,_0x32a52e:0x1fa},_0x1c8894=_0x2f84fa;if(!this['show']||!this['_map']||!this[_0x1c8894(_0x14f1e1._0x3a9bae)]||this[_0x1c8894(0x1c2)][_0x1c8894(0x200)]===0x0)return this;const _0x28edc9=this['_getHeatCanvas']();if(this['style']['type']==='image')this['_layer']['setOptions']({'url':_0x28edc9['toDataURL'](_0x1c8894(0x1e7)),'rectangle':this['_rectangle'],'opacity':this[_0x1c8894(_0x14f1e1._0xbe19a8)][_0x1c8894(0x1cf)]});else this['style']['arc']?this['_graphic']&&_0x33b948?(this['_graphic'][_0x1c8894(_0x14f1e1._0x45fa94)]['image']=_0x28edc9,this['_graphic']['uniforms'][_0x1c8894(0x1fa)]=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x28edc9,this['_graphic2']['uniforms']['bumpMap']=this['_graphic']['uniforms'][_0x1c8894(_0x14f1e1._0x32a52e)])):this[_0x1c8894(0x1b9)](_0x28edc9):this['_graphic']&&_0x33b948?this['_graphic']['uniforms']['image']=_0x28edc9:this['_createGraphic'](_0x28edc9);return this;}[_0x2f84fa(0x1b3)](_0x401801){const _0x47fb90={_0x2da11c:0x1fb},_0x319078=_0x2f84fa;this['clear'](),this[_0x319078(0x1fc)]=new mars3d__namespace[(_0x319078(0x1f4))]['RectanglePrimitive']({...this[_0x319078(_0x47fb90._0x2da11c)],'rectangle':this[_0x319078(0x203)],'appearance':new Cesium[(_0x319078(0x1d3))]({'material':new Cesium[(_0x319078(0x1e3))]({'fabric':{'uniforms':{'image':_0x401801},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}[_0x2f84fa(0x1b9)](_0x2bb76b){const _0x2e9189={_0x4bc0df:0x1cc,_0x185374:0x1dc,_0x4077da:0x1c3,_0x4bf6ee:0x201,_0x1cb370:0x1f4,_0x55ddfa:0x203,_0x536e16:0x20d,_0x37679e:0x1d3},_0x330c1e=_0x2f84fa;this['clear']();const _0x375d61=Cesium[_0x330c1e(_0x2e9189._0x4bc0df)][_0x330c1e(0x204)]({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0x330c1e(0x1f1)]['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'backFunction':Cesium['StencilFunction']['ALWAYS'],'backOperation':{'fail':Cesium[_0x330c1e(0x1f1)][_0x330c1e(_0x2e9189._0x185374)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation'][_0x330c1e(_0x2e9189._0x4077da)]},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x409fd9=Math[_0x330c1e(0x1c9)](this['style']['diffHeight']??this['_mBoundsMax']*0.02)+0.1;this[_0x330c1e(0x20d)]['diffHeight']&&delete this[_0x330c1e(0x20d)]['diffHeight'];const _0x368cab=(this[_0x330c1e(0x20d)]['splitNum'],0x64);let _0x13a6df=Math['max'](this['_rectangle'][_0x330c1e(_0x2e9189._0x4bf6ee)],this['_rectangle']['width']);this['style']['granularity']=_0x13a6df/=_0x368cab;const _0x3890a1=new Cesium['Material']({'fabric':{'uniforms':{'image':_0x2bb76b,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium['Color'](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x1465ab=this['style']['arcDirection']||0x1;this['_graphic']=new mars3d__namespace[(_0x330c1e(_0x2e9189._0x1cb370))][(_0x330c1e(0x1d6))]({...this['options'],'rectangle':this[_0x330c1e(_0x2e9189._0x55ddfa)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x375d61,'material':_0x3890a1,'vertexShaderSource':getVertexShaderSource(_0x409fd9*_0x1465ab)})}),this['_layer']['addGraphic'](this['_graphic']),this[_0x330c1e(_0x2e9189._0x536e16)]['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic']['RectanglePrimitive']({...this[_0x330c1e(0x1fb)],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0x330c1e(_0x2e9189._0x37679e))]({'flat':!![],'aboveGround':!![],'renderState':_0x375d61,'material':_0x3890a1,'vertexShaderSource':getVertexShaderSource(-_0x409fd9)})}),this['_layer'][_0x330c1e(0x1c7)](this['_graphic2']));}[_0x2f84fa(0x1e5)](_0x34df98){const _0x483b07=_0x2f84fa;return _0x34df98!==null&&_0x34df98!==void 0x0&&_0x34df98['isFormat']&&this[_0x483b07(0x203)]?mars3d__namespace['PolyUtil']['formatRectangle'](this[_0x483b07(0x203)]):this['_rectangle'];}['_getHeatCanvas'](){const _0x5742ee={_0x6ff7d6:0x1ca,_0x1b550e:0x1f6,_0x596170:0x1fd,_0x365a81:0x1de,_0x3d167a:0x1fb,_0x332b6d:0x1d8,_0x509b80:0x1f0,_0x276595:0x1f3,_0x1af894:0x1c4,_0x5ed34b:0x1c1,_0x301a12:0x1da,_0x27cc91:0x208,_0x29a6e0:0x1c0,_0x53541d:0x1ff,_0x25483f:0x202},_0x532639={_0x556b11:0x1ea},_0x7d26cf={_0x326b4e:0x1c4,_0x387a16:0x1ec,_0x3bc41b:0x1bc},_0x48d920=_0x2f84fa,_0x1d7c7b=this['_positions'],_0x183b12=[];let _0x24d7c1,_0x320830,_0x4349d4,_0x2e75a1;_0x1d7c7b[_0x48d920(_0x5742ee._0x6ff7d6)](_0x18179d=>{const _0x865a3=_0x48d920,_0x5a3166=mars3d__namespace['LngLatPoint'][_0x865a3(0x207)](_0x18179d);if(!_0x5a3166)return;_0x5a3166[_0x865a3(_0x7d26cf._0x326b4e)]=_0x18179d['value']||0x1,!this['options'][_0x865a3(_0x7d26cf._0x387a16)]&&(_0x24d7c1===undefined?(_0x24d7c1=_0x5a3166['lng'],_0x320830=_0x5a3166['lng'],_0x4349d4=_0x5a3166['lat'],_0x2e75a1=_0x5a3166[_0x865a3(_0x7d26cf._0x3bc41b)]):(_0x24d7c1=Math['min'](_0x24d7c1,_0x5a3166['lng']),_0x320830=Math['max'](_0x320830,_0x5a3166[_0x865a3(0x1ea)]),_0x4349d4=Math['min'](_0x4349d4,_0x5a3166['lat']),_0x2e75a1=Math[_0x865a3(0x1c1)](_0x2e75a1,_0x5a3166['lat']))),_0x183b12['push'](_0x5a3166);});_0x24d7c1===_0x320830&&(_0x24d7c1-=0.000001,_0x320830+=0.000001);_0x4349d4===_0x2e75a1&&(_0x4349d4-=0.000001,_0x2e75a1+=0.000001);let _0x19f454=this['options']['rectangle']||{'xmin':_0x24d7c1,'xmax':_0x320830,'ymin':_0x4349d4,'ymax':_0x2e75a1};const _0x16423d=getMercatorBounds(_0x19f454),_0x55a274=Math[_0x48d920(_0x5742ee._0x1b550e)](_0x16423d['xmax']-_0x16423d[_0x48d920(0x1f8)]),_0x4960c6=Math['abs'](_0x16423d[_0x48d920(0x1da)]-_0x16423d['ymin']),_0x2504fc=Math['max'](_0x55a274,_0x4960c6),_0x3a8608=Math['min'](_0x55a274,_0x4960c6);this[_0x48d920(_0x5742ee._0x596170)]=_0x2504fc;let _0x116e66=0x1;if(_0x2504fc>this['options'][_0x48d920(_0x5742ee._0x365a81)])_0x116e66=_0x2504fc/this['options']['maxCanvasSize'],_0x3a8608/_0x116e66<this['options']['minCanvasSize']&&(_0x116e66=_0x3a8608/this['options']['minCanvasSize']);else _0x3a8608<this['options'][_0x48d920(0x1bb)]&&(_0x116e66=_0x3a8608/this['options']['minCanvasSize'],_0x2504fc/_0x116e66>this[_0x48d920(_0x5742ee._0x3d167a)]['maxCanvasSize']&&(_0x116e66=_0x2504fc/this['options']['maxCanvasSize']));const _0x1143d5=this[_0x48d920(_0x5742ee._0x332b6d)]['radius']*1.5,_0x33eebb=_0x55a274/_0x116e66+_0x1143d5*0x2,_0x296752=_0x4960c6/_0x116e66+_0x1143d5*0x2,_0xeb9608=_0x1143d5*_0x116e66;_0x16423d['xmin']-=_0xeb9608,_0x16423d['ymin']-=_0xeb9608,_0x16423d['xmax']+=_0xeb9608,_0x16423d['ymax']+=_0xeb9608,this[_0x48d920(_0x5742ee._0x509b80)]=_0x116e66,_0x19f454=geLatLngBounds(_0x16423d),this[_0x48d920(0x203)]=Cesium['Rectangle'][_0x48d920(_0x5742ee._0x276595)](_0x19f454[_0x48d920(0x1f8)],_0x19f454[_0x48d920(0x1f9)],_0x19f454['xmax'],_0x19f454['ymax']);let _0x244572=_0x183b12[0x0]['value']??0x1,_0xf1fc90=_0x183b12[0x0][_0x48d920(_0x5742ee._0x1af894)]??0x0;const _0xb1e0b5=[];_0x183b12['forEach'](_0x4b5cec=>{const _0x21449d=_0x48d920,_0x3263ae=mars3d__namespace[_0x21449d(0x1dd)]['lonlat2mercator']([_0x4b5cec[_0x21449d(_0x532639._0x556b11)],_0x4b5cec['lat']]),_0x2a9386=_0x4b5cec['value']||0x1,_0x5c83a0=Math['round']((_0x3263ae[0x0]-_0x16423d['xmin'])/_0x116e66),_0x4328a3=Math['round']((_0x16423d['ymax']-_0x3263ae[0x1])/_0x116e66);_0x244572=Math['max'](_0x244572,_0x2a9386),_0xf1fc90=Math[_0x21449d(0x1b2)](_0xf1fc90,_0x2a9386),_0xb1e0b5[_0x21449d(0x20f)]({'x':_0x5c83a0,'y':_0x4328a3,'value':_0x2a9386});});const _0x19b8aa={'min':this['options']['min']??_0xf1fc90,'max':this['options'][_0x48d920(_0x5742ee._0x5ed34b)]??_0x244572,'data':_0xb1e0b5};this[_0x48d920(0x1d5)]=_0x19b8aa;if(!this['_last_mBounds']||_0x16423d['xmin']!==this['_last_mBounds']['xmin']||_0x16423d['ymin']!==this['_last_mBounds']['ymin']||_0x16423d['xmax']!==this['_last_mBounds']['xmax']||_0x16423d[_0x48d920(_0x5742ee._0x301a12)]!==this['_last_mBounds']['ymax']){this[_0x48d920(_0x5742ee._0x27cc91)]=_0x16423d,this['_container']['style'][_0x48d920(_0x5742ee._0x29a6e0)]='width:'+_0x33eebb+_0x48d920(_0x5742ee._0x53541d)+_0x296752+'px;';const _0x250ab1={...this['heatStyle'],'container':this['_container']};!this[_0x48d920(0x202)]?this['_heat']=h337__namespace['create'](_0x250ab1):this['_heat'][_0x48d920(0x20c)](_0x250ab1);}this[_0x48d920(_0x5742ee._0x25483f)]['setData'](_0x19b8aa);const _0x2c8149=mars3d__namespace['DomUtil']['copyCanvas'](this['_heat']['_renderer']['canvas']);return _0x2c8149;}['_getArcHeatCanvas'](){const _0xa19361={_0x4155a1:0x1d8,_0x3838f8:0x213,_0x571331:0x1bd,_0x57af7b:0x1d1,_0x4083a8:0x1fb},_0x199986=_0x2f84fa;this['_heat']['configure']({'radius':this['heatStyle']['radius']*this['style']['arcRadiusScale'],'blur':this[_0x199986(_0xa19361._0x4155a1)]['blur']*this['style']['arcBlurScale'],'gradient':this[_0x199986(_0xa19361._0x4155a1)][_0x199986(_0xa19361._0x3838f8)]||{0.25:'rgb(0,0,0)',0.55:'rgb(140,140,140)',0.85:_0x199986(0x1e0),0x1:'rgb(255,255,255)'}});const _0x45e6f1=mars3d__namespace['DomUtil'][_0x199986(_0xa19361._0x571331)](this[_0x199986(0x202)][_0x199986(_0xa19361._0x57af7b)]['canvas']);return this['_heat']['configure'](this[_0x199986(_0xa19361._0x4083a8)]['heatStyle']),_0x45e6f1;}[_0x2f84fa(0x209)](_0x161a4e){const _0x83a944={_0x5f5144:0x1bc,_0x37a4d2:0x202},_0x286db7=_0x2f84fa,_0x1da47=mars3d__namespace[_0x286db7(0x1e6)]['parse'](_0x161a4e);if(!_0x1da47)return{};const _0x2f3a84=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x1da47['lng'],_0x1da47[_0x286db7(_0x83a944._0x5f5144)]]),_0x3726b3=this['_last_mBounds'],_0x1e1ec2=Math['round']((_0x2f3a84[0x0]-_0x3726b3['xmin'])/this['_scale']),_0xc34da1=Math['round']((_0x3726b3['ymax']-_0x2f3a84[0x1])/this['_scale']),_0x2e0746=this[_0x286db7(_0x83a944._0x37a4d2)]['getValueAt']({'x':_0x1e1ec2,'y':_0xc34da1}),_0x4793a6=this['_heat']['_renderer']['ctx']['getImageData'](_0x1e1ec2-0x1,_0xc34da1-0x1,0x1,0x1)['data'];return{'x':_0x1e1ec2,'y':_0xc34da1,'value':_0x2e0746,'color':_0x286db7(0x1e4)+_0x4793a6[0x0]+','+_0x4793a6[0x1]+','+_0x4793a6[0x2]+','+_0x4793a6[0x3]+')'};}}mars3d__namespace['LayerUtil']['register']('heat',HeatLayer),mars3d__namespace[_0x2f84fa(0x1cd)]['HeatLayer']=HeatLayer,mars3d__namespace[_0x2f84fa(0x1be)]=h337__namespace;function getMercatorBounds(_0x544b47){const _0x237c71={_0x2dfd85:0x1f2},_0x3dfda1=_0x2f84fa,_0x509399=mars3d__namespace['PointTrans']['lonlat2mercator']([_0x544b47['xmin'],_0x544b47['ymin']]),_0x481420=mars3d__namespace[_0x3dfda1(0x1dd)][_0x3dfda1(0x1b4)]([_0x544b47[_0x3dfda1(_0x237c71._0x2dfd85)],_0x544b47['ymax']]);return{'xmin':_0x509399[0x0],'ymin':_0x509399[0x1],'xmax':_0x481420[0x0],'ymax':_0x481420[0x1]};}function geLatLngBounds(_0x564e0c){const _0x2a35eb={_0xc3f063:0x1f8,_0x2f1ce3:0x1f2},_0x155737=_0x2f84fa,_0x5d6a74=mars3d__namespace['PointTrans'][_0x155737(0x206)]([_0x564e0c[_0x155737(_0x2a35eb._0xc3f063)],_0x564e0c['ymin']]),_0x41c3ae=mars3d__namespace[_0x155737(0x1dd)]['mercator2lonlat']([_0x564e0c[_0x155737(_0x2a35eb._0x2f1ce3)],_0x564e0c['ymax']]);return{'xmin':_0x5d6a74[0x0],'ymin':_0x5d6a74[0x1],'xmax':_0x41c3ae[0x0],'ymax':_0x41c3ae[0x1]};}function _0x47ee(){const _0x228b11=['px;height:','length','height','_heat','_rectangle','fromCache','18LTMBMW','mercator2lonlat','parse','_last_mBounds','getPointData','remove','create','configure','style','BaseLayer','push','in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20','addLayer','body','gradientArc','min','_createGraphic','lonlat2mercator','752880maXEEc','Util','_layer','get','_createArcGraphic','uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a','minCanvasSize','lat','copyCanvas','h337','80416LzvloA','cssText','max','positions','REPLACE','value','442372HlDDmQ','_mountedHook','addGraphic','uniforms','floor','forEach','326436OWhSAs','RenderState','layer','coordinates','opacity','getOwnPropertyDescriptor','_renderer','32317NwQTAX','EllipsoidSurfaceAppearance','removeGraphic','_last_heatData','RectanglePrimitive','GraphicLayer','heatStyle','595088iWthik','ymax','_updatePositionsHook','KEEP','PointTrans','maxCanvasSize','65618EWKaib','rgb(216,216,216)','image','DomUtil','Material','rgba(','getRectangle','LngLatPoint','image/png','30oGKLxl','defineProperty','lng','setPositions','rectangle','27szeYmN','_container','default','_scale','StencilOperation','xmax','fromDegrees','graphic','_positions','abs','clientHeight','xmin','ymin','bumpMap','options','_graphic','_mBoundsMax','3dSyRKI'];_0x47ee=function(){return _0x228b11;};return _0x47ee();}function getVertexShaderSource(_0x1a5875){const _0x3f8011=_0x2f84fa;return _0x3f8011(0x210)+_0x1a5875+';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a';}exports['HeatLayer']=HeatLayer,Object[_0x2f84fa(0x1e9)](exports,'__esModule',{'value':!![]});
}));
