/**
 * Mars3D平台插件,结合echarts可视化功能插件  mars3d-echarts
 *
 * 版本信息：v3.6.5
 * 编译日期：2023-09-08 17:10:07
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.echarts || require('echarts')), (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'echarts', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-echarts"] = {}, global.echarts, global.mars3d));
})(this, (function (exports, echarts, mars3d) { 
'use strict';const _0x4ddb5b=_0x54e0;function _0x54e0(_0x3f3569,_0x2925b3){const _0x97d253=_0x97d2();return _0x54e0=function(_0x54e005,_0x45b5cc){_0x54e005=_0x54e005-0x170;let _0x22cf6c=_0x97d253[_0x54e005];return _0x22cf6c;},_0x54e0(_0x3f3569,_0x2925b3);}(function(_0x10bbbf,_0x1ec4da){const _0x3afdb9={_0x389278:0x1a9,_0x437b14:0x18f,_0x56a961:0x17d,_0x2fcfb6:0x1ad,_0x20e841:0x1a2,_0x5dfd95:0x197,_0x34d8b0:0x186,_0x5cc53d:0x18a},_0x961107=_0x54e0,_0x1bfa5b=_0x10bbbf();while(!![]){try{const _0xb7ae72=-parseInt(_0x961107(_0x3afdb9._0x389278))/0x1+-parseInt(_0x961107(0x1a1))/0x2*(parseInt(_0x961107(_0x3afdb9._0x437b14))/0x3)+parseInt(_0x961107(0x171))/0x4*(parseInt(_0x961107(_0x3afdb9._0x56a961))/0x5)+parseInt(_0x961107(_0x3afdb9._0x2fcfb6))/0x6*(-parseInt(_0x961107(_0x3afdb9._0x20e841))/0x7)+parseInt(_0x961107(_0x3afdb9._0x5dfd95))/0x8+-parseInt(_0x961107(_0x3afdb9._0x34d8b0))/0x9+-parseInt(_0x961107(0x19a))/0xa*(-parseInt(_0x961107(_0x3afdb9._0x5cc53d))/0xb);if(_0xb7ae72===_0x1ec4da)break;else _0x1bfa5b['push'](_0x1bfa5b['shift']());}catch(_0x29a594){_0x1bfa5b['push'](_0x1bfa5b['shift']());}}}(_0x97d2,0x4b1ce));function _interopNamespace(_0x41b7d8){const _0x10014d={_0x1b3397:0x182,_0x408fca:0x19f,_0x4cdf02:0x17b},_0x522bbf={_0x5a6093:0x183},_0xd264f3=_0x54e0;if(_0x41b7d8&&_0x41b7d8[_0xd264f3(_0x10014d._0x1b3397)])return _0x41b7d8;var _0x533ded=Object['create'](null);return _0x41b7d8&&Object['keys'](_0x41b7d8)[_0xd264f3(_0x10014d._0x408fca)](function(_0x24a4ec){const _0x4ae046=_0xd264f3;if(_0x24a4ec!=='default'){var _0x30d6cf=Object[_0x4ae046(_0x522bbf._0x5a6093)](_0x41b7d8,_0x24a4ec);Object[_0x4ae046(0x175)](_0x533ded,_0x24a4ec,_0x30d6cf['get']?_0x30d6cf:{'enumerable':!![],'get':function(){return _0x41b7d8[_0x24a4ec];}});}}),_0x533ded[_0xd264f3(_0x10014d._0x4cdf02)]=_0x41b7d8,_0x533ded;}var echarts__namespace=_interopNamespace(echarts),mars3d__namespace=_interopNamespace(mars3d);const Cesium$1=mars3d__namespace[_0x4ddb5b(0x1a7)];class CompositeCoordinateSystem{constructor(_0x1e5d39,_0x71add2){const _0x19f409=_0x4ddb5b;this['_mars3d_scene']=_0x1e5d39,this['dimensions']=['lng','lat'],this[_0x19f409(0x1a8)]=[0x0,0x0],this['_api']=_0x71add2;}['setMapOffset'](_0x58c7dc){const _0x557a21={_0x5b9aff:0x1a8},_0x32c97c=_0x4ddb5b;this[_0x32c97c(_0x557a21._0x5b9aff)]=_0x58c7dc;}['getBMap'](){return this['_mars3d_scene'];}['dataToPoint'](_0x4bf9ee){const _0x3f860d={_0x50f1bd:0x18d,_0x7a0b26:0x180,_0x292043:0x187},_0x2a8451=_0x4ddb5b,_0x1e1583=this['_mars3d_scene'],_0x5da38e=[NaN,NaN];let _0x3620a0=_0x1e1583['echartsFixedHeight'];_0x1e1583['echartsAutoHeight']&&(_0x3620a0=_0x1e1583['globe'][_0x2a8451(0x17f)](Cesium$1['Cartographic'][_0x2a8451(0x199)](_0x4bf9ee[0x0],_0x4bf9ee[0x1])));const _0x7a70fb=Cesium$1[_0x2a8451(_0x3f860d._0x50f1bd)]['fromDegrees'](_0x4bf9ee[0x0],_0x4bf9ee[0x1],_0x3620a0);if(!_0x7a70fb)return _0x5da38e;const _0x8f37ea=Cesium$1['SceneTransforms']['wgs84ToWindowCoordinates'](_0x1e1583,_0x7a70fb);if(!_0x8f37ea)return _0x5da38e;if(_0x1e1583['echartsDepthTest']&&_0x1e1583['mode']===Cesium$1['SceneMode']['SCENE3D']){const _0xe9fd6c=new Cesium$1['EllipsoidalOccluder'](_0x1e1583[_0x2a8451(_0x3f860d._0x7a0b26)]['ellipsoid'],_0x1e1583[_0x2a8451(_0x3f860d._0x292043)]['positionWC']),_0x156f09=_0xe9fd6c['isPointVisible'](_0x7a70fb);if(!_0x156f09)return _0x5da38e;}return[_0x8f37ea['x']-this['_mapOffset'][0x0],_0x8f37ea['y']-this['_mapOffset'][0x1]];}['getViewRect'](){const _0x28378b={_0x452bff:0x190,_0x534050:0x17e,_0x5a0d77:0x1a3},_0x5e2862=_0x4ddb5b,_0x2e4e6f=this['_api'];return new echarts__namespace[(_0x5e2862(_0x28378b._0x452bff))][(_0x5e2862(_0x28378b._0x534050))](0x0,0x0,_0x2e4e6f[_0x5e2862(_0x28378b._0x5a0d77)](),_0x2e4e6f['getHeight']());}['getRoamTransform'](){return echarts__namespace['matrix']['create']();}}CompositeCoordinateSystem['dimensions']=['lng','lat'],CompositeCoordinateSystem['create']=function(_0x11bc29,_0x197b7e){const _0x19b39c=_0x4ddb5b;let _0x1e14b9;const _0x566171=_0x11bc29[_0x19b39c(0x17c)]['ecInstance'][_0x19b39c(0x173)];_0x11bc29['eachComponent']('mars3dMap',function(_0x3275ca){const _0x315092=_0x197b7e['getZr']()['painter'];if(!_0x315092)return;!_0x1e14b9&&(_0x1e14b9=new CompositeCoordinateSystem(_0x566171,_0x197b7e)),_0x3275ca['coordinateSystem']=_0x1e14b9,_0x1e14b9['setMapOffset'](_0x3275ca['__mapOffset']||[0x0,0x0]);}),_0x11bc29['eachSeries'](function(_0x1f1655){const _0x1cb88c=_0x19b39c;_0x1f1655[_0x1cb88c(0x177)]('coordinateSystem')===_0x1cb88c(0x198)&&(!_0x1e14b9&&(_0x1e14b9=new CompositeCoordinateSystem(_0x566171,_0x197b7e)),_0x1f1655['coordinateSystem']=_0x1e14b9);});};if(echarts__namespace!==null&&echarts__namespace!==void 0x0&&echarts__namespace[_0x4ddb5b(0x189)])echarts__namespace['registerCoordinateSystem']('mars3dMap',CompositeCoordinateSystem),echarts__namespace['registerAction']({'type':'mars3dMapRoam','event':'mars3dMapRoam','update':_0x4ddb5b(0x172)},function(_0x480031,_0x59f92f){}),echarts__namespace['extendComponentModel']({'type':'mars3dMap','getBMap':function(){return this['_mars3d_scene'];},'defaultOption':{'roam':![]}}),echarts__namespace[_0x4ddb5b(0x1a4)]({'type':'mars3dMap','init':function(_0x1b866e,_0x342efc){const _0x24f175={_0x2b97f5:0x188},_0x234df6=_0x4ddb5b;this[_0x234df6(_0x24f175._0x2b97f5)]=_0x342efc,this['scene']=_0x1b866e[_0x234df6(0x17c)][_0x234df6(0x18e)]['_mars3d_scene'],this['scene']['postRender'][_0x234df6(0x19e)](this['moveHandler'],this);},'moveHandler':function(_0x4e1f63,_0x1ef31b){const _0x4b8bd7={_0x510c29:0x1a5},_0x1b76f7=_0x4ddb5b;this['api']['dispatchAction']({'type':_0x1b76f7(_0x4b8bd7._0x510c29)});},'render':function(_0x5f30df,_0x5b0a68,_0x582878){},'dispose':function(_0x22af54){const _0x5bbc57={_0x5c213e:0x17a},_0x18c1f3=_0x4ddb5b;this[_0x18c1f3(0x191)][_0x18c1f3(_0x5bbc57._0x5c213e)][_0x18c1f3(0x196)](this['moveHandler'],this);}});else throw new Error('请引入\x20echarts\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'];class EchartsLayer extends BaseLayer{constructor(_0x5dfb5e={}){const _0x44fbfa={_0x23c32b:0x1a0},_0x5f02fb=_0x4ddb5b;super(_0x5dfb5e),this[_0x5f02fb(_0x44fbfa._0x23c32b)]=this['options']['pointerEvents'];}get[_0x4ddb5b(0x1ac)](){const _0x4bc27c={_0x4778aa:0x184},_0x5ce75d=_0x4ddb5b;return this[_0x5ce75d(_0x4bc27c._0x4778aa)];}get['pointerEvents'](){return this['_pointerEvents'];}set[_0x4ddb5b(0x185)](_0x4d178b){const _0x5d3256={_0x4301fc:0x1a0,_0x3d04f5:0x19d,_0x51c767:0x185},_0xead9d5=_0x4ddb5b;this[_0xead9d5(_0x5d3256._0x4301fc)]=_0x4d178b,this[_0xead9d5(_0x5d3256._0x3d04f5)]&&(_0x4d178b?this['_echartsContainer'][_0xead9d5(0x195)][_0xead9d5(0x185)]='all':this['_echartsContainer']['style'][_0xead9d5(_0x5d3256._0x51c767)]='none');}['_setOptionsHook'](_0x501655,_0x536387){this['setEchartsOption'](_0x501655);}['_showHook'](_0xad1287){const _0x14e9e0={_0x486d15:0x19d},_0x52060c=_0x4ddb5b;_0xad1287?this[_0x52060c(_0x14e9e0._0x486d15)]['style']['visibility']='visible':this[_0x52060c(_0x14e9e0._0x486d15)]['style']['visibility']='hidden';}['_mountedHook'](){const _0x562674={_0x45c2b0:0x18b,_0x2e3056:0x170},_0x33dc25=_0x4ddb5b;this['_map'][_0x33dc25(0x191)]['echartsDepthTest']=this[_0x33dc25(0x18b)]['depthTest']??!![],this['_map']['scene']['echartsAutoHeight']=this[_0x33dc25(_0x562674._0x45c2b0)]['clampToGround']??![],this['_map']['scene']['echartsFixedHeight']=this['options'][_0x33dc25(_0x562674._0x2e3056)]??0x0;}['_addedHook'](){const _0x524523={_0x1ba02b:0x184},_0x5c3209=_0x4ddb5b;this['_echartsContainer']=this['_createChartOverlay'](),this[_0x5c3209(_0x524523._0x1ba02b)]=echarts__namespace['init'](this['_echartsContainer']),this['_echartsInstance']['_mars3d_scene']=this['_map']['scene'],this['setEchartsOption'](this['options']);}[_0x4ddb5b(0x1ab)](){const _0x500b02={_0x4627f2:0x179},_0x12761b=_0x4ddb5b;this['_echartsInstance']&&(this['_echartsInstance']['clear'](),this[_0x12761b(0x184)]['dispose'](),delete this['_echartsInstance']),this['_echartsContainer']&&(this['_map']['container'][_0x12761b(_0x500b02._0x4627f2)](this[_0x12761b(0x19d)]),delete this['_echartsContainer']);}[_0x4ddb5b(0x181)](){const _0x5d8a85={_0x1d2c92:0x195,_0x441ca4:0x195,_0x70d935:0x18c,_0x1d5530:0x19b,_0x57cefe:0x18b},_0x13f8d8=_0x4ddb5b,_0x2c63ec=mars3d__namespace[_0x13f8d8(0x194)]['create']('div','mars3d-echarts',this['_map']['container']);return _0x2c63ec['id']=this['id'],_0x2c63ec['style']['position']='absolute',_0x2c63ec[_0x13f8d8(_0x5d8a85._0x1d2c92)][_0x13f8d8(0x193)]='0px',_0x2c63ec['style']['left']='0px',_0x2c63ec[_0x13f8d8(_0x5d8a85._0x441ca4)]['width']=this['_map']['scene'][_0x13f8d8(_0x5d8a85._0x70d935)]['clientWidth']+'px',_0x2c63ec['style']['height']=this[_0x13f8d8(0x19c)]['scene']['canvas'][_0x13f8d8(0x1ae)]+'px',_0x2c63ec['style']['pointerEvents']=this['_pointerEvents']?_0x13f8d8(_0x5d8a85._0x1d5530):'none',_0x2c63ec['style'][_0x13f8d8(0x176)]=this[_0x13f8d8(_0x5d8a85._0x57cefe)]['zIndex']??0x9,_0x2c63ec;}['resize'](){const _0xf17ca9={_0x29d4ba:0x195,_0xe5dd62:0x19d,_0x45aac3:0x19c,_0x3b89ba:0x192},_0x25cf55=_0x4ddb5b;if(!this['_echartsInstance'])return;this['_echartsContainer'][_0x25cf55(_0xf17ca9._0x29d4ba)]['width']=this['_map'][_0x25cf55(0x191)]['canvas']['clientWidth']+'px',this[_0x25cf55(_0xf17ca9._0xe5dd62)]['style'][_0x25cf55(0x178)]=this[_0x25cf55(_0xf17ca9._0x45aac3)]['scene']['canvas']['clientHeight']+'px',this['_echartsInstance'][_0x25cf55(_0xf17ca9._0x3b89ba)]();}[_0x4ddb5b(0x1aa)](_0x1ce75c,_0x194e23,_0x62e7c6){const _0x20c94f={_0x23c1f0:0x184},_0x52d1cd=_0x4ddb5b;this[_0x52d1cd(0x184)]&&(_0x1ce75c['mars3dMap']=_0x1ce75c['mars3dMap']||{},this[_0x52d1cd(_0x20c94f._0x23c1f0)]['setOption'](_0x1ce75c,_0x194e23,_0x62e7c6));}['getRectangle'](_0x49335c){const _0x40f0c9={_0x4bb521:0x19f},_0x221762={_0x40bc64:0x1af,_0x278708:0x19f},_0x29630f={_0x16235b:0x1a6};let _0x5d2c5f,_0x5b66f9,_0x2f1619,_0x574a60;function _0x32fca8(_0x2259db){const _0x3ea238=_0x54e0;if(!Array['isArray'](_0x2259db))return;const _0x319eea=_0x2259db[0x0]||0x0,_0x13eff3=_0x2259db[0x1]||0x0;_0x319eea!==0x0&&_0x13eff3!==0x0&&(_0x5d2c5f===undefined?(_0x5d2c5f=_0x319eea,_0x5b66f9=_0x319eea,_0x2f1619=_0x13eff3,_0x574a60=_0x13eff3):(_0x5d2c5f=Math[_0x3ea238(_0x29630f._0x16235b)](_0x5d2c5f,_0x319eea),_0x5b66f9=Math['max'](_0x5b66f9,_0x319eea),_0x2f1619=Math['min'](_0x2f1619,_0x13eff3),_0x574a60=Math['max'](_0x574a60,_0x13eff3)));}const _0x35d1ea=this['options']['series'];_0x35d1ea&&_0x35d1ea['forEach'](_0xf47c6e=>{const _0x4e55bc=_0x54e0;_0xf47c6e['data']&&_0xf47c6e['data'][_0x4e55bc(_0x40f0c9._0x4bb521)](_0x1ccd59=>{const _0x34535c=_0x4e55bc;if(_0x1ccd59[_0x34535c(_0x221762._0x40bc64)])_0x32fca8(_0x1ccd59['value']);else _0x1ccd59['coords']&&_0x1ccd59['coords'][_0x34535c(_0x221762._0x278708)](_0x2611df=>{_0x32fca8(_0x2611df);});});});if(_0x5d2c5f===0x0&&_0x2f1619===0x0&&_0x5b66f9===0x0&&_0x574a60===0x0)return null;return _0x49335c!==null&&_0x49335c!==void 0x0&&_0x49335c['isFormat']?{'xmin':_0x5d2c5f,'xmax':_0x5b66f9,'ymin':_0x2f1619,'ymax':_0x574a60}:Cesium['Rectangle']['fromDegrees'](_0x5d2c5f,_0x2f1619,_0x5b66f9,_0x574a60);}['on'](_0x2e2ff7,_0x20a5e7,_0x40c88b){return this['_echartsInstance']['on'](_0x2e2ff7,_0x20a5e7,_0x40c88b||this),this;}[_0x4ddb5b(0x174)](_0x1a17d9,_0x17d4f0,_0x4bc60d,_0x3be3f0){return this['_echartsInstance']['on'](_0x1a17d9,_0x17d4f0,_0x4bc60d,_0x3be3f0||this),this;}['off'](_0x5c0a39,_0x45abff,_0x26274f){const _0x3d263c=_0x4ddb5b;return this[_0x3d263c(0x184)]['off'](_0x5c0a39,_0x45abff,_0x26274f||this),this;}}function _0x97d2(){const _0x4edcf4=['_mapOffset','412138qZXIGb','setEchartsOption','_removedHook','layer','834726ByuJLT','clientHeight','value','fixedHeight','51784RycQLj','updateLayout','_mars3d_scene','onByQuery','defineProperty','zIndex','get','height','removeChild','postRender','default','scheduler','170mJRHjk','BoundingRect','getHeight','globe','_createChartOverlay','__esModule','getOwnPropertyDescriptor','_echartsInstance','pointerEvents','2823615NslrIx','camera','api','init','143lGrzcm','options','canvas','Cartesian3','ecInstance','680868iTfauZ','graphic','scene','resize','top','DomUtil','style','removeEventListener','4604776TYyduf','mars3dMap','fromDegrees','295270sCwfSV','all','_map','_echartsContainer','addEventListener','forEach','_pointerEvents','2bfnevP','7bRMnZZ','getWidth','extendComponentView','mars3dMapRoam','min','Cesium'];_0x97d2=function(){return _0x4edcf4;};return _0x97d2();}mars3d__namespace['LayerUtil']['register']('echarts',EchartsLayer),mars3d__namespace['layer']['EchartsLayer']=EchartsLayer,mars3d__namespace['echarts']=echarts__namespace,exports['EchartsLayer']=EchartsLayer,Object['keys'](echarts)['forEach'](function(_0x45c494){const _0x18d019={_0x117362:0x17b},_0x2f683a=_0x4ddb5b;if(_0x45c494!==_0x2f683a(_0x18d019._0x117362)&&!exports['hasOwnProperty'](_0x45c494))Object['defineProperty'](exports,_0x45c494,{'enumerable':!![],'get':function(){return echarts[_0x45c494];}});}),Object['defineProperty'](exports,_0x4ddb5b(0x182),{'value':!![]});
}));
