/**
 * Mars3D平台插件,结合echarts可视化功能插件  mars3d-echarts
 *
 * 版本信息：v3.5.14
 * 编译日期：2023-07-03 18:40:55
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.echarts || require('echarts')), (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'echarts', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-echarts"] = {}, global.echarts, global.mars3d));
})(this, (function (exports, echarts, mars3d) { 
'use strict';const _0x5b99ab=_0xd6a3;(function(_0x2b5c43,_0xdc6b57){const _0x58b1ea={_0x4476d2:0x132,_0x448e6e:0x11d,_0x26088d:0x12b,_0x17b8c4:0x122},_0xd89098=_0xd6a3,_0x5d811b=_0x2b5c43();while(!![]){try{const _0x1e425c=-parseInt(_0xd89098(_0x58b1ea._0x4476d2))/0x1*(parseInt(_0xd89098(0x10b))/0x2)+parseInt(_0xd89098(_0x58b1ea._0x448e6e))/0x3+-parseInt(_0xd89098(0x13b))/0x4+-parseInt(_0xd89098(0xff))/0x5*(-parseInt(_0xd89098(_0x58b1ea._0x26088d))/0x6)+-parseInt(_0xd89098(0x100))/0x7+-parseInt(_0xd89098(_0x58b1ea._0x17b8c4))/0x8+parseInt(_0xd89098(0x139))/0x9;if(_0x1e425c===_0xdc6b57)break;else _0x5d811b['push'](_0x5d811b['shift']());}catch(_0x113894){_0x5d811b['push'](_0x5d811b['shift']());}}}(_0x209b,0x2800d));function _interopNamespace(_0x318dab){const _0xd92e6b={_0x171f5c:0x10a},_0x4696bd=_0xd6a3;if(_0x318dab&&_0x318dab['__esModule'])return _0x318dab;var _0x18ef24=Object['create'](null);return _0x318dab&&Object[_0x4696bd(0x11a)](_0x318dab)['forEach'](function(_0x230d54){const _0x59fc56=_0x4696bd;if(_0x230d54!==_0x59fc56(0x117)){var _0x5c7ffb=Object[_0x59fc56(_0xd92e6b._0x171f5c)](_0x318dab,_0x230d54);Object[_0x59fc56(0x116)](_0x18ef24,_0x230d54,_0x5c7ffb['get']?_0x5c7ffb:{'enumerable':!![],'get':function(){return _0x318dab[_0x230d54];}});}}),_0x18ef24['default']=_0x318dab,_0x18ef24;}var echarts__namespace=_interopNamespace(echarts),mars3d__namespace=_interopNamespace(mars3d);const Cesium$1=mars3d__namespace['Cesium'];class CompositeCoordinateSystem{constructor(_0x208b31,_0x46be7e){const _0xcca552=_0xd6a3;this['_mars3d_scene']=_0x208b31,this['dimensions']=[_0xcca552(0x12d),'lat'],this['_mapOffset']=[0x0,0x0],this['_api']=_0x46be7e;}[_0x5b99ab(0x113)](_0x4628e2){const _0x6843d5={_0x3710a8:0x104},_0x33c7b5=_0x5b99ab;this[_0x33c7b5(_0x6843d5._0x3710a8)]=_0x4628e2;}[_0x5b99ab(0x102)](){return this['_mars3d_scene'];}['dataToPoint'](_0x2ac304){const _0x5b7250={_0xded9d1:0x110,_0x9a5623:0x130,_0x5e23ea:0x104},_0x40d919=_0x5b99ab,_0x5f3759=this['_mars3d_scene'],_0x3b823f=[NaN,NaN];let _0x4584fb=_0x5f3759['echartsFixedHeight'];_0x5f3759['echartsAutoHeight']&&(_0x4584fb=_0x5f3759['globe']['getHeight'](Cesium$1['Cartographic']['fromDegrees'](_0x2ac304[0x0],_0x2ac304[0x1])));const _0x4c4d22=Cesium$1['Cartesian3']['fromDegrees'](_0x2ac304[0x0],_0x2ac304[0x1],_0x4584fb);if(!_0x4c4d22)return _0x3b823f;const _0x3e3e6c=Cesium$1['SceneTransforms'][_0x40d919(0x118)](_0x5f3759,_0x4c4d22);if(!_0x3e3e6c)return _0x3b823f;if(_0x5f3759[_0x40d919(_0x5b7250._0xded9d1)]&&_0x5f3759['mode']===Cesium$1[_0x40d919(_0x5b7250._0x9a5623)]['SCENE3D']){const _0x18019b=new Cesium$1[(_0x40d919(0x133))](_0x5f3759['globe']['ellipsoid'],_0x5f3759['camera']['positionWC']),_0xafaba4=_0x18019b['isPointVisible'](_0x4c4d22);if(!_0xafaba4)return _0x3b823f;}return[_0x3e3e6c['x']-this['_mapOffset'][0x0],_0x3e3e6c['y']-this[_0x40d919(_0x5b7250._0x5e23ea)][0x1]];}['getViewRect'](){const _0x165657=this['_api'];return new echarts__namespace['graphic']['BoundingRect'](0x0,0x0,_0x165657['getWidth'](),_0x165657['getHeight']());}['getRoamTransform'](){return echarts__namespace['matrix']['create']();}}function _0xd6a3(_0x4b5755,_0x4ea6a3){const _0x209b8d=_0x209b();return _0xd6a3=function(_0xd6a36f,_0x116a8a){_0xd6a36f=_0xd6a36f-0xfe;let _0x52ebc3=_0x209b8d[_0xd6a36f];return _0x52ebc3;},_0xd6a3(_0x4b5755,_0x4ea6a3);}CompositeCoordinateSystem['dimensions']=[_0x5b99ab(0x12d),'lat'],CompositeCoordinateSystem['create']=function(_0x528d69,_0x5843d9){const _0x3f55f5={_0x2b4a83:0x138},_0x433eee=_0x5b99ab;let _0x20cdc9;const _0x16f755=_0x528d69[_0x433eee(0x136)]['ecInstance']['_mars3d_scene'];_0x528d69[_0x433eee(0x135)](_0x433eee(0x129),function(_0x43da22){const _0x2840ee=_0x433eee,_0x796830=_0x5843d9[_0x2840ee(_0x3f55f5._0x2b4a83)]()['painter'];if(!_0x796830)return;!_0x20cdc9&&(_0x20cdc9=new CompositeCoordinateSystem(_0x16f755,_0x5843d9)),_0x43da22['coordinateSystem']=_0x20cdc9,_0x20cdc9[_0x2840ee(0x113)](_0x43da22['__mapOffset']||[0x0,0x0]);}),_0x528d69['eachSeries'](function(_0x139712){_0x139712['get']('coordinateSystem')==='mars3dMap'&&(!_0x20cdc9&&(_0x20cdc9=new CompositeCoordinateSystem(_0x16f755,_0x5843d9)),_0x139712['coordinateSystem']=_0x20cdc9);});};if(echarts__namespace!==null&&echarts__namespace!==void 0x0&&echarts__namespace[_0x5b99ab(0x10c)])echarts__namespace['registerCoordinateSystem']('mars3dMap',CompositeCoordinateSystem),echarts__namespace['registerAction']({'type':'mars3dMapRoam','event':'mars3dMapRoam','update':'updateLayout'},function(_0x46932a,_0x57b9ae){}),echarts__namespace['extendComponentModel']({'type':'mars3dMap','getBMap':function(){return this['_mars3d_scene'];},'defaultOption':{'roam':![]}}),echarts__namespace['extendComponentView']({'type':'mars3dMap','init':function(_0x4deb97,_0x5e04e1){const _0x415750={_0x12ef6d:0x136,_0x193b5d:0x10e},_0x518912=_0x5b99ab;this[_0x518912(0x120)]=_0x5e04e1,this['scene']=_0x4deb97[_0x518912(_0x415750._0x12ef6d)][_0x518912(_0x415750._0x193b5d)]['_mars3d_scene'],this['scene']['postRender']['addEventListener'](this['moveHandler'],this);},'moveHandler':function(_0x44bac4,_0x445857){const _0x36b093=_0x5b99ab;this['api'][_0x36b093(0x12a)]({'type':'mars3dMapRoam'});},'render':function(_0x46969f,_0x57a8e3,_0x41bfea){},'dispose':function(_0x57bad5){const _0x5bcaf1={_0x623e6b:0x11e},_0x5f406d=_0x5b99ab;this['scene'][_0x5f406d(_0x5bcaf1._0x623e6b)]['removeEventListener'](this['moveHandler'],this);}});else throw new Error('请引入\x20echarts\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'];function _0x209b(){const _0x36a056=['scheduler','__esModule','getZr','5873913HhHfNK','clear','1006536dVUwAn','removeChild','absolute','EchartsLayer','scene','series','echarts','data','10VWSFRq','913752QbtaGF','visible','getBMap','clientWidth','_mapOffset','resize','value','_mountedHook','setOption','onByQuery','getOwnPropertyDescriptor','412iNixNB','init','options','ecInstance','_createChartOverlay','echartsDepthTest','_pointerEvents','min','setMapOffset','0px','style','defineProperty','default','wgs84ToWindowCoordinates','depthTest','keys','pointerEvents','forEach','317901KvGzFa','postRender','coords','api','canvas','1539720gOuYxk','height','getRectangle','position','echartsAutoHeight','clientHeight','zIndex','mars3dMap','dispatchAction','864738DqcXwy','_removedHook','lng','echartsFixedHeight','_echartsContainer','SceneMode','_map','1497FCoQCE','EllipsoidalOccluder','_echartsInstance','eachComponent'];_0x209b=function(){return _0x36a056;};return _0x209b();}class EchartsLayer extends BaseLayer{constructor(_0x3b71f1={}){const _0x4d22d4={_0x3d94e5:0x10d},_0x5f0c97=_0x5b99ab;super(_0x3b71f1),this['_pointerEvents']=this[_0x5f0c97(_0x4d22d4._0x3d94e5)]['pointerEvents'];}get['layer'](){return this['_echartsInstance'];}get[_0x5b99ab(0x11b)](){const _0xad6185=_0x5b99ab;return this[_0xad6185(0x111)];}set[_0x5b99ab(0x11b)](_0x5b3e64){const _0x42158a={_0x24981f:0x12f},_0x3db57f=_0x5b99ab;this['_pointerEvents']=_0x5b3e64,this[_0x3db57f(_0x42158a._0x24981f)]&&(_0x5b3e64?this['_echartsContainer']['style']['pointerEvents']='all':this['_echartsContainer'][_0x3db57f(0x115)]['pointerEvents']='none');}['_setOptionsHook'](_0x5ccb71,_0x7242d9){this['setEchartsOption'](_0x5ccb71);}['_showHook'](_0x4ba8ed){const _0x55aef5={_0x8ece20:0x12f,_0x3d57a9:0x101},_0x40a83d=_0x5b99ab;_0x4ba8ed?this[_0x40a83d(_0x55aef5._0x8ece20)]['style']['visibility']=_0x40a83d(_0x55aef5._0x3d57a9):this[_0x40a83d(_0x55aef5._0x8ece20)]['style']['visibility']='hidden';}[_0x5b99ab(0x107)](){const _0x497d8d={_0x2175f1:0x126,_0xe0877b:0x10d,_0x4b2bdb:0x10d},_0x19614f=_0x5b99ab;this['_map']['scene']['echartsDepthTest']=this['options'][_0x19614f(0x119)]??!![],this['_map']['scene'][_0x19614f(_0x497d8d._0x2175f1)]=this[_0x19614f(_0x497d8d._0xe0877b)]['clampToGround']??![],this['_map']['scene'][_0x19614f(0x12e)]=this[_0x19614f(_0x497d8d._0x4b2bdb)]['fixedHeight']??0x0;}['_addedHook'](){const _0xec3024={_0x521f9c:0x10f,_0x1ef095:0x12f,_0x39caa9:0x134},_0x431ad0=_0x5b99ab;this['_echartsContainer']=this[_0x431ad0(_0xec3024._0x521f9c)](),this['_echartsInstance']=echarts__namespace['init'](this[_0x431ad0(_0xec3024._0x1ef095)]),this[_0x431ad0(_0xec3024._0x39caa9)]['_mars3d_scene']=this['_map']['scene'],this['setEchartsOption'](this['options']);}[_0x5b99ab(0x12c)](){const _0x3fcd32={_0x5d3261:0x13a,_0x4112cd:0x12f},_0x5c7028=_0x5b99ab;this[_0x5c7028(0x134)]&&(this['_echartsInstance'][_0x5c7028(_0x3fcd32._0x5d3261)](),this[_0x5c7028(0x134)]['dispose'](),delete this[_0x5c7028(0x134)]),this[_0x5c7028(_0x3fcd32._0x4112cd)]&&(this['_map']['container'][_0x5c7028(0x13c)](this['_echartsContainer']),delete this['_echartsContainer']);}['_createChartOverlay'](){const _0x26f7ea={_0x2bafd7:0x125,_0x3b6ba1:0x114,_0xa4f482:0x115,_0x46de3d:0x121,_0xa72e37:0x103,_0x57ed34:0x115,_0x3a9c39:0x11b},_0x5b7f38=_0x5b99ab,_0xf8b7b8=mars3d__namespace['DomUtil']['create']('div','mars3d-echarts',this['_map']['container']);return _0xf8b7b8['id']=this['id'],_0xf8b7b8['style'][_0x5b7f38(_0x26f7ea._0x2bafd7)]=_0x5b7f38(0x13d),_0xf8b7b8['style']['top']=_0x5b7f38(_0x26f7ea._0x3b6ba1),_0xf8b7b8[_0x5b7f38(_0x26f7ea._0xa4f482)]['left']='0px',_0xf8b7b8['style']['width']=this[_0x5b7f38(0x131)]['scene'][_0x5b7f38(_0x26f7ea._0x46de3d)][_0x5b7f38(_0x26f7ea._0xa72e37)]+'px',_0xf8b7b8[_0x5b7f38(_0x26f7ea._0x57ed34)]['height']=this[_0x5b7f38(0x131)][_0x5b7f38(0x13f)]['canvas'][_0x5b7f38(0x127)]+'px',_0xf8b7b8['style'][_0x5b7f38(_0x26f7ea._0x3a9c39)]=this['_pointerEvents']?'all':'none',_0xf8b7b8['style']['zIndex']=this['options'][_0x5b7f38(0x128)]??0x9,_0xf8b7b8;}[_0x5b99ab(0x105)](){const _0x173983={_0x81b938:0x123,_0x2f7b7e:0x131,_0x4b55b8:0x105},_0x458480=_0x5b99ab;if(!this['_echartsInstance'])return;this['_echartsContainer']['style']['width']=this['_map']['scene']['canvas']['clientWidth']+'px',this['_echartsContainer'][_0x458480(0x115)][_0x458480(_0x173983._0x81b938)]=this[_0x458480(_0x173983._0x2f7b7e)]['scene']['canvas']['clientHeight']+'px',this['_echartsInstance'][_0x458480(_0x173983._0x4b55b8)]();}['setEchartsOption'](_0x598ecd,_0x31a346,_0xb0a4b7){const _0x4ffd22=_0x5b99ab;this['_echartsInstance']&&(_0x598ecd['mars3dMap']=_0x598ecd['mars3dMap']||{},this['_echartsInstance'][_0x4ffd22(0x108)](_0x598ecd,_0x31a346,_0xb0a4b7));}[_0x5b99ab(0x124)](_0x278e0b){const _0xaf532c=_0x5b99ab;let _0xbd5aef,_0x1c79e5,_0x3593c9,_0x190172;function _0x469976(_0x4f45de){const _0x3dc855=_0xd6a3;if(!Array['isArray'](_0x4f45de))return;const _0x1dc59d=_0x4f45de[0x0]||0x0,_0x23efee=_0x4f45de[0x1]||0x0;_0x1dc59d!==0x0&&_0x23efee!==0x0&&(_0xbd5aef===undefined?(_0xbd5aef=_0x1dc59d,_0x1c79e5=_0x1dc59d,_0x3593c9=_0x23efee,_0x190172=_0x23efee):(_0xbd5aef=Math[_0x3dc855(0x112)](_0xbd5aef,_0x1dc59d),_0x1c79e5=Math['max'](_0x1c79e5,_0x1dc59d),_0x3593c9=Math['min'](_0x3593c9,_0x23efee),_0x190172=Math['max'](_0x190172,_0x23efee)));}const _0x9b77ab=this['options'][_0xaf532c(0x140)];_0x9b77ab&&_0x9b77ab[_0xaf532c(0x11c)](_0x5f2ddd=>{const _0x258e71={_0x3b8860:0x106},_0x5727ee=_0xaf532c;_0x5f2ddd[_0x5727ee(0xfe)]&&_0x5f2ddd['data']['forEach'](_0x4b9143=>{const _0x52c985=_0x5727ee;if(_0x4b9143[_0x52c985(_0x258e71._0x3b8860)])_0x469976(_0x4b9143['value']);else _0x4b9143[_0x52c985(0x11f)]&&_0x4b9143['coords'][_0x52c985(0x11c)](_0x24114f=>{_0x469976(_0x24114f);});});});if(_0xbd5aef===0x0&&_0x3593c9===0x0&&_0x1c79e5===0x0&&_0x190172===0x0)return null;return _0x278e0b!==null&&_0x278e0b!==void 0x0&&_0x278e0b['isFormat']?{'xmin':_0xbd5aef,'xmax':_0x1c79e5,'ymin':_0x3593c9,'ymax':_0x190172}:Cesium['Rectangle']['fromDegrees'](_0xbd5aef,_0x3593c9,_0x1c79e5,_0x190172);}['on'](_0x234a38,_0x1feea4,_0x31965a){return this['_echartsInstance']['on'](_0x234a38,_0x1feea4,_0x31965a||this),this;}[_0x5b99ab(0x109)](_0x29f2e6,_0x47ab6b,_0x5968e7,_0x227db7){const _0x1c33f0={_0x466414:0x134},_0x1181f6=_0x5b99ab;return this[_0x1181f6(_0x1c33f0._0x466414)]['on'](_0x29f2e6,_0x47ab6b,_0x5968e7,_0x227db7||this),this;}['off'](_0x226562,_0x50ceae,_0x34a3bd){const _0x387eee=_0x5b99ab;return this[_0x387eee(0x134)]['off'](_0x226562,_0x50ceae,_0x34a3bd||this),this;}}mars3d__namespace['LayerUtil']['register'](_0x5b99ab(0x141),EchartsLayer),mars3d__namespace['layer']['EchartsLayer']=EchartsLayer,mars3d__namespace[_0x5b99ab(0x141)]=echarts__namespace,exports[_0x5b99ab(0x13e)]=EchartsLayer,Object['keys'](echarts)['forEach'](function(_0x1782d6){const _0x33b1aa={_0x1219a6:0x116},_0x260ef5=_0x5b99ab;if(_0x1782d6!=='default'&&!exports['hasOwnProperty'](_0x1782d6))Object[_0x260ef5(_0x33b1aa._0x1219a6)](exports,_0x1782d6,{'enumerable':!![],'get':function(){return echarts[_0x1782d6];}});}),Object[_0x5b99ab(0x116)](exports,_0x5b99ab(0x137),{'value':!![]});
}));
