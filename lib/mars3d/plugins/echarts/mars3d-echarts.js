/**
 * Mars3D平台插件,结合echarts可视化功能插件  mars3d-echarts
 *
 * 版本信息：v3.7.5
 * 编译日期：2024-02-25 10:20:07
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2024-01-15
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.echarts || require('echarts')), (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'echarts', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-echarts"] = {}, global.echarts, global.mars3d));
})(this, (function (exports, echarts, mars3d) { 
'use strict';const _0xb95e32=_0x3f52;function _0x3f52(_0x53ba9b,_0x53d0c0){const _0x25430b=_0x2543();return _0x3f52=function(_0x3f5254,_0x37682d){_0x3f5254=_0x3f5254-0x1aa;let _0x10cea5=_0x25430b[_0x3f5254];return _0x10cea5;},_0x3f52(_0x53ba9b,_0x53d0c0);}(function(_0x1f7b89,_0x5a20c1){const _0x53aa92={_0x14e7a2:0x1f0,_0x425a2a:0x1cb,_0x3bbfdc:0x1d7,_0x1e3759:0x1c2},_0x4d1477=_0x3f52,_0x5bb868=_0x1f7b89();while(!![]){try{const _0x1c09ba=parseInt(_0x4d1477(_0x53aa92._0x14e7a2))/0x1*(-parseInt(_0x4d1477(0x1d1))/0x2)+-parseInt(_0x4d1477(0x1dc))/0x3+parseInt(_0x4d1477(_0x53aa92._0x425a2a))/0x4*(parseInt(_0x4d1477(0x1de))/0x5)+parseInt(_0x4d1477(0x1b4))/0x6*(parseInt(_0x4d1477(0x1c4))/0x7)+parseInt(_0x4d1477(0x1e7))/0x8+parseInt(_0x4d1477(_0x53aa92._0x3bbfdc))/0x9+-parseInt(_0x4d1477(_0x53aa92._0x1e3759))/0xa;if(_0x1c09ba===_0x5a20c1)break;else _0x5bb868['push'](_0x5bb868['shift']());}catch(_0x4b2069){_0x5bb868['push'](_0x5bb868['shift']());}}}(_0x2543,0x82aa7));function _interopNamespace(_0x425dea){if(_0x425dea&&_0x425dea['__esModule'])return _0x425dea;var _0x417877=Object['create'](null);return _0x425dea&&Object['keys'](_0x425dea)['forEach'](function(_0x549567){if(_0x549567!=='default'){var _0x594021=Object['getOwnPropertyDescriptor'](_0x425dea,_0x549567);Object['defineProperty'](_0x417877,_0x549567,_0x594021['get']?_0x594021:{'enumerable':!![],'get':function(){return _0x425dea[_0x549567];}});}}),_0x417877['default']=_0x425dea,_0x417877;}var echarts__namespace=_interopNamespace(echarts),mars3d__namespace=_interopNamespace(mars3d);const Cesium$1=mars3d__namespace['Cesium'];class CompositeCoordinateSystem{constructor(_0x490c50,_0x437e6b){const _0x40276a=_0x3f52;this['_mars3d_scene']=_0x490c50,this[_0x40276a(0x1d3)]=[_0x40276a(0x1bc),'lat'],this[_0x40276a(0x1da)]=[0x0,0x0],this['_api']=_0x437e6b;}['setMapOffset'](_0x3e1aca){this['_mapOffset']=_0x3e1aca;}[_0xb95e32(0x1b3)](){const _0x17b876={_0x4a7c78:0x1db},_0x28f67b=_0xb95e32;return this[_0x28f67b(_0x17b876._0x4a7c78)];}[_0xb95e32(0x1ba)](_0x1174bb){const _0x227613={_0x59b719:0x1c6,_0xd8613d:0x1ec,_0x193405:0x1b0,_0x5b9741:0x1da},_0x3a88ae=_0xb95e32,_0x64db30=this['_mars3d_scene'],_0x36d507=[NaN,NaN];let _0x121c8e=_0x64db30['echartsFixedHeight'];_0x64db30['echartsAutoHeight']&&(_0x121c8e=_0x64db30['getHeight'](Cesium$1['Cartographic']['fromDegrees'](_0x1174bb[0x0],_0x1174bb[0x1])));const _0x4ab30f=Cesium$1[_0x3a88ae(_0x227613._0x59b719)]['fromDegrees'](_0x1174bb[0x0],_0x1174bb[0x1],_0x121c8e);if(!_0x4ab30f)return _0x36d507;const _0xc663da=Cesium$1['SceneTransforms'][_0x3a88ae(0x1e9)](_0x64db30,_0x4ab30f);if(!_0xc663da)return _0x36d507;if(_0x64db30['echartsDepthTest']&&_0x64db30['mode']===Cesium$1['SceneMode'][_0x3a88ae(0x1e5)]){const _0x549c5e=new Cesium$1['EllipsoidalOccluder'](_0x64db30[_0x3a88ae(_0x227613._0xd8613d)]['ellipsoid'],_0x64db30[_0x3a88ae(_0x227613._0x193405)]['positionWC']),_0x173097=_0x549c5e['isPointVisible'](_0x4ab30f);if(!_0x173097)return _0x36d507;}return[_0xc663da['x']-this[_0x3a88ae(_0x227613._0x5b9741)][0x0],_0xc663da['y']-this[_0x3a88ae(_0x227613._0x5b9741)][0x1]];}['getViewRect'](){const _0x12a9ff={_0x39bb46:0x1e1},_0x4071ec=_0xb95e32,_0x2a3663=this[_0x4071ec(0x1bb)];return new echarts__namespace[(_0x4071ec(0x1ae))]['BoundingRect'](0x0,0x0,_0x2a3663[_0x4071ec(0x1bf)](),_0x2a3663[_0x4071ec(_0x12a9ff._0x39bb46)]());}['getRoamTransform'](){return echarts__namespace['matrix']['create']();}}CompositeCoordinateSystem[_0xb95e32(0x1d3)]=['lng','lat'],CompositeCoordinateSystem['create']=function(_0x36ad59,_0x364775){const _0x3b7181={_0x119402:0x1b9},_0x2fc9c6=_0xb95e32;let _0x550fe2;const _0x13b100=_0x36ad59['scheduler']['ecInstance']['_mars3d_scene'];_0x36ad59['eachComponent']('mars3dMap',function(_0x22710d){const _0x40a09f=_0x3f52,_0x543c2d=_0x364775[_0x40a09f(_0x3b7181._0x119402)]()['painter'];if(!_0x543c2d)return;!_0x550fe2&&(_0x550fe2=new CompositeCoordinateSystem(_0x13b100,_0x364775)),_0x22710d[_0x40a09f(0x1c7)]=_0x550fe2,_0x550fe2['setMapOffset'](_0x22710d['__mapOffset']||[0x0,0x0]);}),_0x36ad59[_0x2fc9c6(0x1b6)](function(_0x3f68f0){const _0x5376a5=_0x2fc9c6;_0x3f68f0[_0x5376a5(0x1b5)]('coordinateSystem')==='mars3dMap'&&(!_0x550fe2&&(_0x550fe2=new CompositeCoordinateSystem(_0x13b100,_0x364775)),_0x3f68f0['coordinateSystem']=_0x550fe2);});};if(echarts__namespace!==null&&echarts__namespace!==void 0x0&&echarts__namespace['init'])echarts__namespace['registerCoordinateSystem']('mars3dMap',CompositeCoordinateSystem),echarts__namespace[_0xb95e32(0x1f1)]({'type':_0xb95e32(0x1d9),'event':'mars3dMapRoam','update':'updateLayout'},function(_0x5b98f6,_0x832c8a){}),echarts__namespace['extendComponentModel']({'type':'mars3dMap','getBMap':function(){return this['_mars3d_scene'];},'defaultOption':{'roam':![]}}),echarts__namespace[_0xb95e32(0x1ea)]({'type':'mars3dMap','init':function(_0x27db91,_0x27f0fa){const _0x4a38de={_0x5e8906:0x1b8,_0x1a56a6:0x1e3},_0x22a9c0=_0xb95e32;this[_0x22a9c0(_0x4a38de._0x5e8906)]=_0x27f0fa,this['scene']=_0x27db91[_0x22a9c0(_0x4a38de._0x1a56a6)]['ecInstance']['_mars3d_scene'],this['scene']['postRender']['addEventListener'](this[_0x22a9c0(0x1e4)],this);},'moveHandler':function(_0x224f2e,_0x4f7a67){const _0x370a3e={_0x5c08b4:0x1c9},_0x1d567a=_0xb95e32;this['api'][_0x1d567a(_0x370a3e._0x5c08b4)]({'type':'mars3dMapRoam'});},'render':function(_0x2e7298,_0x853439,_0x2d8c38){},'dispose':function(_0xbba208){const _0x2f139a={_0x3b0ea1:0x1c5},_0x79723f=_0xb95e32;this['scene'][_0x79723f(_0x2f139a._0x3b0ea1)]['removeEventListener'](this['moveHandler'],this);}});else throw new Error('请引入\x20echarts\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer'][_0xb95e32(0x1c1)];function _0x2543(){const _0xdfd4c6=['1406700QGXPlT','height','1434640ejFxUZ','pointerEvents','div','getHeight','top','scheduler','moveHandler','SCENE3D','_echartsInstance','6994664JIKPCS','mars3d-echarts','wgs84ToWindowCoordinates','extendComponentView','_map','globe','isArray','getRectangle','Util','17NQieTN','registerAction','isFormat','setEchartsOption','_echartsContainer','clientWidth','graphic','left','camera','create','width','getBMap','292260LnAZvr','get','eachSeries','echarts','api','getZr','dataToPoint','_api','lng','max','all','getWidth','container','BaseLayer','6702910yNvjIz','forEach','84yfjqgB','postRender','Cartesian3','coordinateSystem','echartsFixedHeight','dispatchAction','echartsAutoHeight','4fboxiL','style','defineProperty','_pointerEvents','fromDegrees','series','92320qEvxwQ','scene','dimensions','_removedHook','coords','none','6420033tCdPpV','resize','mars3dMapRoam','_mapOffset','_mars3d_scene'];_0x2543=function(){return _0xdfd4c6;};return _0x2543();}class EchartsLayer extends BaseLayer{constructor(_0x5c0f0f={}){const _0x508439={_0x5eb2cd:0x1ce},_0x3c2413=_0xb95e32;super(_0x5c0f0f),this[_0x3c2413(_0x508439._0x5eb2cd)]=this['options'][_0x3c2413(0x1df)];}get['layer'](){return this['_echartsInstance'];}get[_0xb95e32(0x1df)](){return this['_pointerEvents'];}set['pointerEvents'](_0x5d3688){const _0x10d9fd=_0xb95e32;this['_pointerEvents']=_0x5d3688,this['_echartsContainer']&&(_0x5d3688?this[_0x10d9fd(0x1ac)][_0x10d9fd(0x1cc)]['pointerEvents']='all':this['_echartsContainer']['style']['pointerEvents']='none');}['_setOptionsHook'](_0x169dc6,_0x5232b6){this['setEchartsOption'](_0x169dc6);}['_showHook'](_0x174849){const _0x32021f={_0x594c6a:0x1cc},_0x1270fb=_0xb95e32;_0x174849?this['_echartsContainer']['style']['visibility']='visible':this['_echartsContainer'][_0x1270fb(_0x32021f._0x594c6a)]['visibility']='hidden';}['_mountedHook'](){const _0x3e0bef=_0xb95e32;this['_map'][_0x3e0bef(0x1d2)]['echartsDepthTest']=this['options']['depthTest']??!![],this['_map']['scene'][_0x3e0bef(0x1ca)]=this['options']['clampToGround']??![],this[_0x3e0bef(0x1eb)]['scene'][_0x3e0bef(0x1c8)]=this['options']['fixedHeight']??0x0;}['_addedHook'](){const _0x5aa189={_0xcd5506:0x1ac,_0x16150b:0x1e6,_0x362aed:0x1db},_0x362c9b=_0xb95e32;this[_0x362c9b(_0x5aa189._0xcd5506)]=this['_createChartOverlay'](),this['_echartsInstance']=echarts__namespace['init'](this['_echartsContainer']),this[_0x362c9b(_0x5aa189._0x16150b)][_0x362c9b(_0x5aa189._0x362aed)]=this['_map']['scene'],this['setEchartsOption'](this['options']);}[_0xb95e32(0x1d4)](){const _0x3ec9a3={_0x47764c:0x1e6,_0x23dc41:0x1ac},_0x5bdfb2=_0xb95e32;this[_0x5bdfb2(_0x3ec9a3._0x47764c)]&&(this['_echartsInstance']['clear'](),this['_echartsInstance']['dispose'](),delete this['_echartsInstance']),this[_0x5bdfb2(_0x3ec9a3._0x23dc41)]&&(this['_map']['container']['removeChild'](this[_0x5bdfb2(0x1ac)]),delete this[_0x5bdfb2(0x1ac)]);}['_createChartOverlay'](){const _0x466ebc={_0x1d3bfc:0x1b1,_0x1a4dd2:0x1c0,_0xe77687:0x1ad,_0x503f57:0x1d6},_0x9d82d4=_0xb95e32,_0x36cd48=mars3d__namespace['DomUtil'][_0x9d82d4(_0x466ebc._0x1d3bfc)](_0x9d82d4(0x1e0),_0x9d82d4(0x1e8),this['_map'][_0x9d82d4(_0x466ebc._0x1a4dd2)]);return _0x36cd48['id']=this['id'],_0x36cd48['style']['position']='absolute',_0x36cd48['style'][_0x9d82d4(0x1e2)]='0px',_0x36cd48['style'][_0x9d82d4(0x1af)]='0px',_0x36cd48[_0x9d82d4(0x1cc)][_0x9d82d4(0x1b2)]=this[_0x9d82d4(0x1eb)]['scene']['canvas'][_0x9d82d4(_0x466ebc._0xe77687)]+'px',_0x36cd48['style']['height']=this['_map']['scene']['canvas']['clientHeight']+'px',_0x36cd48['style']['pointerEvents']=this['_pointerEvents']?_0x9d82d4(0x1be):_0x9d82d4(_0x466ebc._0x503f57),_0x36cd48['style']['zIndex']=this['options']['zIndex']??0x9,_0x36cd48;}[_0xb95e32(0x1d8)](){const _0x1f1f60={_0x18778f:0x1b2,_0x2c7764:0x1dd},_0x55c057=_0xb95e32;if(!this['_echartsInstance'])return;this['_echartsContainer'][_0x55c057(0x1cc)][_0x55c057(_0x1f1f60._0x18778f)]=this['_map']['scene']['canvas']['clientWidth']+'px',this['_echartsContainer'][_0x55c057(0x1cc)][_0x55c057(_0x1f1f60._0x2c7764)]=this['_map'][_0x55c057(0x1d2)]['canvas']['clientHeight']+'px',this['_echartsInstance']['resize']();}[_0xb95e32(0x1ab)](_0x414be8,_0x54f727,_0x421187){const _0x439ec4=_0xb95e32;this['_echartsInstance']&&(_0x414be8={'mars3dMap':{},...mars3d__namespace[_0x439ec4(0x1ef)]['getAttrVal'](_0x414be8,{'onlySimpleType':!![]})},delete _0x414be8['eventParent'],this['_echartsInstance']['setOption'](_0x414be8,_0x54f727,_0x421187));}[_0xb95e32(0x1ee)](_0x415595){const _0x5f1335={_0xca6082:0x1c3},_0x840c25={_0x1afb18:0x1ed,_0x413b62:0x1bd},_0x5ae8d5=_0xb95e32;let _0x43e8e9,_0x4d57d5,_0x128e18,_0x52b79f;function _0x302331(_0xa2eb89){const _0x1088a8=_0x3f52;if(!Array[_0x1088a8(_0x840c25._0x1afb18)](_0xa2eb89))return;const _0x39472b=_0xa2eb89[0x0]||0x0,_0x1be31b=_0xa2eb89[0x1]||0x0;_0x39472b!==0x0&&_0x1be31b!==0x0&&(_0x43e8e9===undefined?(_0x43e8e9=_0x39472b,_0x4d57d5=_0x39472b,_0x128e18=_0x1be31b,_0x52b79f=_0x1be31b):(_0x43e8e9=Math['min'](_0x43e8e9,_0x39472b),_0x4d57d5=Math[_0x1088a8(0x1bd)](_0x4d57d5,_0x39472b),_0x128e18=Math['min'](_0x128e18,_0x1be31b),_0x52b79f=Math[_0x1088a8(_0x840c25._0x413b62)](_0x52b79f,_0x1be31b)));}const _0x3b4143=this['options'][_0x5ae8d5(0x1d0)];_0x3b4143&&_0x3b4143[_0x5ae8d5(_0x5f1335._0xca6082)](_0x382f85=>{const _0x461067=_0x5ae8d5;_0x382f85['data']&&_0x382f85['data'][_0x461067(0x1c3)](_0x31e270=>{const _0x4bf015=_0x461067;if(_0x31e270['value'])_0x302331(_0x31e270['value']);else _0x31e270[_0x4bf015(0x1d5)]&&_0x31e270['coords']['forEach'](_0x5d2e58=>{_0x302331(_0x5d2e58);});});});if(_0x43e8e9===0x0&&_0x128e18===0x0&&_0x4d57d5===0x0&&_0x52b79f===0x0)return null;return _0x415595!==null&&_0x415595!==void 0x0&&_0x415595[_0x5ae8d5(0x1aa)]?{'xmin':_0x43e8e9,'xmax':_0x4d57d5,'ymin':_0x128e18,'ymax':_0x52b79f}:Cesium['Rectangle'][_0x5ae8d5(0x1cf)](_0x43e8e9,_0x128e18,_0x4d57d5,_0x52b79f);}['on'](_0x2bdbd5,_0x1488cd,_0x3bf140){return this['_echartsInstance']['on'](_0x2bdbd5,_0x1488cd,_0x3bf140||this),this;}['onByQuery'](_0x13a123,_0x198264,_0x1927c4,_0x134007){return this['_echartsInstance']['on'](_0x13a123,_0x198264,_0x1927c4,_0x134007||this),this;}['off'](_0x2cd916,_0x33fb8f,_0x259828){const _0x3d1597={_0x4ecd81:0x1e6},_0x49f922=_0xb95e32;return this[_0x49f922(_0x3d1597._0x4ecd81)]['off'](_0x2cd916,_0x33fb8f,_0x259828||this),this;}}mars3d__namespace['LayerUtil']['register']('echarts',EchartsLayer),mars3d__namespace['layer']['EchartsLayer']=EchartsLayer,mars3d__namespace[_0xb95e32(0x1b7)]=echarts__namespace,exports['EchartsLayer']=EchartsLayer,Object['keys'](echarts)[_0xb95e32(0x1c3)](function(_0x207e5a){const _0x50569b=_0xb95e32;if(_0x207e5a!=='default'&&!exports['hasOwnProperty'](_0x207e5a))Object[_0x50569b(0x1cd)](exports,_0x207e5a,{'enumerable':!![],'get':function(){return echarts[_0x207e5a];}});}),Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
