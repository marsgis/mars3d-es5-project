/**
 * Mars3D平台插件,结合echarts可视化功能插件  mars3d-echarts
 *
 * 版本信息：v3.5.8
 * 编译日期：2023-05-23 19:43:59
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.echarts || require('echarts')), (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'echarts', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-echarts"] = {}, global.echarts, global.mars3d));
})(this, (function (exports, echarts, mars3d) { 
'use strict';const _0x590a00=_0x1687;(function(_0x4d9350,_0x1aa259){const _0x35124b={_0x3cfcd4:0xbf,_0x546e03:0xf2,_0x10f869:0xee},_0x18dd20=_0x1687,_0x767f48=_0x4d9350();while(!![]){try{const _0x5792bf=parseInt(_0x18dd20(0xfc))/0x1*(-parseInt(_0x18dd20(0xcc))/0x2)+-parseInt(_0x18dd20(_0x35124b._0x3cfcd4))/0x3+-parseInt(_0x18dd20(0xeb))/0x4*(parseInt(_0x18dd20(0xec))/0x5)+parseInt(_0x18dd20(0xe9))/0x6*(parseInt(_0x18dd20(_0x35124b._0x546e03))/0x7)+-parseInt(_0x18dd20(0xf7))/0x8+parseInt(_0x18dd20(_0x35124b._0x10f869))/0x9*(-parseInt(_0x18dd20(0xce))/0xa)+-parseInt(_0x18dd20(0xfb))/0xb*(-parseInt(_0x18dd20(0xe5))/0xc);if(_0x5792bf===_0x1aa259)break;else _0x767f48['push'](_0x767f48['shift']());}catch(_0x140613){_0x767f48['push'](_0x767f48['shift']());}}}(_0x34cf,0x21c57));function _0x1687(_0xa849f2,_0x201e24){const _0x34cfa4=_0x34cf();return _0x1687=function(_0x168766,_0x46dc1f){_0x168766=_0x168766-0xbd;let _0x5cc6d2=_0x34cfa4[_0x168766];return _0x5cc6d2;},_0x1687(_0xa849f2,_0x201e24);}function _interopNamespace(_0x33dc74){const _0x10a528={_0x2c791b:0xc1},_0x5b4cd9={_0x3e0911:0xd2,_0x278bfb:0xc7},_0xa53df1=_0x1687;if(_0x33dc74&&_0x33dc74['__esModule'])return _0x33dc74;var _0x282a6c=Object[_0xa53df1(_0x10a528._0x2c791b)](null);return _0x33dc74&&Object['keys'](_0x33dc74)['forEach'](function(_0x1fb386){const _0x2726a9=_0xa53df1;if(_0x1fb386!==_0x2726a9(_0x5b4cd9._0x3e0911)){var _0x4d6197=Object['getOwnPropertyDescriptor'](_0x33dc74,_0x1fb386);Object[_0x2726a9(_0x5b4cd9._0x278bfb)](_0x282a6c,_0x1fb386,_0x4d6197[_0x2726a9(0xd6)]?_0x4d6197:{'enumerable':!![],'get':function(){return _0x33dc74[_0x1fb386];}});}}),_0x282a6c[_0xa53df1(0xd2)]=_0x33dc74,_0x282a6c;}var echarts__namespace=_interopNamespace(echarts),mars3d__namespace=_interopNamespace(mars3d);const Cesium$1=mars3d__namespace[_0x590a00(0xc9)];class CompositeCoordinateSystem{constructor(_0x40b960,_0x348a05){const _0x10b357=_0x590a00;this[_0x10b357(0xe6)]=_0x40b960,this['dimensions']=['lng','lat'],this[_0x10b357(0xe3)]=[0x0,0x0],this['_api']=_0x348a05;}['setMapOffset'](_0x4930d6){this['_mapOffset']=_0x4930d6;}['getBMap'](){return this['_mars3d_scene'];}['dataToPoint'](_0x18e355){const _0x1780c0={_0x273b17:0xf8,_0x170aa6:0xd1,_0x4c3b71:0xd4,_0x29ae76:0xfd,_0x5efb61:0xf9,_0x4361b6:0xe3},_0x59561c=_0x590a00,_0x5808d3=this['_mars3d_scene'],_0x3ea5db=[NaN,NaN];let _0x5baf97=_0x5808d3[_0x59561c(0xe2)];_0x5808d3[_0x59561c(_0x1780c0._0x273b17)]&&(_0x5baf97=_0x5808d3['globe'][_0x59561c(_0x1780c0._0x170aa6)](Cesium$1['Cartographic']['fromDegrees'](_0x18e355[0x0],_0x18e355[0x1])));const _0x1e1007=Cesium$1[_0x59561c(_0x1780c0._0x4c3b71)][_0x59561c(0xf4)](_0x18e355[0x0],_0x18e355[0x1],_0x5baf97);if(!_0x1e1007)return _0x3ea5db;const _0x23d0f7=Cesium$1[_0x59561c(_0x1780c0._0x29ae76)]['wgs84ToWindowCoordinates'](_0x5808d3,_0x1e1007);if(!_0x23d0f7)return _0x3ea5db;if(_0x5808d3['echartsDepthTest']&&_0x5808d3['mode']===Cesium$1['SceneMode'][_0x59561c(_0x1780c0._0x5efb61)]){const _0x4265b3=new Cesium$1['EllipsoidalOccluder'](_0x5808d3['globe']['ellipsoid'],_0x5808d3['camera']['positionWC']),_0x172e02=_0x4265b3['isPointVisible'](_0x1e1007);if(!_0x172e02)return _0x3ea5db;}return[_0x23d0f7['x']-this[_0x59561c(_0x1780c0._0x4361b6)][0x0],_0x23d0f7['y']-this['_mapOffset'][0x1]];}[_0x590a00(0xea)](){const _0x5a0a7b=this['_api'];return new echarts__namespace['graphic']['BoundingRect'](0x0,0x0,_0x5a0a7b['getWidth'](),_0x5a0a7b['getHeight']());}[_0x590a00(0xca)](){return echarts__namespace['matrix']['create']();}}CompositeCoordinateSystem[_0x590a00(0xc5)]=[_0x590a00(0xfe),'lat'],CompositeCoordinateSystem[_0x590a00(0xc1)]=function(_0xd6092d,_0x36f9cd){const _0xef1660={_0x40e283:0xc2,_0x3db27d:0xfa,_0x4d21d9:0xdd},_0x165c49={_0x229e54:0xcb},_0x46b946=_0x590a00;let _0x2790fb;const _0x3ca480=_0xd6092d['scheduler'][_0x46b946(_0xef1660._0x40e283)][_0x46b946(0xe6)];_0xd6092d[_0x46b946(_0xef1660._0x3db27d)](_0x46b946(_0xef1660._0x4d21d9),function(_0xbcd216){const _0x5a66f0=_0x46b946,_0x59e554=_0x36f9cd['getZr']()['painter'];if(!_0x59e554)return;!_0x2790fb&&(_0x2790fb=new CompositeCoordinateSystem(_0x3ca480,_0x36f9cd)),_0xbcd216['coordinateSystem']=_0x2790fb,_0x2790fb[_0x5a66f0(_0x165c49._0x229e54)](_0xbcd216['__mapOffset']||[0x0,0x0]);}),_0xd6092d['eachSeries'](function(_0xfd3281){const _0x11e3c8=_0x46b946;_0xfd3281['get'](_0x11e3c8(0xed))==='mars3dMap'&&(!_0x2790fb&&(_0x2790fb=new CompositeCoordinateSystem(_0x3ca480,_0x36f9cd)),_0xfd3281[_0x11e3c8(0xed)]=_0x2790fb);});};if(echarts__namespace!==null&&echarts__namespace!==void 0x0&&echarts__namespace['init'])echarts__namespace['registerCoordinateSystem']('mars3dMap',CompositeCoordinateSystem),echarts__namespace[_0x590a00(0xde)]({'type':'mars3dMapRoam','event':'mars3dMapRoam','update':'updateLayout'},function(_0xb0d5dc,_0x17f35e){}),echarts__namespace['extendComponentModel']({'type':_0x590a00(0xdd),'getBMap':function(){return this['_mars3d_scene'];},'defaultOption':{'roam':![]}}),echarts__namespace['extendComponentView']({'type':_0x590a00(0xdd),'init':function(_0x5d01e0,_0x112bb2){const _0x3d329f=_0x590a00;this['api']=_0x112bb2,this['scene']=_0x5d01e0['scheduler']['ecInstance']['_mars3d_scene'],this['scene'][_0x3d329f(0xbd)]['addEventListener'](this['moveHandler'],this);},'moveHandler':function(_0x4fb521,_0x41ac85){this['api']['dispatchAction']({'type':'mars3dMapRoam'});},'render':function(_0x3acefb,_0x390771,_0x4499d1){},'dispose':function(_0x5d4725){const _0x49fbb4=_0x590a00;this['scene']['postRender']['removeEventListener'](this[_0x49fbb4(0xe4)],this);}});else throw new Error('请引入\x20echarts\x20库\x20');function _0x34cf(){const _0x41355c=['0px','40558PdrKHD','max','fromDegrees','fixedHeight','_createChartOverlay','865792yPwoXp','echartsAutoHeight','SCENE3D','eachComponent','8306518HmqxWj','17421wgBYZg','SceneTransforms','lng','init','postRender','value','532626cNQFKc','_map','create','ecInstance','visibility','div','dimensions','off','defineProperty','_pointerEvents','Cesium','getRoamTransform','setMapOffset','2TrYjRG','echartsDepthTest','4530QEliiq','removeChild','_showHook','getHeight','default','forEach','Cartesian3','height','get','clientHeight','series','style','layer','_echartsInstance','width','mars3dMap','registerAction','EchartsLayer','min','resize','echartsFixedHeight','_mapOffset','moveHandler','12POCzia','_mars3d_scene','_addedHook','pointerEvents','240DsaGSZ','getViewRect','1096148cPYAsL','5TbSjOj','coordinateSystem','5391pqdWth','scene','canvas'];_0x34cf=function(){return _0x41355c;};return _0x34cf();}const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace['layer']['BaseLayer'];class EchartsLayer extends BaseLayer{constructor(_0x442bba={}){super(_0x442bba),this['_pointerEvents']=this['options']['pointerEvents'];}get[_0x590a00(0xda)](){return this['_echartsInstance'];}get['pointerEvents'](){return this['_pointerEvents'];}set['pointerEvents'](_0x3962d1){const _0x5bafc9={_0x137bac:0xc8,_0x17a7fd:0xd9,_0x79d876:0xe8},_0x25b434=_0x590a00;this[_0x25b434(_0x5bafc9._0x137bac)]=_0x3962d1,this['_echartsContainer']&&(_0x3962d1?this['_echartsContainer'][_0x25b434(_0x5bafc9._0x17a7fd)]['pointerEvents']='all':this['_echartsContainer']['style'][_0x25b434(_0x5bafc9._0x79d876)]='none');}['_setOptionsHook'](_0x5de600,_0x4207d7){this['setEchartsOption'](_0x5de600);}[_0x590a00(0xd0)](_0x27a338){const _0xc05918={_0x1d3e91:0xd9},_0x18f02d=_0x590a00;_0x27a338?this['_echartsContainer'][_0x18f02d(_0xc05918._0x1d3e91)][_0x18f02d(0xc3)]='visible':this['_echartsContainer']['style']['visibility']='hidden';}['_mountedHook'](){const _0x56889c={_0x663dc3:0xcd,_0x35c07a:0xc0,_0xe7e227:0xf5},_0x2236f9=_0x590a00;this[_0x2236f9(0xc0)][_0x2236f9(0xef)][_0x2236f9(_0x56889c._0x663dc3)]=this['options']['depthTest']??!![],this['_map']['scene']['echartsAutoHeight']=this['options']['clampToGround']??![],this[_0x2236f9(_0x56889c._0x35c07a)]['scene']['echartsFixedHeight']=this['options'][_0x2236f9(_0x56889c._0xe7e227)]??0x0;}[_0x590a00(0xe7)](){const _0x4fa60b={_0x43e03b:0xf6,_0x1513f0:0xdb},_0x1d9b36=_0x590a00;this['_echartsContainer']=this[_0x1d9b36(_0x4fa60b._0x43e03b)](),this['_echartsInstance']=echarts__namespace[_0x1d9b36(0xff)](this['_echartsContainer']),this[_0x1d9b36(_0x4fa60b._0x1513f0)]['_mars3d_scene']=this['_map']['scene'],this['setEchartsOption'](this['options']);}['_removedHook'](){const _0x12806c={_0x13db18:0xdb,_0x535a40:0xcf},_0x14ea9a=_0x590a00;this['_echartsInstance']&&(this[_0x14ea9a(_0x12806c._0x13db18)]['clear'](),this['_echartsInstance']['dispose'](),delete this[_0x14ea9a(0xdb)]),this['_echartsContainer']&&(this['_map']['container'][_0x14ea9a(_0x12806c._0x535a40)](this['_echartsContainer']),delete this['_echartsContainer']);}['_createChartOverlay'](){const _0x365c28={_0x468be:0xf1,_0x250eb0:0xdc,_0x3c6f03:0xf0,_0x28339f:0xd9,_0x3495c6:0xc0,_0x45044d:0xd7},_0x394355=_0x590a00,_0xae3603=mars3d__namespace['DomUtil']['create'](_0x394355(0xc4),'mars3d-echarts',this['_map']['container']);return _0xae3603['id']=this['id'],_0xae3603['style']['position']='absolute',_0xae3603['style']['top']='0px',_0xae3603[_0x394355(0xd9)]['left']=_0x394355(_0x365c28._0x468be),_0xae3603[_0x394355(0xd9)][_0x394355(_0x365c28._0x250eb0)]=this['_map']['scene'][_0x394355(_0x365c28._0x3c6f03)]['clientWidth']+'px',_0xae3603[_0x394355(_0x365c28._0x28339f)]['height']=this[_0x394355(_0x365c28._0x3495c6)]['scene']['canvas'][_0x394355(_0x365c28._0x45044d)]+'px',_0xae3603['style']['pointerEvents']=this['_pointerEvents']?'all':'none',_0xae3603['style']['zIndex']=this['options']['zIndex']??0x9,_0xae3603;}['resize'](){const _0x1a3b63={_0x54a1f5:0xf0},_0x54349a=_0x590a00;if(!this['_echartsInstance'])return;this['_echartsContainer'][_0x54349a(0xd9)]['width']=this['_map']['scene'][_0x54349a(0xf0)]['clientWidth']+'px',this['_echartsContainer']['style'][_0x54349a(0xd5)]=this['_map']['scene'][_0x54349a(_0x1a3b63._0x54a1f5)]['clientHeight']+'px',this[_0x54349a(0xdb)][_0x54349a(0xe1)]();}['setEchartsOption'](_0x15ba18,_0x41dc1a,_0x41bea5){const _0x32a0af=_0x590a00;this[_0x32a0af(0xdb)]&&(_0x15ba18['mars3dMap']=_0x15ba18['mars3dMap']||{},this['_echartsInstance']['setOption'](_0x15ba18,_0x41dc1a,_0x41bea5));}['getRectangle'](_0x13d26d){const _0x52eeed={_0x15d638:0xd3},_0x370a03={_0x50c10a:0xe0},_0x4558ff=_0x590a00;let _0x3b232b,_0x4148e6,_0x1f949e,_0x113d7e;function _0x4bf13e(_0x2a9187){const _0x97c855=_0x1687;if(!Array['isArray'](_0x2a9187))return;const _0x293d2b=_0x2a9187[0x0]||0x0,_0x4bbcf3=_0x2a9187[0x1]||0x0;_0x293d2b!==0x0&&_0x4bbcf3!==0x0&&(_0x3b232b===undefined?(_0x3b232b=_0x293d2b,_0x4148e6=_0x293d2b,_0x1f949e=_0x4bbcf3,_0x113d7e=_0x4bbcf3):(_0x3b232b=Math['min'](_0x3b232b,_0x293d2b),_0x4148e6=Math['max'](_0x4148e6,_0x293d2b),_0x1f949e=Math[_0x97c855(_0x370a03._0x50c10a)](_0x1f949e,_0x4bbcf3),_0x113d7e=Math[_0x97c855(0xf3)](_0x113d7e,_0x4bbcf3)));}const _0x3265d2=this['options'][_0x4558ff(0xd8)];_0x3265d2&&_0x3265d2['forEach'](_0x2fe239=>{_0x2fe239['data']&&_0x2fe239['data']['forEach'](_0x3d1a47=>{const _0x2ae814=_0x1687;if(_0x3d1a47['value'])_0x4bf13e(_0x3d1a47[_0x2ae814(0xbe)]);else _0x3d1a47['coords']&&_0x3d1a47['coords'][_0x2ae814(_0x52eeed._0x15d638)](_0x2457ed=>{_0x4bf13e(_0x2457ed);});});});if(_0x3b232b===0x0&&_0x1f949e===0x0&&_0x4148e6===0x0&&_0x113d7e===0x0)return null;return _0x13d26d!==null&&_0x13d26d!==void 0x0&&_0x13d26d['isFormat']?{'xmin':_0x3b232b,'xmax':_0x4148e6,'ymin':_0x1f949e,'ymax':_0x113d7e}:Cesium['Rectangle'][_0x4558ff(0xf4)](_0x3b232b,_0x1f949e,_0x4148e6,_0x113d7e);}['on'](_0x1d898d,_0x4e5f05,_0x5dce50){return this['_echartsInstance']['on'](_0x1d898d,_0x4e5f05,_0x5dce50||this),this;}['onByQuery'](_0x51443d,_0x4865f2,_0x100d48,_0x218f21){return this['_echartsInstance']['on'](_0x51443d,_0x4865f2,_0x100d48,_0x218f21||this),this;}[_0x590a00(0xc6)](_0x3a1af6,_0x9aa422,_0x28f082){return this['_echartsInstance']['off'](_0x3a1af6,_0x9aa422,_0x28f082||this),this;}}mars3d__namespace['LayerUtil']['register']('echarts',EchartsLayer),mars3d__namespace['layer']['EchartsLayer']=EchartsLayer,exports[_0x590a00(0xdf)]=EchartsLayer,Object['keys'](echarts)['forEach'](function(_0x17cef7){const _0x29511d=_0x590a00;if(_0x17cef7!==_0x29511d(0xd2)&&!exports['hasOwnProperty'](_0x17cef7))Object['defineProperty'](exports,_0x17cef7,{'enumerable':!![],'get':function(){return echarts[_0x17cef7];}});}),Object['defineProperty'](exports,'__esModule',{'value':!![]});
}));
